(function(){"use strict";"use strict";function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};!function(){angular.module("endo.api",["endo.model","endo.common.rest","endo.api.auth","endo.api.premium","endo.api.workout","endo.api.notifications","endo.api.feed","endo.api.user","endo.api.challenge","endo.api.commitment","endo.api.consent"]).config(["$httpProvider",function(a){var b=["common.rest.JsonCamelCaseInterceptor","common.rest.DateTimeInterceptor","common.rest.CsrfHeaderInterceptor"];b.forEach(function(b){a.interceptors.push(b)})}])}(),function(){angular.module("endo.api.auth",[])}(),function(){angular.module("endo.api.challenge",[])}(),function(){angular.module("endo.api.commitment",[])}(),function(){angular.module("endo.api.consent",[])}(),function(){angular.module("endo.api.feed",[])}(),function(){angular.module("endo.api.notifications",[])}(),function(){angular.module("endo.api.premium",[])}(),function(){angular.module("endo.api.user",[])}(),function(){angular.module("endo.api.workout",[])}(),function(){angular.module("endo.common.base",["endo.core.lang"])}(),function(){angular.module("endo.common.asset",["endo.core","endo.common.base"])}(),function(){function a(a,b,c,d){b.isGuest()&&!a.get("isBot")&&c(d.get())}function b(a,b,c,d){d.subscribe("logout",function(){c.location="/"})}a.$inject=["config","user","common.auth.autologin","common.auth.authProvider"],b.$inject=["$state","$stateParams","$window","core.event.topic"],angular.module("endo.common.auth",["endo.core"]).run(b).run(a)}(),function(){var a=angular.module("endo.common",["endo.common.base","endo.common.asset","endo.common.auth","endo.common.data","endo.common.date","endo.common.detect","endo.common.filter","endo.common.i18n","endo.common.loader","endo.common.model","endo.common.pref","endo.common.rest","endo.common.router","endo.common.template","endo.common.tracker","endo.common.vendor","endo.common.units","endo.common.lang"]);a.config(["layer","userProvider",function(a,b){a.session&&b.set(a.session)}]),a.config(["layer","configProvider",function(a,b){b.layer=a}]),a.config(["layer","common.asset.assetMapProvider",function(a,b){var c={};angular.isObject(a.assetMap)&&(c=a.assetMap),b.set(c)}]),a.config(["common.asset.assetPathProvider",function(a){a.basePath="/assets/"}])}(),function(){angular.module("endo.common.data",[])}(),function(){angular.module("endo.common.date",[])}(),function(){angular.module("endo.common.detect",["endo.core.has"])}(),function(){angular.module("endo.common.filter",[])}(),function(){angular.module("endo.common.i18n",["ui.router","endo.common.asset"])}(),function(){angular.module("endo.common.lang",[])}(),function(){angular.module("endo.common.loader",[])}(),function(){angular.module("endo.common.model",[])}(),function(){angular.module("endo.common.pref",[])}(),function(){angular.module("endo.common.rest",[])}(),function(){function a(a){var b="common.router.type.",c=["after","before","sport","float","integer"];c.forEach(function(c){a.type(c,{},[b+c,function(a){return a}])})}var b=angular.module("endo.common.router",[]);b.config(["$urlRouterProvider","$locationProvider",function(a,b){b.html5Mode(!0),a.when("","/"),a.otherwise(function(a,b){a.get("$state").go("front")}),a.rule(function(a,b){var c=b.url();"/"===c[c.length-1]&&b.replace().path(c.slice(0,-1))})}]),b.run(["$rootScope","$location","$window","header","footer",function(a,b,c,d,e){a.$on("$stateChangeSuccess",function(a,d){b.hash()||d.data&&d.data.autoscroll===!1||c.scrollTo(0,0)}),a.$on("$stateChangeSuccess",function(a,b,c,d,f){return b.footer===!1?void e.hide():void e.show()}),a.$on("$stateChangeSuccess",function(a,b,c,e,f){return b.header===!1?void d.hide():void d.show()})}]),b.run(["$log","$rootScope","$timeout","ui.progress.progressBar","ui.control.Toast","Raven",function(a,b,c,d,e,f){var g="router";b.$on("$stateChangeStart",function(){d.start(g)}),b.$on("$stateChangeSuccess",function(){d.end(g)}),b.$on("$stateChangeError",function(b,h,i,j,k,l){d.end(g),c(function(){e.show(":(")},400),a.error(l),f.captureMessage("RoutingError: '"+h.name+"' => '"+j.name+"'",{tags:{source:"router"},extra:{fromState:h.name,fromParams:i,toState:j.name,toParams:k,error:l}})})}]),a.$inject=["$urlMatcherFactoryProvider"],b.config(a)}(),function(){angular.module("endo.common.template",[])}(),function(){var a=angular.module("endo.common.tracker",["endo.common.auth","endo.common.vendor"]);a.run(["$rootScope","common.tracker",function(a,b){a.$on("$stateChangeSuccess",function(){b.trackPageview()})}])}(),function(){angular.module("endo.common.units",["endo.common.base","endo.common.i18n"])}(),function(){var a=/^\[((?:[$a-zA-Z0-9]+:)?(?:[$a-zA-Z0-9]+))\] (.+?)\n(\S+)$/,b="https://7f35d8199c4d4e90b39910c9471a803c@sentry-proxy.uacf.io/95";if(window.Raven){var c="development";/^secreturl\./.exec(window.location.host)&&(c="staging"),/^www\./.exec(window.location.host)&&(c="production");var d={tags:{env:c},ignoreErrors:[],whitelistUrls:[/endomondo\.com/],dataCallback:function(b){var c=b.exception;if(c){c=c.values[0];var d=a.exec(c.value);d&&(c.type=d[1],c.value=d[2],b.message=c.type+": "+c.value,b.extra.angularDocs=d[3].substr(0,250))}},shouldSendCallback:function(a){if(!a)return!1;if("production"!==c)return!1;var b=JSON.stringify(a);if(~b.indexOf("adsafeprotected.com"))return!1;for(var d=a.message||"",e=["Can't execute code from a freed script","Code eines freigegebenen Skripts kann nicht ausgeführt werden","Kan ikke utføre kode fra et frigitt skript","Impossible d'exécuter le code à partir d'un script libéré","No se puede ejecutar código de un script liberado",'Error: Permission denied to access property "type"',"Error: Permission denied to access property 'type'","NS_ERROR_FAILURE","NS_ERROR_NOT_INITIALIZED","Error: [$rootScope:inprog]","Error: Unspecified error."],f=e.length,g=0;f>g;g++)if(~d.indexOf(e[g]))return!1;if(a.culprit&&"string"==typeof a.culprit)for(var h=a.culprit,i=["/C:/Users/IBM_ADMIN/","metrics in Anonymous function","highcharts"],j=i.length,k=0;j>k;k++)if(~h.indexOf(i[k]))return!1;return!0}};window.Raven.config(b,d).install(),angular.module("endo.common.vendor.raven",[]).constant("Raven",window.Raven)}}(),function(){angular.module("endo.common.vendor",["endo.common.vendor.raven"])}(),function(){angular.module("endo.core",["endo.core.dom","endo.core.event","endo.core.func","endo.core.has","endo.core.io","endo.core.lang","endo.core.math","endo.core.util"])}(),function(){angular.module("endo.core.dom",["ui.bootstrap.transition"])}(),function(){angular.module("endo.core.event",[])}(),function(){angular.module("endo.core.func",[])}(),function(){angular.module("endo.core.has",[])}(),function(){angular.module("endo.core.io",[])}(),function(){angular.module("endo.core.lang",[])}(),function(){angular.module("endo.core.math",[])}(),function(){angular.module("endo.core.util",[])}(),function(){angular.module("endo.model",["endo.core"])}(),function(){angular.module("endo.ui.behavior",["ngSanitize","endo.core"])}(),function(){angular.module("endo.ui.calendar",[])}(),function(){angular.module("endo.ui.challenge",[])}(),function(){angular.module("endo.ui.chart",["endo.core","endo.common.units"])}(),function(){angular.module("endo.ui.control",[])}(),function(){angular.module("endo.ui.datetime",[])}(),function(){angular.module("endo.ui.event",[])}(),function(){angular.module("endo.ui.feed.common",[])}(),function(){angular.module("endo.ui.feed",["endo.ui.feed.common"])}(),function(){angular.module("endo.ui.form",["endo.ui.form.validation"])}(),function(){angular.module("endo.ui.form.validation",[])}(),function(){angular.module("endo.ui.map",[])}(),function(){angular.module("endo.ui.picture",[])}(),function(){angular.module("endo.ui.progress",[])}(),function(){angular.module("endo.ui.social.buttons",[])}(),function(){angular.module("endo.ui.social.links",[])}(),function(){angular.module("endo.ui.social",["endo.ui.social.links","endo.ui.social.buttons"])}(),function(){angular.module("endo.ui.trainingplan",[])}(),function(){function a(a,c,d){c.$on("$stateChangeSuccess",function(c,e){var f=e&&e.name?b.indexOf(e.name)>-1:!1;f||d.execute().then(function(b){return a.log("executed("+b+")")}).catch(function(b){return a.log("not executed("+b+")")})})}var b=["boarding.profile","boarding.metrics","boarding.friends","boarding.welcome","consent.login","consent.signup","auth.login","auth.signup","auth.callback.login.facebook","auth.callback.login.google","auth.callback.signup.facebook","auth.callback.signup.google"];angular.module("endo.ui.trial",[]).run(a),a.$inject=["$log","$rootScope","ui.trial.MonthTrialService"]}(),function(){angular.module("endo.ui",["endo.ui.behavior","endo.ui.calendar","endo.ui.chart","endo.ui.control","endo.ui.datetime","endo.ui.event","endo.ui.form","endo.ui.map","endo.ui.picture","endo.ui.progress","endo.ui.social","endo.ui.workout","endo.ui.trainingplan","endo.ui.feed","endo.ui.challenge","endo.ui.trial"])}(),function(){angular.module("endo.ui.workout",[])}(),function(){var a=angular.module("endo.view.about",[]);a.config(["$stateProvider",function(a){a.state("about",{"abstract":!0,templateUrl:"tpl://view/about/about.en.html",controller:"AboutViewController"}),a.state("about.about",{url:"/about",templateUrl:"tpl://view/about/about/about.en.html"}),a.state("about.jobs",{url:"/jobs",templateUrl:"tpl://view/about/jobs/jobs.en.html"})}])}(),function(){var a={pane:{LOGIN:0,SIGNUP:1,SIGNUP_EMAIL:2,SIGNUP_COUNTRY:3,SIGNUP_CONSENT_CANADA:4,SIGNUP_CONFIRM:5},templateUrl:"tpl://view/auth/auth.en.html",requiresCanadaConsent:!1};angular.module("endo.view.auth",[]).constant("view.auth.locals",a)}(),function(){function a(a){a.state("auth",{"abstract":!0,component:"authLayout"}),a.state("auth.callback",{"abstract":!0,template:"<ui-view/>"}),a.state("auth.callback.login",{"abstract":!0,template:"<ui-view/>"}),a.state("auth.callback.signup",{"abstract":!0,template:"<ui-view/>"})}a.$inject=["$stateProvider"];var b=["endo.view.auth2.login","endo.view.auth2.signup"];angular.module("endo.view.auth2",b).config(a)}(),function(){function a(a,b,c,d,e,f,g){var h=d.makeCallbackUrl(e,f);h?a.location=h:b.login(f).then(function(){c.publish("login/success",e)}).catch(g)}function b(a,b){var c={};if(b)try{var d=JSON.parse(b);d&&d.object&&(c.returnUrl=d.returnUrl,c.sessionParams=d.object)}catch(e){c.returnUrl=b}return c.sessionParams=c.sessionParams?Object.assign(a,JSON.parse(c.sessionParams)):a,c}function c(c,d){d.when("/login?returnUrl",["$state","user",function(a,b){return b.isGuest()?!1:(a.go("home"),!0)}]),c.state("auth.login",{url:"/login?returnUrl",component:"login",header:!1,footer:!1,params:{returnUrl:void 0},resolve:{returnUrl:["$stateParams",function(a){return a.returnUrl}]}}),c.state("auth.callback.login.facebook",{url:"/login/callback/facebook?error&error_code&error_description&error_reason&state",component:"progressOverlay",header:!1,footer:!1,onEnter:["$window","$location","$state","$stateParams","core.io.url","core.event.topic","api.auth.session","ui.MsgBox","urlBuilder",function(c,d,e,f,g,h,i,j,k){function l(){var a=f.state;j.open("tpl://view/auth2/login/error/facebook-auth-error.en.html").finally(function(){e.go("auth.login",{"#":null,returnUrl:a})})}var m=g.parseHash(d.hash()),n=m.access_token,o=m.expires_in,p=m.state;if(f.error)return l();var q={type:"FACEBOOK",accessToken:n,expires:o},r=b(q,p);a(c,i,h,k,r.returnUrl,r.sessionParams,l)}]}),c.state("auth.callback.login.google",{url:"/login/callback/google",component:"progressOverlay",header:!1,footer:!1,onEnter:["$window","$location","core.io.url","core.event.topic","api.auth.session","$state","$stateParams","ui.MsgBox","urlBuilder",function(c,d,e,f,g,h,i,j,k){function l(){j.open("tpl://view/auth2/login/error/google-auth-error.en.html").finally(function(){h.go("auth.login",{"#":null,returnUrl:returnUrl})})}var m=e.parseHash(d.hash()),n=m.access_token,o=m.expires_in,p=m.code,q=m.state;if(m.error)return l();var r=c.location.origin+"/login/callback/google",s={type:"GOOGLE",accessToken:n,expires:o,code:p,redirectUri:r},t=b(s,q);a(c,g,f,k,t.returnUrl,t.sessionParams,l)}]})}function d(a,b,c,d,e,f){e.subscribe("login/success",function(e,g){if(angular.isString(g)){var h=b.location.toString(),i=decodeURIComponent(g);if(f.isSecure(h,i))return void f(i)}return angular.isObject(g)&&angular.isString(g.stateName)?void a.go(g.stateName,g.stateParams):c.get("locale.language")!==d.locale.language()?void(b.location="/home"):void a.go("home",{"#":null})})}c.$inject=["$stateProvider","$urlRouterProvider"],d.$inject=["$state","$window","config","viewer","core.event.topic","common.router.redirect"],angular.module("endo.view.auth2.login",[]).config(c).run(d)}(),function(){function a(a,b){b.when("/signup?returnUrl",["$state","user",function(a,b){return b.isGuest()?!1:(a.go("home"),!0)}]),a.state("auth.signup",{url:"/signup?returnUrl",component:"signup",header:!1,footer:!1,params:{user:void 0,returnUrl:void 0},resolve:{user:["$stateParams",function(a){return a.user}],returnUrl:["$stateParams",function(a){return a.returnUrl}],countries:["$q","api.consent.ConsentResource","model.CountryTranslate",function(a,b,c){return a.all({countries:b.fetchAllConsentsPerCountry(),translate:c.load()}).then(function(a){var b=a.countries;a.translate;return b.map(function(a){return{id:a.countryCode,name:c.name(a.countryCode)}}).filter(function(a){return a.name})})}]}}),a.state("auth.callback.signup.facebook",{url:"/signup/callback/facebook?error&error_code&error_description&error_reason&state",component:"progressOverlay",header:!1,footer:!1,onEnter:["config","$state","$location","$stateParams","api.auth.facebook2","core.io.url","ui.MsgBox",function(a,b,c,d,e,f,g){function h(){var a=d.state;g.open("tpl://view/auth2/signup/error/facebook-auth-error.en.html").finally(function(){b.go("auth.signup",{"#":null,returnUrl:a})})}if(d.error)return h();var i=f.parseHash(c.hash()),j=i.access_token,k=i.expires_in,l=[e.Fields.ID,e.Fields.NAME,e.Fields.EMAIL,e.Fields.BIRTHDAY],m=void 0;e.me(j,l).then(function(a){var b=a.birthday;if(angular.isString(b)&&10===b.length){var c=/(\d{2})\/(\d{2})\/(\d{4})/gm,d=c.exec(b),e=(d[0],d[1]),f=d[2],g=d[3];m=new Date(g,e-1,f)}}).finally(function(){b.go("consent.signup",{user:{type:"FACEBOOK",accessToken:j,expires:k},confirm:{dateOfBirth:m,countryCode:a.get("viewerCountry")||void 0},"#":null})})}]}),a.state("auth.callback.signup.google",{url:"/signup/callback/google",component:"progressOverlay",header:!1,footer:!1,onEnter:["config","$location","$window","core.io.url","core.event.topic","api.auth.session","$state","$stateParams","ui.MsgBox",function(a,b,c,d,e,f,g,h,i){function j(){i.open("tpl://view/auth2/signup/error/google-auth-error.en.html").finally(function(){g.go("auth.signup",{"#":null,returnUrl:o})})}var k=d.parseHash(b.hash()),l=k.access_token,m=k.expires_in,n=k.code,o=k.state;if(k.error)return j();var p=c.location.origin+"/signup/callback/google";g.go("consent.signup",{user:{type:"GOOGLE",accessToken:l,code:n,expires:m,redirectUri:p},confirm:{dateOfBirth:void 0,countryCode:a.get("viewerCountry")||void 0},"#":null})}]})}a.$inject=["$stateProvider","$urlRouterProvider"],angular.module("endo.view.auth2.signup",[]).config(a)}(),function(){function a(a){var c=b.indexOf(a);c>=0&&b.splice(c,1)}var b=["boarding.profile","boarding.metrics","boarding.friends","boarding.welcome"],c=angular.module("endo.view.boarding",["endo.view.boarding.profile","endo.view.boarding.metrics","endo.view.boarding.friends","endo.view.boarding.welcome"]);c.config(["$stateProvider",function(c){c.state("boarding",{"abstract":!0,url:"/boarding?id?group?type?user",templateUrl:"tpl://view/boarding/boarding.en.html",controller:"BoardingViewController",resolve:{userProfile:["api.user.UserResource","user","$q",function(b,c,d){return c.isGuest()?null:d.all({user:b.get(c.id),suggestedFriends:b.suggestedFriends(c.id)}).then(function(b){var c=b.user;return c.suggestedFriends=b.suggestedFriends,b.suggestedFriends&&0!==b.suggestedFriends.length||a("boarding.friends"),c})}],boardingStates:function(){return b}},onEnter:["$state","userProfile",function(a,b){b||a.go("front")}]})}])}(),function(){var a=angular.module("endo.view.boarding.friends",[]);a.config(["$stateProvider",function(a){a.state("boarding.friends",{url:"/friends",templateUrl:"tpl://view/boarding/friends/friends.en.html",controller:"BoardingFriendsController",onEnter:["userProfile","$state",function(a,b){a.suggestedFriends&&0!==a.suggestedFriends.length||b.go("home")}]})}])}(),function(){var a=angular.module("endo.view.boarding.metrics",[]);a.config(["$stateProvider",function(a){a.state("boarding.metrics",{url:"/metrics",templateUrl:"tpl://view/boarding/metrics/metrics.en.html",controller:"BoardingMetricsController",resolve:{translateUnits:["common.unit.UNITS",function(a){return a.load()}]}})}])}(),function(){var a=angular.module("endo.view.boarding.profile",[]);a.config(["$stateProvider",function(a){a.state("boarding.profile",{url:"/profile",templateUrl:"tpl://view/boarding/profile/profile.en.html",controller:"BoardingProfileController"})}])}(),function(){var a=angular.module("endo.view.boarding.welcome",[]);a.config(["$stateProvider",function(a){a.state("boarding.welcome",{url:"/welcome",templateUrl:"tpl://view/boarding/welcome/welcome.en.html",controller:["$scope","$stateParams","$state","user",function(a,b,c,d){a.viewer=d,a.finish=function(){b.id&&d.emailVerified?c.go("invite.success",b):c.go("home")}}]})}])}(),function(){var a=angular.module("endo.view.business",[]);a.config(["$stateProvider",function(a){a.state("business",{"abstract":!0,templateUrl:"tpl://view/business/business.en.html",controller:"BusinessViewController"}),a.state("business.activation",{url:"/activationtools",templateUrl:"tpl://view/business/activation/activation.en.html"}),a.state("business.advertising",{url:"/advertising",templateUrl:"tpl://view/business/ad/ad.en.html"})}])}(),function(){function a(a,b){function c(a,b,c){var d=[];return b.workoutId.forEach(function(a){d.push(c.get(b.userId,a))}),a.all(d)}var d="/users/:userId/compare?workoutId";b.when(d,["$state","$match","user",function(a,b,c){return b.userId==c.id&&c.premium?!1:void a.go("front")}]),a.state("top.compare",{url:d,params:{workoutId:{array:!0}},templateUrl:"tpl://view/compare/compare.en.html",controller:"view.compare.CompareController",resolve:{workouts:c,translate:["$q","common.i18n.Translation","common.unit.UNITS",function(a,b,c){return a.all({units:c.load(),chart:b.load("ui.chart")})}],Highcharts:["common.loader.highcharts",function(a){return a.load()}]}}),c.$inject=["$q","$stateParams","api.workout.WorkoutResource"]}a.$inject=["$stateProvider","$urlRouterProvider"],angular.module("endo.view.compare",[]).config(a)}(),function(){function a(a,b){function c(a,b){return a.isGuest()?void b.go("auth.login"):void b.go("home")}c.$inject=["user","$state"],b.when("/consent",c),a.state("consent",{"abstract":!0,component:"authLayout",resolve:{hasLogoutLink:["user",function(a){return!a.isGuest()}],resolvedUser:["$q","user","api.user.UserResource",function(a,b,c){return b.isGuest()?a.resolve({}):c.get(b.id)}],consentCollection:["api.consent.ConsentResource","model.consent.ConsentCollection",function(a,b){return a.fetchAllConsentsPerCountry().then(function(a){return new b(a)})}],translateConsent:["common.i18n.Translation",function(a){return a.load("common/data/consents.i18n.json")}]}})}function b(a,b,c){var d=function(a){return"settings.account"===a.name||"settings.archive"===a.name||"settings.delete"===a.name||"auth.callback.login.facebook"===a.name||"auth.callback.login.google"===a.name},e=a.$on("$stateChangeStart",function(a,f,g){if("consent.login"!==f.name&&!c.isGuest()){if(c.consentNeeded===!0){if(d(f))return;return a.preventDefault(),void b.go("consent.login",{returnState:{name:f.name,params:g}})}e()}})}a.$inject=["$stateProvider","$urlRouterProvider"],b.$inject=["$rootScope","$state","user"];var c=["endo.view.consent.GDPRLoginConsentFlow","endo.view.consent.GDPRSignupConsentFlow"];angular.module("endo.view.consent",c).config(a).run(b)}(),function(){function a(a){a.state("consent.login",{component:"gdprLoginConsentFlow",header:!1,footer:!1,params:{returnState:void 0},resolve:{returnState:["$stateParams",function(a){return a.returnState}],dateOfBirth:["resolvedUser",function(a){return a.dateOfBirth}],country:["config","resolvedUser",function(a,b){return b.country?b.country:a.get("viewerCountry")}],countries:["$q","api.consent.ConsentResource","model.CountryTranslate",function(a,b,c){return a.all({countries:b.fetchAllConsentsPerCountry(),translate:c.load()}).then(function(a){var b=a.countries;a.translate;return b.map(function(a){return{id:a.countryCode,name:c.name(a.countryCode)}}).filter(function(a){return a.name})})}],consentResolver:["consentCollection","translateConsent","model.consent.ConsentResolver",function(a,b,c){return new c(a,b)}],saveUser:["user","api.user.UserResource",function(a,b){return function(c){return b.update(a.id,c)}}],saveConsents:["user","api.consent.ConsentResource",function(a,b){return function(c){return b.putUserConsents(a.id,c)}}]}})}a.$inject=["$stateProvider"],angular.module("endo.view.consent.GDPRLoginConsentFlow",[]).config(a)}(),function(){function a(a){a.state("consent.signup",{component:"gdprSignupFacebookFlow",header:!1,footer:!1,params:{user:void 0,confirm:void 0},resolve:{user:["$stateParams",function(a){return a.user}],confirm:["$stateParams",function(a){return a.confirm}],countries:["$q","api.consent.ConsentResource","model.CountryTranslate",function(a,b,c){return a.all({countries:b.fetchAllConsentsPerCountry(),translate:c.load()}).then(function(a){var b=a.countries;a.translate;return b.map(function(a){return{id:a.countryCode,name:c.name(a.countryCode)}}).filter(function(a){return a.name})})}],consentResolver:["consentCollection","translateConsent","model.consent.ConsentResolver",function(a,b,c){return new c(a,b)}],createAccount:["api.auth.account",function(a){return function(b){return a.create(b)}}]}})}a.$inject=["$stateProvider"],angular.module("endo.view.consent.GDPRSignupConsentFlow",[]).config(a)}(),function(){var a=angular.module("endo.view.download",[]);a.config(["$stateProvider",function(a){a.state("download",{url:"/download",templateUrl:"tpl://view/download/download.en.html",controller:"DownloadFeaturesController"}),a.state("features",{url:"/features",templateUrl:"tpl://view/download/download.en.html",controller:"DownloadFeaturesController"})}])}(),function(){angular.module("endo.view.front",[]).config(["$stateProvider",function(a){a.state("front",{url:"/",templateUrl:"tpl://view/front/front.en.html",controller:"FrontViewController"})}]).run(["$state","$rootScope","user",function(a,b,c){b.$on("$stateChangeStart",function(b,d,e,f,g){c.isGuest()||"front"!==d.name||(b.preventDefault(),a.go("home"))})}])}(),function(){function a(a,b){var c={};a.state("top.history",{"abstract":!0,templateUrl:"tpl://view/history/history.en.html",controller:"view.history.HistoryController",resolve:{model:[function(){return c}],translate:["$q","common.data.SportTranslate","common.unit.UNITS",function(a,b,c){return a.all({units:c.load(),sports:b.load()})}]}});var d=["{after:after}","{before:before}","{sport:sport}","{fromDistance:float}","{toDistance:float}","{fromDuration:integer}","{toDuration:integer}","title","{route:integer}","tags"],e="/users/:userId/history?"+d.join("&");b.when(e,["$state","$match","$location","user",function(a,b,c,d){return d.isGuest()?void a.go("auth.login",{returnUrl:c.url()}):(b.userId=d.id,void a.go("top.history.params",b))}]),a.state("top.history.params",{url:e,params:{tags:{array:!0}},onEnter:["$stateParams","workouts","routes","sports",function(a,b,d,e){c.params=a,c.workouts=b,c.routes=d,c.sports=e}],data:{autoscroll:!1},resolve:{workouts:["$stateParams","api.workout.WorkoutResource",function(a,b){var c={};return angular.forEach(a,function(a,b){a&&(c[b]=a)}),b.search(a.userId,c)}],routes:["$stateParams","api.user.UserResource",function(a,b){return c.routes&&c.params&&c.params.userId==a.userId?c.routes:b.listWorkoutRoutes(a.userId)}],sports:["$q","$stateParams","api.user.UserResource","api.workout.SportEnum",function(a,b,d,e){return a(function(a,f){return c.sports&&c.params&&c.params.userId==b.userId?a(c.sports):void d.listWorkoutSports(b.userId).then(function(b){return b&&b.length?(b=b.map(function(a){return e.get(a.sport)}),void a(b)):a(e)}).catch(function(){a(e)})})}]}})}a.$inject=["$stateProvider","$urlRouterProvider"],angular.module("endo.view.history",[]).config(a)}(),function(){function a(a,d){var e={},f=20,g=["$state","$match","user",function(a,b,d){if(d.isGuest())return void a.go("auth.login");var e={tag:b.tag,feedId:b.feedId};a.go(c,e,{location:!1})}];d.when(b,g),d.when(b+"/feed/:feedId",g),d.when(b+"/tag/:tag",g),a.state(c,{url:b,params:{feedId:null,tag:null},footer:!1,templateUrl:"tpl://view/home/home.en.html",controller:"HomeViewController",resolve:{feeds:["$stateParams","api.feed.FeedResource","common.model.Collection","user",function(a,b,c,d){return a.feedId?b.getFeed(a.feedId).then(function(a){return new c([a])}):a.tag?b.getFeedsByTag(a.tag):b.subscriptions(d.id,f)}],translate:["common.i18n.Translation","common.unit.UNITS","common.data.SportTranslate","model.challenge.ChallengeTranslate","$q",function(a,b,c,d,e){return e.all([c.load(),b.load(),a.load("common.data.records"),a.load("common.data.privacy"),a.load("common.data.trainingplan"),a.load("ui.chart"),d.load()])}],userProfile:["api.user.UserResource","user",function(a,b){return a.get(b.id)}],Highcharts:["common.loader.highcharts",function(a){return a.load()}],model:[function(){return e}],sharethrough:["common.loader.sharethrough",function(a){return a.load(),!0}]},onEnter:["feeds","userProfile","$stateParams",function(a,b,c){e.showStartBoxes=!(a&&a.length),e.feeds=a,e.user=b,e.PAGE_SIZE=f}]})}var b="/home",c="home";a.$inject=["$stateProvider","$urlRouterProvider"];var d=angular.module("endo.view.home",[]);d.config(a)}(),function(){var a=angular.module("endo.view.invite",[]);a.config(["$stateProvider","$urlRouterProvider","inviteTypes",function(a,b,c){var d="/invite?user?type?group?id";b.when(d,["$state","$match","$location","api.user.UserResource","api.challenge.ChallengeResource","api.commitment.CommitmentResource",function(a,b,d,e,f,g){var h=!!~[c.CHALLENGE,c.COMMITMENT].indexOf(b.type);return b.user&&b.id&&b.type&&(!h||b.group)?void e.get(b.user).then(function(c){a.go("invite.welcome",{user:c,id:b.id,group:b.group,type:b.type}).catch(function(a){$stage.go("front")})}).catch(function(b){a.go("auth.login",{returnUrl:d.url()})}):void a.go("front")}]),a.state("invite",{template:"<div ui-view></div>","abstract":!0,params:{id:void 0,group:void 0,type:void 0,user:void 0},resolve:{model:["$q","$stateParams","api.user.UserResource","api.challenge.ChallengeResource","api.commitment.CommitmentResource",function(a,b,d,e,f){var g=b.user,h={user:g};switch(b.type){case c.CHALLENGE:h.challenge=e.get(b.group);break;case c.COMMITMENT:h.commitment=f.get(g.id,b.group)}return a.all(h)}],translateSports:["common.data.SportTranslate",function(a){return a.load()}]}}),a.state("invite.welcome",{params:{id:void 0,group:void 0,type:void 0,user:void 0},controller:"InviteViewController",templateUrl:"tpl://view/invite/invite.en.html"}),a.state("invite.success",{templateUrl:"tpl://view/invite/success.en.html",controller:"InviteSuccessViewController"})}]),a.constant("inviteTypes",{FRIENDS:"si",CHALLENGE:"ch",COMMITMENT:"co"})}(),function(){var a=["front","premium","splash","login","login-facebook-callback","login-google-callback","signup","invite.welcome","invite.success","invite.confirm","static.samsunggear","static.applemusic","consent.login","consent.signup","auth.login","auth.signup","auth.callback.login.facebook","auth.callback.login.google","auth.callback.signup.facebook","auth.callback.signup.google"];angular.module("endo.view.layout",[]).config(["$stateProvider",function(a){a.state("top",{"abstract":!0,template:"<ui-view/>"}),a.state("dialog",{"abstract":!0,views:{dialog:{template:"<ui-view/>"}}})}]).run(["$rootScope","cta","user",function(b,c,d){b.$on("$stateChangeSuccess",function(b,e,f,g,h){return a.indexOf(e.name)>-1?void c.hide():d.isGuest()||d.emailVerified?void(d.isGuest()&&!c.isVisible()&&(c.setContent("<eo-guest-cta></eo-guest-cta>"),c.show())):(c.setContent("<eo-email-cta></eo-email-cta>"),void c.show())})}])}(),function(){function a(a){function b(a,b,c){d=c.open(),d.result.finally(function(){d=null})}function c(){d&&d.dismiss()}var d;a.state("dialog.merge",{params:{workoutIds:{array:!0}},onEnter:b,onExit:c}),b.$inject=["$stateParams","$previousState","view.merge.MergeDialog"],c.$inject=[]}a.$inject=["$stateProvider"],angular.module("endo.view.merge",[]).config(a)}(),function(){function a(a,d){a.state("newsletters",{url:b,template:c,resolve:{newsletters:["$stateParams","$state","$location","api.settings.NewslettersResource",function(a,b,c,d){var e={};return a.key&&(e.key=a.key,e.userId=a.id,e.email=a.email),d.get(e).catch(function(){return b.go("auth.login",{returnUrl:c.path()})})}],params:["$stateParams",function(a){return{key:a.key,userId:a.id,email:a.email}}],onSubmit:["$stateParams","api.settings.NewslettersResource",function(a,b){var c={key:a.key,userId:a.id,email:a.email};return function(a,d){return d.$pristine?void 0:b.put(c,a)}}]}})}var b="/newsletter/unsubscribe?{key:any}&id&email",c='\n    <div class="container">\n      <div class="row">\n        <div class="col-xs-12 col-sm-8 col-sm-push-2 col-md-6 col-md-push-3">\n          <div class="newsletters-wrap">\n            <newsletters\n              newsletters="$resolve.newsletters"\n              params="$resolve.params"\n              on-submit="$resolve.onSubmit(data, form)"\n            >\n          </div>\n        </div>\n      </div>\n    </div>\n  ';a.$inject=["$stateProvider","$urlRouterProvider"],angular.module("endo.view.newsletters",[]).config(a)}(),function(){var a=angular.module("endo.view.policy",[]);a.config(["$urlRouterProvider",function(a){function b(a){return["$window",function(b){b.location=a}]}a.when("/terms",b("https://account.underarmour.com/terms-and-conditions")),a.when("/privacy",b("https://account.underarmour.com/privacy")),a.when("/cookies",b("https://account.underarmour.com/privacy#how-we-use-data-collection-tools-and-online-advertising"))}])}(),function(){var a=angular.module("endo.view.premium",[]);a.config(["$stateProvider","$urlRouterProvider",function(a,b){b.when("/premium/:coupon",["$match","$state",function(a,b){var c={coupon:a.coupon,plan:"yearly"};b.transitionTo("premium",c,{location:!1})}]),b.when("/premium/:coupon/nopopup",["$match","$state",function(a,b){var c={coupon:a.coupon,plan:"yearly",nopopup:!0};b.transitionTo("premium",c,{location:!1})}]),a.state("premium",{url:"/premium?coupon&plan&campaign&nopopup",templateUrl:"tpl://view/premium/premium.en.html",controller:"PremiumViewController",resolve:{isEligibleForFreeTrial:["$q","user","api.premium.plan",function(a,b,c){var d=a.defer();return b.isGuest()?a.resolve(!1):b.premium?a.resolve(!1):(c.isEligibleForFreeTrial().then(function(){
return d.resolve(!0)}).catch(function(){return d.resolve(!1)}),d.promise)}]}})}])}(),function(){function a(a){a.state("settings.archive",{url:"/account/archive",component:"archivePage",resolve:{jobInfo:["$q","user","model.job.JobStateEnum","api.settings.ArchiveResource",function(a,b,c,d){return function(){var c=a.defer();return d.getJobStatus(b.id).then(function(){return c.resolve()}).catch(function(a){return c.reject(a)}),c.promise}}]}})}a.$inject=["$stateProvider"],angular.module("endo.view.settings.archive",[]).config(a)}(),function(){function a(a){a.state("settings.delete",{url:"/account/delete",component:"deletePage",resolve:{jobInfo:["$q","user","model.job.JobStateEnum","api.settings.DeleteResource",function(a,b,c,d){return function(){var c=a.defer();return d.getJobStatus(b.id).then(function(){return c.resolve()}).catch(function(a){return c.reject(a)}),c.promise}}]}})}a.$inject=["$stateProvider"],angular.module("endo.view.settings.delete",[]).config(a)}(),function(){function a(a){a.state("settings.privacy",{url:"/privacy",component:"privacyPage",resolve:{rules:["$q","user","api.settings.PrivacyResource","api.auth.session",function(a,b,c,d){var e=c.fetch(b.id),f=d.get();return a.all({rules:e,session:f}).then(function(a){var b=a.rules;return b})}],isPrivateUserJobPending:["user","model.job.JobStateEnum","api.settings.PrivacyResource",function(a,b,c){return c.getPrivateUserJob(a.id).then(function(a){var c=a.state;return b.isPending(c)}).catch(function(){return!1})}],isWorkoutPrivacySyncJobPending:["user","model.job.JobStateEnum","api.settings.PrivacyResource",function(a,b,c){return c.getWorkoutPrivacySyncJob(a.id).then(function(a){var c=a.state;return b.isPending(c)}).catch(function(){return!1})}],onRuleClick:["user","api.settings.PrivacyResource",function(a,b){return function(c,d){var e;return b.updateRules(a.id,(e={},e[c]=d,e))}}],onPresetClick:["$q","user","api.auth.session","api.settings.PrivacyResource","model.privacy.PrivacyPresetEnum",function(a,b,c,d,e){return function(f){var g=a.defer();return f===e.PRIVATE?(d.triggerPrivateUserJob(b.id).then(function(){return g.resolve()}).catch(function(a){return g.reject(a)}),g.promise):(d.updateRules(b.id,f).then(function(a){c.get().then(function(){return g.resolve(a)}).catch(function(a){return g.reject(a)})}).catch(function(a){return g.reject(a)}),g.promise)}}],onWorkoutPrivacySyncJob:["user","api.settings.PrivacyResource",function(a,b){return function(){return b.triggerWorkoutPrivacySyncJob(a.id)}}]}})}a.$inject=["$stateProvider"],angular.module("endo.view.settings.privacy",[]).config(a)}(),function(){function a(a,d){d.when(b,["core.dom.media",function(a){return a.getBreakpointName()===a.XSMALL?!1:""+b+c}]),d.when(b+"/{path:.*}",["$state","$match","$location","user",function(a,b,c,d){return d.isGuest()?void a.go("auth.login",{returnUrl:c.url()}):!1}]),a.state("settings",{url:b,component:"settingsView",resolve:{message:function(){return"This is message."}}}),a.state("settings.profile",{url:"/profile",component:"profileSettingsView",resolve:{user:["user","api.user.UserResource",function(a,b){return b.get(a.id)}],translate:["$q","common.i18n.Translation","model.CountryTranslate","common.data.SportTranslate",function(a,b,c,d){return a.all({units:b.load("common/units/units.i18n.json"),countries:c.load(),sports:d.load()})}],countries:["$q","api.auth.account","model.auth.ConsentFallbackCollection",function(a,b,c){return a(function(a,d){b.listCountries().then(function(b){return a(b)}).catch(function(){return a(new c)})})}]}}),a.state("settings.account",{url:"/account",component:"accountSettingsView"}),a.state("settings.emails",{url:"/emails",component:"emailsSettingsView",resolve:{emails:["user","api.settings.EmailsResource",function(a,b){return b.list(a.id)}]}}),a.state("settings.connect",{url:"/connect",component:"connectSettingsView",params:{connectionResult:null},resolve:{userConnections:["user","api.settings.ConnectionsResource","model.connection.ConnectionType",function(a,b,c){return b.list(a.id).then(function(a){return a.map(function(a){return a.type=c.get(a.type),a})})}],visibleConnections:["user","api.settings.ConnectionsResource","model.connection.ConnectionType",function(a,b,c){return window.ConnectionType=c,b.listVisible(a.id).catch(function(a){return c.filter(function(a){return!a.isDeprecated}).filter(function(a){return a!==c.OTHER}).filter(function(a){return a!==c.POLAR})}).then(function(a){return a.map(function(a){return c.get(a)}).filter(function(a){return"undefined"!=typeof a})})}]}}),d.when("/connect/callback/ng/mmf",["$state","model.connection.ConnectionType",function(a,b){a.transitionTo("callback",{connectionType:b.MMF},{location:!1})}]),d.when("/connect/callback/ng/myfitnesspal",["$state","model.connection.ConnectionType",function(a,b){a.transitionTo("callback",{connectionType:b.MYFITNESSPAL},{location:!1})}]),d.when("/connections/callback/:connectionType",["$state","$match","model.connection.ConnectionType",function(a,b,c){var d=b.connectionType;return d&&c.has(d)?void a.transitionTo("callback",{connectionType:d},{location:!1}):void a.go("settings.connect")}]),a.state("callback",{url:"/connect/callback/ng?connectionType",component:"connectCallbackView",resolve:{connectionType:["$stateParams","model.connection.ConnectionType",function(a,b){return b.get(a.connectionType)}]}}),a.state("settings.privacyDeprecated",{url:"/privacy-deprecated",component:"privacySettingsView",resolve:{translate:["common.i18n.Translation","$q",function(a,b){return b.all({privacy:a.load("common.data.privacy")})}],rules:["user","api.settings.PrivacyResource",function(a,b){return b.fetch(a.id)}]}}),a.state("settings.notifications",{url:"/notifications",component:"notificationsSettingsView",resolve:{notifications:["user","api.settings.NotificationsResource",function(a,b){return b.fetch(a.id)}]}}),a.state("settings.newsletters",{url:"/account/newsletter",component:"newslettersSettingsView",resolve:{newsletters:["api.settings.NewslettersResource",function(a){return a.get()}]}}),a.state("settings.subscription",{url:"/subscription",component:"subscriptionSettingsView",resolve:{subscription:["api.premium.subscription",function(a){return a.get()}]}}),a.state("settings.subscriptionCancel",{component:"subscriptionCancelView",url:"/subscription/cancel",params:{subscription:null},resolve:{subscription:["$stateParams","$state",function(a,b){return a.subscription}]}}),a.state("settings.heartrate",{url:"/heartrate",component:"heartrateSettingsView",resolve:{zones:["user","api.settings.HeartrateResource",function(a,b){return b.get(a.id)}],units:["common.unit.UNITS",function(a){return a.load()}]}})}var b="/settings",c="/profile";a.$inject=["$stateProvider","$urlRouterProvider"],angular.module("endo.view.settings",["endo.view.settings.privacy","endo.view.settings.archive","endo.view.settings.delete"]).config(a)}(),function(){function a(){f&&f.dismiss()}function b(b,c,g,h,i,j,k){function l(b,l,m,n,o){return e.some(function(a){return c.includes(a)})?void a():void(g.isGuest()||g.hasAcceptedTerms!==!1?!g.isGuest()&&h.isAccountActivationPending()&&k.days.diff(new Date,new Date(g.createdDate))>=d?f=i.open():a():f=j.open())}b.$on("$stateChangeSuccess",l)}var c=angular.module("endo.view.shutout",[]),d=10,e=["about"],f=void 0;b.$inject=["$rootScope","$state","user","viewer","view.shutout.EmailShutoutDialog","view.shutout.TermsDialog","core.lang.date"],c.run(b)}(),function(){var a=angular.module("endo.view.splash",[]);a.config(["$stateProvider",function(a){var b=['<div class="splash">','<div class="splash-loader">','<div class="splash-circle">&nbsp;</div>','<div class="splash-circle">&nbsp;</div>','<div class="splash-circle">&nbsp;</div>','<div class="splash-circle">&nbsp;</div>',"</div>","</div>"].join("");a.state("splash",{template:b,footer:!1,controller:["$scope","$state","$stateParams","core.event.topic","$window",function(a,b,c,d,e){function f(a,d){var f=d&&d.stateName?d.stateName:"home",g=d&&d.stateParams?d.stateParams:c;return g.returnUrl?void(e.location=decodeURIComponent(g.returnUrl)):void b.go(f,g)}d.subscribe("login/success",f),a.$on("$destroy",function(){d.unsubscribe("login/success",f)})}]})}])}(),function(){var a=angular.module("endo.view.static.applemusic",[]);a.config(["$stateProvider",function(a){a.state("static.applemusic",{url:"/applemusiccode",templateUrl:"tpl://view/static/applemusic/applemusic.en.html",controller:"view.static.applemusic.AppleMusicViewController",header:!1,footer:!0})}])}(),function(){var a=angular.module("endo.view.static.samsunggear",[]);a.config(["$stateProvider",function(a){a.state("static.samsunggear",{url:"/samsunggear",templateUrl:"tpl://view/static/samsunggear/samsunggear.html",header:!1,footer:!1})}])}(),function(){var a=angular.module("endo.view.static",["endo.view.static.samsunggear","endo.view.static.applemusic"]);a.config(["$stateProvider",function(a){a.state("static",{"abstract":!0,template:"<ui-view/>"})}])}(),function(){function a(a){a.when("/store",["$window","config","user","model.uacf.EcomLinks",function(a,b,c,d){var e=b.get("viewerCountry"),f=d.get(e,d.POSITION_STORE);try{a.location.replace(f)}catch(g){a.location=f}}])}a.$inject=["$urlRouterProvider"],angular.module("endo.view.store",[]).config(a)}(),function(){angular.module("endo.view.subscription",[]).config(["$stateProvider",function(a){a.state("redeem",{params:{coupon:null},onEnter:["$window","$stateParams",function(a,b){var c="/redeem/code/"+a.encodeURIComponent(b.coupon);a.location=c}],footer:!1})}])}(),function(){var a=angular.module("endo.view.workout",[]),b={};a.config(["$stateProvider",function(a){a.state("top.workouts",{"abstract":!0,templateUrl:"tpl://view/workout/workout.en.html",controller:"view.workout.WorkoutController",data:{autoscroll:!1},resolve:{model:[function(){return b}],Highcharts:["common.loader.highcharts",function(a){return a.load()}],translate:["common.i18n.Translation","common.unit.UNITS","common.data.SportTranslate","$q",function(a,b,c,d){return d.all({sports:c.load(),units:b.load(),weather:a.load("common.data.weather"),charts:a.load("ui.chart"),records:a.load("common.data.records"),privacy:a.load("common.data.privacy"),trainingplan:a.load("common.data.trainingplan")})}]}}),a.state("top.workouts.info",{"abstract":!0,views:{headline:{templateUrl:"tpl://view/workout/headline/headline.en.html",controller:"view.workout.HeadlineController"},stats:{templateUrl:"tpl://view/workout/stats/stats.html",controller:"view.workout.StatsController"},charts:{templateUrl:"tpl://view/workout/charts/charts.en.html",controller:"view.workout.ChartsController"},zones:{templateUrl:"tpl://view/workout/zones/zones.en.html",controller:"view.workout.ZonesController"},social:{templateUrl:"tpl://view/workout/social/social.en.html",controller:"view.workout.SocialController"}}}),a.state("top.workouts.info.latest",{url:"/users/:userId/workouts",onEnter:["$state","$stateParams","user","api.workout.WorkoutResource",function(a,b,c,d){"me"===b.userId&&(b.userId=c.id);var e={userId:b.userId,workoutId:d.LATEST_WORKOUT_ID};a.transitionTo("top.workouts.info.byId",e,{location:!1})}]}),a.state("top.workouts.info.byId",{url:"/users/:userId/workouts/:workoutId",onEnter:["$state","$stateParams","workout","api.workout.WorkoutResource",function(a,c,d,e){b.workout=d,b.workout.$latest=c.workoutId===e.LATEST_WORKOUT_ID;try{b.workout.$userId=d.author.id}catch(f){b.workout.$userId=c.userId}}],resolve:{workout:["$q","$stateParams","model.workout.Workout","api.workout.WorkoutResource","api.user.UserResource","model.user.AnonymousUser",function(a,b,c,d,e,f){return a(function(a,g){d.get(b.userId,b.workoutId).then(function(c){c.author||Object.defineProperties(c,{author:{value:new f(b.userId).toObject()}}),a(c)}).catch(function(d){var g;e.get(b.userId).then(function(a){g=a}).catch(function(){g=new f(b.userId).toObject()}).finally(function(){var b=new c;Object.defineProperties(b,{$error:{value:d},author:{value:g}}),a(b)})})})}]}})}])}(),function(){function a(a,b){function c(a,b,c,d,e){this.showAll=a,this.showUsers=b,this.showFriends=c,this.showMe=d,this.icon=e}var d={EVERYONE:[!0,!0,!0,!0,"icon-public"],FRIENDS:[!1,!1,!0,!0,"icon-friends"],ONLY_ME:[!1,!1,!1,!0,"icon-onlyme"]};c.prototype=Object.create(Object.prototype),c.prototype.constructor=c,c.prototype.isVisible=function(a){return b.hasRole("ADMIN")?!0:this.showAll?!0:this.showFriends&&0===a.viewerFriendship?!0:!(!this.showMe||a.id!==b.id)};var e=a(c,d);return e}a.$inject=["core.lang.enumeration","user"],angular.module("endo.api").factory("api.PrivacyEnum",a)}(),function(){function a(a,b){function c(c){var d=a.defer();return b(c).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject({data:a,status:b,headers:c,config:e})}),d.promise}function d(b,d,e,f){var g=a.defer(),h={method:"GET",url:b,id:d};return angular.isObject(f)&&angular.extend(h,f),c(h).then(function(a){a=void 0===e?a:new e(a),g.resolve(a)}).catch(function(a){g.reject(a)}),g.promise}function e(b,d){var e=a.defer();d=d||{};var f=d;return f.method="GET",f.url=b,c(f).then(function(a){e.resolve(a)}).catch(function(a){e.reject(a)}),e.promise}function f(a,b){var d={method:"POST",url:a,data:b||{}};return c(d)}function g(a,b){var d={method:"PUT",url:a,data:b||{}};return c(d)}function h(a,b){b=b||{};var d=b;return d.method="DELETE",d.url=a,d.data=b.data||{},d.headers=b.headers||{},d.headers["Content-Type"]=i,c(d)}var i="application/json";return{get:d,query:e,put:g,post:f,"delete":h}}a.$inject=["$q","$http"],angular.module("endo.api").factory("api.Resource",a)}(),function(){function a(a){function b(){}var c={UNKNOWN:{},BAD_REQUEST:{},FORBIDDEN:{},UNAUTHORIZED:{},MISSING_REQUIRED_FIELD:{},INVALID_FIELD_VALUE:{},INVALID_EMAIL_FIELD_VALUE:{},RESOURCE_CONFLICT:{},NO_MATCH:{}},d=a(b,c);return d}a.$inject=["core.lang.enumeration"],angular.module("endo.api").factory("api.ResponseCodeEnum",a)}(),function(){function a(a,b,c,d,e,f,g,h){function i(a){var b=angular.copy(a);return b&&f.isDate(b.dateOfBirth)&&(b.dateOfBirth=g.convertToUTCNoon(b.dateOfBirth)),b}function j(d){var e=i(d),f=a.defer();return b.post(m,e,{ignoreAuthModule:!0}).success(function(a,b,d,e){c.set(a),f.resolve({status:b,data:a})}).error(function(a,b){return f.reject({status:b,data:a})}),f.promise}function k(c){var d=i(c),e=a.defer();return b.post(n,d,{ignoreAuthModule:!0}).success(function(a){return e.resolve(a)}).error(function(a,b){return e.reject({status:b,data:a})}),e.promise}function l(){return b.get(o).then(function(a){var b=a.data.data,c=d.keys.map(b,function(a){return e.camelCase(a)});return new h(c)})}var m="/rest/account",n="/rest/account?validation=1",o="/mobile/api/countryconsent/list",p=400,q=409;return{VALIDATION_ERROR:p,VALIDATION_CONFLICT:q,create:j,validate:k,listCountries:l}}a.$inject=["$q","$http","user","core.lang.object","core.lang.string","core.lang.date","common.date.TimezoneUtils","model.auth.ConsentCollection"],angular.module("endo.api.auth").factory("api.auth.account",a)}(),function(){function a(a,b,c,d,e,f,g){function h(a){f.load().then(function(b){a.call(null,b)})}function i(){return!!j()}function j(){return f.require().getAuthResponse()}function k(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return{type:"FACEBOOK",accessToken:a.accessToken,expires:a.expiresIn}}function l(b){return a(function(a,c){f.load().then(function(d){d.getLoginStatus(function(d){if(d&&"connected"===d.status){var e=d.authResponse;return b!==!0&&(e=k(e)),a(e)}c(d)},!0)}).catch(c)})}function m(b){var c=[u.PROFILE];return arguments.length&&(c=Array.prototype.slice.call(arguments)),a(function(a,b){function d(c){if(c&&"connected"===c.status&&c.authResponse){var d=(c.authResponse.grantedScopes||"").split(","),e=!0;if(e=!!~d.indexOf(u.FRIENDS)||!!~d.indexOf(u.PROFILE))return a(c.authResponse)}b(c)}f.load().then(function(a){a.login(d,{scope:c.join(","),return_scopes:!0})}).catch(b)})}function n(){var a=[u.PROFILE,u.EMAIL,u.FRIENDS];return m.apply(null,a)}function o(a){var b=m(u.PROFILE,u.FRIENDS,u.EMAIL);return a===!0?b:b.then(k)}function p(a){var b=m(u.PROFILE,u.FRIENDS,u.EMAIL);return a===!0?b:b.then(k)}function q(a){return Array.isArray(a)?a.filter(function(a){return"granted"===a.status}).map(function(a){return a.permission}):void 0}function r(){return a(function(a,b){h(function(c){c.api("/me/permissions",function(c){return c&&!c.error&&Array.isArray(c.data)?void a(c.data):(c.error&&g.captureMessage("FB Error: getPermissions()",{tags:{source:"facebook.permissions"},extra:{error:c.error}}),void b(c))})})})}function s(){var a=f.require(),b=["https://graph.facebook.com/",f.version,"/me/permissions?access_token=",a.getAccessToken()].join(""),c=d.sync.get(b);return null===c&&g.captureMessage("FB Failure: getPermissionsSync()",{tags:{source:"facebook.permissions"}}),c=JSON.parse(c),q(c.data)}function t(a){var d=c.get("api.facebook.appId","202423869273"),e="token",f=[u.PROFILE,u.EMAIL,u.FRIENDS],g="/login/callback/facebook",h=encodeURIComponent(b.location.origin+g),i=a?encodeURIComponent(a):"",j="https://www.facebook.com/v2.9/dialog/oauth?client_id="+d+"&redirect_uri="+h+"&response_type="+e+"&scope="+f.join(",");return i&&(j+="&state="+i),j}var u={PROFILE:"public_profile",EMAIL:"email",FRIENDS:"user_friends"};return{PERMISSIONS:angular.copy(u),getLoginStatus:l,login:o,signup:p,buildAuthorizeUrl:t,authorize:m,authorizeFriends:n,getPermissions:r,sync:{isConnected:i,getAuthResponse:j,getPermissions:s}}}a.$inject=["$q","$window","config","core.io.http","core.io.url","common.loader.facebook","Raven"],angular.module("endo.api.auth").factory("api.auth.facebook",a)}(),function(){function a(a,c,d,e){function f(a,b,d,f,g){var h=e.get("api.facebook.appId","202423869273"),i="token",j=encodeURIComponent(c.location.origin+a),k=d?encodeURIComponent(f?JSON.stringify({returnUrl:d,object:f}):d):"",l="https://www.facebook.com/v2.9/dialog/oauth?client_id="+h+"&redirect_uri="+j+"&response_type="+i+"&scope="+b.join(",");return k&&(l+="&state="+k),g&&(l+="&auth_type=reauthenticate"),l}function g(a,b,c){return f("/login/callback/facebook",[j.PROFILE,j.EMAIL,j.FRIENDS],a,b,c)}function h(a){return f("/signup/callback/facebook",[j.PROFILE,j.EMAIL,j.FRIENDS,j.BIRTHDAY],a)}function i(c,e){return Array.isArray(e)&&(e=e.join(",")),d.get("https://graph.facebook.com/"+b+"/me?fields="+e+"&access_token="+c).then(function(a){var b=a.data;return b}).catch(function(b){var c=b.data;return a.reject(c)})}var j=Object.freeze({PROFILE:"public_profile",EMAIL:"email",BIRTHDAY:"user_birthday",FRIENDS:"user_friends"}),k=Object.freeze({ID:"id",NAME:"name",EMAIL:"email",BIRTHDAY:"birthday"});return{Fields:k,buildLoginUrl:g,buildSignupUrl:h,me:i}}var b="v3.0";a.$inject=["$q","$window","$http","config"],angular.module("endo.api.auth").factory("api.auth.facebook2",a)}(),function(){function a(a,b,c,d){function e(){return p===!0?o.promise:(c.googleAsyncInit=function(){try{gapi.load("auth2",{callback:function(){p=!0,delete c.googleAsyncInit,o.resolve(gapi)},onerror:function(){o.reject("auth2 load failure")},timeout:m,ontimeout:function(){o.reject("auth2 load timeout")}})}catch(a){o.reject(a)}},function(){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="https://apis.google.com/js/platform.js?onload=googleAsyncInit";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}(),d(function(){p||o.reject("Google SDK timeout.")},m),o.promise)}function f(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return{type:"GOOGLE",accessToken:a.access_token,code:a.code,expires:a.expires_in}}function g(c){function d(a){return a&&a.access_token&&!a.error?g.resolve(a):g.reject(a)}var f=c.prompt,g=b.defer();return e().then(function(b){b.auth2.authorize({client_id:a.get("api.google.clientId"),scope:[n.PROFILE,n.EMAIL].join(" "),response_type:"code token",prompt:f?"select_account":"none"},d)}).catch(function(a){return g.reject(a)}),g.promise}function h(a){var b=g({prompt:!0});return a===!0?b:b.then(f)}function i(a){var b=g({prompt:!0});return a===!0?b:b.then(f)}function j(a){var b=g({prompt:!0});return a===!0?b:b.then(f)}function k(a){var b=g({prompt:!1});return a===!0?b:b.then(f)}function l(b){var d=a.get("api.google.clientId","120670263313-k5ce5d5443kog82te5p6i86ihldooupt.apps.googleusercontent.com"),e="code token",f=[n.PROFILE,n.EMAIL],g="/login/callback/google",h=encodeURIComponent(c.location.origin+g),i=b?encodeURIComponent(b):"",j="https://accounts.google.com/o/oauth2/v2/auth?client_id="+d+"&redirect_uri="+h+"&response_type="+e+"&scope="+f.join(" ")+"&include_granted_scopes=true";return i&&(j+="&state="+i),j}var m=7e3,n={PROFILE:"profile",EMAIL:"email"},o=b.defer(),p=!1;return e(),{getLoginStatus:k,authorize:h,login:i,signup:j,buildAuthorizeUrl:l}}a.$inject=["config","$q","$window","$timeout"],angular.module("endo.api.auth").factory("api.auth.google",a)}(),function(){function a(a,b,c,d){function e(a,d,e,f){var g=b.get("api.google.clientId","120670263313-k5ce5d5443kog82te5p6i86ihldooupt.apps.googleusercontent.com"),h="code token",i=encodeURIComponent(c.location.origin+a),j=e?encodeURIComponent(f?JSON.stringify({returnUrl:e,object:f}):e):"",k="https://accounts.google.com/o/oauth2/v2/auth?client_id="+g+"&redirect_uri="+i+"&response_type="+h+"&scope="+d.join(" ")+"&include_granted_scopes=true";return j&&(k+="&state="+j),k}function f(a,b){return e("/login/callback/google",[i.PROFILE,i.EMAIL],a,b)}function g(a){return e("/signup/callback/google",[i.PROFILE,i.EMAIL],a)}function h(b,c){return d.get("https://www.googleapis.com/oauth2/v2/userinfo?access_token="+b).then(function(a){var b=a.data;return b}).catch(function(b){var c=b.data;return a.reject(c)})}var i=Object.freeze({PROFILE:"profile",EMAIL:"email"}),j=Object.freeze({});return{Fields:j,buildLoginUrl:f,buildSignupUrl:g,me:h}}a.$inject=["$q","config","$window","$http"],angular.module("endo.api.auth").factory("api.auth.google2",a)}(),function(){angular.module("endo.api.auth").service("api.auth.session",["$q","$http","user","viewer",function(a,b,c,d){var e="/rest/session",f={login:function(f){var g=a.defer();return b.post(e,f,{ignoreAuthModule:!0}).success(function(a,b,e,f){c.set(a),d.setSession(a),g.resolve(a)}).error(function(a,b,c,d){g.reject()}),g.promise},logout:function(){var f=a.defer();return b.delete(e).success(function(){c.set(null),d.setSession(null),f.reject()}).error(function(){c.set(null),d.setSession(null),f.reject()}),f.promise},get:function(){var f=a.defer();return b.get(e).success(function(a,b,e,g){c.set(a),d.setSession(a),f.resolve(a)}).error(function(){c.set(null),f.reject()}),f.promise}};return f}])}(),function(){function a(a,b,c,j){function k(){}var l=a.compile(d),m=a.compile(e),n=a.compile(f),o=a.compile(g),p=a.compile(h),q=a.compile(i);return k.prototype.get=function(a){var b=l.format({challengeId:a});return c.get(b,a,j)},k.prototype.joinChallenge=function(a,d){var e={sponsorKey:d},f=b.defer();return c.put(m.format({challengeId:a.id}),e).then(function(b){return b.success?(a.viewerJoined=!0,void f.resolve(b)):void f.reject(b)}).catch(function(a){return f.reject(a)}),f.promise},k.prototype.rejectChallenge=function(a){var d=b.defer();return c.put(q.format({challengeId:a.id})).then(function(b){return b.success?(a.viewerJoined=!1,void d.resolve(b.success)):void d.reject(b)}).catch(function(a){return d.reject(a)}),d.promise},k.prototype.rankings=function(a,b){var d=arguments.length<=2||void 0===arguments[2]?"FRIENDS":arguments[2],e=arguments.length<=3||void 0===arguments[3]?1:arguments[3],f={challengeId:a,user:b,filter:d,radius:e};return c.get(n.format(f))},k.prototype.userChallenges=function(a){var b=arguments.length<=1||void 0===arguments[1]?2:arguments[1],d={user:a,limit:b};return c.get(o.format(d)).then(function(a){return a.data.map(function(a){return new j(a)})})},k.prototype.featured=function(a){var b=arguments.length<=1||void 0===arguments[1]?2:arguments[1],d={user:a,limit:b};return c.get(p.format(d)).then(function(a){return a.data.map(function(a){return new j(a)})})},new k}var b="/rest/v1",c="/challenges/:challengeId",d=b+c,e=b+c+"/join",f=b+c+"/ranking?filter&user&radius",g=b+"/challenges?user&limit",h=b+"/challenges/featured?user&limit",i=b+c+"/reject";a.$inject=["$urlMatcherFactory","$q","api.Resource","model.challenge.Challenge"],angular.module("endo.api.challenge").factory("api.challenge.ChallengeResource",a)}(),function(){function a(a,b){function c(){}var f=a.compile(d),g=a.compile(e);return c.prototype.get=function(a,c){var d={userId:a,commitmentId:c};return b.get(f.format(d))},c.prototype.motivate=function(a,c,d){var e={userId:a,commitmentId:c},f={sponsorKey:d};return b.put(g.format(e),f)},new c}var b="/rest/v1",c="/users/:userId/commitments/:commitmentId",d=b+c,e=b+c+"/motivate";a.$inject=["$urlMatcherFactory","api.Resource"],angular.module("endo.api.commitment").factory("api.commitment.CommitmentResource",a)}(),function(){function a(a,b,c,h,i,j){function k(){return b.get(g).then(function(a){var b=a.data.data,c=i.keys.map(b,function(a){return j.camelCase(a)});return c})}function l(a){o=o||h.compile(f);var b=o.format({userId:a});return c.get(b).then(function(a){var b=a.value;return b===!0})}function m(a){p=p||h.compile(d);var b=p.format({userId:a});return c.get(b).then(function(a){var b=a.values;return b})}function n(b,d){q=q||h.compile(e);var f=q.format({userId:b});return c.put(f,{values:d}).then(function(b){var c=b.success,d=b.message;return c===!1?a.reject(d):void 0})}var o=void 0,p=void 0,q=void 0;return{fetchAllConsentsPerCountry:k,isConsentRequired:l,getUserConsents:m,putUserConsents:n}}var b="/rest/v1",c="/users/:userId",d=""+b+c+"/consents",e=""+b+c+"/consents",f=""+b+c+"/consents/needed",g="/mobile/api/countryconsent/list";a.$inject=["$q","$http","api.Resource","$urlMatcherFactory","core.lang.object","core.lang.string"],angular.module("endo.api.consent").factory("api.consent.ConsentResource",a)}(),function(){function a(a,b,c,o,p){function q(a,b){var d=I.format(a);return c.get(d,a.feedId,o,b)}function r(a,b,d){var e={feedId:a.id,offset:b,limit:d},f=L.format(e);return c.get(f,a.id).then(function(b){a.addLikes(b.data)})}function s(a){var b=L.format({feedId:a.id});return c.post(b).then(function(b){a.like()})}function t(a){var b=L.format({feedId:a.id});return c.delete(b).then(function(b){a.dislike()})}function u(a,b,d){var e={feedId:a.id,offset:b,limit:d},f=J.format(e);return c.get(f,a.id).then(function(b){a.addComments(b.data)})}function v(a,b,d){var e={feedId:a.id,offset:b,limit:d},f=M.format(e);return c.get(f,a.id).then(function(b){a.addPeptalks(b.data)})}function w(a,b){var d=J.format({feedId:a.id});return c.post(d,{text:b}).then(function(c){var d={id:c.id,text:b,timestamp:new Date};a.postComment(d)})}function x(a,b){var d={feedId:a.id,commentId:b},e=K.format(d);return c.delete(e).then(function(c){a.deleteComment(b)})}function y(a,b){var d=N.format({feedId:a.id});return c.post(d,{text:b}).then(function(c){var d={id:c.id,text:b,timestamp:new Date};a.postPeptalk(d)})}function z(a,b,d){return c.query(a).then(function(a){var c=a.data.map(function(a){return new o(a)}),e={params:b,pages:a.paging};return d&&d instanceof p||(d=new p),d.append(c),d.setMetadata(e),d})}function A(b){var c=a.defer(),d=b.getMetadata()||{};return B(b)?(z(d.pages.next,d.params,b).then(function(a){return c.resolve(a)}).catch(function(a){return c.reject(a)}),c.promise):(c.reject(),c.promise)}function B(a){var b=a.getMetadata()||{};return b.pages&&b.pages.next}function C(a,b){var c={userId:a,limit:b},d=O.format(c);return z(d,c)}function D(a){var b=I.format({feedId:a.id,userId:a.author.id});return c.delete(b)}function E(a){var b=P.format({feedId:a});return c.get(b,a,o)}function F(a){var b={tag:a},c=Q.format(b);return z(c,b)}function G(a,b){var d=I.format({userId:a});return c.post(d,b).then(function(a){return new o(a)})}function H(a){return R=R||b.compile(n),R.format({userId:a})}var I=(b.compile(d),b.compile(e)),J=b.compile(g),K=b.compile(h),L=b.compile(i),M=b.compile(j),N=b.compile(k),O=b.compile(l),P=b.compile(f),Q=b.compile(m),R=void 0,S={getUserFeed:q,listLikes:r,like:s,dislike:t,listComments:u,postComment:w,deleteComment:x,postPeptalk:y,listPeptalks:v,subscriptions:C,"delete":D,getFeed:E,getFeedsByTag:F,postStatus:G,getPictureUrl:H};return S.subscriptions.next=A,S.subscriptions.hasNext=B,S.getFeedsByTag.next=A,S.getFeedsByTag.hasNext=B,S}var b="/rest/v1",c="/users/:userId/feeds",d=b+c+"?limit&offset",e=b+c+"/:feedId",f=b+"/feeds/:feedId",g=f+"/comments?offset&limit",h=f+"/comments/:commentId",i=f+"/likes?offset&limit",j=f+"/peptalks?offset&limit",k=f+"/peptalks/:peptalkId",l=b+"/feeds/subscriptions?limit",m=b+"/feeds?tag",n=b+c+"/picture";a.$inject=["$q","$urlMatcherFactory","api.Resource","model.feed.Feed","common.model.Collection"],angular.module("endo.api.feed").factory("api.feed.FeedResource",a)}(),function(){var a=angular.module("endo.api.notifications");a.constant("api.notifications.NOTIFICATION_TYPE",{NEWSFEED_COMMENT_ON_OWN:"A",NEWSFEED_COMMENT_AFTER_M:"B",NEWSFEED_LIKE_ON_OWN:"C",NEWSFEED_TAGGED:"F",FRIENDREQUEST:"I",CHALLENGEREQUEST:"J",EVENTREQUEST:"K",INVITEREQUEST:"L",JOINREQUEST:"M",GLOBAL_CHALLENGE_REQUEST:"O",EVENT_PLANNED_WORKOUT:"T",FROM_BRAND_INVITE:"V",FROM_BRAND_LEAVE:"W",NOTIFICATION_GENERIC:"G",hasRequest:function(a){return[this.FRIENDREQUEST,this.CHALLENGEREQUEST,this.EVENTREQUEST,this.INVITEREQUEST,this.JOINREQUEST,this.GLOBAL_CHALLENGE_REQUEST].indexOf(a)>-1},showUserAvatar:function(a){return[this.NEWSFEED_COMMENT_ON_OWN,this.NEWSFEED_COMMENT_AFTER_M,this.NEWSFEED_LIKE_ON_OWN,this.NEWSFEED_TAGGED,this.FRIENDREQUEST,this.EVENT_PLANNED_WORKOUT].indexOf(a)>-1}})}(),function(){angular.module("endo.api.notifications").factory("api.notifications.notificationService",["$http","$q","urlBuilder","api.notifications.NOTIFICATION_TYPE","user",function(a,b,c,d,e){function f(a){h.splice(h.indexOf(a),1),i.pending-=a.seen?0:1,i.all--}var g="/rest/notifications",h=[],i={pending:0,all:0},j={getCounters:function(){return i},list:function(){var c=b.defer();return a.get(g).success(function(a,b,d,e){h=a.data,i.pending=a.pendingCount,i.all=h.length,c.resolve(h)}).error(function(a){h=[],i.pending=0,i.all=0,c.reject(a)}),c.promise},getPending:function(){var c=b.defer();return a({url:g,method:"GET",params:{getData:!1}}).success(function(a){i.pending=a.pendingCount,c.resolve(a)}).error(function(a){c.reject(a)}),c.promise},acceptRequest:function(c){var d=b.defer();return a.put(g+"/"+c.id+"/accept",{}).success(function(a,b,e,g){f(c),d.resolve(a)}).error(function(a){d.reject(a)}),d.promise},declineRequest:function(c){var d=b.defer();return a.put(g+"/"+c.id+"/decline",{}).success(function(a,b,e,g){f(c),d.resolve(a)}).error(function(a){d.reject(a)}),d.promise},markAllAsSeen:function(){var c=[],d=b.defer();if(i.pending<=0)return d.resolve(!0),d.promise;for(var e=0,f=h.length;f>e;e++)c.push(h[e].id);return a.put(g+"/seen",c).success(function(a,b,c,e){i.pending=a,d.resolve(!0)}).error(function(a){d.reject(a)}),d.promise},getLink:function(a){switch(a.type){case d.NEWSFEED_COMMENT_ON_OWN:case d.NEWSFEED_COMMENT_AFTER_M:case d.NEWSFEED_LIKE_ON_OWN:case d.NEWSFEED_TAGGED:return a.social.workoutId>0?c.buildWorkoutUrl({workoutId:a.social.workoutId,userId:a.social.workoutOwnerId||e.id}):c.buildFeedUrl({id:a.social.feedId});case d.FRIENDREQUEST:return c.buildProfileUrl({id:a.from.id});case d.CHALLENGEREQUEST:return c.buildChallengeUrl({id:a.to.id});case d.EVENTREQUEST:return c.buildEventUrl({id:a.to.id});case d.INVITEREQUEST:return c.buildTeamUrl({id:a.to.id});case d.JOINREQUEST:return c.buildTeamUrl({id:a.to.id});case d.GLOBAL_CHALLENGE_REQUEST:return c.buildChallengeUrl({id:a.to.id});case d.FROM_BRAND_INVITE:return c.buildPageUrl({id:a.from.id});case d.NOTIFICATION_GENERIC:return a.link;case d.EVENT_PLANNED_WORKOUT:return c.buildTraningPlanUrl();default:return""}}};return j}])}(),function(){function a(a){function b(){}var c={VALID:{},INVALID:{},FREE:{},UNDEFINED:{},FREE_TRIAL:{}};return a(b,c)}a.$inject=["core.lang.enumeration"],angular.module("endo.api.premium").factory("api.premium.CouponStateEnum",a);
}(),function(){function a(a){var b={UNKNOWN:{},APPLE_APP_STORE_PREMIUM_MEMBER:{},BLACKBERRY_PREMIUM_MEMBER:{},CAMPAIGN_PREMIUM_MEMBER:{isLimited:!0},EARNED_PREMIUM_MEMBER:{isLimited:!0},EMPLOYEE_FITNESS_PREMIUM_MEMBER:{isLimited:!0},GIFT_CARD_PREMIUM_MEMBER:{isLimited:!0},GOOGLE_PLAY_PREMIUM_MEMBER:{},MANUAL_PREMIUM_MEMBER:{isLimited:!0},RECURLY_PREMIUM_MEMBER:{canManage:!0},NULL:{},API_PREMIUM_MEMBER:{isLimited:!0}},c=function d(a){_classCallCheck(this,d),this.isLimited=a.isLimited,this.canManage=a.canManage};return a(c,b)}a.$inject=["core.lang.enumeration"],angular.module("endo.api.premium").factory("api.premium.SubscriptionType",a)}(),function(){angular.module("endo.api.premium").factory("api.premium.banner",["$http",function(a){var b="/rest/premium/banner",c={get:function(c){var d=b;return angular.isNumber(c)&&(d+="/"+c),a.get(d)}};return c}])}(),function(){function a(a,b,c){function d(a){var b=8,c=String(a);return c=c.replace(/(\s+)|(-)/g,""),c.length>b&&(c=c.substring(0,b)),c}var e="https://lookup.binlist.net/",f={country:function(f){return b(function(b,g){var h=d(f);a.get(e+encodeURIComponent(h),{headers:{"Accept-Version":"3"}}).then(function(a){var d=c.get(a,"data.country.alpha2")||"";b(d)}).catch(function(){b("")})})}};return f}a.$inject=["$http","$q","core.lang.object"],angular.module("endo.api.premium").factory("api.premium.bin",a)}(),function(){angular.module("endo.api.premium").factory("api.premium.plan",["$q","$log","$http","api.premium.recurly","api.premium.CouponStateEnum","Raven",function(a,b,c,d,e,f){function g(a){return{monthly:a.monthlyPlan,yearly:a.yearlyPlan,coupon:a.coupon}}function h(a){return b.log(a),a}function i(b){var d=a.defer(),e=k;return b&&(e+="/"+b),c.get(e).then(function(a){return a.data}).then(g).then(h).then(function(a){return d.resolve(a)}).catch(function(a){return d.reject(a)}),d.promise}function j(c,g,h){var i,j=a.defer(),k=angular.extend({},c);switch(k.price={trialPeriodDays:c.coupon.trialPeriodDays,trialPeriodMonths:c.coupon.trialPeriod,planType:g,planCode:c[g].code},delete k.coupon,e.get(c.coupon.state)){case e.FREE:return k.price.couponType=F,j.resolve(k),j.promise;case e.VALID:k.price.couponType=E;break;case e.FREE_TRIAL:k.price.couponType=H;break;case e.INVALID:i=h;break;default:k.price.couponType=C}return d.price(c[g].code,i).then(function(a){k.price.total=Number(a.now.total),i&&(k.price.coupon=i,k.price.discount=Number(a.now.discount),k.price.couponType=0===k.price.discount?G:D),j.resolve(k)}).catch(function(a){b.log(a),k.price.couponType=G,j.resolve(k),f.captureMessage("RecurlyPriceError",{tags:{source:"recurly"},extra:{plan:c[g].code,coupon:i}})}),j.promise}var k="/rest/premium/plan",l="monthly",m="yearly",n="yearlypro",o="monthly2mtrial",p="yearly2mtrial",q="monthly3mtrial",r="yearly3mtrial",s="monthly1mtrial",t="yearly1mtrial",u="monthly12mtrial",v="yearly12mtrial",w="monthly24mtrial",x="yearly24mtrial",y="monthly6mtrial",z="yearly6mtrial",A="monthly7dtrial",B="yearly7dtrial",C="NONE",D="DISCOUNT",E="TRIAL",F="FREE",G="ERROR",H="FREE_TRIAL",I={PLAN_TYPE_MONTHLY:l,PLAN_TYPE_YEARLY:m,PLAN_TYPE_YEARLY_PRO:n,PLAN_TYPE_MONTHLY_2M_TRIAL:o,PLAN_TYPE_YEARLY_2M_TRIAL:p,PLAN_TYPE_MONTHLY_3M_TRIAL:q,PLAN_TYPE_YEARLY_3M_TRIAL:r,PLAN_TYPE_MONTHLY_1M_TRIAL:s,PLAN_TYPE_YEARLY_1M_TRIAL:t,PLAN_TYPE_MONTHLY_12M_TRIAL:u,PLAN_TYPE_YEARLY_12M_TRIAL:v,PLAN_TYPE_MONTHLY_24M_TRIAL:w,PLAN_TYPE_YEARLY_24M_TRIAL:x,PLAN_TYPE_MONTHLY_6M_TRIAL:y,PLAN_TYPE_YEARLY_6M_TRIAL:z,PLAN_TYPE_MONTHLY_7D_TRIAL:A,PLAN_TYPE_YEARLY_7D_TRIAL:B,COUPON_TYPE_NONE:C,COUPON_TYPE_DISCOUNT:D,COUPON_TYPE_TRIAL:E,COUPON_TYPE_FREE:F,COUPON_TYPE_ERROR:G,COUPON_TYPE_FREE_TRIAL:H,isEligibleForFreeTrial:function(){var b=a.defer();return i().then(function(a){return angular.isObject(a)&&angular.isObject(a.coupon)&&e.get(a.coupon.state)===e.FREE_TRIAL?b.resolve(a):void b.reject()}).catch(function(a){return b.reject(a)}),b.promise},get:function(b,c){var d=a.defer();return i(c).then(function(a){return j(a,b,c)}).catch(function(a){return d.reject(a),d.promise})}};return I}])}(),function(){angular.module("endo.api.premium").factory("api.premium.recurly",["$q","common.loader.recurly",function(a,b){function c(){return b.load().then(function(a){return d.api=a,a})}var d={library:function(){return c()},price:function(b,d){var e=a.defer();return c().then(function(a){var c=a.Pricing().plan(b);d&&(c=c.coupon(d)),c.catch(function(a){e.reject(a)}).done(function(a){e.resolve(a)})}),e.promise},token:function(){function b(a,b){return a?d.reject(a):void d.resolve(b.id)}var d=a.defer();return c().then(function(a){a.token(document.getElementById("subscriptionForm"),b)}),d.promise},risk:function(b,d){var e=a.defer();return c().then(function(a){var c=a.Risk(),f=c.ThreeDSecure({actionTokenId:b}),g=d.challenge(f);e.resolve(g)}),e.promise}};return d}])}(),function(){angular.module("endo.api.premium").factory("api.premium.subscription",["$q","$http","api.premium.recurly","api.premium.bin","core.io.http","ui.progress.progressBar","api.Resource",function(a,b,c,d,e,f,g){var h="/rest/premium/subscription",i={create:function(e,f,g,i){var j=a.defer(),k="";return angular.isObject(f)&&(k=d.country(f.number)),a.all({tokenId:a.when(e),binCountry:a.when(k)}).then(function(d){var e=d.tokenId,f=d.binCountry,k=angular.extend(g,{recurlyToken:e});f&&(k.binCountry=f),b.post(h,k).success(function(d){if(d.threeDSecureToken){var e=c.risk(d.threeDSecureToken,i);a.all({resolvedToken:a.when(e)}).then(function(a){var c=angular.extend(g,{resultRecurlyToken:a.resolvedToken});b.post(h,c).success(function(a){j.resolve(a)}).error(function(a){j.reject(a)})}).catch(function(a){j.reject(a)})}else j.resolve(d)}).error(function(a){j.reject(a)})}).catch(function(a){j.reject(a)}),j.promise},validateEUSync:function(a){var b=h+"/euvalidation?billingCountry="+encodeURIComponent(a),c=e.sync.get(b);return"true"===c},get:function(){return g.get(h)},cancel:function(a,b){return g.put(h+"/"+a+"/cancel",b)},changePlan:function(a,b){return g.put(h+"/"+a,b)},reactivate:function(a){return g.put(h+"/"+a+"/reactivate")},getRenewalDate:function(a){return g.get(h+"/"+a+"/renewaldate").then(function(a){return a?new Date(a):null})},getExpiryDate:function(a){return g.get(h+"/"+a+"/expirydate").then(function(a){return a?new Date(a):null})}};return i}])}(),function(){function a(a,b){var c=void 0,f=void 0,g=function(){function g(){_classCallCheck(this,g)}return g.prototype.getPromotions=function(e){return c=c||a.compile(d),b.get(c.format({userId:e})).then(function(a){return a.data})},g.prototype.markAsSeen=function(c,d){return f=f||a.compile(e),b.delete(f.format({userId:c,promoId:d}))},g}();return new g}var b="/rest/v1",c="/users/:userId",d=b+c+"/promotions",e=b+c+"/promotions/:promoId";a.$inject=["$urlMatcherFactory","api.Resource"],angular.module("endo.api").factory("api.PromoResource",a)}(),function(){function a(a,b){function c(c){return f=f||a.compile(d),b.query(f.format({userId:c}))}function e(c,e){return f=f||a.compile(d),b.put(f.format({userId:c}),e)}var f=void 0;return{getJobStatus:c,makeArchiveRequest:e}}var b="/rest/v1",c="/users/:userId/async/EXPORT_USER_DATA",d=b+c;a.$inject=["$urlMatcherFactory","api.Resource"],angular.module("endo.api").factory("api.settings.ArchiveResource",a)}(),function(){function a(a,b){function c(c){return n=n||a.compile(d),b.query(n.format({userId:c}))}function i(c){return o=o||a.compile(e),b.query(o.format({userId:c}))}function j(c,d){return p=p||a.compile(f),b.put(p.format({userId:c}),d)}function k(c,e){return n=n||a.compile(d),b.post(n.format({userId:c}),e)}function l(c,d,e){return q=q||a.compile(g),b.put(q.format({userId:c,connectionId:d}),e)}function m(c,d){return r=r||a.compile(h),b.delete(r.format({userId:c,connectionId:d}))}var n=void 0,o=void 0,p=void 0,q=void 0,r=void 0;return{list:c,listVisible:i,authorize:j,connect:k,update:l,deauthorize:m}}var b="/rest/v1",c="/users/:userId/settings/connections",d=b+c,e=b+c+"/visible",f=d+"/authorize",g=d+"/:connectionId",h=d+"/:connectionId/deauthorize";a.$inject=["$urlMatcherFactory","api.Resource"],angular.module("endo.api").factory("api.settings.ConnectionsResource",a)}(),function(){function a(a,b){function c(c){return f=f||a.compile(d),b.query(f.format({userId:c}))}function e(c,e){return f=f||a.compile(d),b.put(f.format({userId:c}),e)}var f=void 0;return{getJobStatus:c,makeDeleteRequest:e}}var b="/rest/v1",c="/users/:userId/async/DELETE_USER_DATA",d=b+c;a.$inject=["$urlMatcherFactory","api.Resource"],angular.module("endo.api").factory("api.settings.DeleteResource",a)}(),function(){function a(a,b){function c(c){return l=l||a.compile(d),b.query(l.format({userId:c}))}function h(c,e){return l=l||a.compile(d),b.post(l.format({userId:c}),e)}function i(c,d){return m=m||a.compile(e),b.delete(m.format({userId:c,emailId:d}))}function j(c,d){return n=n||a.compile(f),b.put(n.format({userId:c,emailId:d}))}function k(c,d){return o=o||a.compile(g),b.put(o.format({userId:c,emailId:d}))}var l=void 0,m=void 0,n=void 0,o=void 0;return{list:c,add:h,"delete":i,verify:j,makePrimary:k}}var b="/rest/v1",c="/users/:userId/settings/emails",d=b+c,e=d+"/:emailId",f=d+"/:emailId/verify",g=d+"/:emailId/primary";a.$inject=["$urlMatcherFactory","api.Resource"],angular.module("endo.api").factory("api.settings.EmailsResource",a)}(),function(){function a(a,b){function c(c){return f=f||a.compile(d),b.query(f.format({userId:c}))}function e(c,e){return f=f||a.compile(d),b.put(f.format({userId:c}),e)}var f=void 0;return{get:c,save:e}}var b="/rest/v1",c="/users/:userId/settings/heartrate",d=b+c;a.$inject=["$urlMatcherFactory","api.Resource"],angular.module("endo.api").factory("api.settings.HeartrateResource",a)}(),function(){function a(a,b){function c(c){return f=f||a.compile(d),b.get(f.format(c))}function e(c,e){return f=f||a.compile(d),b.put(f.format(c),e)}var f=void 0;return{get:c,put:e}}var b="/rest/v1",c="/settings/newsletters?userId&email&key",d=b+c;a.$inject=["$urlMatcherFactory","api.Resource"],angular.module("endo.api").factory("api.settings.NewslettersResource",a)}(),function(){function a(a,b){function c(b){return g=g||a.compile(d),g.format({userId:b})}function e(a){return b.query(c(a))}function f(a,d){return b.put(c(a),d)}var g=void 0;return{fetch:e,patch:f}}var b="/rest/v1",c="/users/:userId/settings/notifications",d=b+c;a.$inject=["$urlMatcherFactory","api.Resource"],angular.module("endo.api").factory("api.settings.NotificationsResource",a)}(),function(){function a(a,b,c,f){function g(a){return o=o||b.compile(d),o.format({userId:a})}function h(a){return c.query(g(a))}function i(a,b){return c.put(g(a),b)}function j(b,d){var e=a.defer();return c.put(g(b),d).then(function(){c.query(g(b)).then(function(a){return e.resolve(a)}).catch(e.reject)}).catch(e.reject),e.promise}function k(a){p=p||b.compile(e);var d=p.format({userId:a,job:f.PRIVATE_USER});return c.get(d)}function l(a){p=p||b.compile(e);var d=p.format({userId:a,job:f.PRIVATE_USER});return c.put(d)}function m(a){q=q||b.compile(e);var d=q.format({userId:a,job:f.WORKOUT_PRIVACY_SYNC});return c.get(d)}function n(a){q=q||b.compile(e);var d=q.format({userId:a,job:f.WORKOUT_PRIVACY_SYNC});return d+='?params={"workout_command": "CHANGE_PRIVACY_EXACT"}',c.put(d)}var o=void 0,p=void 0,q=void 0;return{fetch:h,patch:i,updateRules:j,getPrivateUserJob:k,triggerPrivateUserJob:l,getWorkoutPrivacySyncJob:m,triggerWorkoutPrivacySyncJob:n}}var b="/rest/v1",c="/users/:userId/settings/privacy",d=b+c,e=b+"/users/:userId/async/:job";a.$inject=["$q","$urlMatcherFactory","api.Resource","model.job.JobEnum"],angular.module("endo.api").factory("api.settings.PrivacyResource",a)}(),function(){function a(a,b){function e(d,e,f){g||(g=a.compile(c));var h=g.format({userId:d});return b.put(h,{oldPassword:e,newPassword:f})}function f(c,e){h||(h=a.compile(d));var f=h.format({userId:c});return b.put(f,e)}var g=void 0,h=void 0;return{changePassword:e,closeAccount:f}}var b="/rest/v1/users/:userId",c=b+"/settings/password",d=b+"/settings/account/close";a.$inject=["$urlMatcherFactory","api.Resource"],angular.module("endo.api.user").factory("api.user.AccountResource",a)}(),function(){function a(a){return{userId:a.id}}function b(b,c,d,t,u){function v(){}var w,x,y,z,A,B,C,D=b.compile(g),E=b.compile(h),F=b.compile(i),G=b.compile(j),H=b.compile(k),I=b.compile(l);return v.prototype.get=function(a,b){return c.get(D.format({userId:a}),a,d)},v.prototype.getAbstract=function(a){var b=D.format({userId:a,expand:"user:abs"},a,d);return c.get(b,a,d)},v.prototype.queryFriends=function(b,d,g,h){var i=a(b);i.limit=d?d:e,i.offset=g||f,i.search=h;var j=E.format(i);return c.get(j).then(function(a){return a.data})},v.prototype.befriend=function(b,d){var e=d?{sponsorKey:d}:null,f=F.format(a(b));return c.put(f,e)},v.prototype.listWorkoutHashtags=function(b){return c.get(G.format(a(b)))},v.prototype.update=function(a,b){return b&&t.isDate(b.dateOfBirth)&&(b.dateOfBirth=u.convertToUTCNoon(b.dateOfBirth)),c.put(D.format({userId:a}),b)},v.prototype.profilePictureUrl=function(a,b){return H.format({userId:a})},v.prototype.suggestedFriends=function(a){return c.get(I.format({userId:a}))},v.prototype.rejectSuggestion=function(a,d){return z=z||b.compile(m),c.delete(z.format({userId:a,friendId:d}))},v.prototype.addFriends=function(a,b){return c.put(E.format({userId:a}),b)},v.prototype.listWorkoutRoutes=function(a){w=w||b.compile(n);var d=w.format({userId:a});return c.get(d).then(function(a){return a.data})},v.prototype.listWorkoutSports=function(a){x=x||b.compile(o);var d=x.format({userId:a});return c.get(d)},v.prototype.sendConfirmationEmail=function(a){y=y||b.compile(p);var d=y.format({userId:a});return c.post(d)},v.prototype.acceptTerms=function(a){A=A||b.compile(q);var d=A.format({userId:a});return c.put(d)},v.prototype.viewTerms=function(a){C=C||b.compile(r);var d=C.format({userId:a});return c.put(d)},v.prototype.termsSummaryUrl=function(a){return B=B||b.compile(s),B.format({userId:a})},new v}var c="/rest/v1",d="/users/:userId",e=100,f=1,g=c+d+"?expand",h=c+d+"/friends?search&limit&offset",i=c+d+"/befriend",j=c+d+"/workouts/hashtags",k=c+d+"/profilepicture",l=c+d+"/suggestedfriends",m=l+"/:friendId",n=c+d+"/workouts/routes",o=c+d+"/sports",p=c+d+"/account/verify",q=c+d+"/terms/accept",r=c+d+"/terms/viewed",s=c+d+"/terms/summary";b.$inject=["$urlMatcherFactory","api.Resource","model.user.User","core.lang.date","common.date.TimezoneUtils"],angular.module("endo.api.user").factory("api.user.UserResource",b)}(),function(){function a(a){function b(a){this.color=a.color,this.zone=a.zone}var c={LOW:{color:"#f8b39b",zone:.8},MEDIUM:{color:"#f48159",zone:1.1},HIGH:{color:"#d3362d",zone:1.4},UNASSIGNED:{color:"#e6e6e6",zone:1},WALKING:{color:"#7bcfa9",zone:1},WALKING_FAST:{color:"#33b679",zone:2},JOGGING:{color:"#0f9d58",zone:2},RECOVERY:{color:"#e6e6e6",zone:1},MODERATE:{color:"#f48159",zone:2},TEMPO:{color:"#f05622",zone:3},FAST:{color:"#e94d20",zone:4},VERY_FAST:{color:"#e2431e",zone:5},MAXIMUM:{color:"#d3362d",zone:6},WARM_UP:{color:"#e6e6e6",zone:1},COOL_DOWN:{color:"#e6e6e6",zone:1}},d="UNASSIGNED",e=a(b,c);return e.get=function(a){var b=e.super.prototype.get.call(this,a);return void 0===b?this.get(d):b},e}a.$inject=["core.lang.enumeration"],angular.module("endo.api.workout").factory("api.workout.IntensityEnum",a)}(),function(){function a(a,b,c,j,k,l){function m(a,b,e){u=u||c.compile(d);var f=b.after.toISOString(),g=b.before.toISOString(),h=u.format({userId:a,before:g,after:f});return j.query(h,e).then(function(a){return new l(a)})}function n(a){return a&&a.success===!0}function o(b,d){v=v||c.compile(e);var f=v.format({userId:b,plannedWorkoutId:d.plannedWorkoutId});return a(function(a,b){j.put(f,{workoutId:d.workoutId}).then(function(c){(n(c)?a:b)()}).catch(b)})}function p(b,d){v=v||c.compile(e);var f=v.format({userId:b,plannedWorkoutId:d});return a(function(a,b){j.delete(f).then(function(c){(n(c)?a:b)()}).catch(b)})}function q(b,d){w=w||c.compile(f);var e=w.format({userId:b,plannedWorkoutId:d});return a(function(a,b){j.put(e).then(function(c){(n(c)?a:b)()}).catch(b)})}function r(b,d){x=x||c.compile(g);var e=x.format({userId:b,plannedWorkoutId:d});return a(function(a,b){j.put(e).then(function(c){(n(c)?a:b)()}).catch(b)})}function s(b,d,e){y=y||c.compile(h);var f=y.format({userId:b,plannedWorkoutId:d});return a(function(a,b){j.put(f,{result:e}).then(function(c){(n(c)?a:b)()}).catch(b)})}function t(a,b){z=z||c.compile(i);var d=z.format({userId:a,plannedWorkoutId:b});return d}var u,v,w,x,y,z;return{query:m,link:o,unlink:p,postpone:q,skip:r,report:s,getExportUrl:t}}var b="/rest/v1",c="/users/:userId/planned",d=b+c+"?before&after",e=b+c+"/:plannedWorkoutId/link",f=b+c+"/:plannedWorkoutId/test/postpone",g=b+c+"/:plannedWorkoutId/test/skip",h=b+c+"/:plannedWorkoutId/test/report",i=b+c+"/:plannedWorkoutId/export";a.$inject=["$q","$timeout","$urlMatcherFactory","api.Resource","api.workout.SportEnum","model.workout.PlannedWorkoutCollection"],angular.module("endo.api.workout").factory("api.workout.PlannedWorkoutResource",a)}(),function(){function a(){function a(a,b){var c=0;if(void 0===this.cache[a]){var d;d=c?c>this.length?this.length:c:this.length,this.cache[a]=!1;for(var e=0;d>e;e++)if(b.call(this[e])){this.cache[a]=!0;break}}return this.cache[a]}function b(a){a=a||[];var c=Array.isArray(a)||a instanceof b?a:a.points;this.push.apply(this,c),Object.defineProperty(this,"cache",{value:{}})}return b.prototype=Object.create(Array.prototype,{constructor:{value:b},hasDistance:{value:function(){var a=this[this.length-1].distance;return a>.1}},hasSpeed:{value:function(){return a.call(this,"hasSpeed",function(){return this.distance>0&&this.speed>0})}},hasCadence:{value:function(){return a.call(this,"hasCadence",function(){return this.sensorData&&this.sensorData.cadence?angular.isNumber(this.sensorData.cadence):!1})}},hasHeartRate:{value:function(){return a.call(this,"hasHeartRate",function(){return this.sensorData&&this.sensorData.heartRate?angular.isNumber(this.sensorData.heartRate):!1})}},hasAltitude:{value:function(){return a.call(this,"hasAltitude",function(){return angular.isNumber(this.altitude)})}},hasPower:{value:function(){return a.call(this,"hasPower",function(){return this.sensorData&&this.sensorData.power?angular.isNumber(this.sensorData.power):!1})}},hasSensorData:{value:function(){return a.call(this,"hasSensorData",function(){var a=this.sensorData,b=!!Object.keys(a).length;if(!b)return!1;var c=Object.keys(a).some(function(b){return!!a[b]});return c?!0:!!this.speed})}}}),b}a.$inject=[],angular.module("endo.api.workout").factory("api.workout.PointCollection",a)}(),function(){function a(a){function b(a){var b=angular.extend({},g,a);Object.defineProperty(this,"data",{value:b})}var c=1.609344,d=[!1],e={CUSTOM:"",DISTANCE:"distance",DURATION:"duration",ALTITUDE:"altitude",ENERGY:"energy"},f={METRIC:"metric",IMPERIAL:"imperial"},g={isAggregated:!1,isDeprecated:!1,quantity:null,unitSystem:null},h={TEST12MIN:{quantity:720,valueFormat:e.DISTANCE,valueParams:[2]},ONE_HOUR:{quantity:3600,valueFormat:e.DISTANCE,valueParams:[2]},M100:{quantity:.1,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d,isDeprecated:!0},M200:{quantity:.2,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d,isDeprecated:!0},M400:{quantity:.4,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d,isDeprecated:!0},M800:{quantity:.8,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d,isDeprecated:!0},M1000:{quantity:1,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},M1500:{quantity:1.5,unitSystem:f.METRIC,labelFormat:e.DISTANCE,labelParams:[1],valueFormat:e.DURATION,valueParams:d},KM2:{quantity:2,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},KM3:{quantity:3,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},KM5:{quantity:5,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},KM10:{quantity:10,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},KM15:{quantity:15,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},KM20:{quantity:20,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},HALF_MARATHON:{quantity:21.097494,labelFormat:e.CUSTOM,valueFormat:e.DURATION,valueParams:d},KM25:{quantity:25,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},KM30:{quantity:30,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},MARATHON:{quantity:42.195,labelFormat:e.CUSTOM,valueFormat:e.DURATION,valueParams:d},KM50:{quantity:50,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},KM100:{quantity:100,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},MI1:{quantity:c,unitSystem:f.IMPERIAL,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},MI2:{quantity:2*c,unitSystem:f.IMPERIAL,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},MI3:{quantity:3*c,unitSystem:f.IMPERIAL,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},MI5:{quantity:5*c,unitSystem:f.IMPERIAL,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},MI6:{quantity:6*c,unitSystem:f.IMPERIAL,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},MI10:{quantity:10*c,unitSystem:f.IMPERIAL,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},MI20:{quantity:20*c,unitSystem:f.IMPERIAL,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},MI30:{quantity:30*c,unitSystem:f.IMPERIAL,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},MI50:{quantity:50*c,unitSystem:f.IMPERIAL,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},MI100:{quantity:100*c,unitSystem:f.IMPERIAL,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d},KM14:{quantity:14,unitSystem:f.METRIC,labelFormat:e.DISTANCE,valueFormat:e.DURATION,valueParams:d,isDeprecated:!0},MAX_DISTANCE:{isAggregated:!0,labelFormat:e.CUSTOM,valueFormat:e.DISTANCE,valueParams:[2]},MAX_DURATION:{isAggregated:!0,labelFormat:e.CUSTOM,valueFormat:e.DURATION,valueParams:d},MAX_CALORIES:{isAggregated:!0,labelFormat:e.CUSTOM,valueFormat:e.ENERGY},MAX_ASCENT:{isAggregated:!0,labelFormat:e.CUSTOM,valueFormat:e.ALTITUDE}};b.prototype=Object.create(Object.prototype,{isMetric:{enumerable:!0,get:function(){var a=this.data.unitSystem;return null===a||a===f.METRIC}},isImperial:{enumerable:!0,get:function(){var a=this.data.unitSystem;return null===a||a===f.IMPERIAL}},labelFormat:{enumerable:!0,get:function(){return this.data.labelFormat}},labelParams:{enumerable:!0,get:function(){return this.data.labelParams}},valueFormat:{enumerable:!0,get:function(){return this.data.valueFormat}},valueParams:{enumerable:!0,get:function(){return this.data.valueParams}},quantity:{enumerable:!0,get:function(){return this.data.quantity}},isAggregated:{enumerable:!0,get:function(){return this.data.isAggregated}},isDeprecated:{get:function(){return this.data.isDeprecated}}});var i=a(b,h);return i.format=angular.copy(e),i}a.$inject=["core.lang.enumeration"],angular.module("endo.api.workout").factory("api.workout.RecordEnum",a)}(),function(){function a(a){function b(a){Object.defineProperty(this,"data",{value:a})}var c={RUNNING:{color:"#8cc474",pace:!0,route:!0},CYCLING_TRANSPORTATION:{color:"#f4b400",route:!0},CYCLING_SPORT:{color:"#fbcb43",route:!0},MOUNTAIN_BIKING:{color:"#f7981d",route:!0},ROLLER_SKATING:{color:"#a61d4c",route:!0},ROLLER_SKIING:{color:"#6f85bf",route:!0},SKIING_CROSS_COUNTRY:{color:"#a8b5d8",route:!0},SKIING_DOWNHILL:{color:"#6f85bf",route:!0},SNOWBOARDING:{color:"#a8b5d8",route:!0},KAYAKING:{color:"#a0c3ff",route:!0},KITE_SURFING:{color:"#76a7fa",route:!0},ROWING:{color:"#76a7fa",route:!0},SAILING:{color:"#a0c3ff",route:!0},WINDSURFING:{color:"#76a7fa",route:!0},FITNESS_WALKING:{color:"#a61d4c",route:!0},GOLFING:{color:"#7bcfa9",route:!0},HIKING:{color:"#a8b5d8",route:!0},ORIENTEERING:{color:"#33b679",pace:!0,route:!0},WALKING:{color:"#bc5679",route:!0},RIDING:{color:"#7bcfa9",route:!0},SWIMMING:{color:"#76a7fa",route:!0},SPINNING:{color:"#f9b256"},OTHER:{color:"#f48159",route:!0},AEROBICS:{},BADMINTON:{},BASEBALL:{},BASKETBALL:{},BOXING:{},STAIR_CLIMBING:{},CRICKET:{},CROSS_TRAINING:{},DANCING:{},FENCING:{},AMERICAN_FOOTBALL:{},RUGBY:{},SOCCER:{},HANDBALL:{},HOCKEY:{},PILATES:{},POLO:{},SCUBA_DIVING:{},SQUASH:{},TABLE_TENNIS:{},TENNIS:{},BEACH_VOLLEY:{icon:"VOLLEYBALL"},VOLLEYBALL:{},WEIGHT_TRAINING:{color:"#c3d03f"},YOGA:{color:"#f8b39b"},MARTIAL_ARTS:{color:"#9e69af"},GYMNASTICS:{color:"#7bcfa9"},STEP_COUNTER:{color:"#bc5679"},ARCHERY:{isHPB:!0},ATHLETICS_SPRINTS:{icon:null,isHPB:!0},ATHLETICS_THROWS:{isHPB:!0},ATHLETICS_JUMPS:{isHPB:!0},BOWLING:{isHPB:!0},BRISK_WALKING:{icon:null,isHPB:!0},CALISTHENICS:{icon:null,isHPB:!0},CIRCUIT_TRAINING:{icon:null,isHPB:!0},DANCE_FIT:{icon:null,isHPB:!0},DRAGON_BOAT:{icon:null,isHPB:!0},FABULOUS:{icon:null,isHPB:!0},FLOOR_BALL:{icon:"HOCKEY",isHPB:!0},GARDENING:{isHPB:!0},HEALTH_QIGONG:{icon:null,isHPB:!0},HOUSEHOLD_CHORES_LIGHT:{isHPB:!0},HOUSEHOLD_CHORES_MODERATE:{isHPB:!0},JUMPING_ROPE:{isHPB:!0},LINE_DANCING:{icon:null,isHPB:!0},LION_DANCING:{icon:null,isHPB:!0},NET_BALL:{icon:null,isHPB:!0},STROLLING:{icon:null,isHPB:!0},SINGAPORE_WORKOUT:{icon:null,isHPB:!0},QIGONG:{icon:null,isHPB:!0},QUICK_SIX:{icon:null,isHPB:!0},ROCK_CLIMBING:{color:"#dae56b",isHPB:!0},SEPAK_TAKRAW:{icon:null,isHPB:!0},SHOOTING:{isHPB:!0},SOFTBALL:{isHPB:!0},TAICHI:{icon:null,isHPB:!0},TOUCH_RUGBY:{icon:null,isHPB:!0},TREKKING:{icon:null,isHPB:!0},TRIATHLON:{isHPB:!0},ULTIMATE_FRISBEE:{isHPB:!0},WEIGHT_LIFTING:{icon:null,isHPB:!0},PICKLEBALL:{icon:null,isHPB:!0},WALKING_TRANSPORTATION:{icon:null,isHPB:!0},CROSSFIT:{color:"#0f9d58"},TREADMILL_RUNNING:{color:"#33b679"},SKATEBOARDING:{},SURFING:{},SNOWSHOEING:{color:"#6f85bf"},WHEELCHAIR:{},CLIMBING:{color:"#c3d03f",icon:"ROCK_CLIMBING"},TREADMILL_WALKING:{color:"#bc5679"},KICK_SCOOTER:{color:"#fbcb43",route:!0},STANDUP_PADDLING:{color:"#4374e0",route:!0},RUNNING_TRAIL:{color:"#65b045",pace:!0,route:!0},ROWING_INDOOR:{color:"#a0c3ff"},FLOORBALL:{color:"#f9b256"},ICE_SKATING:{color:"#a8b5d8",route:!0},SKIING_TOURING:{color:"#a8b5d8",route:!0},ROPE_JUMPING:{color:"#33b679"},STRETCHING:{color:"#e57368"},RUNNING_CANICROSS:{color:"#63a74a",pace:!0,route:!0},PADDLE_TENNIS:{color:"#f4b400"},PARAGLIDING:{color:"#4dbfd9",route:!0}},d=22,e="#f48159",f="other";b.prototype=Object.create(Object.prototype,{color:{enumerable:!0,get:function(){return void 0===this.data.color?e:this.data.color}},icon:{enumerable:!0,get:function(){function a(a){return"sport-"+a.toLowerCase().replace(/_/g,"-")}return a(void 0===this.data.icon?this.$$code:"string"==typeof this.data.icon?this.data.icon:f)}},pace:{enumerable:!0,get:function(){return!!this.data.pace}},allowRoute:{enumerable:!0,get:function(){return!!this.data.route}},isHPB:{enumerable:!0,get:function(){return!!this.data.isHPB}}});var g=a(b,c);return g.get=function(a){var b=g.super.prototype.get.call(this,a);return void 0===b?this.get(d):b},g.is=function(a){return a instanceof b},g}a.$inject=["core.lang.enumeration"],angular.module("endo.api.workout").factory("api.workout.SportEnum",a)}(),function(){function a(a){return{workoutId:a.id,userId:a.author.id}}function b(b,c,d,s,u,v,w){function x(){}var y=c.compile(e),z=c.compile(f),A=c.compile(i),B=c.compile(g),C=c.compile(j),D=c.compile(k),E=c.compile(l),F=c.compile(m),G=c.compile(n),H=c.compile(o),I=c.compile(h),J=c.compile(p);x.prototype.query=function(a,b,c){var d=b.after.toISOString(),e=b.before.toISOString(),f={userId:a,before:e,after:d},g=y.format(f);return v.query(g,c).then(function(a){return new s(a)})};var K;x.prototype.search=function(a,b){K=K||c.compile(t),b=angular.copy(b)||{},b.after=angular.isDate(b.after)?b.after.toISOString():b.after,b.before=angular.isDate(b.before)?b.before.toISOString():b.before;var d=15,e=angular.extend({},b,{userId:a,expand:"workout:full",limit:d}),f=K.format(e);return v.query(f).then(function(a){return new s(a.data,{params:e,paginator:new w(a.paging.total,d)})})},x.prototype.search.page=function(a,d){var e=b.defer(),f=a.getMetadata()||{},g=f.params||{},h=f.paginator;if(h&&h instanceof w){if(!h.hasPage(d))return e.reject(),e.promise;h.page(d),g=angular.extend({},g,h.toQuery()),K=K||c.compile(t);var i=K.format(g);v.query(i).then(function(b){a.replace(b.data),a.setMetadata({params:g,paginator:h}),e.resolve(a)}).catch(e.reject)}else e.reject();return e.promise},x.prototype.get=function(a,b,c){var e=z.format({userId:a,workoutId:b});return v.get(e,b,d,c)},x.prototype.postHashtag=function(b,c){var d=a(b);d.hashtag=c;var e=A.format(d);return v.post(e,null)},x.prototype.deleteHashtag=function(b,c){var d=a(b);d.hashtag=c;var e=A.format(d);return v.delete(e,null)},x.prototype.update=function(a,b,c){var d=z.format({userId:a,workoutId:b});return v.put(d,c)},x.prototype.delete=function(b){var c=z.format(a(b));return v.delete(c)},x.prototype.tagUsers=function(b,c){var d=B.format(a(b)),e=[];angular.forEach(c,function(a){this.push(a.id)},e);var f={taggedUsers:e};return v.put(d,f).then(function(a){return b.taggedUsers=c,a})},x.prototype.untagUser=function(b,c){var d=a(b);return d.taggedUserId=c.id,v.delete(I.format(d))},x.prototype.shareToFacebook=function(a,b){var c={userId:a.author.id,workoutId:a.id},d=D.format(c);return v.put(d,{facebookId:b.userId,accessToken:b.accessToken})},x.prototype.sharedToFacebook=function(b,c){var d=D.format(a(b));return v.put(d,{postId:c})},x.prototype.shareToTwitter=function(a){var b={userId:a.author.id,workoutId:a.id},c=E.format(b);return v.put(c)},x.prototype.deletePicture=function(b,c){var d=C.format(a(b)),e={data:{url:c.url},headers:{"Content-Type":"application/json"}};return v.delete(d,e).then(function(){b.pictures.remove(c)})},x.prototype.copy=function(b){var c=F.format(a(b));return v.put(c)},x.prototype.createRoute=function(b,c){var d=G.format(a(b));return v.put(d,c)},x.prototype.export=function(b,c){var d=a(b);d.format=c;var e=H.format(d);return v.get(e)},x.prototype.getHashtags=function(b){return v.get(A.format(a(b)))},x.prototype.getSuggestedFriends=function(b){return v.get(J.format(a(b)))},x.prototype.LATEST_WORKOUT_ID="latest",x.prototype.getPictureUploadUrl=function(b){return C.format(a(b))},x.prototype.getExportUrl=function(b,c){var d=a(b);return d.format=c,H.format(d)};var L;x.prototype.merge=function(a){L=L||c.compile(q);var b={userId:a.userId,deleteOriginals:a.deleteOriginals,test:a.test},d=L.format(b);return v.post(d,a.workoutIds)},x.prototype.canMerge=function(a){var b=angular.copy(a);return b.test=1,this.merge(b)};var M=void 0;return x.prototype.shareUrl=function(b){M=M||c.compile(r);var d=M.format(a(b));return v.put(d)},new x}var c="/rest/v1",d="/users/:userId/workouts",e=c+d+"?before&after",f=c+d+"/:workoutId",g=f+"/taggedusers",h=g+"/:taggedUserId",i=f+"/hashtags/:hashtag",j=f+"/pictures/",k=f+"/share/facebook",l=f+"/share/twitter",m=f+"/copy",n=f+"/createroute",o=f+"/export?format",p=f+"/suggestedfriends",q=c+d+"/merge?deleteOriginals&test",r=c+d+"/:workoutId/shareurl",s=["after","before","fromDistance","toDistance","fromDuration","toDuration","title","route","tags","sport","offset","limit","expand"],t=c+d+"/history?"+s.join("&");b.$inject=["$q","$urlMatcherFactory","model.workout.Workout","model.workout.WorkoutCollection","api.workout.SportEnum","api.Resource","common.rest.Paginator"],angular.module("endo.api.workout").factory("api.workout.WorkoutResource",b)}(),function(){angular.module("endo.common.base").provider("config",[function(){var a=this;this.layer={},this.$get=["$parse",function(b){return{get:function(c,d){var e=b(c)(a.layer);return angular.isUndefined(e)&&!angular.isUndefined(d)?d:e}}}]}])}(),function(){function a(){if(!h)try{angular.module("endo.debug"),h=e}catch(a){h=/^secreturl\./.exec(window.location.host)?f:g}return h}function b(){return a()===e}function c(){return a()===f}function d(){
return a()===g}var e="development",f="staging",g="production",h=void 0;angular.module("endo.common.base").constant("env",{DEVELOPMENT:e,STAGING:f,PRODUCTION:g,getEnvironment:a,isDevelopment:b,isStaging:c,isProduction:d})}(),function(){var a={};angular.module("endo.common.base").config(["$provide","core.lang.object",function(b,c){var d=angular.isObject(window.endoConfig)?angular.copy(window.endoConfig):{},e=c.merge(a,d);e.$put=function(a,b){var d=c.get(e,a);if(!angular.isObject(d)||angular.isObject(b))return c.set(e,a,b,{merge:!0})},window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),b.constant("layer",e)}])}(),function(){function a(){function a(){return null!==d}function b(b){return a()?d.getItem(b):null}function c(b,c){return a()?d.setItem(b,c):!1}var d=null;try{"localStorage"in window&&null!==window.localStorage&&(d=window.localStorage)}catch(e){}this.$get=function(){return{isBrowserSupported:a,get:b,set:c}}}angular.module("endo.common.base").provider("localStorage",a)}(),function(){angular.module("endo.common.base").config(["layer",function(a){a.$put("requirejs.waitSeconds",30)}]).run(["config","$window",function(a,b){if(!(b.define&&b.define.amd&&b.requirejs))throw new Error("Cannot find AMD library (missing RequireJS?).");requirejs.config(a.get("requirejs",{}))}]).constant("require",window.require).constant("define",window.define).run(["define",function(a){a("async",function(){function a(a){var b,c;b=document.createElement("script"),b.type="text/javascript",b.async=!0,b.src=a,c=document.getElementsByTagName("script")[0],c.parentNode.insertBefore(b,c)}function b(a,b){var c=/!(.+)/,e=a.replace(c,""),f=c.test(a)?a.replace(/.+!/,""):d;return e+=e.indexOf("?")<0?"?":"&",e+f+"="+b}function c(){return e+=1,"__async_req_"+e+"__"}var d="callback",e=0;return{load:function(d,e,f,g){if(g.isBuild)f(null);else{var h=c();window[h]=f,a(b(e.toUrl(d),h))}}}})}])}(),function(){function a(a){a[b]||a.$put(b,d)}var b="version",c="@__VERSION__@",d="2019.09.17.193803";d===c&&(d=void 0),d&&(window.endoConfig=window.endoConfig||{},window.endoConfig[b]=d,window.Raven&&window.Raven.setRelease(d)),a.$inject=["layer"],angular.module("endo.common.base").constant(b,d).config(a)}(),function(){function a(a,b,c,d){function e(e){if(void 0===e)return c.get(n,"locale.unit")||b.get("locale.unit")||l.METRIC;if(!~[l.METRIC,l.IMPERIAL].indexOf(e))throw new Error("'"+e+"' is not valid unit system.");angular.isObject(n)&&c.set(n,"locale.unit",e),a.$put("locale.unit",e),d.publish(m.UNITS_CHANGE,e)}function f(){return e()===l.METRIC}function g(){return e()===l.IMPERIAL}function h(){return c.get(n,"accountStatus")===k.ACCOUNT_ACTIVATION_PENDING}function i(){return c.get(n,"accountStatus")===k.ACTIVE_PRIVATE}function j(){return c.get(n,"locale.language")||b.get("locale.language")}var k={ACCOUNT_ACTIVATION_PENDING:0,PASSWORD_CHANGE_PENDINGL:1,ACTIVE:2,DELETED:3,EMAIL_ACTIVATION_PENDING:4,ACTIVE_PRIVATE:5},l={METRIC:"METRIC",IMPERIAL:"IMPERIAL"},m={UNITS_CHANGE:"viewer/change/units"},n=void 0;return{EVENTS:m,locale:{units:e,isMetric:f,isImperial:g,language:j},isAccountActivationPending:h,isPrivateUser:i,setSession:function(a){n=a}}}a.$inject=["layer","config","core.lang.object","core.event.topic"],angular.module("endo.common.base").factory("viewer",a)}(),function(){function a(a){this.map=a||{}}a.$inject=[],a.prototype={set:function(a){this.map=a},find:function(a){if(a in this.map)return this.map[a];for(var b=Object.keys(this.map),c=null,d=0,e=b.length;e>d;d++){var f=a.indexOf(b[d]);if(~f&&f+b[d].length==a.length){c=this.map[b[d]];break}}return c}},angular.module("endo.common.asset").provider("common.asset.assetMap",[function(){var b=new a;this.set=function(a){b.set(a)},this.$get=function(){return b}}])}(),function(){angular.module("endo.common.asset").provider("common.asset.assetPath",[function(){var a=this;this.basePath="",this.$get=["common.asset.assetMap","core.io.path",function(b,c){function d(b){var d=a.basePath.trim();if(b=b.trim(),d){var e=d;return d.endsWith(c.sep)&&b.startsWith(c.sep)?e=e.substring(0,e.length-1):d.endsWith(c.sep)||b.startsWith(c.sep)||(e+=c.sep),e+b}return b}function e(a,b){var d,e=c.extname(a),f=c.basename(a,e),g=c.dirname(a);return d=g+c.sep+f+"."+b+e}return function(a){var c=b.find(a);return d(null===c?a:e(a,c))}}]}])}(),function(){angular.module("endo.common.asset").provider("common.asset.localePath",[function(){var a=this;this.defaultLocale="en",this.specialExtensions=[".i18n.json"],this.$get=["core.io.path",function(b){function c(c){for(var d,e=0;e<a.specialExtensions.length;e++){var f=a.specialExtensions[e];if(c.endsWith(f)){d=c.slice(-f.length);break}}return d||(d=b.extname(c)),d}function d(d){var e=c(d),f=b.basename(d,e);return!!f.endsWith("."+a.defaultLocale)}function e(d){d=String(d).trim();var e="."+a.defaultLocale,f="",g=c(d),h=b.basename(d,g),i=b.dirname(d);return h.endsWith(e)&&(f=h.slice(-e.length+1),h=h.slice(0,-e.length)),{dir:i,base:h,locale:f,ext:g}}return{addLocale:function(a,c){var d=e(a),f="";return d.dir&&(f=d.dir+b.sep),f+=d.base,f+="."+c,f+=d.ext},changeLocale:function(a,c){if(!d(a))return a;var f=e(a),g=f.dir+b.sep+f.base;return f.locale&&c&&(g+="."+c),g+=f.ext}}}]}])}(),function(){angular.module("endo.common.asset").provider("common.asset.templateUrl",[function(){var a=this;this.protocol="tpl://",this.$get=["config","common.asset.assetPath","common.asset.localePath",function(b,c,d){return function(e){return e.startsWith(a.protocol)?(e=e.slice(a.protocol.length),e=d.changeLocale(e,angular.lowercase(b.get("locale.language"))),e=c(e)):e}}]}])}(),function(){angular.module("endo.common.asset").factory("common.asset.translationPath",["config","common.asset.assetPath","common.asset.localePath",function(a,b,c){return function(d){return d=c.addLocale(d,angular.lowercase(a.get("locale.language"))),d=b(d)}}])}(),function(){function a(a,c,d){function e(){var e,f=a.get(b);switch(f){case"FACEBOOK":e=c;break;case"GOOGLE":e=d;break;default:e=null}return e}return{get:e}}var b="EndomondoApplication_AUTO";a.$inject=["core.io.cookies","api.auth.facebook","api.auth.google"],angular.module("endo.common.auth").factory("common.auth.authProvider",a)}(),function(){function a(a,b,c,d){function e(e){function f(){k(),d.publish("login/success",{stateName:i,stateParams:j})}function g(){k(),a.go(i,j)}if(null!==e){a.go("splash");var h=!1,i="front",j={},k=b.$on("$stateChangeStart",function(a,b,c,d,e){h||(i=b.name,j=c,h=!0),a.preventDefault()});return e.getLoginStatus().then(function(a){c.login(a).then(f).catch(g)}).catch(g)}}return e}a.$inject=["$state","$rootScope","api.auth.session","core.event.topic"],angular.module("endo.common.auth").factory("common.auth.autologin",a)}(),function(){angular.module("endo.common.auth").config(["$httpProvider",function(a){a.interceptors.push(["$q","$rootScope","common.auth.requestBuffer",function(a,b,c){return{responseError:function(d){if(401==d.status&&!d.config.ignoreAuthModule){var e=a.defer();return c.append(d.config,e),b.$broadcast("auth-required",d),e.promise}return a.reject(d)}}}])}]).run(["$rootScope","view.auth.AuthDialog","common.auth.requestBuffer","common.auth.authProvider","api.auth.session","core.event.topic",function(a,b,c,d,e,f){function g(){b.open(b.MODE_LOGIN,{backdrop:"static"}).then(function(){c.retryAll()}).catch(function(){c.rejectAll("xxx")})}function h(){return void 0===j?!0:Date.now()-j>k}function i(){j=Date.now(),f.publish("login/success")}var j,k=18e5;a.$on("auth-required",function(){var a=d.get();return null!==a&&h()?void a.getLoginStatus().then(function(a){e.login(a).then(i).catch(g)}).catch(g):void g()})}])}(),function(){angular.module("endo.common.auth").factory("common.auth.requestBuffer",["$injector",function(a){function b(b,d){function e(a){d.resolve(a)}function f(a){d.reject(a)}c=c||a.get("$http"),c(b).then(e,f)}var c,d=[];return{append:function(a,b){d.push({config:a,deferred:b})},rejectAll:function(a){a&&angular.forEach(d,function(b){b.deferred.reject(a)}),d=[]},retryAll:function(){angular.forEach(d,function(a){b(a.config,a.deferred)}),d=[]}}}])}(),function(){var a="ROLES",b=function(){function b(c){_classCallCheck(this,b),this[a]=c}return b.prototype.has=function(b){return this[a].indexOf(b)>-1},b.prototype.toString=function(){return this[a].join(", ")},b}();angular.module("endo.common.auth").constant("common.auth.Roles",b)}(),function(){var a=angular.module("endo.common.auth");a.provider("user",["core.event.topic","common.auth.Roles",function(a,b){function c(){this.role=e}var d=["id","email","emailVerified","firstName","lastName","avatarUrl","premium","locale","createdDate","dateOfBirth","gender","hasAcceptedTerms","consentNeeded"],e="guest",f="member";c.ROLE_GUEST=e,c.ROLE_MEMBER=f,c.prototype={isGuest:function(){return this.role===e},set:function(b){var c="user/change";return null===b?(this.role=e,this._reset(),void a.publish(c,this)):(this.role=f,this._set(b),void a.publish(c,this))},hasRole:function(a){return"USER"===a?!0:this.roles instanceof b?this.roles.has(a):!1},isFrontendTester:function(){return this.hasRole("FRONTEND_TESTER")},grantConsent:function(){this.consentNeeded=!1},revokeConsent:function(){this.consentNeeded=!0},_reset:function(){d.forEach(function(a){delete this[a]},this)},_set:function(a){var c=[];a&&Array.isArray(a.roles)&&(c=a.roles.slice()),this.roles=new b(c),d.forEach(function(b){this[b]=a[b]},this),this.dateOfBirth&&!angular.isDate(this.dateOfBirth)&&(this.dateOfBirth=new Date(this.dateOfBirth))}};var g=new c;this.set=function(a){g.set(angular.copy(a))},this.$get=function(){return g}}])}(),function(){function a(a,b,c,d,e,f,g){function h(b,c){return(n=n||a.require(o))(b,c)}function i(){return a.require(o)}function j(){return a.load(o)}function k(a){a=b.get(a);var c=h(a.toString()+".title");return c?c:a.toString()}function l(a){var c=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],i=b.get(a.sport).toString()+".action",j="."+g.genderToString(a.author),k=void 0,l="",m=void 0,n=void 0,o=void 0,p=a.isLive?".present":".past";return a.distance&&a.duration?(m=".distAndDur",o=[d(a.distance,2),e(a.duration)]):a.distance?(m=".dist",o=[d(a.distance,2)]):(m=".dur",o=[e(a.duration)]),a.isLive&&c&&(l=h("tracked.present"+m+j)),n=i+p+(a.isLive?"":m)+j,k=h(n,void 0),void 0===k&&(n="OTHER.action"+p+(a.isLive?"":m)+j,k=h(n)),k+=a.isLive?" "+l:"",f.substitute(k,o)}function m(a){var c=b.get(a).toString();return h(c+".activity",void 0)}var n,o="common/data/sports.i18n.json";return{getTitle:k,getAction:l,getActivity:m,load:j,require:i}}a.$inject=["common.i18n.Translation","api.workout.SportEnum","common.unit.UNITS","distanceFilter","durationFilter","core.lang.string","model.user.UserUtils"],angular.module("endo.common.i18n").factory("common.data.SportTranslate",a)}(),function(){function a(a){function b(a){Object.defineProperty(this,"data",{value:a})}var c={SUNNY:{icon:"sunny"},MOSTLY_SUNNY:{icon:"sunny"},PARTLY_SUNNY:{icon:"partlycloudy-am"},INTERMITTENT_CLOUDS:{icon:"partlycloudy-am"},HAZY_SUNSHINE:{icon:"partlyfoggy-am"},MOSTLY_CLOUDY:{icon:"partlycloudy-am"},CLOUDY_AM_AND_PM:{icon:"cloud"},DREARY_AM_AND_PM:{icon:"cloud"},RETIRED_9:{},RETIRED_10:{},FOG_AM_AND_PM:{icon:"fog"},SHOWERS_AM_AND_PM:{icon:"cloudyrain"},MOSTLY_CLOUDY_WITH_SHOWERS:{icon:"cloudyrain"},PARTLY_SUNNY_WITH_SHOWERS:{icon:"cloudyrain"},THUNDERSTORMS_AM_AND_PM:{icon:"lightning"},MOSTLY_CLOUDY_WITH_THUNDER_SHOWERS:{icon:"lightning"},PARTLY_SUNNY_WITH_THUNDER_SHOWERS:{icon:"lightning"},RAIN_AM_AND_PM:{icon:"rain"},FLURRIES_AM_AND_PM:{icon:"snow"},MOSTLY_CLOUDY_WITH_FLURRIES:{icon:"cloudysnow"},PARTLY_SUNNY_WITH_FLURRIES:{icon:"cloudysnow"},SNOW_AM_AND_PM:{icon:"cloudysnow"},MOSTLY_CLOUDY_WITH_SNOW:{icon:"cloudysnow"},ICE_AM_AND_PM:{icon:"ice"},SLEET_AM_AND_PM:{icon:"ice"},FREEZING_RAIN_AM_AND_PM:{icon:"ice"},RETIRED_27:{},RETIRED_28:{},RAIN_AND_SNOW_MIXED_AM_AND_PM:{icon:"ice"},HOT_AM_AND_PM:{},COLD_AM_AND_PM:{},WINDY_AM_AND_PM:{},CLEAR_NIGHT:{icon:"moon"},MOSTLY_CLEAR_NIGHT:{icon:"moon"},PARTLY_CLOUDY_NIGHT:{icon:"partlycloudy-pm"},INTERMITTENT_CLOUDS_NIGHT:{icon:"partlycloudy-pm"},HAZY_NIGHT:{icon:"partlyfoggy-pm"},MOSTLY_CLOUDY_NIGHT:{icon:"partlyfoggy-pm"},PARTLY_CLOUDY_WITH_SHOWERS_NIGHT:{icon:"partlyfoggy-pm"},MOSTLY_CLOUDY_WITH_SHOWERS_NIGHT:{icon:"partlyfoggy-pm"},PARTLY_CLOUDY_WITH_THUNDER_SHOWERS_NIGHT:{icon:"partlyfoggy-pm"},MOSTLY_CLOUDY_WITH_THUNDER_SHOWERS_NIGHT:{icon:"partlyfoggy-pm"},MOSTLY_CLOUDY_WITH_FLURRIES_NIGHT:{icon:"partlyfoggy-pm"},MOSTLY_CLOUDY_WITH_SNOW_NIGHT:{icon:"partlyfoggy-pm"}},d=["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW","UNKNOWN"],e=2;b.prototype=Object.create(null,{icon:{enumerable:!0,get:function(){function a(a){return"weather-"+a.toLowerCase().replace(/_/g,"-")}return a(void 0===this.data.icon?this.$$code:"string"==typeof this.data.icon?this.data.icon:DEFAULT_ICON)}}});var f=a(b,c);return f.get=function(a){var b=f.super.prototype.get.call(this,a);return void 0===b?this.get(e):b},f.windDirection=function(a){return d[a]||"UNKNOWN"},f}a.$inject=["core.lang.enumeration"],angular.module("endo.api.workout").factory("api.workout.WeatherEnum",a)}(),function(){angular.module("endo.common.data").constant("FEATURES",{app:{trainingPlan:!0,statistics:!0,interactiveGraphs:!0,intervalTraining:!0,hrZones:!0,weatherInfo:!0,customSettings:!0,extraWorkoutGoals:!0,personalBestHistory:!1,workoutComparison:!1,adFree:!0,vipSupport:!0},web:{trainingPlan:!0,statistics:!0,interactiveGraphs:!0,intervalTraining:!0,hrZones:!0,weatherInfo:!0,customSettings:!1,extraWorkoutGoals:!1,personalBestHistory:!0,workoutComparison:!0,adFree:!0,vipSupport:!0}})}(),function(){function a(a){var b=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),12);return new Date(b)}function b(a){var b=/^(\d{4})(\/|-)(\d{1,2})(\/|-)(\d{1,2})/;if(b.test(a)){var c=b.exec(a),d=parseInt(c[1],10),e=parseInt(c[3],10)-1,f=parseInt(c[5],10),g=new Date(d,e,f,12);return g}}var c={convertToUTCNoon:a,parseToNoon:b};angular.module("endo.common.date").constant("common.date.TimezoneUtils",c)}(),function(){angular.module("endo.common.detect").factory("common.detect.adBlock",["$document","$q","$timeout",function(a,b,c){var d=!1,e=!1,f=null;null===f&&(f=document.createElement("iframe"),f.src="https://ads.google.com/adserver/adlogger_tracker.php",f.height=0,f.width=0,document.body.appendChild(f));var g=function(){if(e)return d;var a=b.defer();return c(function(){"hidden"!==f.style.visibility&&"none"!==f.style.display||(d=!0),e=!0,a.resolve(d),f.parentNode.removeChild(f)},500),a.promise};return g()}])}(),function(){function a(a,b){b.add("browser-ie9",function(){var a=/*@cc_on!@*/!1;return a}),b.add("browser-ie",function(){var b=-1,c=a.navigator.userAgent,d=c.indexOf("MSIE "),e=c.indexOf("Trident/");if(d>0)b=parseInt(c.substring(d+5,c.indexOf(".",d)),10);else if(e>0){var f=c.indexOf("rv:");b=parseInt(c.substring(f+3,c.indexOf(".",f)),10)}return b>-1?b:void 0})}a.$inject=["$window","core.has"],angular.module("endo.common.detect").run(a)}(),function(){var a=angular.module("endo.common.detect"),b={ios:function(a){return/(iphone|ipad|ipod)/i.test(a)},osx:function(a){return/os x/i.test(a)&&!this.ios(a)},win:function(a){return/windows nt/i.test(a)},wp:function(a){return/windows phone/i.test(a)},android:function(a){return/android/i.test(a)},blackberry:function(a){return/blackberry/i.test(a)}};a.run(["core.has",function(a){a.add("os-ios",function(a){return b.ios(a.navigator.userAgent)}),a.add("os-osx",function(a){return b.osx(a.navigator.userAgent)}),a.add("os-win",function(a){return b.win(a.navigator.userAgent)}),a.add("os-wp",function(a){return b.wp(a.navigator.userAgent)}),a.add("os-android",function(a){return b.android(a.navigator.userAgent)}),a.add("os-blackberry",function(a){return b.blackberry(a.navigator.userAgent)})}]),window.jasmine&&a.value("common.detect.os",b)}(),function(){function a(a,b){function c(b){return void 0===b?d:a(b,f||e)}var d="--",e="MMM d, yyyy h:mm a",f=b.get("locale.datetimeFormat");b.get("locale.timezoneOffset");return c}a.$inject=["dateFilter","config"],angular.module("endo.common.filter").filter("datetime",a)}(),function(){function a(a){return a}angular.module("endo.common.filter").filter("markdown",a),a.$inject=["core.util.markdown"]}(),function(){angular.module("endo.common.filter").filter("replace",function(){return function(a,b,c,d){var e=a||"",f="\\$\\{\\s*"+b+"\\s*\\}",g=c;return d&&(g="<b>"+c+"</b>"),e.replace(new RegExp(f,"g"),g)}})}(),function(){angular.module("endo.common.filter").filter("substitute",["core.lang.string",function(a){return a.substitute}])}(),function(){function a(a,c){function d(b,c,d){c=c||"";var e=a.buildTagFeedsUrl({tag:d.substring(1,d.length)});return c+'<a class="hashtag-link" href="'+e+'">'+d+"</a>"}return function(a){return a.replace(b,d)}}var b=/(^|\s|\b)?(#\w*[a-zA-Z_]+\w*)/gim;angular.module("endo.common.filter").filter("tags",a),a.$inject=["urlBuilder"]}(),function(){angular.module("endo.common.filter").filter("transform",["core.lang.string",function(a){return a.transform}])}(),function(){angular.module("endo.common.filter").filter("unescape",["core.lang.html",function(a){return function(b){return a.toText(b)}}])}(),function(){function a(a){function b(b,f){if(void 0===b||!angular.isNumber(b))return c;f=f||d;var g=a.convertDistance(b,a.distance.METRIC.meters.name,a.METRIC,e);return a.append.altitude(g.toFixed(f))}var c="--",d=0,e=a.getViewerUnitSystem();return b}a.$inject=["common.unit.UNITS"],angular.module("endo.common.filter").filter("altitude",a)}(),function(){function a(a,b){function c(c,g){if(void 0===c||!angular.isNumber(c))return d;g=g||e;var h=a.convertDistance(c,a.distance.METRIC.kilometers.name,a.METRIC,f);return a.append.distance(b(h,g))}var d="--",e=0,f=a.getViewerUnitSystem();return c}a.$inject=["common.unit.UNITS","numberFilter"],angular.module("endo.common.filter").filter("distance",a)}(),function(){function a(a,b,c){function d(d,f){var g=angular.isDefined(f)?f:!0;if(void 0===d||!isFinite(d))return e;var h=a(d),i=h.getHours()>0,j=h.getMinutes()>0,k=h.getDays()>0,l="";return l=k?l.concat(h.getDays()).concat(g?c.short.days:"").concat(":"):l,l=i?l.concat(k?b.zeroPad(h.getHours()):h.getHours()).concat(g?c.short.hours:"").concat(":"):l,l=l.concat(i||!g?b.zeroPad(h.getMinutes()):h.getMinutes()).concat(g?c.short.minutes:"").concat(k?"":":"),l=k?l:l.concat(j||i||!g?b.zeroPad(h.getSeconds()):h.getSeconds()).concat(g?c.short.seconds:"")}var e="--";return d}a.$inject=["core.math.duration","core.lang.number","common.unit.UNITS"],angular.module("endo.common.filter").filter("duration",a)}(),function(){function a(a,b){function c(c){return void 0===c?d:a.append.energy(b(Math.round(c)))}var d="--";return c}a.$inject=["common.unit.UNITS","numberFilter"],angular.module("endo.common.filter").filter("energy",a)}(),function(){function a(a,b,c){function d(d,g){if(void 0===d)return f;var h;h=e===a.IMPERIAL?c(d).kilometersPerHour.toMinutesPerMile():c(d).kilometersPerHour.toMinutesPerKilometer(),h=isFinite(h)?h:0;var i=b(60*h,!1);return g&&"short"===g?i+"/"+a.append.distance("").trim():a.append.pace(i)}var e=a.getViewerUnitSystem(),f="--";return d}a.$inject=["common.unit.UNITS","durationFilter","core.math.conversion.speed"],angular.module("endo.common.filter").filter("pace",a)}(),function(){function a(a,b){function c(c,g){return void 0!==c&&angular.isNumber(c)?(g=g||e,f===b.IMPERIAL&&(c=a(c).kilometersPerHour.toMilesPerHour()),b.append.speed(c.toFixed(g))):d}var d="--",e=0,f=b.getViewerUnitSystem();return c}a.$inject=["core.math.conversion.speed","common.unit.UNITS"],angular.module("endo.common.filter").filter("speed",a)}(),function(){function a(a,b){function c(c,g){if(void 0===c||!angular.isNumber(c))return d;g=g||e;var h=c;return f===a.IMPERIAL&&(h=b(c).celcius.toFahrenheit()),h.toFixed(g)+" "+a.short.temperature}var d="--",e=0,f=a.getViewerUnitSystem();return c}a.$inject=["common.unit.UNITS","core.math.conversion.unitConvert"],angular.module("endo.common.filter").filter("temperature",a)}(),function(){function a(a,b,c,d,e,f){function g(b){b=c.get(b);var d=b.labelFormat,g=b.labelParams||[];switch(d){case c.format.DISTANCE:var h=b.isMetric?f.METRIC:f.IMPERIAL,i=e.apply(void 0,[h,b.quantity].concat(g));return i;case c.format.DURATION:case c.format.ALTITUDE:case c.format.ENERGY:return a(d).apply(void 0,[b.quantity].concat(g));default:var j=l("label."+b.toString(),void 0);return void 0===j?b.toString():j}}function h(b,d){b=c.get(b);var e=b.valueFormat;if(e){var f=b.valueParams||[];return a(e).apply(void 0,[d].concat(f))}return d}function i(a,b){var c=l("record");return d.substitute(c,{record:g(a),value:h(a,b)})}function j(a,b){if(isFinite(b))return l("scope.monthly."+m[b-1]);if(isFinite(a)){var c=l("scope.yearly");return d.substitute(c,{year:a})}return l("scope.allTime")}function k(a,b){b=b||0;var c=l("improvement");return d.substitute(c,{value:h(a,b)})}var l=b.require("common.data.records"),m=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];return{label:g,value:h,record:i,scope:j,improvement:k}}a.$inject=["$filter","common.i18n.Translation","api.workout.RecordEnum","core.lang.string","common.unit.formatDistance","common.unit.UNITS"],angular.module("endo.common.i18n").factory("common.i18n.RecordTranslate",a)}(),function(){angular.module("endo.common.i18n").service("common.i18n.Translation",["$state","$http","$injector","common.asset.translationPath","common.i18n.translationCache","common.asset.templateUrl","$cacheFactory","common.i18n.translationRegistry","common.i18n.translateFactory",function(a,b,c,d,e,f,g,h,i){function j(a){var b;if(a&&a.templateUrl)return b=f(a.templateUrl),e.get(b);if(a&&a.component){var d=c.get(a.component+"Directive");if(Array.isArray(d)){var g=void 0;if(1===d.length&&(g=d[0]),d.length>1)for(var h=g.length,i=0;h>i;i++)if(d[i]&&d[i].templateUrl){g=d[i];break}if(g&&g.templateUrl)return b=f(g.templateUrl),e.get(b)}}var j={};return angular.isObject(a.views)&&angular.forEach(a.views,function(a,c){a.templateUrl&&(b=f(a.templateUrl),j[c]=e.get(b))}),j}function k(a){return a=d(a),b.get(a,{cache:o}).then(function(b){return e.put(a,b.data),b.data})}function l(a){var b=f(a);return e.get(b)}function m(a){var b=h.get(a)||a;return k(b).then(function(a){return i(a)})}function n(a){var b=l(a);if(angular.isDefined(b))return i(b);var c=h.get(a)||a;if(b=e.get(d(c)),angular.isUndefined(b))throw new Error("Translations with key: "+a+" have not been loaded in the current state");return i(b)}var o=g("translationsHttpCache");return{fromCurrentState:function(){return j(a.current)},fromCurrentStateTree:function(){for(var b=j(a.current),c=a.$current.parent,d=b;c&&c.self.name;)d.$parent=j(c.self),c=c.parent,d=d.$parent;return b},fromUrl:k,load:m,require:n}}])}(),function(){function a(a,d){var e=angular.lowercase(d.get("locale.language"));a.DATETIME_FORMATS.dayMonth=c[e]||b}var b="MMMM d",c={en:"MMMM d",fr:"d MMMM",da:"d. MMMM",de:"d. MMMM",es:"d 'de' MMMM",it:"d MMMM",pl:"d MMMM"};a.$inject=["$locale","config"],angular.module("endo.common.i18n").run(a)}(),function(){function a(a,b){function c(c){var f={translation:{}},g=a[0].createElement("div");return g.innerHTML=String(c).trim(),angular.forEach(g.childNodes,function(a){if(a.nodeType===d){var c=String(a.data).trim();if(c.startsWith(e)){c=c.replace(e,"");try{var g=JSON.parse(c);angular.extend(f.translation,g)}catch(h){b.track("Cannot parse template i18n JSON: "+c)}a.parentNode.removeChild(a)}}}),f.template=String(g.innerHTML).trim(),f}var d=8,e="@i18n:";return c}a.$inject=["$document","common.tracker.rum"],angular.module("endo.common.i18n").factory("common.i18n.templateParser",a)}(),function(){angular.module("endo.common.i18n").filter("translate",[function(){function a(a,b,c){if(angular.isFunction(b)){var d;try{d=b(a)}finally{return d||c}}return"---"}return a}])}(),function(){angular.module("endo.common.i18n").factory("common.i18n.translateFactory",["$parse",function(a){return function(b){function c(c,d){var e=a(c)(b);if(angular.isUndefined(e)&&!angular.isUndefined(d))return d;if(void 0!==e||void 0!==d||2!==arguments.length)return e||c}return c.raw=function(){return b},c}}])}(),function(){angular.module("endo.common.i18n").factory("common.i18n.translationCache",["$cacheFactory",function(a){return a("translations")}])}(),function(){function a(){function a(a){return b[a]}function c(a,c){b[a]=c}return{get:a,register:c}}var b={"common.data.weather":"common/data/weather.i18n.json","common.data.records":"common/data/records.i18n.json","ui.chart":"ui/chart/chart.i18n.json","common.data.privacy":"common/data/privacy.i18n.json","common.data.trainingplan":"common/data/trainingplan.i18n.json"};angular.module("endo.common.i18n").service("common.i18n.translationRegistry",a)}(),function(){function a(a,b){var c=function(){function c(){_classCallCheck(this,c)}return c.prototype.supportedLanguages=function(){return b.get("supportedLanguages")},c.prototype.viewerLanguage=function(){return b.get("locale.language")},c.prototype.generateLanguageUrl=function(b){var c=[a.protocol(),"://",a.host(),80===a.port()?"":":"+a.port(),a.path(),"?language="+b,a.hash()?"#"+a.hash():""].join("");return c},c}();return new c}a.$inject=["$location","config"],angular.module("endo.common.lang").factory("common.lang.Languages",a)}(),function(){function a(a){var b={};b.supportsAddEventListener=function(){return!!document.addEventListener},b.createElement=function(a){return document.createElement(a)},b.createText=function(a){return document.createTextNode(a)},b.style=function(a,b){a.style.cssText=b},b.append=function(a,b){a.appendChild(b)},b.remove=function(a,b){a.removeChild(b)},b.hasClass=function(a,b){return-1!==a.className.split(/\s+/).indexOf(b)},b.addClass=function(a,c){b.hasClass(a,c)||(a.className+=" "+c)},b.removeClass=function(a,c){if(b.hasClass(a,c)){var d=a.className.split(/\s+/),e=d.indexOf(c);d.splice(e,1),a.className=d.join(" ")}},b.replaceClass=function(a,c,d){if(b.hasClass(a,c)){var e=a.className.split(/\s+/),f=e.indexOf(c);e[f]=d,a.className=e.join(" ")}},b.addListener=function(a,c,d){b.supportsAddEventListener()?a.addEventListener(c,d,!1):a.attachEvent(c,d)},b.waitForBody=function(a){document.body?a():b.supportsAddEventListener()?document.addEventListener("DOMContentLoaded",function c(){document.removeEventListener("DOMContentLoaded",c),a()}):document.attachEvent("onreadystatechange",function d(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",d),a())})};var c={};c.Ruler=function(a){var c="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.element=b.createElement("div"),this.element.setAttribute("aria-hidden","true"),b.append(this.element,b.createText(a)),this.collapsible=b.createElement("span"),this.expandable=b.createElement("span"),this.collapsibleInner=b.createElement("span"),this.expandableInner=b.createElement("span"),this.lastOffsetWidth=-1,b.style(this.collapsible,c),b.style(this.expandable,c),b.style(this.expandableInner,c),b.style(this.collapsibleInner,"display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;"),b.append(this.collapsible,this.collapsibleInner),b.append(this.expandable,this.expandableInner),b.append(this.element,this.collapsible),b.append(this.element,this.expandable)};var d=c.Ruler;d.prototype.getElement=function(){return this.element},d.prototype.setFont=function(a){b.style(this.element,"max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+a+";")},d.prototype.getWidth=function(){return this.element.offsetWidth},d.prototype.setWidth=function(a){this.element.style.width=a+"px"},d.prototype.reset=function(){var a=this.getWidth(),b=a+100;return this.expandableInner.style.width=b+"px",this.expandable.scrollLeft=b,this.collapsible.scrollLeft=this.collapsible.scrollWidth+100,this.lastOffsetWidth!==a?(this.lastOffsetWidth=a,!0):!1},d.prototype.onScroll=function(a){this.reset()&&null!==this.element.parentNode&&a(this.lastOffsetWidth)},d.prototype.onResize=function(a){function c(){d.onScroll(a)}var d=this;b.addListener(this.collapsible,"scroll",c),b.addListener(this.expandable,"scroll",c),this.reset()},c.Observer=function(a,b){var c=b||{};this.family=a,this.style=c.style||"normal",this.weight=c.weight||"normal",this.stretch=c.stretch||"normal"};var e=c.Observer;return e.HAS_WEBKIT_FALLBACK_BUG=null,e.HAS_SAFARI_10_BUG=null,e.SUPPORTS_STRETCH=null,e.SUPPORTS_NATIVE_FONT_LOADING=null,e.DEFAULT_TIMEOUT=3e3,e.getUserAgent=function(){return window.navigator.userAgent},e.getNavigatorVendor=function(){return window.navigator.vendor},e.hasWebKitFallbackBug=function(){if(null===e.HAS_WEBKIT_FALLBACK_BUG){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(e.getUserAgent());e.HAS_WEBKIT_FALLBACK_BUG=!!a&&(parseInt(a[1],10)<536||536===parseInt(a[1],10)&&parseInt(a[2],10)<=11)}return e.HAS_WEBKIT_FALLBACK_BUG},e.hasSafari10Bug=function(){if(null===e.HAS_SAFARI_10_BUG)if(e.supportsNativeFontLoading()&&/Apple/.test(e.getNavigatorVendor())){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(e.getUserAgent());e.HAS_SAFARI_10_BUG=!!a&&parseInt(a[1],10)<603}else e.HAS_SAFARI_10_BUG=!1;return e.HAS_SAFARI_10_BUG},e.supportsNativeFontLoading=function(){return null===e.SUPPORTS_NATIVE_FONT_LOADING&&(e.SUPPORTS_NATIVE_FONT_LOADING=!!document.fonts),e.SUPPORTS_NATIVE_FONT_LOADING},e.supportStretch=function(){if(null===e.SUPPORTS_STRETCH){var a=b.createElement("div");try{a.style.font="condensed 100px sans-serif"}catch(c){}e.SUPPORTS_STRETCH=""!==a.style.font}return e.SUPPORTS_STRETCH},e.prototype.getStyle=function(a){return[this.style,this.weight,e.supportStretch()?this.stretch:"","100px",a].join(" ")},e.prototype.getTime=function(){return(new Date).getTime()},e.prototype.load=function(c,f){var g=this,h=c||"BESbswy",i=0,j=f||e.DEFAULT_TIMEOUT,k=g.getTime();return a(function(c,f){if(e.supportsNativeFontLoading()&&!e.hasSafari10Bug()){var l=a(function(a,b){var c=function d(){var c=g.getTime();c-k>=j?b():document.fonts.load(g.getStyle('"'+g.family+'"'),h).then(function(b){b.length>=1?a():setTimeout(d,25)},function(){b()})};c()}),m=a(function(a,b){i=setTimeout(b,j)});a.race([m,l]).then(function(){clearTimeout(i),c(g)},function(){f(g)})}else b.waitForBody(function(){function a(){null!==w.parentNode&&b.remove(w.parentNode,w)}function l(){if((-1!=q&&-1!=r||-1!=q&&-1!=s||-1!=r&&-1!=s)&&(q==r||q==s||r==s)){if(e.hasWebKitFallbackBug()&&(q==t&&r==t&&s==t||q==u&&r==u&&s==u||q==v&&r==v&&s==v))return;a(),clearTimeout(i),c(g)}}function m(){var b=g.getTime();if(b-k>=j)a(),f(g);else{var c=document.hidden;c!==!0&&void 0!==c||(q=n.getWidth(),r=o.getWidth(),s=p.getWidth(),l()),i=setTimeout(m,50)}}var n=new d(h),o=new d(h),p=new d(h),q=-1,r=-1,s=-1,t=-1,u=-1,v=-1,w=b.createElement("div");w.dir="ltr",n.setFont(g.getStyle("sans-serif")),o.setFont(g.getStyle("serif")),p.setFont(g.getStyle("monospace")),b.append(w,n.getElement()),b.append(w,o.getElement()),b.append(w,p.getElement()),b.append(document.body,w),t=n.getWidth(),u=o.getWidth(),v=p.getWidth(),m(),n.onResize(function(a){q=a,l()}),n.setFont(g.getStyle('"'+g.family+'",sans-serif')),o.onResize(function(a){r=a,l()}),o.setFont(g.getStyle('"'+g.family+'",serif')),p.onResize(function(a){s=a,l()}),p.setFont(g.getStyle('"'+g.family+'",monospace'))})})},c.Observer}a.$inject=["$q"],angular.module("endo.common.loader").factory("common.loader.FontFaceObserver",a)}(),function(){function a(a,b,c,d){var e,f="v2.3",g=3e3,h=b.defer(),i=!1;return{version:f,require:function(){if(!i)throw new Error("Facebook SDK not loaded.");return e},load:function(){var b=arguments.length<=0||void 0===arguments[0]?g:arguments[0];return i===!0?h.promise:(c.fbAsyncInit=function(){try{FB.init({appId:a.get("api.facebook.appId","202423869273"),version:f,status:!0}),i=!0,delete c.fbAsyncInit,e=FB,h.resolve(FB)}catch(b){h.reject(b)}},function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk"),d(function(){i||h.reject("Facebook SDK timeout.")},b),h.promise)}}}a.$inject=["config","$q","$window","$timeout"],angular.module("endo.common.loader").factory("common.loader.facebook",a)}(),function(){function a(a,b){function c(c){var d="amd/highcharts/"+c;b.isDevelopment()&&(d+=".src");var e=a.assetMap||{},f=d+".js";return d+=f in e?"."+e[f]:"","/assets/"+d}var d={paths:{"highcharts-adapter":c("standalone-framework"),highcharts:c("highcharts"),"highcharts-more":c("highcharts-more"),"highcharts-drilldown":c("drilldown")},shim:{"highcharts-adapter":{exports:"HighchartsAdapter"},highcharts:{deps:["highcharts-adapter"],exports:"Highcharts"},"highcharts-more":{deps:["highcharts"],exports:"Highcharts.columnrangex"},"highcharts-drilldown":{deps:["highcharts"],exports:"Highcharts.seriesTypes.column.prototype.supportsDrilldown"}}};a.$put("requirejs",d)}function b(a,b){function c(){return a(function(a){b(["highcharts","highcharts-more","highcharts-drilldown"],function(b){b.wrap(b.seriesTypes.column.prototype,"drawPoints",function(a){var b=this;if(b.data.length>0){var c=b.options.minPointWidth,d=b.options.maxPointWidth,e=b.barW;d&&d<b.barW?e=d:c&&c>b.barW&&(e=c),angular.forEach(this.data,function(a){a.shapeArgs.x+=(a.shapeArgs.width-e)/2,
a.shapeArgs.width=e})}a.call(this)}),a(b)})})}return{load:c}}a.$inject=["layer","env"],b.$inject=["$q","require"],angular.module("endo.common.loader").config(a).factory("common.loader.highcharts",b)}(),function(){function a(){function a(a,d,e){var f=a.defer(),g=[];return angular.forEach(c,function(a,b){g.push(b+"="+a)}),g=g.join("&"),e(["async!".concat(b,g)],function(a){f.resolve(d.google.maps)}),f.promise}var b="https://maps.googleapis.com/maps/api/js?";this.configure=function(a){angular.extend(c,a)},this.$get=a}function b(a,b,c){var d={},e=b.get(c,"locale.language"),f=b.get(c,"api.maps.key"),g=b.get(c,"api.maps.client");e&&(d.language=e),g&&(d.client=g),f&&(d.key=f),a.configure(d)}var c={language:"EN",key:"key",v:"3",libraries:"geometry,visualization"},d=new a;d.$get.$inject=["$q","$window","require"],b.$inject=["common.loader.mapsProvider","core.lang.object","layer"],angular.module("endo.common.loader").value("common.loader.mapsConfig",c).provider("common.loader.maps",d).config(b)}(),function(){function a(a,b,c,d){return{load:function(){return a(function(a,e){c(["recurly"],function(c){c.configured===!1&&c.configure({publicKey:b.get("api.recurly.publicKey","sc-qeDNoytiqTWgIQgKCOTwwJ"),cors:!d("browser-ie9")}),a(c)})})}}}angular.module("endo.common.loader").config(["layer",function(a){a.$put("requirejs.paths.recurly","https://js.recurly.com/v4/recurly"),a.$put("requirejs.shim.recurly",{exports:"recurly"})}]).factory("common.loader.recurly",a),a.$inject=["$q","config","require","core.has"]}(),function(){function a(a){a.$put("requirejs.paths.sharethrough","//native.sharethrough.com/assets/sfp")}function b(a,b){function c(){return a(function(a,c){b(["sharethrough"],function(b){return a(b)},function(a){return c(a)})})}return{load:c}}a.$inject=["layer"],b.$inject=["$q","require"],angular.module("endo.common.loader").config(a).factory("common.loader.sharethrough",b)}(),function(){function a(){function a(a,b){this.append(a),Object.defineProperty(this,"_metadata",{value:b,writable:!0}),this.setMetadata(b)}return a.isCollection=function(a){throw"Collection.isCollection() not implemented"},a.prototype=Object.create(Array.prototype,{constructor:{value:a,writable:!0},append:{value:function(a){this.push.apply(this,a)}},replace:{value:function(a){this.length=0,this.append(a)}},setMetadata:{value:function(a){this._metadata=a}},getMetadata:{value:function(){return this._metadata}}}),a}a.$inject=[],angular.module("endo.common.model").factory("common.model.Collection",a)}(),function(){function a(a){var b=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,a.apply(this,arguments))}return _inherits(b,a),b.prototype._serialize=function(a){return Number(!!a)},b.prototype._deserialize=function(a){return void 0!==a?"true"===a?!0:"false"===a?!1:!!Number(a):void 0},b}(a);return b}a.$inject=["common.pref.Preference"],angular.module("endo.common.pref").factory("common.pref.BooleanPreference",a)}(),function(){function a(a){var b=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,a.apply(this,arguments))}return _inherits(b,a),b.prototype._serialize=function(a){return parseInt(a,10)},b.prototype._deserialize=function(a){return void 0!==a?"NaN"===a?NaN:parseInt(a,10):void 0},b}(a);return b}a.$inject=["common.pref.Preference"],angular.module("endo.common.pref").factory("common.pref.IntegerPreference",a)}(),function(){function a(a){var b=function(){function b(a,c){_classCallCheck(this,b),this.key=a,this.defaultValue=c}return b.prototype._serialize=function(a){return a},b.prototype._deserialize=function(a){return a},b.prototype.get=function(){var b=a.get(this.key);return null===b?this._deserialize(this.defaultValue):this._deserialize(b)},b.prototype.set=function(b){return a.set(this.key,this._serialize(b)),this},b.getBoolean=function(b){var c=a.get(b);if(void 0!==c&&null!==c)return"true"===c?!0:"false"===c?!1:!!Number(c)},b.getInteger=function(b){var c=a.get(b);if(void 0!==c&&null!==c)return"NaN"===c?NaN:parseInt(c,10)},b.getString=function(b){var c=a.get(b);if(void 0!==c&&null!==c)return String(c)},b}();return b}a.$inject=["common.pref.storage"],angular.module("endo.common.pref").factory("common.pref.Preference",a)}(),function(){function a(a){return a}a.$inject=["localStorage"],angular.module("endo.common.pref").factory("common.pref.storage",a)}(),function(){function a(a,d){return{request:function(e){var f=a.parse(e.url).pathname;return f.startsWith("/rest/")?(d.has(b)&&(e.headers[c]=d.get(b)),e):e}}}a.$inject=["core.io.url","core.io.cookies"];var b="CSRF_TOKEN",c="X-CSRF-TOKEN";angular.module("endo.common.rest").factory("common.rest.CsrfHeaderInterceptor",a)}(),function(){function a(a,b,c,d,e,f){function g(b){var c=e(b);return c.isValid()?c.toDate():(a.warn("DateTimeInterceptor: '"+b+"' is not valid dateString."),b)}return{response:function(a){var c=d.parse(a.config.url).pathname;return c.startsWith("/rest/")?(angular.isObject(a.data)&&(a.data=b.map(a.data,function(a,b){if("string"!=typeof b)return a;var c=b.toLowerCase();if("date_of_birth"===c)return f.parseToNoon(a)||a;if(c.startsWith("time")||c.endsWith("time")||c.startsWith("date")||c.endsWith("date")){var d=g(a);return d}return a})),a):a}}}a.$inject=["$log","core.lang.object","core.lang.string","core.io.url","common.vendor.moment","common.date.TimezoneUtils"],angular.module("endo.common.rest").factory("common.rest.DateTimeInterceptor",a)}(),function(){function a(a,b,c){return{request:function(d){var e=c.parse(d.url).pathname;return e.startsWith("/rest/")?(angular.isObject(d.data)&&(d.data=a.keys.map(d.data,function(a){return b.snakeCase(a)})),d):d},response:function(d){var e=c.parse(d.config.url).pathname;return e.startsWith("/rest/")?(angular.isObject(d.data)&&(d.data=a.keys.map(d.data,function(a){return b.camelCase(a)})),d):d}}}a.$inject=["core.lang.object","core.lang.string","core.io.url"],angular.module("endo.common.rest").factory("common.rest.JsonCamelCaseInterceptor",a)}(),function(){function a(){function a(a){return this.hasPage(a)?(this._offset=this._limit*a,!!~this._offset):!1}function b(a,b){this._total=a,this._limit=b,this._offset=0}return b.prototype=Object.create(Object,{count:{value:function(){return Math.ceil(this._total/this._limit)}},total:{value:function(){return this._total}},hasPage:{value:function(a){return 0===a?!0:this.count()-1>=a}},page:{value:function(b){return void 0===b?this._offset/this._limit:a.call(this,b)}},offset:{value:function(){return this._offset}},limit:{value:function(){return this._limit}},toQuery:{value:function(){return{offset:this.offset(),limit:this.limit()}}}}),b}angular.module("endo.common.rest").factory("common.rest.Paginator",a)}(),function(){var a=angular.module("endo.common.router");a.directive("eoTitle",["$document",function(a){return{link:function(b,c,d){var e=d.eoTitle;a[0].title=e}}}])}(),function(){angular.module("endo.common.router").constant("common.router.LEGACY_URLS",{HOME:"/home",WORKOUT:"/workouts/:workoutId/:userId",PROFILE:"/profile/:id",TEAM:"/teams/:id",CHALLENGE:"/challenges/:id",NEWSFEED:"/home/feed/:id",EVENT:"/event/:id",PAGE:"/page/:name",TRAINING_PLAN:"/training/plan/:userId",ROUTE:"/routes/:id",LINK_ROUTE:"/routes/link/:workoutId",TAG_FEEDS:"/home/tag/:tag",SEARCH:"/search/users?key",SETTINGS:"/settings",STATS:"/stats"})}(),function(){function a(a){function b(a,b,e,f,g){f&&f.$$state&&f.$$state()&&(d=c,c={state:f,params:g})}a.$on("$stateChangeStart",b)}function b(a,b,d){var f={get:function(a){return a?e[a]:c},set:function(a,c,d){e[a]={state:b.get(c),params:d}},go:function(a,c){var e=f.get(a);return e?b.go(e.state,e.params,c):d.reject(new Error("no previous state "+(a?"for memo: "+a:"")))},memo:function(a,d,f){e[a]=c||{state:b.get(d),params:f}},forget:function(a){a?delete e[a]:c=void 0}};return f}var c=null,d=null,e={};a.$inject=["$rootScope"],b.$inject=["$rootScope","$state","$q"],angular.module("endo.common.router").run(a).factory("common.router.previousState",b)}(),function(){function a(a,b){function c(b){a.location=decodeURIComponent(b)}return c.isSecure=function(){var a=arguments.length<=0||void 0===arguments[0]?"":arguments[0],c=arguments.length<=1||void 0===arguments[1]?"":arguments[1];return(angular.lowercase(c)||"").startsWith("javascript")?!1:(a=b.parse(a),c=b.parse(c),a.origin===c.origin)},c}a.$inject=["$window","core.io.url"],angular.module("endo.common.router").factory("common.router.redirect",a)}(),function(){function a(a){function b(b){if(!b)return[];for(var c=b.split("."),d="state-"+c[0],e=[d],f=1;f<c.length;f++)d+="_"+c[f],e.push(a.camelCase(d));return e}return{stateClasses:b}}a.$inject=["core.lang.string"],angular.module("endo.model").factory("common.router.routerUils",a)}(),function(){var a=angular.module("endo.common.router");a.run(["$log","$rootScope","$document","common.router.routerUils",function(a,b,c,d){var e=[],f=angular.element(c[0].body);b.$on("$stateChangeStart",function(a,b,c,d,g){e.forEach(function(a){f.removeClass(a)})}),b.$on("$stateChangeSuccess",function(a,b,c,g,h){e=d.stateClasses(b.name),e.forEach(function(a){f.addClass(a)})})}])}(),function(){function a(a){var b=angular.copy(a);return b.$normalize=function(a){return this.is(a)?(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a):this.decode(a)},b}a.$inject=["common.router.type.date"],angular.module("endo.common.router").factory("common.router.type.after",a)}(),function(){function a(a){var b=angular.copy(a);return b.$normalize=function(a){return this.is(a)?(a.setHours(23),a.setMinutes(59),a.setSeconds(59),a.setMilliseconds(999),a):this.decode(a)},b}a.$inject=["common.router.type.date"],angular.module("endo.common.router").factory("common.router.type.before",a)}(),function(){function a(a){function b(b){return a.days.parse(b)}function c(b){return a.isDate(b)?a.days.format(b):b}function d(b){return a.isDate(b)}function e(b,c){return a.days.equal(b,c)}return{decode:b,encode:c,is:d,equals:e,pattern:a.days.pattern}}a.$inject=["core.lang.date"],angular.module("endo.common.router").factory("common.router.type.date",a)}(),function(){function a(a){function b(a){return parseFloat(a)}function c(a){return null!==a?a||0===a?String(a).replace(/\//g,"%2F"):a:void 0}function d(a){return null===a?!0:angular.isDefined(a)&&this.decode(String(a))===a}function e(a,b){return a===b}return{decode:b,encode:c,is:d,equals:e,pattern:a.FLOAT_POSITIVE}}a.$inject=["core.regexp"],angular.module("endo.common.router").factory("common.router.type.float",a)}(),function(){function a(a){function b(a){return parseInt(a,10)}function c(a){return null!==a?a||0===a?String(a).replace(/\//g,"%2F"):a:void 0}function d(a){return null===a?!0:angular.isDefined(a)&&this.decode(String(a))===a}function e(a,b){return a===b}return{decode:b,encode:c,is:d,equals:e,pattern:a.INTEGER}}a.$inject=["core.regexp"],angular.module("endo.common.router").factory("common.router.type.integer",a)}(),function(){function a(a){function b(b){return null===b?null:a.get(b)}function c(b){return a.is(b)?b.valueOf():b}function d(b){return null===b?!0:a.is(this.decode(b))}function e(a,b){return a===b}return{decode:b,encode:c,is:d,equals:e,pattern:/^\d{1,2}$/}}a.$inject=["api.workout.SportEnum"],angular.module("endo.common.router").factory("common.router.type.sport",a)}(),function(){angular.module("endo.common.router").factory("urlBuilder",["$state","$urlMatcherFactory","common.router.LEGACY_URLS",function(a,b,c){function d(a,c){var d=b.compile(a);return d.format(c)}function e(b,c,e){var f=a.href(b,c,{inherit:!1,lossy:!1});if(null===f){if(void 0===e)throw new Error("Could not build url for state: "+b+". No state or legacyUrl found");return d(e,c)}return f}var f="isCallback",g={buildPremiumUrl:function(a){return e("premium",a)},buildFeedUrl:function(a){return e("feed",a,c.NEWSFEED)},buildProfileUrl:function(a){return e("profile",a,c.PROFILE)},buildChallengeUrl:function(a){return e("challenge",a,c.CHALLENGE)},buildEventUrl:function(a){return e("event",a,c.EVENT)},buildTeamUrl:function(a){return e("team",a,c.TEAM)},buildPageUrl:function(a){return e("page",a,c.PAGE)},buildWorkoutUrl:function(a){return e("top.workouts.info.byId",a,c.WORKOUT)},buildWorkoutsUrl:function(){return e("top.workouts.info.latest",{userId:"me"})},buildTraningPlanUrl:function(a){return e("traningplan",a,c.TRAINING_PLAN)},buildRouteUrl:function(a){return e("routes",a,c.ROUTE)},buildLinkRouteUrl:function(a){return e("linkRoute",a,c.LINK_ROUTE)},buildTagFeedsUrl:function(a){return e("taggedFeeds",a,c.TAG_FEEDS)},buildSearchUrl:function(a){return e("search",a,c.SEARCH)},buildSettingsUrl:function(){return e("settings",void 0,c.SETTINGS)},buildEmailSettingsUrl:function(){return e("settings.emails",void 0,c.SETTINGS)},buildStatsUrl:function(a){return e("stats",a,c.STATS)},buildAccountSettingsUrl:function(){return e("settings.account",void 0,c.SETTINGS)},buildHeartrateSettingsUrl:function(){return e("settings.heartrate",void 0,c.SETTINGS)},buildArchiveSettingsUrl:function(){return e("settings.archive",void 0,c.SETTINGS)},buildDeleteSettingsUrl:function(){return e("settings.delete",void 0,c.SETTINGS)},addCallbackParam:function(a){return a.indexOf("?")>=0?a+"&"+f:a+"?"+f},makeCallbackUrl:function(a,b){if(a){var c=a.split("?");if(c&&c.length>1&&c[1]){var d=c[1].split("&");if(d&&d.indexOf(f)>=0)return d=d.filter(function(a){return a!==f}),b&&(b=Object.keys(b).map(function(a){return a+"="+b[a]}),d=d.concat(b)),a=d.length>0?c[0]+"?"+d.join("&"):c[0]}}return!1}};return g}])}(),function(){angular.module("endo.common.template").config(["$provide",function(a){a.decorator("$templateFactory",["$delegate","common.asset.templateUrl","common.i18n.templateParser","common.i18n.translationCache",function(a,b,c,d){var e=Object.getPrototypeOf(a).fromUrl;return Object.getPrototypeOf(a).fromUrl=function(a,f){var g=e(b(a),f);return null===g?null:g.then(function(e){var f=c(e);return d.put(b(a),f.translation),f.template})},a}])}]).run(["$templateFactory",function(a){}])}(),function(){angular.module("endo.common.template").config(["$provide",function(a){a.decorator("$templateRequest",["$delegate","common.asset.templateUrl","common.i18n.templateParser","common.i18n.translationCache",function(a,b,c,d){function e(f,g){var h=b(f);return a(h,g).then(function(b){e.totalPendingRequests=a.totalPendingRequests;var f=c(b);return d.put(h,f.translation),f.template})}return e}])}])}(),function(){function a(a){a.decorator("$exceptionHandler",b)}function b(a,b){return function(c,d){a.captureException(c,{extra:{cause:d}}),b(c,d)}}a.$inject=["$provide"],b.$inject=["Raven","$delegate"]}(),function(){function a(a,b,c){a.subscribe("user/change",function(a,d){return d.role===b.ROLE_GUEST?void c.setUserContext():void c.setUserContext({id:d.id})})}var b={track:angular.noop};a.$inject=["core.event.topic","userProvider","Raven"],angular.module("endo.common.tracker").constant("common.tracker.rum",b).config(a)}(),function(){var a=angular.module("endo.common.tracker");a.directive("eoTrack",["common.tracker","$timeout","$window","core.io.url",function(a,b,c,d){return{scope:{},link:function(e,f,g){var h=g.eoTrack;f.on("click",function(e){a.trackEvent(h,"click"),d.isOutboundLink(f)&&(e.preventDefault(),b(function(){c.location=f[0].href},500))})}}}])}(),function(){var a=angular.module("endo.common.tracker");a.directive("eoTrackScroll",["$window","common.tracker","core.dom.viewport",function(a,b,c){return{scope:{},link:function(d,e,f){var g=angular.element(a),h=f.eoTrackScroll,i=function j(){c.contains(e)&&(b.trackEvent(h,"scroll"),g.off("scroll resize",j))};g.on("scroll resize",i),i()}}}])}(),function(){var a=angular.module("endo.common.tracker");a.factory("common.tracker",["$state","$location","$window","config",function(a,b,c,d){function e(){return{title:a.current.name,location:b.absUrl(),page:b.url()}}function f(a,b,c,d){var f={hitType:"event",eventCategory:a,eventAction:b};return c&&(f.eventLabel=c),d&&(f.eventValue=c),angular.extend({},f,e())}function g(a){c.ga("send",a)}function h(){var a=angular.extend({hitType:"pageview"},e());c.ga("send",a);var f=d.get("api.comscore.client_id");if(c.COMSCORE&&c.COMSCORE.beacon&&f){var g={c1:"2",c2:f,c3:"",c4:b.absUrl()};c.COMSCORE.beacon(g)}}function i(a,b,d,e){c.ga("send",f.apply(void 0,arguments))}function j(){c["ga-disable-UA-5671071-1"]=!1}function k(){c["ga-disable-UA-5671071-1"]=!0}return"ga"in c&&"function"==typeof c.ga||(c.ga=angular.noop),{track:g,trackPageview:h,trackEvent:i,enable:j,disable:k}}])}(),function(){function a(a,b,c){function d(d,e,f){if(!~[c.METRIC,c.IMPERIAL].indexOf(d))throw new Error("common.unit.formatDistance: Invalid unit system ['"+d+"']");if(!isFinite(e))throw new Error("common.unit.formatDistance: distance is not a valid number ["+e+"]");f=f||0;var g=d===c.IMPERIAL?b(e).kilometers.toMiles():e;return d===c.METRIC&&1>g&&0===f?(g=b(e).kilometers.toMeters(),c.append.altitude(g,d)):(g=a.round(g,f),c.append.distance(g,d))}return d}a.$inject=["core.math","core.math.conversion.distance","common.unit.UNITS"],angular.module("endo.common.units").factory("common.unit.formatDistance",a)}(),function(){function a(a,c,d,e,f,g){function h(a){return(k=k||g.require("common/units/units.i18n.json"))(a)}function i(a,b){b=b||l.getViewerUnitSystem();var d=c.substitute(a,[b]);return h(d)}function j(a){return function(b,c){return b+" "+i(a,c)}}var k,l={distance:{METRIC:{name:"METRIC",centimeters:{name:"centimeters",to:"inches"},meters:{name:"meters",to:"feet"},kilometers:{name:"kilometers",to:"miles"}},IMPERIAL:{name:"IMPERIAL",inches:{name:"inches",to:"centimeters"},feet:{name:"feet",to:"meters"},miles:{name:"miles",to:"kilometers"}}},METRIC:"METRIC",IMPERIAL:"IMPERIAL"};return l.load=function(){return g.load("common/units/units.i18n.json")},l.getViewerDistanceUnit=function(a){return a=a||b,l.getViewerUnitSystem()===l.METRIC?a:l.distance.METRIC[a].to},l.getViewerUnitSystem=function(){return a.locale.units()||l.METRIC},l.convertDistance=function(a,b,c,e){if(c===e)return a;if(void 0===l.distance[c][b])throw new Error("conversion from : "+b+" Not implemented!");var f=d(a)[b],g=l.distance[c][b].to;return g===l.distance.METRIC.centimeters.name?f.toCentimeters():g===l.distance.METRIC.meters.name?f.toMeters():g===l.distance.METRIC.kilometers.name?f.toKilometers():g===l.distance.IMPERIAL.inches.name?f.toInches():g===l.distance.IMPERIAL.feet.name?f.toFeet():g===l.distance.IMPERIAL.miles.name?f.toMiles():void 0},l.append={speed:j("speed.${0}.short"),pace:j("pace.${0}.short"),distance:function(a,b){b=b||l.getViewerUnitSystem();var d=c.substitute("distance.${system}.${unit}.short",{system:b,unit:"METRIC"==b?"kilometers":"miles"});return a+" "+h(d)},altitude:function(a,b){b=b||l.getViewerUnitSystem();var d=c.substitute("distance.${system}.${unit}.short",{system:b,unit:"METRIC"==b?"meters":"feet"});return a+" "+h(d)},heartRate:function(a){return a+" "+h("heartRate.short")},cadence:function(a){return a+" "+h("cadence.short")},energy:function(a){return a+" "+h("energy.short")}},l.label={get distance(){return h("distance.label")},get speed(){return h("speed.label")},get pace(){return h("pace.label")},get time(){return h("time.label")},get duration(){return h("time.duration")},get altitude(){return h("altitude.label")},get heartRate(){return h("heartRate.label")},get cadence(){return h("cadence.label")},get lap(){return h("lap.label")},get energy(){return h("energy.plural")},get heartRateMax(){return h("heartRate.maxLabel")},get heartRateAvg(){return h("heartRate.avgLabel")},get ascent(){return h("altitude.ascent")},get descent(){return h("altitude.descent")},get weight(){return h("weight.label")}},l.short={get weight(){return i("weight.${0}.short")},get height(){return h(l.getViewerUnitSystem()===l.METRIC?"distance.METRIC.centimeters.short":"distance.IMPERIAL.feet.short")},get days(){return h("time.day.short","d")},get hours(){return h("time.hour.short","h")},get minutes(){return h("time.minute.short","m")},get seconds(){return h("time.second.short","s")},get temperature(){return i("temperature.${0}.short")},get distance(){return i("distance.${0}."+l.getViewerDistanceUnit()+".short")},get elevation(){return h(l.getViewerUnitSystem()===l.METRIC?"distance.METRIC.meters.short":"distance.IMPERIAL.feet.short")},get heartRate(){return h("heartRate.short")}},l.plural={get distance(){return i("distance.${0}."+l.getViewerDistanceUnit()+".plural")},get steps(){return h("steps.unit")}},l}var b="kilometers";a.$inject=["viewer","core.lang.string","core.math.conversion.distance","core.math.conversion.speed","core.math.conversion.unitConvert","common.i18n.Translation"],angular.module("endo.common.units").factory("common.unit.UNITS",a)}(),function(){function a(a,b){return b.googletag=b.googletag||{},b.googletag.cmd=b.googletag.cmd||[],function(){var b=a[0],c=b.createElement("script");c.async=!0,c.type="text/javascript";var d="https:"==b.location.protocol;c.src=(d?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";var e=b.getElementsByTagName("script")[0];e.parentNode.insertBefore(c,e)}(),googletag}a.$inject=["$document","$window"],angular.module("endo.common.vendor").factory("common.vendor.GooglePublisherTag",a)}(),function(){angular.module("endo.common.vendor").factory("common.vendor.hammer",["$window",function(a){return a.Hammer}])}(),function(){angular.module("endo.common.vendor").factory("common.vendor.iscroll",["$window",function(a){return{getInstance:function(b,c){return new a.IScroll(b,c)}}}])}(),function(){angular.module("endo.common.vendor").factory("common.vendor.moment",["$window",function(a){return a.moment}])}(),function(){function a(){return c}var b=2,c=function(){function a(b){_classCallCheck(this,a),this.videoId=b}return a.prototype.getVideoId=function(){return this.videoId},a.prototype.getUrl=function(){return"https://www.youtube.com/watch?v="+this.videoId},a.prototype.getPictureUrl=function(){return"https://img.youtube.com/vi/"+this.videoId+"/0.jpg"},a.prototype.getEmbedUrl=function(){return"https://www.youtube.com/embed/"+this.videoId+"?rel=0"},a.parse=function(c){var d=/(https?:\/\/)?(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube\.com\S*[^\w\-\s])([\w\-]{11})(?=[^\w\-]|$)(?![?=&+%\w]*(?:['\"][^<>]*>|<\/a>))[?=&+%\w]*/g,e=d.exec(c);return e&&e[b]?new a(e[b]):null},a}();a.$inject=[],angular.module("endo.common").factory("common.video.YoutubeLink",a)}(),function(){angular.module("endo.core.dom").config(function(){var a,b,c,d,e=0,f=["ms","moz","webkit","o"];for(a=0,b=f.length;b>a&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[f[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[f[a]+"CancelAnimationFrame"]||window[f[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a,b){return c=(new Date).getTime(),d=Math.max(0,16-(c-e)),e=c+d,window.setTimeout(function(){a(c+d)},d)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})})}(),function(){var a=angular.module("endo.core.dom");a.factory("core.dom.geometry",["$document",function(a){return{getDocumentHeight:function(){var b=a[0].body,c=a[0].documentElement;return Math.max(b.scrollHeight,b.offsetHeight,c.clientHeight,c.scrollHeight,c.offsetHeight)},getClipRect:function(a){function b(a){c+=a.offsetTop,d+=a.offsetLeft,a.offsetParent&&b(a.offsetParent)}var c=0,d=0;return b(a),{top:c,left:d}}}}])}(),function(){var a=angular.module("endo.core.dom");a.service("core.dom.media",["$window","$document",function(a,b){return{XSMALL:"xs",SMALL:"sm",MEDIUM:"md",LARGE:"lg",getBreakpointName:function(){var c=a.getComputedStyle(b[0].body,":after"),d=c.getPropertyValue("content"),e=d.replace(/"/g,"").replace(/'/g,"");return e},hasTouchSupport:function(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}}}])}(),function(){var a=angular.module("endo.common");a.factory("core.dom.scroll",["$window","$document","core.dom.viewport","core.dom.geometry",function(a,b,c,d){return{to:function(b){var d=c.getOffset().top,e=b,f=e>d?e-d:d-e;if(100>f)return void a.scroll(0,e);var g=Math.round(f/100);g>=20&&(g=20);var h=Math.round(f/25),i=e>d?d+h:d-h,j=0,k=function(b){return function(){a.scrollTo(0,b)}};if(e>d)for(var l=d;e>l;l+=h)setTimeout(k(i),j*g),i+=h,i>e&&(i=e),j++;else for(var m=d;m>e;m-=h)setTimeout(k(i),j*g),i-=h,e>i&&(i=e),j++},toElement:function(c,e,f){var g=b[0].querySelector(c),h=d.getClipRect(g);e=angular.isNumber(e)?e:0;var i=h.top+e;return f&&f.animation===!1?void a.scroll(0,i):void this.to(i)}}}])}(),function(){var a=angular.module("endo.core.dom");a.factory("core.dom.transition",["$transition","$q",function(a,b){function c(c,e,f){if(f=f===!0?{noTransition:!0}:f||{},f.noTransition===!0){var g=b.defer(),h=c.hasClass(d);return h||c.addClass(d),angular.isString(e)?c.addClass(e):angular.isFunction(e)?e(c):angular.isObject(e)&&c.css(e),c[0].offsetHeight,h||c.removeClass(d),g.resolve(),g.promise}return a(c,e,f)}var d="notransition";return c.findEventName=function(){var a=document.createElement("trans"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return b[c]},c}])}(),function(){var a=angular.module("endo.core.dom");a.factory("core.dom.viewport",["$document","$window",function(a,b){return{getOffset:function(){var c=a[0];return{top:b.pageYOffset||c.documentElement.scrollTop||c.body.scrollTop,left:b.pageXOffset||c.documentElement.scrollLeft||c.body.scrollLeft}},getSize:function(){var c,d,e=a[0],f={height:b.innerHeight,width:b.innerWidth};return f.height||(c=e.compatMode,c&&(d="CSS1Compat"===c?e.documentElement:e.body,f={height:d.clientHeight,width:d.clientWidth})),f},contains:function(a){a instanceof angular.element&&(a=a[0]);var b=a.getBoundingClientRect(),c=this.getSize(),d=b.top+b.height>=0,e=b.top<=c.height;return d&&e}}}])}(),function(){var a=angular.element("<div>"),b={subscribe:function(){a.on.apply(a,arguments)},unsubscribe:function(){a.off.apply(a,arguments)},publish:function(){a.triggerHandler.apply(a,arguments)}};angular.module("endo.core.event").constant("core.event.topic",b)}(),function(){var a=function(){var a={},b=null,c=this,d={},e=function(b,c){return a[b]||(a[b]=[]),a[b].push(c),d},f=function(b,c){if(a[b]){for(var e=[],f=0;a[b][f];f++){var g=a[b][f];g!==c&&e.push(g)}a[b]=e}return d},g=function(b,c){if(a[b])for(var d=0;a[b][d];d++){var e=a[b][d];e(c)}},h=function i(){var a=arguments;if(arguments.length>0){var e,f;!function(){for(var d=[],g=0;a[g];g++){var h=a[g];d.push(h)}var j=d.shift();"function"==typeof j?j(b,function(a){b=a,i.apply(c,d)}):"object"===("undefined"==typeof j?"undefined":_typeof(j))&&j.length>0&&(e=j.shift(),f=function(a){b=a,i.apply(c,d)},e.apply(e,j.concat([f])))}()}else g("done",b);return d};return d={run:h,on:e,off:f}}();angular.module("endo.core.func").constant("core.func.Chain",a)}(),function(){function a(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return 0===b.length?function(a){return a}:1===b.length?b[0]:b.reduce(function(a,b){return function(){return a(b.apply(void 0,arguments))}})}angular.module("endo.core.func").constant("core.func.compose",a)}(),function(){function a(a,b){var c=null;return function(){var d=this,e=arguments;clearTimeout(c),c=setTimeout(function(){a.apply(d,e)},b)}}angular.module("endo.core.func").constant("core.func.debounce",a)}(),function(){function a(a,b,c){b=b||250;var d,e;return function(){var f=c||this,g=Date.now(),h=arguments;d&&d+b>g?(clearTimeout(e),e=setTimeout(function(){d=g,a.apply(f,h)},b)):(d=g,a.apply(f,h))}}angular.module("endo.core.func").constant("core.func.throttle",a)}(),function(){angular.module("endo.core.has").factory("core.has",["$document","$window",function(a,b){function c(c){var d=b,e=a[0],f=e.createElement("div");return c(d,e,f)}function d(a){return angular.isFunction(f[a])&&(f[a]=c(f[a])),f[a]}function e(a,b,d){f[a]=d?c(b):b}var f={};return d.add=e,d._tests=f,d.add("javascript",!0),d}])}(),function(){angular.module("endo.core.io").factory("core.io.cookies",["$document",function(a){var b=a[0],c={get:function(a){return decodeURIComponent(b.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},set:function(a,c,d,e,f,g){if(!a||/^(?:expires|max\-age|path|domain|secure)$/i.test(a))return!1;var h="";if(d)switch(d.constructor){case Number:h=d===1/0?"; expires=Tue, 19 Jan 2038 03:14:07 GMT":"; max-age="+d;break;case String:h="; expires="+d;break;case Date:h="; expires="+d.toUTCString()}return b.cookie=encodeURIComponent(a)+"="+encodeURIComponent(c)+h+(f?"; domain="+f:"")+(e?"; path="+e:"")+(g?"; secure":""),!0},remove:function(a,c,d){return a&&this.has(a)?(b.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(d?"; domain="+d:"")+(c?"; path="+c:""),!0):!1},has:function(a){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(b.cookie)},keys:function(){for(var a=b.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),c=0;c<a.length;c++)a[c]=decodeURIComponent(a[c]);return a}};return c}])}(),function(){function a(a,b){function c(c){var d=c.method||"GET",e=c.url,f=c.data||null,g=new a.XMLHttpRequest;return g.open(d,e,!1),g.send(f),g.status/100!==2?(b.captureMessage("Error: core.io.http.sync",{tags:{source:"http.sync"},extra:{url:e,method:d,status:g.status,response:g.responseText}}),null):g.responseText}var d={};return d.sync=c,d.sync.get=function(a){return c({method:"GET",url:a})},d}a.$inject=["$window","Raven"];var b=angular.module("endo.core.io");b.factory("core.io.http",a)}(),function(){var a="/";angular.module("endo.core.io").constant("core.io.path",{extname:function(a){var b=a.lastIndexOf(".");return~b?a.substring(b,a.length):""},basename:function(b,c){var d=b.lastIndexOf(a),e=b.substring(d+1,b.length);return c&&e.endsWith(c)&&(e=e.slice(0,-c.length)),e},dirname:function(b){if(b===a)return b;var c=b.lastIndexOf(a);return~c?b.substring(0,c):""},sep:a})}(),function(){var a=angular.module("endo.core.io"),b=["hash","host","hostname","origin","pathname","port","protocol"];a.factory("core.io.url",["$document","$window",function(a,c){function d(a,b){return"http:"===a&&80===b?!1:"https:"!==a||443!==b}function e(a,b){return d(a.protocol,b)?a.host:a.hostname}function f(a){var b=a.pathname;return"/"==b[0]?b:"/"+b}function g(a){var b=a.port;return b&&"0"!==b||"http:"!==a.protocol?b&&"0"!==b||"https:"!==a.protocol?parseInt(b):443:80}function h(a,b){var c=a.protocol+"//"+a.hostname;return d(a.protocol,b)?c+":"+b:c}function i(a){for(var b=a.search,c=/[?&]([^=#]+)=([^&#]*)/g,d={},e=c.exec(b);e;){var f=e[1],g=decodeURIComponent(e[2]);d[f]?(d[f]=[d[f]],d[f].push(g)):d[f]=g,e=c.exec(b)}return d}function j(c){var d=a[0].createElement("a");d.href=c;var j={};return b.forEach(function(a){j[a]=d[a]}),j.pathname=f(d),j.port=g(d),j.origin=h(d,j.port),j.host=e(d,j.port),j.search=i(d),j.href=d.href,j}function k(a){var b=a[0]||{};if(b.tagName&&"a"!==b.tagName.toLowerCase())return!1;if(b.target&&b.target.match(/^_(self|parent|top)$/i))return!0;if(!b.href)return!1;var d=j(c.location.toString()),e=j(b.href);return d.origin!==e.origin}function l(a){var b={};return a.split("&").forEach(function(a){var c=a.split("=");b[c[0]]=c.slice(1).join("=")}),b}return{parse:j,parseHash:l,isOutboundLink:k}}])}(),function(){function a(a,b){for(var c=a.slice(),d=[];c.length>0;)d.push(c.splice(0,b));return d}function b(a,c){if(!Array.isArray(a)||!Array.isArray(c))return!1;if(a===c)return!0;if(a.length!=c.length)return!1;for(var d=0,e=a.length;e>d;d++)if(Array.isArray(a[d])&&Array.isArray(c[d])){if(!b(a[d],c[d]))return!1}else if(a[d]!=c[d])return!1;return!0}angular.module("endo.core.lang").constant("core.lang.array",{split:a,equal:b})}(),function(){function a(a){return"[object Date]"===Object.prototype.toString.call(a)}function b(a,b){return a.toDateString()===b.toDateString()}function c(a,b){return a=new Date(a.getFullYear(),a.getMonth(),a.getDate()),
b=new Date(b.getFullYear(),b.getMonth(),b.getDate()),(a-b)/864e5}function d(a,b,d){var e=c(a,b)>=0,f=c(a,d)<=0;return e&&f}function e(a){var b=a.getMonth(),c=a.getFullYear();return 1===b?c%4!==0?28:c%100!==0?29:c%400!==0?28:29:j.indexOf(b)>=0?30:31}function f(b){if(a(b)){var c=[b.getFullYear(),("0"+(b.getMonth()+1)).slice(-2),("0"+b.getDate()).slice(-2)].join("-");return c}}function g(a){if(a=a||"",i.test(a)){var b=i.exec(a),c=parseInt(b[1],10),d=parseInt(b[3],10)-1,e=parseInt(b[5],10);return new Date(c,d,e,0,0,0,0)}}function h(a,b){var c=void 0;if(a>b){c=!0;var d=a;a=b,b=d}var e=b.getFullYear()-a.getFullYear();return(b.getMonth()<a.getMonth()||b.getMonth()==a.getMonth()&&b.getDate()<a.getDate())&&e--,c?-e:e}var i=/^(\d{4})(\/|-)(\d{1,2})(\/|-)(\d{1,2})$/,j=[3,5,8,10];angular.module("endo.core.lang").constant("core.lang.date",{isDate:a,days:{pattern:i,equal:b,diff:c,contain:d,format:f,parse:g,lastOfMonth:e},years:{diff:h}})}(),function(){function a(a){function b(a){a.forEach(function(a){Object.defineProperties(a.value,{$$id:{value:a.id},$$code:{value:a.code}});var b=Object.freeze(a.value);this.push(b),Object.defineProperty(this,a.code,{enumerable:!0,value:b})},this)}function c(){}function d(d,e){var f=0,g=[];if(1===arguments.length&&Array.isArray(d)&&(e=d,d=c),d.prototype){var h=d.prototype.toString;(angular.isUndefined(h)||angular.isFunction(h)&&a.isNative(h))&&Object.defineProperty(d.prototype,"toString",{value:function(){return this.$$code}});var i=d.prototype.valueOf;(angular.isUndefined(i)||angular.isFunction(i)&&a.isNative(i))&&Object.defineProperty(d.prototype,"valueOf",{value:function(){return this.$$id}})}if(d===c&&Array.isArray(e))return e.forEach(function(a,b){g.push({id:b,code:a,value:new c})}),new b(g);for(var j in e){var k,l=e[j];Array.isArray(l)?(k=Object.create(d.prototype),d.apply(k,l)):k=new d(l),g.push({id:f,code:j,value:k}),f++}return new b(g)}return b.prototype=Object.create(Array.prototype,{"super":{value:b},get:{writable:!0,value:function(a){return this[a]}},has:{writable:!0,value:function(a){return angular.isDefined(this[a])}}}),d}a.$inject=["core.lang.func"],angular.module("endo.core.lang").factory("core.lang.enumeration",a)}(),function(){function a(a){return!("prototype"in a)}angular.module("endo.core.lang").constant("core.lang.func",{isNative:a})}(),function(){function a(a){var b=document.createElement("div");b.innerHTML=a;var c=b.textContent||b.innerText;return b=null,c}function b(a){return String(a).replace(/[&<>"'\/]/g,function(a){return c[a]})}var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"},d={toText:a,escape:b};angular.module("endo.core.lang").constant("core.lang.html",d)}(),function(){function a(a){var b=Math.abs(a),c=10>b?"0"+b:b.toString();return 0>a?"-"+c:c}function b(a){return a===+a&&a!==(0|a)}function c(a){return a===+a&&a===(0|a)}angular.module("endo.core.lang").constant("core.lang.number",{zeroPad:a,isFloat:b,isInteger:c})}(),function(){function a(a){return"undefined"==typeof a}function b(a){return null!==a&&"object"===("undefined"==typeof a?"undefined":_typeof(a))}function c(a){return"[object Date]"===Object.prototype.toString.call(a)}function d(a){return!(!a||!(a.nodeName||a.prop&&a.attr&&a.find))}function e(a){return!(b(a)||Array.isArray(a))||c(a)||d(a)}function f(a,d){if(!b(a)||!b(d))throw new Error("Cannot object.merge(). Params must be objects.");var e=angular.copy(a);for(var g in d)try{!b(d[g])||c(d[g])||c(e[g])?e[g]=d[g]:e[g]=f(e[g],d[g])}catch(h){e[g]=d[g]}return e}function g(a){var b=[];for(var c in a)b.push(c);return b}function h(a,c,d,f){if(Array.isArray(a))a.forEach(function(a,b){var g=a;e(a)?g=f.call(null,a,b):(g=Array.isArray(a)?[]:{},h(a,g,d,f)),c.push(g)});else if(b(a))for(var g in a){var i=a[g],j=d.call(null,g),k=i;e(i)?k=f.call(null,i,g):(k=Array.isArray(i)?[]:{},h(i,k,d,f)),c[j]=k}}function i(a,b){if(e(a))return a;var c=Array.isArray(a)?[]:{};return h(a,c,function(a){return a},b),c}function j(c,d,e,g){g=g||{};for(var h=c,i=d.split("."),j=i.pop(),k=0;k<i.length;k++){var l=i[k];a(h[l])&&(h[l]={});{if(!b(h[l]))return;h=h[l]}}return g.merge&&b(h[j])&&b(e)&&(e=f(h[j],e)),h[j]=e,e}function k(c,d){if(b(c)&&!Array.isArray(c)){for(var e=c,f=d.split("."),g=0;g<f.length;g++){var h=f[g];if(a(e[h]))return;e=e[h]}return e}}g.map=function(a,b){if(e(a))return a;var c=Array.isArray(a)?[]:{};return h(a,c,b,function(a){return a}),c};var l={merge:f,set:j,get:k,keys:g,map:i};angular.module("endo.core.lang").constant("core.lang.object",l)}(),function(){function a(a){return a.replace(/_./g,function(a,b){return 0===b?a:a[1].toUpperCase()})}function b(a){var b=/(.)([A-Z]+)/g;return a.replace(b,function(a,b,c){return b+"_"+c.toLowerCase()}).toLowerCase()}function c(a){return a.replace(h,function(a,b,c,d){return d?c.toUpperCase():c})}function d(a,b,c){function d(a,b){if("object"===("undefined"==typeof a?"undefined":_typeof(a))&&null!==a&&!Array.isArray(a)){for(var c=a,d=b.split("."),e=0;e<d.length;e++){var f=d[e];if(angular.isUndefined(c[f]))return;c=c[f]}return c}}var e=Array.isArray(b),f=a.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(a,f,g){var h=e?b[f]:d(b,f);return"function"==typeof c&&(h=c(h,f,a)),void 0===h?a:h});return f}function e(a,b,e){function f(a){function h(a){var b=11;return(a.parentNode||{}).nodeType===b}Array.prototype.forEach.call(a,function(a){a.childNodes&&f(a.childNodes);var i,j=a.transformation?a.transformation:a.textContent;if(a.tagName){i=c(a.tagName.toLowerCase());var k=_typeof(b[i]);"function"===k&&(j=b[i](j,i)),"string"===k&&(j=d(b[i],{text:j}))}return"function"==typeof e&&(j=e(j,i,a.outerHTML)||j),h(a)?g+=j:void(a.parentNode.transformation=j)})}if(!/(<.[^(><.)]+>)/g.test(a))return a;b=b||{};var g="",h=document.createDocumentFragment(),i=document.createElement("div");for(i.innerHTML=a;i.childNodes[0];)h.appendChild(i.childNodes[0]);return f(h.childNodes),i=null,h=null,g}function f(a){return String(a).replace(/^[\s\uFEFF\xA0]+/g,"")}function g(a){return String(a).replace(/[\s\uFEFF\xA0]+$/g,"")}angular.module("endo.core.lang").config(function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(a,b){return b=b||0,this.indexOf(a,b)===b}}),String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(a,b){var c=this.toString();(void 0===b||b>c.length)&&(b=c.length),b-=a.length;var d=c.indexOf(a,b);return-1!==d&&d===b}}),String.prototype.repeat||(String.prototype.repeat=function(a){if(null===this)throw new TypeError("can't convert "+this+" to object");var b=""+this;if(a=+a,a!=a&&(a=0),0>a)throw new RangeError("repeat count must be non-negative");if(a==1/0)throw new RangeError("repeat count must be less than infinity");if(a=Math.floor(a),0===b.length||0===a)return"";if(b.length*a>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var c="";1==(1&a)&&(c+=b),a>>>=1,0!==a;)b+=b;return c})}).constant("core.lang.string",{camelCase:a,snakeCase:b,substitute:d,transform:e,trimLeft:f,trimRight:g});var h=/([\:\-\_]+(.))/g}(),function(){function a(a){function b(b,c,d){var e=c*d;return 1===a.round(e,8)&&(e=1),b*e}function c(a,b){this.distance=a,this.factor=b}function d(a){Object.defineProperties(this,{millimeters:{get:function(){return new c(a,.001)}},centimeters:{get:function(){return new c(a,.01)}},meters:{get:function(){return new c(a,1)}},kilometers:{get:function(){return new c(a,1e3)}},feet:{get:function(){return new c(a,.3048)}},inches:{get:function(){return new c(a,.0254)}},yards:{get:function(){return new c(a,.9144)}},miles:{get:function(){return new c(a,1609.344)}}})}function e(a){return new d(a)}return c.prototype.toMillimeters=function(){return b(this.distance,this.factor,1e3)},c.prototype.toCentimeters=function(){return b(this.distance,this.factor,100)},c.prototype.toMeters=function(){return b(this.distance,this.factor,1)},c.prototype.toKilometers=function(){return b(this.distance,this.factor,.001)},c.prototype.toFeet=function(){return b(this.distance,this.factor,3.28083989501312)},c.prototype.toInches=function(){return b(this.distance,this.factor,39.3700787402)},c.prototype.toYards=function(){return b(this.distance,this.factor,1.09361329834)},c.prototype.toMiles=function(){return b(this.distance,this.factor,.00062137119)},e}a.$inject=["core.math"],angular.module("endo.core.math").factory("core.math.conversion.distance",a)}(),function(){function a(a){function b(b,c,d){var e=c*d;return 1===a.round(e,8)&&(e=1),b*e}function c(a,b){this.speed=a,this.factor=b}function d(a){Object.defineProperties(this,{metersPerSecond:{get:function(){return new c(a,1)}},kilometersPerHour:{get:function(){return new c(a,1/3.6)}},feetPerSecond:{get:function(){return new c(a,1/3.2808)}},milesPerHour:{get:function(){return new c(a,.44704)}},minutesPerKilometer:{get:function(){return new c(60/a,1/3.6)}},minutesPerMile:{get:function(){return new c(60/a,.44704)}}})}function e(a){return new d(a)}return c.prototype.toMetersPerSecond=function(){return b(this.speed,this.factor,1)},c.prototype.toKilometersPerHour=function(){return b(this.speed,this.factor,3.6)},c.prototype.toFeetPerSecond=function(){return b(this.speed,this.factor,3.2808)},c.prototype.toMilesPerHour=function(){return b(this.speed,this.factor,1/.44704)},c.prototype.toMinutesPerKilometer=function(){return 60/this.toKilometersPerHour()},c.prototype.toMinutesPerMile=function(){return 60/this.toMilesPerHour()},e}a.$inject=["core.math"],angular.module("endo.core.math").factory("core.math.conversion.speed",a)}(),function(){function a(a){function b(b,c,d,e,f){e=e||0,f=f||0;var g=c*d;return 1===a.round(g,8)&&(g=1),(b+e)*g+f}function c(a,b,c){this.value=a,this.factor=b,this.constant=c}function d(a,b,d){c.call(this,a,b,d)}function e(a,b,d){c.call(this,a,b,d)}function f(a){Object.defineProperties(this,{kilograms:{get:function(){return new d(a,1)}},pounds:{get:function(){return new d(a,1/2.2046)}},celcius:{get:function(){return new e(a,1,0)}},fahrenheit:{get:function(){return new e(a,1/1.8,-32)}}})}function g(a){return new f(a)}return d.prototype=Object.create(c.prototype),d.prototype.constructor=d,d.prototype.toKilograms=function(){return b(this.value,this.factor,1)},d.prototype.toPounds=function(){return b(this.value,this.factor,2.2046)},e.prototype=Object.create(c.prototype,{}),e.prototype.constructor=c,e.prototype.toCelcius=function(){return b(this.value,this.factor,1,this.constant,0)},e.prototype.toFahrenheit=function(){return b(this.value,this.factor,1.8,this.constant,32)},g}a.$inject=["core.math"],angular.module("endo.core.math").factory("core.math.conversion.unitConvert",a)}(),function(){function a(){function a(a,b){return b===h?0:Math.floor(a/86400)}function b(a,b){return b===h?Math.floor(a/3600):Math.floor(a%86400/3600)}function c(a){return Math.floor(a%3600/60)}function d(a){return a%60}function e(e){function f(e){n+=e,k=a(n,l),j=b(n,l),i=c(n),h=d(n),m=n+o}var h,i,j,k,l=arguments.length<=1||void 0===arguments[1]?g:arguments[1],m=e,n=Math.round(e),o=m-n;k=a(n,l),j=b(n,l),i=c(n),h=d(n),this.getSeconds=function(){return h},this.setSeconds=function(a){f(a-h)},this.getMinutes=function(){return i},this.setMinutes=function(a){var b=Math.floor(60*a);f(b-60*i)},this.getHours=function(){return j},this.setHours=function(a){var b=Math.floor(3600*a);f(b-3600*j)},this.getDays=function(){return k},this.setDays=function(a){var b=Math.floor(86400*a);f(b-86400*k)},this.getSecondsTotal=function(){return m}}function f(a,b){return new e(a,b)}var g="days",h="hours";return f.DAYS=g,f.HOURS=h,f}angular.module("endo.core.math").factory("core.math.duration",a)}(),function(){function a(a,b,c){return"undefined"==typeof c||0===+c?Math[a](b):(b=+b,c=+c,isNaN(b)||"number"!=typeof c||c%1!==0?NaN:(b=b.toString().split("e"),b=Math[a](+(b[0]+"e"+(b[1]?+b[1]-c:-c))),b=b.toString().split("e"),+(b[0]+"e"+(b[1]?+b[1]+c:c))))}function b(b,c){return c=c?-c:0,a("round",b,c)}var c={round:b};angular.module("endo.core.math").constant("core.math",c)}(),function(){function a(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}var b={INTEGER:/\d+/,FLOAT:/^[-+]?[0-9]*\.?[0-9]+$/,FLOAT_POSITIVE:/^[0-9]*\.?[0-9]+$/,LOCAL_DATE:/^[0-9]{4}\-[0-9]{2}\-[0-9]{2}$/,escape:a};angular.module("endo.core").constant("core.regexp",b)}(),function(){function a(a){return function(b,c,d){return d&&isNaN(d)?'<a href="'+d+'">'+c+"</a>":d&&Array.isArray(a)&&a[d]?a[d](c):"function"==typeof a?a(c):c}}function b(b,c){var h=b||"";return h.replace(f,a(c)).replace(e,g("<strong>","</strong>")).replace(d,g("<i>","</i>"))}function c(){return b}angular.module("endo.core.util").factory("core.util.markdown",c);var d=/\*([^\*]+?)\*/g,e=/\*\*([^\*]+?)\*\*/g,f=/\[(.+?)\](?:\(([^\*]+?)\)){0,1}/g,g=function(a,b){return function(c,d){return a+d+b}}}(),function(){function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}angular.module("endo.core.util").constant("core.util.uuid",a)}(),function(){function a(){function a(a){a=a||[],a.forEach(function(a){this.push(a)},this)}return a.prototype=Object.create(Array.prototype,{contains:{value:function(a){for(var b=!1,c=0;c<this.length&&!b;c++)b=this[c].id===a.id;return b}},find:{value:function(a){for(var b=!1,c=0;c<this.length&&!b;c++)b=this[c].id===a.id;return b?c-1:-1}},add:{value:function(a){var b=this.find(a);return 0>b?(this.splice(0,0,a),!0):!1}},remove:{value:function(a){var b=this.find(a);return b>=0?(this.splice(b,1),!0):!1}},clone:{value:function(){return new a(this.splice(0))}}}),a}a.$inject=[],angular.module("endo.model").factory("model.ModelCollection",a)}(),function(){function a(a){var b={AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AC:"Ascension Island",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia and Herzegovina",BW:"Botswana",BR:"Brazil",IO:"British Indian Ocean Territory",VG:"British Virgin Islands",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CD:"Congo (DRC)",CG:"Congo (Republic)",CK:"Cook Islands",CR:"Costa Rica",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",TL:"East Timor",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Islas Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",CI:"Ivory Coast",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Laos",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macau",MK:"Macedonia (FYROM)",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar (Burma)",QN:"Nagorno-Karabakh Republic",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",KP:"North Korea",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territories",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn Islands",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RO:"Romania",RU:"Russia",RW:"Rwanda",RE:"Réunion",BL:"Saint Barthélemy",SH:"Saint Helena",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",KR:"South Korea",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syria",ST:"São Tomé and Príncipe",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TA:"Tristan da Cunha",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UM:"U.S. Minor Outlying Islands",VI:"U.S. Virgin Islands",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VA:"Vatican City",VE:"Venezuela",VN:"Vietnam",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe",AX:"Åland Islands"},c=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","GB"],d=["CU","IR","KP","SD","SY"],e=function(){function a(b){_classCallCheck(this,a),this.name=b}return a.prototype.isEuropeanUnionMember=function(){return!!~c.indexOf(this.$$code)},a.prototype.isSanctioned=function(){return!!~d.indexOf(this.$$code)},a}(),f=a(e,b);return f}a.$inject=["core.lang.enumeration"],angular.module("endo.model").factory("model.CountryEnum",a)}(),function(){function a(a,c){function d(a,b){return(h=h||e())(a,b)}function e(){return a.require(b)}function f(){return a.load(b)}function g(a){var b=c.get(a);if(b)return d(b.toString())}var h=void 0;return{load:f,require:e,name:g}}var b="model/_base/countries.i18n.json";a.$inject=["common.i18n.Translation","model.CountryEnum"],angular.module("endo.model").factory("model.CountryTranslate",a)}(),function(){function a(a){function b(a,b){var c=a.match(e),d="gm"===c[1].toLowerCase(),f=c[2],g=c[3];return"GMT"+(d?"-":"+")+f+":"+g+" "+b}function c(a){var b={};Object.defineProperty(this,"data",{value:b}),this.data.readableName=a}var d={Gm1200_DAT:["Dateline, west","Etc/GMT+12"],Gm1100_SAM:["Midway, Samoa","Pacific/Samoa"],Gm1000_HAW:["Hawaii","US/Hawaii"],Gm0900_ALA:["Alaska","US/Alaska"],Gm0800_PST:["Pacific Time (US & Canada)","US/Pacific"],Gm0800_TIJ:["Tijuana, Baja California","America/Tijuana"],Gm0700_ARI:["Arizona","US/Arizona"],Gm0700_CHI:["Chihuahua, Mazatlan","America/Chihuahua"],Gm0700_MST:["Mountain Time (US & Canada)","US/Mountain"],Gm0600_CST:["Central Time (US & Canada)","US/Central"],Gm0600_MEX:["Mexico City, Monterrey","America/Mexico_City"],Gm0600_CEN:["Central America","Mexico/General"],Gm0600_SAS:["Saskatchewan","Canada/Saskatchewan"],Gm0500_BOG:["Bogota, Lima, Rio Branco","America/Bogota"],Gm0500_EST:["Eastern Time (US & Canada)","US/Eastern"],Gm0500_IND:["Indiana (East)","US/East-Indiana"],Gm0430_CAR:["Caracas","America/Caracas"],Gm0400_ATC:["Atlantic Time (Canada)","Canada/Atlantic"],Gm0400_LAP:["La Paz","America/La_Paz"],Gm0400_MAN:["Manaus","America/Manaus"],Gm0400_SAN:["Santiago","America/Santiago"],Gm0330_NEW:["Newfoundland","Canada/Newfoundland"],Gm0300_BRA:["Brazil, east","Brazil/East"],Gm0300_BUE:["Buenos Aires","America/Buenos_Aires"],Gm0300_GRE:["Greenland","America/Godthab"],Gm0300_MON:["Montevideo","America/Montevideo"],Gm0200_ATL:["Mid-Atlantic","Etc/GMT+2"],Gm0100_AZO:["Azores","Atlantic/Azores"],Gm0100_CAP:["Cape Verde","Atlantic/Cape_Verde"],Gm0000_CAS:["Casablanca","Africa/Casablanca"],Gm0000_GMT:["Dublin, Edinburgh, Lisbon, London","Europe/London"],Gm0000_MON:["Monrovia, Reykjavik","Atlantic/Reykjavik"],Gp0100_AMS:["Amsterdam, Berlin, Bern, Brussels, Rome, Vienna","Europe/Amsterdam"],Gp0100_BEL:["Belgrade, Bratislava, Budapest, Ljubljana, Prague","Europe/Belgrade"],Gp0100_CPH:["Copenhagen, Stockholm, Oslo, Madrid, Paris","Europe/Copenhagen"],Gp0100_SAR:["Sarajevo, Skopje, Warsaw, Zagreb","Europe/Warsaw"],Gp0100_WCA:["West Central Africa","Etc/GMT-1"],Gp0100_WIN:["Windhoek","Africa/Windhoek"],Gp0200_AMM:["Amman","Asia/Amman"],Gp0200_ATH:["Athens, Bucharest, Istanbul","Europe/Athens"],Gp0200_BEI:["Beirut","Asia/Beirut"],Gp0200_HAR:["Harare, Pretoria","Africa/Harare"],Gp0200_HEL:["Helsinki, Kiev, Riga, Sofia, Tallinn, Vilnius","Europe/Helsinki"],Gp0200_JER:["Jerusalem","Asia/Jerusalem"],Gp0200_CAI:["Cairo","Africa/Cairo"],Gp0200_MIN:["Minsk","Europe/Minsk"],Gp0300_BAG:["Baghdad","Asia/Baghdad"],Gp0300_KUW:["Kuwait, Riyadh","Asia/Kuwait"],Gp0300_MOS:["Moscow, St. Petersburg, Volgograd","Europe/Moscow"],Gp0300_NAI:["Nairobi","Africa/Nairobi"],Gp0330_TEH:["Tehran","Asia/Tehran"],Gp0400_ABU:["Abu Dhabi, Muscat","Asia/Muscat"],Gp0400_BAK:["Baku","Asia/Baku"],Gp0400_YER:["Yerevan","Asia/Yerevan"],Gp0430_KAB:["Kabul","Asia/Kabul"],Gp0500_YEK:["Yekaterinburg","Asia/Yekaterinburg"],Gp0500_ISL:["Islamabad, Karachi","Asia/Karachi"],Gp0500_TAS:["Tashkent","Asia/Tashkent"],Gp0530_CHE:["Chennai, Calcutta, Mumbai, New Delhi","Asia/Calcutta"],Gp0545_KAT:["Katmandu","Asia/Katmandu"],Gp0600_ALM:["Almaty, Novosibirsk","Asia/Novosibirsk"],Gp0600_AST:["Astana, Dhaka","Asia/Dhaka"],Gp0630_RAN:["Rangoon","Asia/Rangoon"],Gp0700_BAN:["Bangkok, Hanoi, Jakarta","Asia/Bangkok"],Gp0700_KRA:["Krasnoyarsk","Asia/Krasnoyarsk"],Gp0800_BEI:["Beijing, Chongqing, Hong Kong, Urumqi","Asia/Hong_Kong"],Gp0800_IRK:["Irkutsk, Ulaan Bataar","Asia/Irkutsk"],Gp0800_KUA:["Kuala Lumpur, Singapore","Asia/Singapore"],Gp0800_PER:["Perth","Australia/Perth"],Gp0800_TAI:["Taipei","Asia/Taipei"],Gp0900_OSA:["Osako, Sapporo, Tokyo","Asia/Tokyo"],Gp0900_SEO:["Seoul","Asia/Seoul"],Gp0900_YAK:["Yakutsk","Asia/Yakutsk"],Gp0930_ADE:["Adelaide","Australia/Adelaide"],Gp0930_DAR:["Darwin","Australia/Darwin"],Gp1000_BRI:["Brisbane","Australia/Brisbane"],Gp1000_CAN:["Canberra, Melbourne, Sydney","Australia/Sydney"],Gp1000_GUA:["Guam, Port Moresby","Pacific/Guam"],Gp1000_HOB:["Hobart","Australia/Hobart"],Gp1000_VLA:["Vladivostok","Asia/Vladivostok"],Gp1100_MAG:["Magadan, Solomon Islands, New Caledonia","Asia/Magadan"],Gp1200_AUC:["Auckland, Wellington","Pacific/Auckland"],Gp1200_FIJ:["Fiji, Kamchatka, Marshall Islands","Pacific/Fiji"],Gp1300_TON:["Tongatapu","Pacific/Tongatapu"]},e=/(gm|gp)(\d{2})(\d{2})_(\S.*)/i,f={};angular.forEach(d,function(a,c){f[a[1]]=b(c,a[0])}),c.prototype=Object.create(Object.prototype,{valueOf:{value:function(){return this.$$code}},toString:{value:function(){return this.data.readableName}}});var g=a(c,f);return g}a.$inject=["core.lang.enumeration"],angular.module("endo.model").factory("model.TimezoneEnum",a)}(),function(){function a(a){function b(b){return a.isDate(b)?a.years.diff(b,new Date)>=c:void 0}var c=13;return{LEGAL_AGE:c,validateDateOfBirth:b}}a.$inject=["core.lang.date"],angular.module("endo.model").factory("model.auth.AuthUtils",a)}(),function(){function a(a){var b=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,a.call(this,c))}return _inherits(b,a),b.prototype.findCountry=function(a){for(var b=void 0,c=0;c<this.length;c++)if(a==this[c].countryCode){b=this[c];break}return b},b}(a);return b}function b(a,b){var c=function(){function a(b){_classCallCheck(this,a),this.countryCode=b}return _createClass(a,[{key:"marketingConsentType",get:function(){return"OPT_IN"}},{key:"termsConsentType",get:function(){return"OPT_IN"}},{key:"consentTextVersion",get:function(){return 1}}]),a}(),d=function(b){function d(){_classCallCheck(this,d);var e=a.filter(function(a){return!a.isSanctioned()}).map(function(a){return new c(a.toString())});return _possibleConstructorReturn(this,b.call(this,e))}return _inherits(d,b),d}(b);return d}a.$inject=["common.model.Collection"],b.$inject=["model.CountryEnum","model.auth.ConsentCollection"],angular.module("endo.model").factory("model.auth.ConsentCollection",a).factory("model.auth.ConsentFallbackCollection",b)}(),function(){function a(a,b){function c(c){angular.extend(this,c),this.type=a.get(this.type),this.sports&&this.sports.length&&(this.sports=this.sports.map(function(a){return b.get(a)}))}return c.prototype=Object.create(Object.prototype,{}),c}a.$inject=["model.challenge.ChallengeType","api.workout.SportEnum"],angular.module("endo.model").factory("model.challenge.Challenge",a)}(),function(){function a(a,b,c,d,e){function f(b){return(j=j||a.require(i))(b)}function g(){return a.load(i)}function h(a){var b=f(a.type.toString()+".goal");return e.substitute(b,{distance:c(a.goal),distUnit:d.plural.distance})}var i="model/challenge/ChallengeType.i18n.json",j=void 0;return{goal:h,load:g}}a.$inject=["common.i18n.Translation","model.challenge.ChallengeType","distanceFilter","common.unit.UNITS","core.lang.string"],angular.module("endo.model").factory("model.challenge.ChallengeTranslate",a)}(),function(){function a(a){function b(a){Object.defineProperty(this,"data",{value:a})}var c={MOST_KM:{},MOST_WORKOUTS:{},FASTEST_X_KM:{lowerIsBetter:!0},MOST_CALORIES:{},MOST_ACTIVE_MINUTES:{},FASTEST_DISTANCE:{lowerIsBetter:!0},AVG_DISTANCE:{},AVG_DURATION:{},AVG_CALORIES:{},AVG_WORKOUTS:{},TEST12MIN:{},LONGEST_ONE_HOUR:{}};b.prototype=Object.create(null,{lowerIsBetter:{enumerable:!0,get:function(){return!!this.data.lowerIsBetter}}});var d=a(b,c);return d}a.$inject=["core.lang.enumeration"],angular.module("endo.model").factory("model.challenge.ChallengeType",a)}(),function(){function a(a,b){var c={OTHER:{},FACEBOOK:{canDisconnect:!1,name:"Facebook"},GOOGLE:{name:"Google"},TWITTER:{name:"Twitter"},GARMIN:{name:"Garmin"},MYFITNESSPAL:{name:"My Fitness Pal",callback:"/connect/callback/ng/myfitnesspal"},MMF:{name:"Map My Fitness",callback:"/connect/callback/ng/mmf"},WITHINGS:{name:"Withings",isDeprecated:!0},FITBIT:{name:"Fitbit",isDeprecated:!0},FITBIT2:{name:"Fitbit"},WITHINGS2:{name:"Withings"},YAHOO:{name:"Yahoo",isDeprecated:!0},NIKE:{name:"Nike+",isDeprecated:!0},POLAR:{name:"Polar",authorizeUrl:function(a,c){var d=b.parse(c).host||"",e=d.split(".").reverse().slice(2).join(".");return a+"&state="+encodeURIComponent(e)}}},d=function(){function a(b){_classCallCheck(this,a),this.name=b.name,this.callback=b.callback,this.link=b.link,this.isDeprecated=b.isDeprecated,this.authorizeUrl=b.authorizeUrl}return a.prototype.canDisconnect=function(){return void 0!==this.canDisconnect?this.canDisconnect:!0},a}();return a(d,c)}a.$inject=["core.lang.enumeration","core.io.url"],angular.module("endo.model").factory("model.connection.ConnectionType",a)}(),function(){function a(a){var b=function(a){function b(c){return _classCallCheck(this,b),_possibleConstructorReturn(this,a.call(this,c))}return _inherits(b,a),b.prototype.findCountry=function(a){for(var b=void 0,c=0;c<this.length;c++)if(a==this[c].countryCode){b=this[c];break}return b},b}(a);return b}a.$inject=["common.model.Collection"],angular.module("endo.model").factory("model.consent.ConsentCollection",a)}(),function(){function a(a){var b={title:"<h1>${text}</h1>",paragraph:"<p>${text}</p>",email:'<a href="https://support.endomondo.com/hc/en-us/requests/new" target="_blank">${text}</a>'},c=function(){function c(a,b){_classCallCheck(this,c),this.consentCollection=a,this.translateConsent=b}return c.prototype.getMinAge=function(a){var b=this.consentCollection.findCountry(a);if(void 0!==b)return b.minAge},c.prototype.getRequiredConsents=function(c){var d=this.consentCollection.findCountry(c);if(void 0!==d){var e=this.translateConsent,f=d.region,g=d.consentTypes;return g.map(function(c){var d=c.name,g=a.transform(e(f+"."+d+".description"),b);return{id:d,title:e(f+"."+d+".title"),summary:e(f+"."+d+".summary"),description:g}})}},c}();return c}a.$inject=["core.lang.string"],angular.module("endo.model").factory("model.consent.ConsentResolver",a)}(),function(){function a(a,b,c,d,e,f,g,h){function i(g){angular.extend(this,g),this.type=c.get(this.type),this.comments=new a(this.comments),this.likes=new a(this.likes),this.peptalks=new a(this.peptalks),this.taggedWith=new a(this.taggedWith),Array.isArray(this.pictures)&&this.pictures.reverse(),this.pictures=new a(this.pictures),this.workout=this.workout?new b(this.workout):null,this.friend=this.friend?new d(this.friend):null,this.trainingPlan=this.trainingPlan?new e(this.trainingPlan):null,this.challenge=this.challenge?new f(this.challenge):null,this.message&&(this.message=h.escape(this.message)),this.workout&&this.workout.notes&&(this.workout.notes=h.escape(this.workout.notes)),this.challenge&&this.challenge.name&&(this.challenge.name=h.escape(this.challenge.name))}return g=new d(g),i.prototype=Object.create(Object.prototype,{addComments:{value:function(a){a.forEach(function(a){this.push(a)},this.comments)}},addPeptalks:{value:function(a){a.forEach(function(a){this.push(a)},this.peptalks)}},addLikes:{value:function(a){a.forEach(function(a){this.add(a)},this.likes)}},postComment:{value:function(a){a.author=g,this.comments.push(a),this.commentsCount++,this.commentByMe=!0}},deleteComment:{value:function(a){this.comments.remove({id:a})&&this.commentsCount--}},like:{value:function(){this.likes.add(g)&&this.likeCount++,this.likeByMe=!0}},dislike:{value:function(){this.likes.remove(g)&&this.likeCount--,this.likeByMe=!1}},postPeptalk:{value:function(a){a.author=g,this.peptalks.push(a),this.peptalksCount++,this.peptalkByMe=!0}},canDelete:{value:function(){return this.author&&this.author.id===g.id}}}),i}a.$inject=["model.ModelCollection","model.workout.Workout","model.feed.FeedType","model.user.User","model.trainingplan.TrainingPlan","model.challenge.Challenge","user","core.lang.html"],angular.module("endo.model").factory("model.feed.Feed",a)}(),function(){function a(a){function b(a){Object.defineProperty(this,"data",{value:a})}var c={WORKOUT:{},FRIENDSHIP:{},STATUS:{},CHALLENGE_JOINED:{},CHALLENGE_CREATED:{},CHALLENGE_FINISHED:{},TEAM_CREATED:{},TEAM_JOINED:{},PREMIUM_SIGNUP:{},PROFILE_PICTURE:{},CONNECT_WITHINGS:{},CONNECT_NIKEPLUS:{},CONNECT_FITBIT:{},CONNECT_MFP:{},TRAININGPLAN_CREATED:{},CONNECT_GARMIN:{},CONNECT_MMF:{}},d=1;b.prototype=Object.create(null,{hasAvatar:{enumerable:!0,get:function(){return void 0===this.data.hasAvatar?!0:this.data.hasAvatar}}});var e=a(b,c);return e.get=function(a){var b=e.super.prototype.get.call(this,a);return void 0===b?this.get(d):b},e}a.$inject=["core.lang.enumeration"],angular.module("endo.model").factory("model.feed.FeedType",a)}(),function(){function a(){var a="PRIVATE_USER",b="WORKOUT_PRIVACY_SYNC",c={PRIVATE_USER:a,WORKOUT_PRIVACY_SYNC:b};return Object.freeze(c),c}angular.module("endo.model").factory("model.job.JobEnum",a)}(),function(){function a(){var a=0,b=1,c=2,d=3,e={NOT_PRESENT:a,ABORTABLE:b,PENDING:c,FINISHED:d};return Object.defineProperty(e,"isMissing",{value:function(a){return a===this.NOT_PRESENT}}),Object.defineProperty(e,"isPending",{value:function(a){return a===this.ABORTABLE||a===this.PENDING}}),Object.defineProperty(e,"isFinished",{value:function(a){return a===this.FINISHED}}),Object.freeze(e),e}angular.module("endo.model").factory("model.job.JobStateEnum",a)}(),function(){function a(){var a=0,b=1,c=2,d=3,e={PUBLIC:a,FRIENDS:b,PRIVATE:c,MEMBERS:d};return Object.freeze(e),e}angular.module("endo.model").factory("model.privacy.PrivacyLevelEnum",a)}(),function(){function a(a,b){var c,d,e=(c={},c[b.DATE_OF_BIRTH]=a.PRIVATE,c[b.WEIGHT]=a.PRIVATE,c[b.HEIGHT]=a.PRIVATE,c[b.HEART_RATE]=a.PRIVATE,c[b.DURATION]=a.PUBLIC,
c[b.TRAINING_PLAN]=a.PUBLIC,c[b.DEFAULT_WORKOUT]=a.PUBLIC,c[b.DEFAULT_MAP]=a.PUBLIC,c[b.DEFAULT_TRANSPORTATION]=a.PUBLIC,c[b.PROFILE]=a.PUBLIC,c),f=(d={},d[b.DATE_OF_BIRTH]=a.PRIVATE,d[b.WEIGHT]=a.PRIVATE,d[b.HEIGHT]=a.PRIVATE,d[b.HEART_RATE]=a.PRIVATE,d[b.DURATION]=a.FRIENDS,d[b.TRAINING_PLAN]=a.FRIENDS,d[b.DEFAULT_WORKOUT]=a.FRIENDS,d[b.DEFAULT_MAP]=a.FRIENDS,d[b.DEFAULT_TRANSPORTATION]=a.PUBLIC,d[b.PROFILE]=a.MEMBERS,d),g=[0,e],h=[1,f],i=[2,{}],j=[3,{}],k={PUBLIC:g,FRIENDS:h,PRIVATE:i,CUSTOM:j},l={};return Object.keys(k).forEach(function(a){var b=k[a][0],c=k[a][1];Object.defineProperty(c,"toString",{value:function(){return a}}),Object.freeze(c),l[a]=c,Object.defineProperty(l,b,{value:c})}),Object.freeze(l),l}a.$inject=["model.privacy.PrivacyLevelEnum","model.privacy.PrivacyRuleEnum"],angular.module("endo.model").factory("model.privacy.PrivacyPresetEnum",a)}(),function(){function a(a){function b(b){if(!angular.isObject(b))return a.CUSTOM;var c=Object.keys(a.PUBLIC).every(function(c){var d=a.PUBLIC[c],e=b[c];return d===e});if(c)return a.PUBLIC;var d=Object.keys(a.FRIENDS).every(function(c){var d=a.FRIENDS[c],e=b[c];return d===e});return d?a.FRIENDS:a.CUSTOM}return{exec:b}}a.$inject=["model.privacy.PrivacyPresetEnum"],angular.module("endo.model").factory("model.privacy.PrivacyPresetMatcher",a)}(),function(){function a(){function a(){return this.id}var b={id:"showDateOfBirth"},c={id:"showWeight"},d={id:"showHeight"},e={id:"showHeartRate"},f={id:"showDuration"},g={id:"showProfile"},h={id:"showTrainingPlan"},i={id:"showDefaultWorkout"},j={id:"showDefaultWorkoutMap"},k={id:"showDefaultTransportation"},l={DATE_OF_BIRTH:b,WEIGHT:c,HEIGHT:d,HEART_RATE:e,DURATION:f,PROFILE:g,TRAINING_PLAN:h,DEFAULT_WORKOUT:i,DEFAULT_MAP:j,DEFAULT_TRANSPORTATION:k};return Object.keys(l).forEach(function(b){var c=angular.extend({},l[b],b);Object.defineProperty(c,"toString",{value:a}),Object.freeze(c),l[b]=c,Object.defineProperty(l,c.id,{value:c})}),Object.freeze(l),l}angular.module("endo.model").factory("model.privacy.PrivacyRuleEnum",a)}(),function(){function a(a){function b(a,b){this.distance=a,this.custom=b}var c={GOAL_CUSTOM:[void 0,!0],GOAL_5KM:[5,!1],GOAL_10KM:[10,!1],GOAL_HALF_MARATHON:[21.0975,!1],GOAL_MARATHON:[42.195,!1]};b.prototype=Object.create(Object.prototype),b.prototype.constructor=b;var d=a(b,c);return d}a.$inject=["core.lang.enumeration"],angular.module("endo.model").factory("model.trainingplan.TrainingGoalEnum",a)}(),function(){function a(a){function b(b){angular.extend(this,b),this.goalType=a.get(b.goalType)}return b}a.$inject=["model.trainingplan.TrainingGoalEnum"],angular.module("endo.model").factory("model.trainingplan.TrainingPlan",a)}(),function(){function a(a,b){var c={ALL:["all"],AGEUNDER18:["under18",0,17],AGE18TO24:["18to24",18,24],AGE25TO34:["25to34",25,34],AGE35TO44:["35to44",35,44],AGE45TO54:["45to54",45,54],AGE55ANDOVER:["55andover",55,120]},d=function f(a,b,c){_classCallCheck(this,f),this.name=a,this.ageRange=[b,c]},e=a(d,c);return e.getForAge=function(a){for(var b=e.ALL,c=0;c<e.length;c++){var d=e[c].ageRange;if(a>=d[0]&&a<=d[1]){b=e[c];break}}return b},e.getForDateOfBirth=function(a){var c=void 0;return b.isDate(a)&&(c=b.years.diff(a,new Date)),e.getForAge(c)},e}a.$inject=["core.lang.enumeration","core.lang.date"],angular.module("endo.model").factory("model.uacf.AgeGroupEnum",a)}(),function(){function a(a){function b(b,d,e){var f=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];d=d||"generic";var g=c[angular.lowercase(b)]||c.fallback,h=g[d];return e=a.get(e),h.replace(":viewer_state:",f?"logged_in":"logged_out").replace(":gender_path:",e===a.UNSPECIFIED?"":e===a.MALE?"mens":"womens").replace(":gender_pick:",e===a.UNSPECIFIED?"top_picks":e===a.MALE?"men_top_picks":"women_top_picks")}var c={fallback:{generic:"https://www.underarmour.com?cid=MMF|REF|Endo|Site|||",store:"https://www.underarmour.com?cid=MMF|REF|Endo|Site||Store|",footer:"https://www.underarmour.com?cid=MMF|REF|Endo|Site||footer|",header:"https://www.underarmour.com?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},us:{generic:"https://www.underarmour.com/en-us/best-sellers/:gender_path:/g/326z?cid=MMF|REF|Endo|Site",store:"https://www.underarmour.com/en-us/best-sellers/:gender_path:/g/326z?cid=MMF|REF|Endo|Site||Store|",footer:"https://www.underarmour.com/en-us/best-sellers/:gender_path:/g/326z?cid=MMF|REF|Endo|Site||footer|",header:"https://www.underarmour.com/en-us/best-sellers/g/326z?cid=MMF|REF|Endo|Site|Nav|:gender_pick:|:viewer_state:"},cn:{generic:"http://www.underarmour.cn/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink",store:"http://www.underarmour.cn/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink&utm_content=store",footer:"http://www.underarmour.cn/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink&utm_content=footerUALogo",header:"http://www.underarmour.cn/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink"},hk:{generic:"http://www.underarmour.hk/en/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink",store:"http://www.underarmour.hk/en/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink&utm_content=store",footer:"http://www.underarmour.hk/en/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink&utm_content=footerUALogo",header:"http://www.underarmour.hk/en/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink"},tw:{generic:"http://www.underarmour.tw/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink",store:"http://www.underarmour.tw/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink&utm_content=store",footer:"http://www.underarmour.tw/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink&utm_content=footerUALogo",header:"http://www.underarmour.tw/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink"},sg:{generic:"http://www.underarmour.com.sg/en-sg/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.com.sg/en-sg/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.com.sg/en-sg/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.com.sg/en-sg/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},my:{generic:"http://www.underarmour.com.my/en-my/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.com.my/en-my/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.com.my/en-my/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.com.my/en-my/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},th:{generic:"http://www.underarmour.co.th/en-th/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.co.th/en-th/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.co.th/en-th/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.co.th/en-th/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},ph:{generic:"http://www.underarmour.com.ph/en-ph/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.com.ph/en-ph/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.com.ph/en-ph/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.com.ph/en-ph/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},gb:{generic:"http://www.underarmour.co.uk/en-gb/best-sellers/?CID=MMF|REF|Endo|Site",store:"http://www.underarmour.co.uk/en-gb/best-sellers/?CID=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.co.uk/en-gb/best-sellers/?CID=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.co.uk/en-gb/best-sellers/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},no:{generic:"http://www.underarmour.com/en-no/ua-best-sellers/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.com/en-no/ua-best-sellers/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.com/en-no/ua-best-sellers/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.com/en-no/ua-best-sellers/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},fr:{generic:"http://www.underarmour.fr/fr-fr/meilleures-ventes/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.fr/fr-fr/meilleures-ventes/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.fr/fr-fr/meilleures-ventes/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.fr/fr-fr/meilleures-ventes/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},ru:{generic:"http://www.underarmour.com/en-ru/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.com/en-ru?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.com/en-ru?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.com/en-ru?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},de:{generic:"http://www.underarmour.de/de-de/bestseller/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.de/de-de/bestseller/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.de/de-de/bestseller/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.de/de-de/bestseller/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},nl:{generic:"http://www.underarmour.nl/nl-nl/bestsellers/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.nl/nl-nl/bestsellers/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.nl/nl-nl/bestsellers/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.nl/nl-nl/bestsellers/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},at:{generic:"http://www.underarmour.eu/en-at/bestseller/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.eu/en-at/bestseller/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.eu/en-at/bestseller/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.eu/en-at/bestseller/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},ie:{generic:"http://www.underarmour.eu/en-ie/best-sellers/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.eu/en-ie/best-sellers/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.eu/en-ie/best-sellers/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.eu/en-ie/best-sellers/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},be:{generic:"http://www.underarmour.eu/en-be/best-sellers/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.eu/en-be/best-sellers/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.eu/en-be/best-sellers/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.eu/en-be/best-sellers/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},pt:{generic:"http://www.underarmour.eu/en-pt/best-sellers/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.eu/en-pt/best-sellers/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.eu/en-pt/best-sellers/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.eu/en-pt/best-sellers/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},it:{generic:"http://www.underarmour.it/it-it/best-seller/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.it/it-it/best-seller/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.it/it-it/best-seller/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.it/it-it/best-seller/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},dk:{generic:"http://www.underarmour.eu/en-dk/best-sellers/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.eu/en-dk/best-sellers/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.eu/en-dk/best-sellers/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.eu/en-dk/best-sellers/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},es:{generic:"http://www.underarmour.es/es-es/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.es/es-es//?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.es/es-es/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.es/es-es/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},pl:{generic:"http://www.underarmour.eu/en-pl/best-sellers/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.eu/en-pl/best-sellers/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.eu/en-pl/best-sellers/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.eu/en-pl/best-sellers/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},se:{generic:"http://www.underarmour.eu/en-se/best-sellers/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.eu/en-se/best-sellers/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.eu/en-se/best-sellers/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.eu/en-se/best-sellers/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},mx:{generic:"http://www.underarmour.com.mx/es-mx/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.com.mx/es-mx/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.com.mx/es-mx/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.com.mx/es-mx/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},br:{generic:"http://www.underarmour.com.br/?cid=MMF|REF|Endo|Site|||",store:"http://www.underarmour.com.br/?cid=MMF|REF|Endo|Site||Store|",footer:"http://www.underarmour.com.br/?cid=MMF|REF|Endo|Site||footer|",header:"http://www.underarmour.com.br/?cid=MMF|REF|Endo|Site|Nav|ua_home|:viewer_state:"},jp:{generic:"http://www.underarmour.co.jp/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink",store:"http://www.underarmour.co.jp/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink&utm_content=store",footer:"http://www.underarmour.co.jp/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink&utm_content=footerUALogo",header:"http://www.underarmour.co.jp/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink"},kr:{generic:"http://www.underarmour.co.kr/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink",store:"http://www.underarmour.co.kr/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink&utm_content=store",footer:"http://www.underarmour.co.kr/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink&utm_content=footerUALogo",header:"http://www.underarmour.co.kr/?utm_source=Endomondo&utm_medium=website&utm_campaign=EndoShopLink"}};return{POSITION_GENERIC:"generic",POSITION_HEADER:"header",POSITION_STORE:"store",POSITION_FOOTER:"footer",get:b}}a.$inject=["model.user.GenderEnum"],angular.module("endo.model").factory("model.uacf.EcomLinks",a)}(),function(){function a(a,b){function c(a,c){var e={};e.loginStatus=c.isGuest()?"logged_out":"logged_in";var j=b.get(c.gender);e.page="bestsellers",e.gender="",j===b.MALE&&(e.page="bestsellersmens",e.gender="mens"),j===b.FEMALE&&(e.page="bestsellerswomens",e.gender="womens"),e.position="",a===f&&(e.position="Nav"),a===g&&(e.position="Footer"),a===h&&(e.position="Store");var k=d+i.format(e);return k}var d="https://www.endomondo.com/uaecom?",e="page=:page&cid=MMF|REF|Endo|Site|:position|:gender|:loginStatus",f="header",g="footer",h="store",i=a.compile(e);return{POSITION_HEADER:f,POSITION_FOOTER:g,POSITION_STORE:h,get:c}}a.$inject=["$urlMatcherFactory","model.user.GenderEnum"],angular.module("endo.model").factory("model.uacf.EcommerceLink",a)}(),function(){function a(a,b){var c={expand:"abs",id:0,firstName:"",lastName:"",name:"Anonymous",gender:b.UNSPECIFIED.valueOf(),isPremium:!1,viewerFriendship:1},d=function(a){function b(d){_classCallCheck(this,b);var e=angular.copy(c);return d&&(e.id=d),_possibleConstructorReturn(this,a.call(this,e))}return _inherits(b,a),b}(a);return d}a.$inject=["model.user.User","model.user.GenderEnum"],angular.module("endo.model").factory("model.user.AnonymousUser",a)}(),function(){function a(a){var b=["MALE","FEMALE","UNSPECIFIED"],c=a(b);return c.get=function(a){angular.isString(a)&&(a=a.toUpperCase());var b=c.super.prototype.get.call(this,a);return b===c.MALE||b===c.FEMALE?b:c.UNSPECIFIED},c}a.$inject=["core.lang.enumeration"],angular.module("endo.model").factory("model.user.GenderEnum",a)}(),function(){function a(a,b,c){var d={FRIENDS:0,NOT_FRIENDS:1,REQUEST_SENT:2},e=["weight","height","lastName","firstName","dateOfBirth","picture.url"],f=function(){function f(b){_classCallCheck(this,f),angular.extend(this,b),this.picture=this.picture||{url:this.avatarUrl},this.favoriteSport=void 0!==this.favoriteSport?a.get(this.favoriteSport):void 0,this.isPremium="boolean"==typeof this.isPremium?this.isPremium:this.isPremium||this.premium,this.name=this.name||this.firstName+" "+this.lastName}return f.prototype.toObject=function(){var a={};for(var b in this)if(this.hasOwnProperty(b)){var c=this[b];"object"===("undefined"==typeof c?"undefined":_typeof(c))&&(c=angular.copy(this[b])),a[b]=c}return a},_createClass(f,[{key:"isFriend",get:function(){return this.viewerFriendship===d.FRIENDS},set:function(a){this.viewerFriendship=a?d.FRIENDS:d.NOT_FRIENDS}},{key:"requestSent",get:function(){return this.viewerFriendship===d.REQUEST_SENT||this.viewerFriendship===d.FRIENDS},set:function(a){this.viewerFriendship=a?d.REQUEST_SENT:this.viewerFriendship}},{key:"isViewer",get:function(){return b.id===this.id}},{key:"profileCompleteness",get:function(){var a=this,b=0;return e.forEach(function(d){c.get(a,d)&&b++}),b/e.length}}]),f}();return f}a.$inject=["api.workout.SportEnum","user","core.lang.object"],angular.module("endo.model").factory("model.user.User",a)}(),function(){function a(a){function b(a){return a.gender===e.MALE?"male":a.gender===e.FEMALE?"female":"unspecified"}function c(a){return angular.isDefined(a.firstName)?a.firstName:angular.isString(a.name)?a.name.split(/\b\s+/)[0]:"( no name )"}function d(b){return a.buildProfileUrl({id:b.id})}var e={MALE:0,FEMALE:1,UNSPECIFIED:2};return{genderToString:b,firstName:c,profileUrl:d,GENDER:e}}a.$inject=["urlBuilder"],angular.module("endo.model").factory("model.user.UserUtils",a)}(),function(){function a(a,b,c,d){function e(c,e){var f={index:e+1,distance:0,duration:0,polyline:[]};return c.forEach(function(a){f.distance+=d.getViewerUnitSystem()===d.METRIC?a.distance:b(a.distance).kilometers.toMiles(),f.duration+=a.duration,f.polyline.push(a.smallEncodedPolyline)}),f.duration=f.duration/1e3,f.distance=a.round(f.distance,5),f}function f(a){return a.speed=a.distance/(a.duration/3600),a.pace=3600/a.speed,a}function g(a,b){var c=a;b&&(a=a.slice(0,-1));var d=a.map(function(a){return a.speed}),e=d.indexOf(Math.min.apply(null,d)),f=d.indexOf(Math.max.apply(null,d));return~e&&(c[e].isSlowest=!0),~f&&(c[f].isFastest=!0),c}function h(b,d){var h,i=0===d,j=b;i||(b=c.split(b,d),j=b.map(e)),j.map(f),h=i?!1:a.round(j[j.length-1].distance,4)!==d,j=g(j,h),h&&(j[j.length-1].isPartial=!0);var k=0,l=0;return j=j.map(function(a){return k+=a.distance,l+=a.duration,a.cumulativeDistance=k,a.cumulativeDuration=l,a})}return{groupLaps:h}}a.$inject=["core.math","core.math.conversion.distance","core.lang.array","common.unit.UNITS"],angular.module("endo.model").factory("model.workout.LapProcessor",a)}(),function(){function a(a,b){function c(a){this.push.apply(this,a),this.forEach(function(a,c){this[c]&&void 0!==this[c].sport&&(this[c].sport=b.get(a.sport))},this)}return c.prototype=Object.create(Array.prototype,{findByDate:{value:function(b){return this.filter(function(c){return a.days.equal(b,c.plannedDate)})}}}),c}a.$inject=["core.lang.date","api.workout.SportEnum"],angular.module("endo.model").factory("model.workout.PlannedWorkoutCollection",a)}(),function(){function a(){function a(a){var b={};return a.forEach(function(a){var c=a.sport.valueOf();b[c]=b[c]||{sport:a.sport,distance:0,duration:0,calories:0},b[c].distance+=a.distance||0,b[c].duration+=a.duration||0,b[c].calories+=a.calories||0}),b}function b(b,c){var d={};c.forEach(function(c,e){var f=b.findByDateRange(c.firstDate,c.lastDate);if(f.length){var g=a(f);for(var h in g){var i=g[h];d[h]=d[h]||{sport:i.sport,intervalTotals:[]},d[h].intervalTotals[e]=i?{distance:i.distance,duration:i.duration,calories:i.calories}:null}}});for(var e in d)for(var f=0;f<c.length;f++)d[e].intervalTotals[f]=d[e].intervalTotals[f]||null;return d}return{totalsBySport:a,intervalTotalsBySport:b}}a.$inject=[],angular.module("endo.model").factory("model.workout.SummaryProccessor",a)}(),function(){function a(a,b,c,d,e,f,g){function h(f){angular.extend(this,f),this.sport=c.get(this.sport),this.heartRateAvg&&(this.heartRateAvg=a.round(this.heartRateAvg)),this.heartRateMax&&(this.heartRateMax=a.round(this.heartRateMax)),this.points=new b(this.points),this.showMap=e.get(this.showMap),this.showWorkout=e.get(this.showWorkout),this.taggedUsers=new d(this.taggedUsers),this.pictures=this.pictures||[],this.pictures.forEach(function(a){a.id=a.id||a.url}),this.pictures=new d(this.pictures),this.trainingplan&&(this.trainingplan=new g(this.trainingplan))}function i(a){if(!this.sharing||!this.sharing.length)return!1;var b=!1;return angular.forEach(this.sharing,function(c){c&&c.type===a&&(b=!0)}),b}h.prototype=Object.create(Object.prototype,{hasPoints:{value:function(){return!!this.points&&!!this.points.length}},hasLaps:{value:function(){var a=0,b=this.laps;return b?([b.imperial,b.metric].forEach(function(b){Array.isArray(b)&&(a+=b.reduce(function(a,b){var c=b?b.distance:0;return a+c},0))}),!!a):!1}},hasManualLaps:{value:function(){var a=0,b=this.laps;return b&&Array.isArray(b.manual)?(b.manual.forEach(function(b){a+=b.distance}),!!a):!1}},hasRecords:{value:function(){if(!Array.isArray(this.records))return!1;if(!this.records.length)return!1;var a=this.records.filter(function(a){return!f.get(a.type).isAggregated});return!!a.length}},getLaps:{value:function(a){return this.laps?angular.isString(a)?this.laps[a.toLowerCase()]:this.laps:void 0}},hasMap:{value:function(){return this.isMapVisible()?this.smallEncodedPolyline?!0:!!(this.hasLaps()&&this.laps.metric[0].beginLatitude&&this.laps.metric[0].beginLongitude&&this.laps.imperial[0].beginLatitude&&this.laps.imperial[0].beginLongitude):!1}},isMapVisible:{value:function(){return this.showMap&&this.showMap.isVisible(this.author)}},clone:{value:function(){return new h(this)}},isSharedToFacebook:{value:function(){return i.call(this,j.FACEBOOK)}},isSharedToTwitter:{value:function(){return i.call(this,j.TWITTER)}}});var j={FACEBOOK:0,TWITTER:1};return h}a.$inject=["core.math","api.workout.PointCollection","api.workout.SportEnum","model.ModelCollection","api.PrivacyEnum","api.workout.RecordEnum","model.trainingplan.TrainingPlan"],angular.module("endo.model").factory("model.workout.Workout",a)}(),function(){function a(a,b,c){function d(){a.apply(this,arguments)}return d.prototype=Object.create(a.prototype,{append:{value:function(c){c=Array.isArray(c)?c:[],c.forEach(function(a,d){void 0!==a.sport&&(c[d].sport=b.get(a.sport))}),a.prototype.append.call(this,c)}},findByDate:{value:function(a){return this.filter(function(b){return c.days.equal(a,b.startTime)})}},findByDateRange:{value:function(a,b){return this.filter(function(d){return c.days.contain(d.startTime,a,b)})}},includedInStats:{value:function(){return new d(this.filter(function(a){return a.includeInStats}))}}}),d.prototype.constructor=d,d}a.$inject=["common.model.Collection","api.workout.SportEnum","core.lang.date"],angular.module("endo.model").factory("model.workout.WorkoutCollection",a)}(),function(){function a(a,b,c){function d(d,f,g,h){var i=(f.findByDate(d),g.findByDate(d)),j=[];h=h||e;var k=a.days.diff(d,new Date)>0;if(!k){var l=i.some(function(a){return void 0===a.workoutId});if(l){var m=b(d).subtract(h,"days").toDate(),n=b(d).add(h,"days").toDate();j=f.findByDateRange(m,n).filter(function(a){var b=[c.RUNNING,c.TREADMILL_RUNNING];return!!~b.indexOf(a.sport)}).filter(function(a){return!g.findByDate(a.startTime).some(function(b){return a.id===b.workoutId})})}}return j}var e=3;return{RANGE:e,suggest:d}}a.$inject=["core.lang.date","common.vendor.moment","api.workout.SportEnum"],angular.module("endo.model").factory("model.workout.WorkoutSuggester",a)}(),function(){function a(a,b,c){function d(c){var d="&nbsp;",e=b.escape(c);return e=e.replace(/[ ]{2,}/g,function(a){return d.repeat(a.length)}),e=e.replace(/^[ ]|[ ]$/gm,d),e=e.replace(/\n/g,"<br>"),e=a(e)}function e(a){var c=g(a);return c=b.toText(c),c=c.trim(),c=f(c)}function f(a){return String(a).replace(/\xa0/g," ")}function g(a){var b=function(a){return new RegExp(c.escape(a),"g")},d=String(a),e="\n";return d=d.replace(/^[ ]*?(<div>)/g,"").replace(/^[ ]*?(<p>)/g,"").replace(b("<p><br></p>"),e).replace(b("<p>&nbsp;</p>"),e).replace(b("<div><br>"),e).replace(b("<br>"),e).replace(b("<div>"),e).replace(b("<p>"),e).replace(b("</div>"),"").replace(b("</p>"),"")}return{toHtml:d,toText:e}}function b(a,b){function c(c,d,e,f){function g(){var a=b.toText(d.html());j.$setViewValue(a)}function h(){k&&k.update(j.$viewValue)}function i(){c.$apply(g),h()}var j=f[0],k=f[1];j&&(j.$render=function(){var a=j.$viewValue;a=a?b.toHtml(a):"",d.html(a),h()},a("browser-ie")?(d.on("keyup",i),d.on("paste",function(a){setTimeout(i)})):d.on("input",i),d.on("change",i))}return{require:["?ngModel","?^eoPlaceholder"],restrict:"A",priority:1,link:c}}function c(a){function b(){var a=this;this.text=function(b){a.placeholder&&a.placeholder.text(b)},this.update=function(b){a.placeholder&&a.placeholder.css({display:b?"none":"block"})},this.create=function(){angular.isElement(a.placeholder)||(a.placeholder=angular.element('<div class="eoPlaceholder"></div>'),a.element.append(a.placeholder))}}function c(b,c,d,e){function f(a){var b=c[0].querySelector("[contenteditable]");b&&b.focus()}e.element=c,e.create(),d.$observe("placeholder",function(a){return e.text(a)}),a("browser-ie")<11&&e.placeholder.on("click",f),b.$on("$destory",function(){e.placeholder.off("click",f)})}return{restrict:"E",require:"eoPlaceholder",controller:b,link:c}}a.$inject=["$sanitize","core.lang.html","core.regexp"],b.$inject=["core.has","ui.behavior.contenteditable"],c.$inject=["core.has"],angular.module("endo.ui.behavior").factory("ui.behavior.contenteditable",a).directive("eoPlaceholder",c).directive("contenteditable",b)}(),function(){angular.module("endo.ui.behavior").directive("eoExpandText",["$document","$window","$timeout",function(a,b,c){var d={topics:{},subscribe:function(a,b){this.topics[a]||(this.topics[a]=[]),this.topics[a].push(b)},publish:function(a,b){!this.topics[a]||this.topics[a].length<1||this.topics[a].forEach(function(a){a(b||{})})}};return{template:['<div class="eoExpandText">','<div class="ng-cloak ng-hide eoExpandText-expanded" ','ng-show="shorten && expanded">','<div class="eoExpandText-tip"></div>','<div class="eoExpandText-tipBorder"></div>','<div class="eoExpandText-close" ng-click="expand($event)">','<i class="icon-close"></i>',"</div>","<span ng-transclude></span>","</div>",'<div ng-transclude ng-click="expand($event)" ',"ng-class=\"{'eoExpandText-click' : shorten}\" ",'class="ng-cloak eoExpandText-paragraph"></div>',"</div>"].join(""),restrict:"EA",scope:{},link:function(e,f,g){e.expanded=!1,e.shorten=!1,d.subscribe("expand",function(){e.expanded=!1}),f.children().eq(0).on("click",function(a){a.stopPropagation()}),e.expand=function(b){if(e.shorten){if(b.stopPropagation(),e.expanded)return void(e.expanded=!1);d.publish("expand"),e.expanded=!0,a.one("click",function(){e.$apply(function(){e.expanded=!1})})}};var h=f.children().eq(0),i=f.children().eq(1),j=function(){c(function(){e.shorten=f.prop("offsetWidth")<=i.prop("offsetWidth")})};j(),e.$watch(function(){return h.text().trim()},function(a){e.fullText=a,j()}),angular.element(b).bind("resize",j),e.$on("$destroy",function(){angular.element(b).unbind("resize",j)})},transclude:!0,replace:!0}}])}(),function(){function a(){return{restrict:"A",link:function(a,b,c){function d(){b.css("height",b[0].contentWindow.document.body.scrollHeight+"px")}b.on("load",d),a.$on("$destroy",function(){b.off("load",d)})}}}angular.module("endo.ui.behavior").directive("eoIframeResize",a)}(),function(){angular.module("endo.ui.behavior").directive("eoParallaxScroll",["$window","core.dom.viewport","core.dom.media","core.dom.geometry",function(a,b,c,d){return{compile:function(e,f){if(c.hasTouchSupport())return angular.noop;var g=e.children().eq(0);return function(c,e,f){var h=function(){var c=b.getSize(),f=e[0].getBoundingClientRect();if(b.contains(e[0])){var h=d.getDocumentHeight()-(f.top+a.pageYOffset),i=c.height+f.height,j=g[0].getBoundingClientRect(),k=j.height-f.height,l=f.top+f.height,m=d.getClipRect(e[0]).top;if(m<c.height){var n=c.height-m;i-=n,h-=n}var o=1-l/i;i>h&&(o*=i/h),g[0].style.marginTop=-k*o+"px"}};h(),angular.element(a).on("scroll resize",h)}}}}])}(),function(){function a(a,b){function c(b,c,d){function e(){var a=j.getBoundingClientRect();a.top<=f&&!h?(c.css({position:"fixed",top:f+"px"}),h=!0):a.top>=f&&h&&(c.css({position:"static",width:"auto"}),h=!1),h&&c.css("width",a.width+"px")}var f=Number(d.eoScrollFixedTop)||0,g=c[0],h=!1,i=c.parent()[0],j=angular.element('<div class="js-top-delimiter"></div>')[0];i.insertBefore(j,g),angular.element(a).on("scroll resize",e),b.$on("$destroy",function(){angular.element(a).off("scroll resize",e)})}return{link:c,restrict:"A"}}a.$inject=["$window","core.dom.viewport"],angular.module("endo.ui.behavior").directive("eoScrollFixedTop",a)}(),function(){function a(){return{restrict:"A",link:function(a,b,c){function d(a){a.stopPropagation()}b.on("click",d),a.$on("$destroy",function(){b.off("click",d)})}}}angular.module("endo.ui.behavior").directive("eoStopClickPropagation",a)}(),function(){function a(){var a={START_DAY:1,ROW_COUNT:6,COL_COUNT:7};return a.CELL_COUNT=a.ROW_COUNT*a.COL_COUNT,Object.freeze(a)}a.$inject=[],angular.module("endo.ui.calendar").factory("ui.calendar.CalendarConfig",a)}(),function(){function a(a,b,c,d,e){function f(){}return f.prototype.empty=function(){return{workouts:new d,plannedWorkouts:new e}},f.prototype.fetch=function(f,g,h){var i=this;return a(function(j,k){i.workoutCanceler&&i.workoutCanceler.resolve(),i.plannedWorkoutCanceler&&i.plannedWorkoutCanceler.resolve(),i.workoutCanceler=a.defer();var l={timeout:i.workoutCanceler.promise},m={after:g,before:h};b.query(f,m,l).then(function(b){i.plannedWorkoutCanceler=a.defer();var g,h={timeout:i.plannedWorkoutCanceler.promise};c.query(f,m,h).then(function(a){g=a}).finally(function(){j({workouts:b||new d,plannedWorkouts:g||new e})})}).catch(function(){k()})})},f}a.$inject=["$q","api.workout.WorkoutResource","api.workout.PlannedWorkoutResource","model.workout.WorkoutCollection","model.workout.PlannedWorkoutCollection"],angular.module("endo.ui.calendar").factory("ui.calendar.CalendarResource",a)}(),function(){function a(a,b,c){function d(b,c){var d=new Date(c,b,1),e=new Date(d),f=a.START_DAY-d.getDay(),g=f>0?a.COL_COUNT-f:-f;return g>0&&e.setDate(-g+1),e}function e(b,c){c=c||a.CELL_COUNT;var d=new Array(c),e=new Date(b),f=0;for(e.setHours(12);c>f;)d[f++]=new Date(e),e.setDate(e.getDate()+1);return d}function f(a,b){var c=new Date(a.valueOf());return c.setMonth(c.getMonth()+b),c}function g(a,e){var f=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],g=new Date(e,a,1),h=new Date(e,a,c.days.lastOfMonth(g)),i=d(a,e),j=b(i),k=[];do k.push({firstDate:j.clone().toDate(),lastDate:j.add(6,"days").clone().toDate()}),j.add(1,"days");while(j.isBefore(h));return f&&(k[0].firstDate=g,k[k.length-1].lastDate=b(h).endOf("day").toDate()),k}return{date:{first:d,all:e,move:f},weeks:{forMonth:g}}}a.$inject=["ui.calendar.CalendarConfig","common.vendor.moment","core.lang.date"],angular.module("endo.ui.calendar").factory("ui.calendar.CalendarUtils",a)}(),function(){function a(a){function b(a,b){this.rootNode=a,this.options=angular.extend({},g,b),this.width=100,this.height=100,this.centerX=this.width/2,this.centerY=this.height/2,this.segmentTotal=0,this.paths=[],this.donutRadius=Math.min(this.width/2,this.height/2)-this.options.edgeOffset,this.cutoutRadius=this.donutRadius*(this.options.percentageInnerCutout/100),this.create()}var c=['<svg class="eoDonut-svg" viewBox="0 0 100 100" preserveAspectRatio="xMinYMin meet" xmlns:xlink="http://www.w3.org/1999/xlink">','<g class="js-donut-arcGroup">','<circle cx="50" cy="50" r="40" fill="white" stroke="white"></circle>',"</g>",'<text class="js-donut-arcText" x="50" y="58" font-size="22" text-anchor="middle"></text>','<text class="js-donut-arcUnit" x="51" y="69" font-size="12" text-anchor="middle"></text>','<g class="js-donut-badgeGroup">','<circle cx="78" cy="76" r="21" fill="white" stroke="white"></circle>','<circle class="js-donut-badgeCircle" cx="78" cy="76" r="19" fill="none" stroke-width="2"></circle>','<text class="js-donut-badgeText" x="78" y="81" font-size="12" text-anchor="middle"></text>',"</g>","</svg>"].join(""),d="http://www.w3.org/2000/svg",e=1,f=2,g={
animation:!1,edgeOffset:10,percentageInnerCutout:90};return b.prototype.create=function(){var a=this.element=angular.element(c),b=this.node=a[0];this.arcGroupNode=b.querySelector(".js-donut-arcGroup"),this.arcTextNode=b.querySelector(".js-donut-arcText"),this.arcUnitNode=b.querySelector(".js-donut-arcUnit"),this.badgeGroupNode=b.querySelector(".js-donut-badgeGroup"),this.badgeCircleNode=b.querySelector(".js-donut-badgeCircle"),this.badgeTextNode=b.querySelector(".js-donut-badgeText"),this.rootNode.appendChild(b)},b.prototype._createPaths=function(b){this.paths=[];for(var c=0;b>c;c++){var e=a[0].createElementNS(d,"path");this.arcGroupNode.appendChild(e),this.paths.push(e)}return this.paths},b.prototype._destroyPaths=function(){this.paths.length&&(this.paths.forEach(function(a){a.parentNode.removeChild(a)}),this.paths=[])},b.prototype._updateLabel=function(a){return a?(this.arcTextNode.textContent=a.text,this.arcTextNode.setAttribute("fill",a.color),void(a.unit?(this.arcUnitNode.textContent=a.unit,this.arcUnitNode.setAttribute("fill",a.color),this.arcTextNode.setAttribute("y",54)):(this.arcUnitNode.textContent="",this.arcTextNode.setAttribute("y",58)))):void(this.arcTextNode.textContent="")},b.prototype._updateBadge=function(a){return a?(this.badgeGroupNode.setAttributeNS(null,"visibility","visible"),this.badgeTextNode.textContent=a.text,void this.badgeCircleNode.setAttribute("stroke",a.color)):(this.badgeGroupNode.setAttributeNS(null,"visibility","hidden"),void(this.badgeTextNode.textContent=""))},b.prototype._reset=function(){this._destroyPaths(),this._updateLabel(),this._updateBadge(),this.requestAnimationId&&(window.cancelAnimationFrame(this.requestAnimationId),this.requestAnimationId=void 0)},b.prototype.update=function(a){this._reset(),null!==a&&(this.data=a.items,this._createPaths(this.data.length),this.total=a.items.reduce(function(a,b){return a+b.value},0),this._updateLabel(a.label),this._updateBadge(a.badge),this.animate())},b.prototype.animate=function(a,b){function c(){d+=g,h._draw(d),d>=0&&1>=d?h.requestAnimationId=window.requestAnimationFrame(c):b&&b.apply(h)}if(!this.paths.length)return void(b&&b.apply(this));a=a||e;var d=this.options.animation?0:1,g=.05;g=a===f?-g:g;var h=this;this.requestAnimationId=window.requestAnimationFrame(c)},b.prototype._draw=function(a){var b=-Math.PI/2,c=this.options.animation?a:1;this.data.forEach(function(a,d){var e=1===this.data.length?.999999:a.value/this.total,f=c*(e*(2*Math.PI)),g=b+f,h=(g-b)%(2*Math.PI)>Math.PI?1:0,i=this.centerX+Math.cos(b)*this.donutRadius,j=this.centerY+Math.sin(b)*this.donutRadius,k=this.centerX+Math.cos(b)*this.cutoutRadius,l=this.centerY+Math.sin(b)*this.cutoutRadius,m=this.centerX+Math.cos(g)*this.donutRadius,n=this.centerY+Math.sin(g)*this.donutRadius,o=this.centerX+Math.cos(g)*this.cutoutRadius,p=this.centerY+Math.sin(g)*this.cutoutRadius,q=["M",i,j,"A",this.donutRadius,this.donutRadius,0,h,1,m,n,"L",o,p,"A",this.cutoutRadius,this.cutoutRadius,0,h,0,k,l,"Z"];this.paths[d].setAttribute("d",q.join(" ")),this.paths[d].setAttribute("fill",a.color),b+=f},this)},b}a.$inject=["$document"],angular.module("endo.ui.calendar").factory("ui.calendar.donut.Donut",a)}(),function(){function a(a,b,c,d,e,f,g){function h(a){return a.some(function(a){return a.isTest})}function i(a){return a.some(function(a){return void 0===a.duration})}function j(a){var b=Math.floor(a/3600),d=Math.floor((a-3600*b)/60);return b+":"+c.zeroPad(d)}function k(b){var d=a.locale.isMetric()?b:f(b).kilometers.toMiles();return d=c.isFloat(d)?e.round(d,Number(10>d)):e.round(d,0)}function l(a){return e.round(a)}function m(a){return a+"×"}function n(b){if(h(b))return w;var c=b.reduce(function(a,b){return a+b.distance},0);return a.locale.isImperial()&&(c=f(c).kilometers.toMiles()),Math.floor(c)+(a.locale.isMetric()?"k":"mi")}function o(a,b){switch(b){case v.DURATION:return j(a);case v.DISTANCE:return k(a);case v.ENERGY:return l(a);case v.COUNT:return m(a);default:return a}}function p(a){switch(a){case v.DISTANCE:return g.append.distance("");case v.ENERGY:return g.append.energy("");default:return""}}function q(a){var b=a.workouts,c=a.plannedWorkouts,d=c.filter(function(a){return!a.workoutId});if(!b.length)return(a.isViewerOwner||a.isToday)&&d.length?{items:[{value:1,color:"#eee"}],label:{text:o(0,a.property),unit:p(a.property),color:"#ddd"},badge:{text:n(d),color:a.isToday?"#ddd":u}}:null;var e={label:{color:"black"}},f=b.reduce(function(b,c){var d=c[a.property]||0;return b+d},0);return i(a.workouts)&&a.property==v.DURATION?e.label.text=o(a.workouts.length,v.COUNT):(e.label.text=o(f,a.property),e.label.unit=p(a.property)),e.items=b.map(function(b){var c={color:b.sport.color},d=b[a.property];return d>0?(c.value=d,c):0===f?(c.value=1,c):(c.value=a.property==v.DURATION?900:.1*f,c)}),d.length&&(a.isViewerOwner||a.isToday)&&(e.badge={text:n(d),color:a.isToday?"#ddd":u}),e}function r(a){if(!a.plannedWorkouts||!a.plannedWorkouts.length)return{items:[]};var b={items:[{value:1,color:"#eee"}],label:{color:"#aaa"}};if(h(a.plannedWorkouts))return b.label.text=w,b;var c=a.plannedWorkouts.reduce(function(a,b){return a+b.distance},0);return b.label.text=k(c),b.label.unit=p(v.DISTANCE),b}function s(a){if(!a)return a;var b=a.items;if(b.length<=1)return a;var c=[],d=b.reduce(function(a,b){return a+b.value},0),e={color:"white",value:.01*d};return b.forEach(function(a){c.push(a),c.push(e)}),a.items=c,a}function t(a){if(!a.workouts.length&&!a.plannedWorkouts.length)return null;var b=d.days.diff(a.date,new Date);a.property=a.property||v.DURATION,a.isToday=0===b;var c=b>0?r(a):q(a);return s(c)}var u="#D799AE",v={DURATION:"duration",DISTANCE:"distance",ENERGY:"calories",COUNT:"count"},w="TEST";return{map:t}}a.$inject=["viewer","core.lang.array","core.lang.number","core.lang.date","core.math","core.math.conversion.distance","common.unit.UNITS"],angular.module("endo.ui.calendar").factory("ui.calendar.donut.DonutMapper",a)}(),function(){function a(a,d,e){return{restrict:"E",require:["eoDonut","?eoListPopover","?^eoCalendar"],template:c,scope:{model:"="},controller:function(){},link:function(c,f,g,h){function i(a){m&&(b=null,m.select(a))}function j(a){a&&a.length&&i(a[0])}var k=h[0],l=h[1],m=h[2],n=f[0].querySelector(".js-donut"),o=new d(n);c.$watchGroup(["model.workouts","model.plannedWorkouts"],function(){var b=c.model,d=e.map({date:b.date,property:b.mode,workouts:b.workouts,plannedWorkouts:b.plannedWorkouts,isViewerOwner:a.id==b.ownerId});o.update(d),c.isActionable=!!d}),c.click=function(a){return l&&c.isActionable?a.shiftKey?void j(c.model.workouts):void(l.isOpened&&b===f||(l.open(f,c.model),b=f,a.stopPropagation())):void 0},k.select=i}}}var b,c=['<div class="eoDonut" ng-click="click($event)" ng-class="{\'eoDonut-actionable\': isActionable, \'eoDonut-hidden\': !isActionable }">','<div class="eoDonut-inner js-donut"></div>',"</div>"].join("");a.$inject=["user","ui.calendar.donut.Donut","ui.calendar.donut.DonutMapper"],angular.module("endo.ui.calendar").directive("eoDonut",a)}(),function(){function a(a,b,c,d,e,f,g,h,i){function j(a,j,k){function l(a){var b=a.month;if(d.isDate(b))return""+b.getFullYear()+b.getMonth()}function m(){a.prevInProgress=!1,a.nextInProgress=!1,y=!1}function n(){p(),q().then(o).finally(m)}function o(){C=!1;var b=s(),d=b.map(r);a.rows=c.split(d,e.COL_COUNT)}function p(){C=!0;var b=B.empty();v=b.workouts,w=b.plannedWorkouts;var d=s(),f=d.map(r);a.rows=c.split(f,e.COL_COUNT)}function q(){y?a[0>x?"prevInProgress":"nextInProgress"]=!0:(a.prevInProgress=!0,a.nextInProgress=!0);var b={after:h(t).subtract(i.RANGE,"days").toDate(),before:h(u).add(i.RANGE,"days").toDate()};return B.fetch(a.userId,b.after,b.before).then(function(a){v=a.workouts,w=a.plannedWorkouts})}function r(b){var c=v.findByDate(b),d=w.findByDate(b),e=c.reduce(function(a,b){var c=b.pbCount||0;return a+c},0);return{date:b,dayString:b.toDateString(),selectedWorkoutId:a.workoutId,isDateOverflow:b.getMonth()!==a.month.getMonth(),label:b.getDate(),ownerId:a.userId,workouts:c,plannedWorkouts:d,suggestedWorkouts:i.suggest(b,v,w),hasPb:e>0,mode:a.mode}}function s(){var b,c=a.month.getMonth(),d=a.month.getFullYear(),e=f.date.first(c,d);return z=new Date(d,c,1),A=new Date(d,c+1,0),b=f.date.all(e),t=h(b[0]).startOf("day").toDate(),u=h(b[b.length-1]).endOf("day").toDate(),b}var t,u,v,w,x,y,z,A,B=new g,C=!1;b.subscribe("calendar/refresh",n);var D=a.MODE_COUNT="count";void 0===a.mode&&(a.mode=D),p(),a.$watchGroup([l,"userId"],function(a){n()}),a.$watch("mode",function(b){void 0===b&&(a.mode=D),a.mode!==D&&o()}),a.today=(new Date).toDateString(),a.move=function(b){x=b,y=!0,a.month=f.date.move(a.month,b)}}return{restrict:"E",transclude:!0,templateUrl:"tpl://ui/calendar/eoCalendar.en.html",scope:{month:"=",mode:"=",userId:"=",workoutId:"=",onSelect:"&"},controller:["$scope",function(a){var b=this;b.select=function(b){a.onSelect({$workout:b})}}],link:j}}a.$inject=["$timeout","core.event.topic","core.lang.array","core.lang.date","ui.calendar.CalendarConfig","ui.calendar.CalendarUtils","ui.calendar.CalendarResource","common.vendor.moment","model.workout.WorkoutSuggester"],angular.module("endo.ui.calendar").directive("eoCalendar",a)}(),function(){function a(a,b){function c(c,f,g,h){function i(){c.controls.limit=(c.model.plannedWorkouts||[]).length>0?d-1:d,c.model.workouts.length>c.controls.limit&&(c.controls.limit-=1),c.controls.expanded&&(c.controls.limit=c.model.workouts.length),c.controls.more=c.model.workouts.length-c.controls.limit,c.controls.more=c.controls.more<0?0:c.controls.more}var j=h[0],k=h[1],l=h[2];c.controls={expanded:!1,more:c.model.workouts&&c.model.workouts.length>d?c.model.workouts.length-d:0,limit:d,selected:e},c.$watch("model.workouts",function(a){a&&a.length||(c.controls.more=0,c.controls.expanded=!1),e.id=c.model.selectedWorkoutId,i()}),c.$watch("model.plannedWorkouts",function(d){if(d&&d.length){c.missedPlanned=!1;var e=new Date;d.forEach(function(a){b.days.diff(a.plannedDate,e)<0&&(c.missedPlanned=!0)}),c.showPlanned=b.days.diff(c.model.date,e)>=0||a.id==c.model.ownerId}}),c.expand=function(){c.controls.expanded=!0,i()},c.select=function(a,b){e.id=b.id,c.closeWorkoutPopover(),l.select&&l.select(b)},c.openWorkoutPopover=function(a,b){if(j){var c={date:b.localStartTime||b.startTime,workout:b};k&&k.close(!1),j.open(angular.element(a.target),c)}},c.closeWorkoutPopover=function(){j&&j.close()},c.openPlannedPopover=function(b,d){k&&k.open(angular.element(b.target),{plannedWorkout:d,suggestedWorkouts:c.model.suggestedWorkouts,allowEditing:String(a.id)===c.model.ownerId,ownerId:c.model.ownerId})},c.closePlannedPopover=function(){k&&k.close(!0)},c.togglePlannedPopover=function(a,b){k.isVisible()?k.close(!1):c.openPlannedPopover(a,b)}}var d=6,e={id:null},f=['<ul class="eoSportIconList list-unstyled">','<li class="eoSportIconList-item" ng-repeat="workout in model.workouts | orderBy:\'startTime\' | limitTo : controls.limit  track by workout.id" ','ng-mouseenter="openWorkoutPopover($event, workout)" ng-mouseleave="closeWorkoutPopover()" ','ng-click="select($event, workout)" ng-class="{ selected: controls.selected.id === workout.id}">','<eo-sport-icon class="eoSportIconList-icon" sport="workout.sport" size="20">',"</li>",'<li class="eoSportIconList-item" ng-if="showPlanned" ng-repeat="workout in model.plannedWorkouts track by workout.id" ','ng-mouseenter="openPlannedPopover($event, workout)" ng-mouseleave="closePlannedPopover()" ','ng-click="togglePlannedPopover($event, workout)" ng-hide="workout.workoutId">','<eo-sport-icon class="planned" size="18" sport="workout.sport" ng-class="{ \'planned--missed\': missedPlanned }">',"</li>",'<li class="eoSportIconList-item--more" ','ng-if="!controls.expanded && controls.more > 0" ng-click="expand()" eo-stop-click-propagation>',"<span>+{{controls.more}}</span>","</li>","</ul>"].join("");return{require:["?eoWorkoutItemPopover","?eoPlannedWorkoutPopover","^eoCalendar"],scope:{model:"="},template:f,link:c}}a.$inject=["user","core.lang.date"],angular.module("endo.ui.calendar").directive("eoSportIconList",a)}(),function(){function a(a,b,c,d){function e(e,f,g,h){e.suggest=function(){a.open(e.ownerId,e.plannedWorkout,e.suggestedWorkouts)},e.$watchGroup(["plannedWorkout","ownerId"],function(a){if(a[0]){var f=a[0];if(e.isToday=d().startOf("day").isSame(f.plannedDate,"day"),a[1]){var g=a[1];e.allowEditing=String(c.id)===String(g),e.exportUrl=b.getExportUrl(g,f.id)}}})}return{templateUrl:"tpl://ui/calendar/item/eoPlannedWorkoutItem.en.html",scope:{plannedWorkout:"=",suggestedWorkouts:"=",ownerId:"="},link:e}}a.$inject=["ui.workout.suggester.SuggesterDialog","api.workout.PlannedWorkoutResource","user","common.vendor.moment"],angular.module("endo.ui.calendar").directive("eoPlannedWorkoutItem",a)}(),function(){function a(a){function b(b,c,d){b.translateTitle=function(){return a.getTitle(b.sportTitle)}}var c=['<div class="eoWorkoutItem">','<div class="eoWorkoutItem-inner">','<div class="eoWorkoutItem-leading">','<div class="eoWorkoutItem-icon" ng-if="sportIcon">','<eo-sport-icon sport="sportIcon" size="2.4rem"></eo-sport-icon>',"</div>",'<div class="eoWorkoutItem-title" ng-if="sportTitle">',"{{ translateTitle() }}","</div>",'<div class="eoWorkoutItem-date" ng-if="date">','{{ date | date:"MMM d" }}',"</div>",'<div class="eoWorkoutItem-time" ng-if="time">','{{ time | date:"HH:mm" }}',"</div>","</div>",'<div class="eoWorkoutItem-trailing">','<div class="eoWorkoutItem-duration" ng-if="duration || duration === 0">','<span class="icon-duration eoWorkoutItem-label"></span>',"{{ duration | duration }}","</div>",'<div class="eoWorkoutItem-distance" ng-if="distance || distance === 0">','<span class="icon-distance eoWorkoutItem-label"></span>',"{{ distance | distance:2 }}","</div>",'<div class="eoWorkoutItem-calories" ng-if="calories || calories === 0">','<span class="icon-calories eoWorkoutItem-label"></span>',"{{ calories | energy }}","</div>","</div>","</div>","</div>"].join("");return{template:c,scope:{sportIcon:"=",sportTitle:"=",date:"=",time:"=",distance:"=",duration:"=",calories:"="},link:b}}a.$inject=["common.data.SportTranslate"],angular.module("endo.ui.calendar").directive("eoWorkoutItem",a)}(),function(){function a(a,b,e,f){var g=this;g.open=function(a,h){angular.extend(d,h),d.allowEditing=f.id==h.ownerId,d.plannedWorkouts=h.plannedWorkouts.filter(function(a){return!a.workoutId}),g.isOpened=!0,b(function(){c.show(a)}),e.one("click",function(){g.hide()})},g.hide=function(){g.isOpened=!1,c.hide()}}function b(b,f,g,h,i){function j(a,i,j,k){var l=k[0],m=k[1];c||(d=b.$new(!0),d.select=function(a){m&&(l.hide(),m.select(a))},d.hasViewRights=function(a,b){if(!(a&&b instanceof Date))return!1;var c=g.days.diff(b,new Date);return c>0||f.id==a},c=new h(e,{scope:d,offsetTop:-12}))}return{restrict:"A",require:["eoListPopover","?eoDonut"],controller:a,link:j}}var c,d,e=['<div class="eoListPopover" eo-stop-click-propagation>',"<h3 class=\"popover-title\">{{ date | date:'EEEE - MMM dd' }}</h3>",'<div class="popover-content">','<ul class="list-unstyled eoListPopover-workouts">','<li class="eoListPopover-workout" ng-repeat="workout in workouts | orderBy:\'startTime\'" ng-click="select(workout)">','<div ng-switch="mode">','<div ng-switch-when="distance">','<eo-workout-item sport-icon="workout.sport" sport-title="workout.sport" distance="workout.distance"></eo-workout-item>',"</div>",'<div ng-switch-when="duration">','<eo-workout-item sport-icon="workout.sport" sport-title="workout.sport" duration="workout.duration"></eo-workout-item>',"</div>",'<div ng-switch-when="calories">','<eo-workout-item sport-icon="workout.sport" sport-title="workout.sport" calories="workout.calories"></eo-workout-item>',"</div>","</div>","</li>","</ul>",'<div class="eoListPopover-planWrapper" ng-if="hasViewRights(ownerId, date) && plannedWorkouts.length">','<ul class="list-unstyled eoListPopover-plannedWorkouts">','<li ng-repeat="plannedWorkout in plannedWorkouts">','<eo-planned-workout-item planned-workout="plannedWorkout" suggested-workouts="suggestedWorkouts" owner-id="ownerId"></eo-planned-workout-item>',"</li>","</ul>","</div>","</div>","</div>"].join("");a.$inject=["$scope","$timeout","$document","user"],b.$inject=["$rootScope","user","core.lang.date","ui.Popover"],angular.module("endo.ui.calendar").directive("eoListPopover",b)}(),function(){function a(a,b){function g(){f&&(b.cancel(f),f=null)}var i=this;i.open=function(a,i){g(),f=b(function(){d.model=i,c.show(a),e=!0},h)},i.close=function(a){g(),e&&(a?f=b(function(){c.hide(),e=!1},h):(c.hide(),e=!1))},i.isVisible=function(){return e}}function b(b,e,h,i){function j(a,i,j,k){c||(d=b.$new(!0),c=new h(g,{scope:d})),d.mouseenter=function(){f&&(e.cancel(f),f=null)},d.mouseleave=function(){k.close(!0)},d.close=function(){k.close(!1)}}return{require:"eoPlannedWorkoutPopover",restrict:"A",controller:a,link:j}}var c,d,e,f,g=['<div class="eoWorkoutItemPopover" ng-mouseenter="mouseenter()" ng-mouseleave="mouseleave()" ng-click="close()">','<h3 class="popover-title">{{ model.plannedWorkout.title }} </h3>','<div class="popover-content">','<div class="eoWorkoutItemPopover-plannedWorkouts" >','<eo-planned-workout-item planned-workout="model.plannedWorkout" suggested-workouts="model.suggestedWorkouts" owner-id="model.ownerId"></eo-planned-workout-item>',"</div>","</div>","</div>"].join(""),h=300;a.$inject=["$scope","$timeout"],b.$inject=["$rootScope","$timeout","ui.Popover","common.i18n.Translation"],angular.module("endo.ui.calendar").directive("eoPlannedWorkoutPopover",b)}(),function(){function a(a,b,g){function i(){f&&(b.cancel(f),f=null)}var j=this;j.open=function(a,j){i(),f=b(function(){d.model=j,d.model.workoutTitle=j.workout.title||g.getTitle(j.workout.sport),d.model.hasDistance=angular.isDefined(j.workout.distance),d.model.hasDuration=angular.isDefined(j.workout.duration),c.show(a),e=!0},h)},j.close=function(){i(),c.hide(),e=!1}}function b(b,e,f,h){function i(a,e,h){c||(d=b.$new(!0),c=new f(g,{scope:d}))}return{restrict:"A",controller:a,link:i}}var c,d,e,f,g=['<div class="eoWorkoutItemPopover" >',"<h3 class=\"popover-title\">{{ model.workoutTitle }} - {{ model.date | date: 'h:mm a' }} </h3>",'<div class="popover-content eoWorkoutItemPopover-item">','<div class="eoWorkoutItemPopover-item-stat" ng-if="model.hasDistance"> <span class="icon-distance eoWorkoutItemPopover-item-icon"></span>{{ model.workout.distance | distance : 2 }}</div>','<div class="eoWorkoutItemPopover-item-stat" ng-if="model.hasDuration"> <span class="icon-duration eoWorkoutItemPopover-item-icon"></span> {{ model.workout.duration | duration }}</div>',"</div>","</div>"].join(""),h=300;a.$inject=["$scope","$timeout","common.data.SportTranslate"],b.$inject=["$rootScope","$timeout","ui.Popover"],angular.module("endo.ui.calendar").directive("eoWorkoutItemPopover",b)}(),function(){function a(a,b,c,d,e){function f(a,f,g){function h(){a.onDismiss&&a.onDismiss(),e.getPending()}a.goalText=b.goal(a.challenge),a.joinChallenge=function(){return a.joinPromise=c.joinChallenge(a.challenge).then(h)},a.dismiss=function(){return c.rejectChallenge(a.challenge).then(h)},a.challenge.sports&&(a.sportTitles=a.challenge.sports.map(function(a){return d.getTitle(a)}).join(", "))}var g="tpl://ui/challenge/eoChallengeFeaturedBox.en.html";return{restrict:"E",templateUrl:g,scope:{challenge:"=model",onDismiss:"&"},link:f}}angular.module("endo.ui.challenge").directive("eoChallengeFeaturedBox",a),a.$inject=["$timeout","model.challenge.ChallengeTranslate","api.challenge.ChallengeResource","common.data.SportTranslate","api.notifications.notificationService"]}(),function(){function a(a,b,c,d,e,f,g){function h(h,k,l){function m(){switch(h.challenge.type){case d.MOST_KM:case d.TEST12MIN:case d.LONGEST_ONE_HOUR:case d.AVG_DISTANCE:case d.FASTEST_X_KM:return e;case d.MOST_ACTIVE_MINUTES:case d.FASTEST_DISTANCE:case d.AVG_DURATION:return g;case d.AVG_CALORIES:case d.MOST_CALORIES:return f;case d.MOST_WORKOUTS:return function(a){return a+" "+n("workouts")}}}h.viewer=a;var n=b.require(i);c.rankings(h.challenge.id,a.id).then(function(a){var b=m();a.forEach(function(a){a.percent=a.value/a.maxValue*100,a.percent=Math.max(a.percent,j),a.percent=Math.min(a.percent,100),a.displayValue=b(a.value)}),h.ranking=a})}var i="tpl://ui/challenge/eoChallengeRanking.en.html",j=5;return{restrict:"E",templateUrl:i,scope:{challenge:"=model"},link:h}}angular.module("endo.ui.challenge").directive("eoChallengeRanking",a),a.$inject=["user","common.i18n.Translation","api.challenge.ChallengeResource","model.challenge.ChallengeType","distanceFilter","energyFilter","durationFilter"]}(),function(){var a={chart:{BACKGROUND_COLOR:"#f8f8f8"},axis:{COLOR:"#b1b1b1",LABEL_COLOR:"#b3b3b3",FONT_SIZE:"10px",disableLabels:{labels:{enabled:!1},lineWidth:0,tickWidth:0,title:{text:null}}},tooltip:{BACKGROUND_COLOR:"rgba(255, 255, 255, 0.95)",BORDER_COLOR:"#e6e6e6",SHAPE:"square",SHADOW:!1},dataLabel:{COLOR:"#666666"},"char":{HARE:"",TURTLE:"",LTE:"≤"},color:{LAP:"rgba(51, 182, 121, 1)",LAP_PARTIAL:"rgba(51, 182, 121, 0.5)",LAP_SLOWEST:"#94d8e8",LAP_FASTEST:"#bc5679"}};Object.freeze(a),angular.module("endo.ui.chart").constant("ui.chart.common.ChartConfig",a)}(),function(){function a(a){var b={chart:{backgroundColor:a.chart.BACKGROUND_COLOR,spacingTop:12,spacingBottom:12,spacingLeft:12,spacingRight:12,height:300},title:{text:null},credits:{text:null},legend:{enabled:!1},xAxis:{title:{text:null},lineColor:a.axis.COLOR,gridLineWidth:0},yAxis:{title:{text:null},lineColor:a.axis.COLOR,gridLineWidth:0},tooltip:{shape:"square",backgroundColor:a.tooltip.BACKGROUND_COLOR,borderWidth:1,borderColor:a.tooltip.BORDER_COLOR,shadow:!1,useHTML:!0}};return Object.freeze(b),b}a.$inject=["ui.chart.common.ChartConfig"],angular.module("endo.ui.chart").factory("ui.chart.common.ResetOptions",a)}(),function(){function a(a,b,c,d){function e(d,e,h){var i=h||f,j=[];return e.forEach(function(e){var f;Array.isArray(e)&&(f=e[1],e=e[0]);var h=d[e];switch(e){case"intensity":h=g("intensity."+h),f=f||g("tooltip.intensity"),j.push(f+i+h);break;case"distance":h=a.round(h,2),f=f||b.label.distance,j.push(f+i+b.append.distance(h));break;case"lapDistance":h=a.round(h,2),f=f||b.label.distance,j.push(f+i+b.append.distance(h));break;case"speed":h=a.round(h,2),f=f||b.label.speed,j.push(f+i+b.append.speed(h));break;case"pace":h=c(h,!1),f=f||b.label.pace,j.push(f+i+b.append.pace(h));break;case"lapDuration":f=f||b.label.duration,j.push(f+i+c(h));break;case"duration":f=f||b.label.duration,j.push(f+i+c(h));break;case"lap":f=f||b.label.lap,j.push(f+i+h);break;case"altitude":f=f||b.label.altitude,j.push(f+i+b.append.altitude(h));break;case"cadence":f=f||b.label.cadence,j.push(f+i+b.append.cadence(h));break;case"heartRate":f=f||b.label.heartRate,j.push(f+i+b.append.heartRate(h));break;case"power":f="Power",j.push(f+i+h+" W");break;case i:j.push("");break;default:j.push(e)}}),j.join("<br>")}var f=": ",g=d.require("ui.chart");return{SEPARATOR:f,format:e}}a.$inject=["core.math","common.unit.UNITS","durationFilter","common.i18n.Translation"],angular.module("endo.ui.chart").factory("ui.chart.common.TooltipFormatter",a)}(),function(){function a(a){function b(a){this.node=a}var c=["#0f9d58","#6f85bf","#bc5679"];return b.prototype.update=function(b){this.destroy();var d=a.create();d.chart.renderTo=this.node,d.series=[],b.forEach(function(a,b){if(Array.isArray(a)){var e={type:"column",data:a,color:c[b]};d.series.push(e)}}),this.chart=new Highcharts.Chart(d)},b.prototype.destroy=function(){this.chart&&(this.chart.destroy(),this.chart=null)},b}a.$inject=["ui.chart.compare.CompareChartOptions"],angular.module("endo.ui.chart").factory("ui.chart.compare.CompareChart",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j){function k(){var b,c=this.value,d=this.chart.series[0].points;return d&&(b=d[d.length-1]),c=!this.isLast||b&&b.isManual?a.round(c):f.char.LTE+a.round(c+.5,0)}function l(){return this.point.pointWidth>9?h(this.point.split,!1):""}function m(){var a,b=[];this.points.forEach(function(c){c=c.point,a||(a=c.lap);var d=['<div class="eoCompareChart-tooltip-row">',"<div>",'<span class="icon-duration eoCompareChart-color'+c.compareIndex+'"></span>'," ",h(c.split),"</div>","<div>",'<span class="icon-speed-avg eoCompareChart-color'+c.compareIndex+'"></span>'," ",c.sport.pace?j(c.speed):i(c.speed),"</div>","</div>"].join("");b.push(d)});var c='<div class="eoCompareChart-tooltip-header">';return c+=g.format({lap:a},[["lap"]]," "),c+="</div>",c+=b.join("")}function n(){return angular.copy(b.merge(e,q))}var o=36,p="#666666",q={chart:{height:null,spacingLeft:24,spacingRight:24,spacingTop:24},xAxis:{type:"category",labels:{formatter:k,style:{color:p}},tickLength:0,lineColor:"#e6e6e6"},yAxis:{labels:{enabled:!1}},plotOptions:{series:{point:{events:{}}},column:{animation:!1,color:f.color.LAP,borderWidth:0,maxPointWidth:o,dataLabels:{enabled:!0,rotation:270,align:"left",style:{fontSize:9,color:p},x:-1,y:-6,formatter:l},stickyTracking:!0,pointPadding:0,groupPadding:.1}},series:[],tooltip:{shared:!0,animation:!1,style:{padding:0},formatter:m,positioner:function(a,b,c){var d=this.chart,e=d.plotBox,f=d.plotLeft+c.plotX,g=10;return f+a>e.x+e.width&&(f+=e.x+e.width-(f+a)),{x:f,y:g}}}};return{create:n}}a.$inject=["core.math","core.lang.object","common.unit.UNITS","core.math.conversion.distance","ui.chart.common.ResetOptions","ui.chart.common.ChartConfig","ui.chart.common.TooltipFormatter","durationFilter","speedFilter","paceFilter"],angular.module("endo.ui.chart").factory("ui.chart.compare.CompareChartOptions",a)}(),function(){function a(a,b,c,d){function e(e,f,g){function h(a,b,c){var d={lap:a.index,name:a.cumulativeDistance,y:a.pace,split:a.duration,speed:a.speed,sport:a.sport,compareIndex:a.compareIndex};return d}function i(c){if(c=c||e.workouts,Array.isArray(c)){var d=[];c.forEach(function(c,f){var g=c.getLaps(a.locale.units()),i=g&&g.length?b.groupLaps(g,e.groupBy).map(function(a){return a.sport=c.sport,a.compareIndex=f,a}).map(h):void 0;d.push(i)}),m.update(d)}}function j(b){b=b||e.workouts;var c=e.workouts.map(function(b){var c=b.getLaps(a.locale.units());return Array.isArray(c)?c.length:0}),d=Math.max.apply(null,c);e.groups=[],k(1),d>2&&k(2),d>5&&k(5),d>10&&k(10),e.groupBy=1,d>=52&&(e.groupBy=2),d>=100&&(e.groupBy=5),d>=150&&(e.groupBy=10)}function k(a){e.groups=e.groups||[],e.groups.push({distance:a,label:d.append.distance(a)})}var l=f[0].querySelector(".js-chart"),m=new c(l);e.$watchCollection("workouts",function(){j(),i()}),e.$watch("groupBy",function(a){void 0!==a&&i()}),e.$on("$destroy",function(){m.destroy()})}var f=['<div class="eoCompareChart">','<div class="row eoCompareChart-grouping">','<div class="col-sm-2 col-sm-offset-10">','<select class="form-control" ng-model="groupBy" ng-options="group.distance as group.label for group in groups"></select>',"</div>","</div>",'<div class="eoCompareChart-inner js-chart"></div>',"</div>"].join("");return{restrict:"E",template:f,scope:{workouts:"=model"},link:e}}a.$inject=["viewer","model.workout.LapProcessor","ui.chart.compare.CompareChart","common.unit.UNITS"],angular.module("endo.ui.chart").directive("eoCompareChart",a)}(),function(){function a(a,b,c,d,e,f,g,h,i){function j(){var b=a.locale.isImperial()?"toMinutesPerMile":"toMinutesPerKilometer",c=f(this.value).kilometersPerHour[b]();return isFinite(c)?e(60*c,!1):""}function k(){return this.value}function l(a){return function(){var b=this.point,c=b.interval,d=b.track;if(q.sport=a,q.duration=this.x,q.interval=c,c&&c.intensity){var e=q.interval.intensity;q.interval.intensityLabel=n("intensity."+e)}q.track=d,c&&(q.intervalPace=f(c.pace/60).minutesPerKilometer.toKilometersPerHour());var g=p(q);return q.$digest(),g[0].outerHTML}}function m(b){var c=angular.copy(r);return c.yAxis.labels.formatter=b.pace?j:k,c.yAxis.title.text=b.pace?i.append.pace("",a.locale.units()):i.append.speed("",a.locale.units()),c.tooltip.formatter=l(b),c}var n=g.require("ui.chart"),o=["<div>",'<div class="eoIntervalChart-tooltip-plannedContainer" ng-show="interval">',"<div>","<strong>${tooltip.interval}</strong>","</div>",'<div ng-show="interval.distanceBased">',"${tooltip.distance}: <strong>{{ ::interval.distance | distance:2 }}</strong>","</div>",'<div ng-hide="interval.distanceBased">',"${tooltip.duration}: <strong>{{ ::interval.duration | duration }}</strong>","</div>","${tooltip.intensity}: <strong>{{ ::interval.intensityLabel }}</strong>",'<div ng-show="intervalPace">','<span ng-show="sport.pace">',"${tooltip.pace}: <strong>{{ ::intervalPace | pace }}</strong>","</span>",'<span ng-hide="sport.pace">',"${tooltip.speed}: <strong>{{ ::intervalPace | speed:1 }}</strong>","</span>","</div>","</div>",'<div class="eoIntervalChart-tooltip-trackedContainer">',"<div>","${tooltip.time}: <strong>{{ ::duration | duration }}</strong>","</div>",'<div ng-show="track.speed || track.speed === 0">','<span ng-show="sport.pace">',"${tooltip.pace}: <strong>{{ ::track.speed | pace }}</strong>","</span>",'<span ng-hide="sport.pace">',"${tooltip.speed}: <strong>{{ ::track.speed | speed:1 }}</strong>","</span>","</div>","</div>","</div>"].join(""),p=b(d(o,n.raw())),q=c.$new(!0),r={chart:{animation:!1,backgroundColor:"#f7f7f7",spacingTop:30,spacingLeft:12},title:{text:null},credits:{text:null},legend:{enabled:!1},xAxis:{title:{text:null},labels:{formatter:function(){return e(this.value,!1)},style:{fontSize:"10px"}},startOnTick:!1,lineWidth:1,lineColor:"#d1d1d1",tickInterval:300},yAxis:{type:"linear",allowDecimals:!1,startOnTick:!1,lineWidth:1,lineColor:"#d1d1d1",tickWidth:1,tickLength:4,tickColor:"#d1d1d1",gridLineWidth:0,title:{text:null,style:{fontSize:h.axis.FONT_SIZE}},labels:{style:{fontSize:h.axis.FONT_SIZE},x:-6,y:4},showFirstLabel:!1,tickPixelInterval:50},series:[],plotOptions:{series:{marker:{enabled:!1},states:{hover:{enabled:!1}}},area:{animation:!1,fillOpacity:1,lineWidth:0,trackByArea:!0,enableMouseTracking:!1},line:{animation:!1,turboThreshold:0},spline:{animation:!1,turboThreshold:0}},tooltip:{shared:!1,shape:"square",backgroundColor:"none",borderWidth:0,shadow:!1,crosshairs:[{dashStyle:"ShortDash",zIndex:3},!1],useHTML:!0,style:{padding:"0"},positioner:function(a,b,c){var d=this.chart.plotWidth,e=c.plotX+a/2,f=20;return c.plotX+a>d&&(e=c.plotX-a/2-18),{x:e,y:f}}}};return m}a.$inject=["viewer","$compile","$rootScope","substituteFilter","durationFilter","core.math.conversion.speed","common.i18n.Translation","ui.chart.common.ChartConfig","common.unit.UNITS"],angular.module("endo.ui.chart").factory("ui.chart.interval.IntervalChartOptions",a)}(),function(){function a(a,b,c,d){function e(a,b){var e,f=0,g=[];return b&&(e=b.reduce(function(a,b){return angular.isNumber(b.speed)?a+b.speed:a},0)/b.length),angular.forEach(a,function(a){var b=d.get(a.intensity),h=b.zone;e&&(h*=e),a.pace&&(h=c(a.pace/60).minutesPerKilometer.toKilometersPerHour());var i={x:f,y:h};f+=a.duration;var j={x:f,y:h};g.push({type:"area",color:b.color,data:[i,j],enableMouseTracking:!1})}),g}function f(a,b){var c=[],d=0,e=0;return angular.forEach(a,function(a,f){var g,h,i,j,k;if(a.distanceBased)if(i=b.filter(function(b){var c=b.distance,d=e,f=e+a.distance;return c>=d&&f>=c}),h=a.distance,i.length){j=i[0],k=i[i.length-1];var l=k.distance-j.distance,m=(k.duration-j.duration)/1e3,n=l/m;g=h/n}else g=a.duration||0;else i=b.filter(function(b){var c=b.duration,d=1e3*e,f=1e3*(e+a.duration);return c>=d&&f>=c}),g=a.duration,i.length?(j=i[0],k=i[i.length-1],h=k.distance-j.distance):h=a.distance||0;c.push(angular.extend({},a,{distance:!isNaN(h)&&isFinite(h)?h:a.distance,duration:!isNaN(g)&&isFinite(g)?g:a.duration})),d+=g,e+=h}),c}function g(a){var b=[];return angular.forEach(a,function(a){a.duration&&(a.speed||0===a.speed)&&b.push({x:a.duration/1e3,y:a.speed})}),{type:"spline",color:"#647ab7",data:b,enableMouseTracking:!1}}function h(d,e,f){function g(a){for(var b,c=d.length,e=0,f=0;c>f;f++)if(e+=d[f].duration,e>=a){b=d[f];break}return b}function h(d){if(d){var e={intensity:d.intensity,duration:d.duration};return d.pace&&(e.pace=a.locale.isMetric()?d.pace:c(d.pace).minutesPerKilometer.toMinutesPerMile()),
d.distance&&(e.distance=a.locale.isMetric()?d.distance:b(d.distance).kilometers.toMiles()),e}}e=e||[],f=f||1;for(var i=d.reduce(function(a,b){return a+b.duration},0),j=e&&e.length?e[e.length-1].duration/1e3:0,k=Math.max(i,j),l=Math.floor(j/e.length)||f,m=e.map(function(a){var b=g(a.duration/1e3);return{x:a.duration/1e3,y:0,interval:b,model:h(b),track:a}}),n=j+l;k>=n;n+=l){var o=g(n);m.push({x:n,y:0,interval:o,model:h(o)})}return{type:"line",data:m,lineWidth:0}}return{createIntervals:e,normalizeIntervals:f,createPoints:g,createTooltip:h}}a.$inject=["viewer","core.math.conversion.distance","core.math.conversion.speed","api.workout.IntensityEnum"],angular.module("endo.ui.chart").factory("ui.chart.interval.IntervalChartUtils",a)}(),function(){function a(a,b,c){function d(d,e){function f(){d.$watch("workout.id",function(){i(),g()}),k=!0}function g(){var a=d.workout,e=b(a.sport),f=a.plannedIntervals,g=a.points;if(e.chart.renderTo=l,g&&g.hasSensorData()){var i=c.normalizeIntervals(f,g);e.series=c.createIntervals(i,g),e.series.push(c.createPoints(g));var k=c.createTooltip(i,g);e.series.push(k)}else e.series=c.createIntervals(f),e.series.push(c.createTooltip(f));j=new Highcharts.Chart(e),h()}function h(){function b(){return j&&j.renderTo?j.renderTo.clientWidth?void j.reflow():void(++c<=m&&a(b,0,!1)):void 0}var c=0;b()}function i(){j&&(j.destroy(),j=null)}var j,k=!1,l=e[0].querySelector(".js-interval-chart");d.$watch("visible",function(a){if(a){if(!k)return void f();h()}});var m=10;d.$on("$destroy",function(){i()})}var e=['<div class="eoIntervalChart">','<div class="js-interval-chart eoIntervalChart-inner"></div>',"</div>"].join("");return{template:e,scope:{workout:"=",visible:"="},link:d}}a.$inject=["$timeout","ui.chart.interval.IntervalChartOptions","ui.chart.interval.IntervalChartUtils"],angular.module("endo.ui.chart").directive("eoIntervalChart",a)}(),function(){function a(a,b,c){function d(d,e,f){function g(){d.intervals&&(l.series=b.createIntervals(d.intervals),l.series.push(b.createTooltip(d.intervals,[],10)),j=new Highcharts.Chart(l))}function h(){i(),g()}function i(){j&&(j.destroy(),j=null)}var j,k=e[0].querySelector(".js-chart"),l={chart:{renderTo:k,animation:!1,backgroundColor:"#f7f7f7",spacingTop:12,spacingLeft:0,spacingRight:0,spacingBottom:0},title:{text:null},credits:{text:null},legend:{enabled:!1},xAxis:{title:{text:null},labels:{enabled:!1},lineWidth:0,tickWidth:0,tickLength:0},yAxis:{type:"datetime",title:{text:null},labels:{enabled:!1},lineWidth:0,tickWidth:0,tickLength:0,gridLineWidth:0},plotOptions:{series:{marker:{enabled:!1}},area:{animation:!1,fillOpacity:1,lineWidth:0,enableMouseTracking:!1},line:{animation:!1,turboThreshold:0,states:{hover:{enabled:!1}}}},tooltip:{enabled:!0,shape:a.tooltip.SHAPE,shadow:a.tooltip.SHADOW,backgroundColor:a.tooltip.BACKGROUND_COLOR,borderColor:a.tooltip.BORDER_COLOR,borderWidth:1,style:{fontSize:"10px",padding:"4px"},formatter:function(){var a=this.point.model,b=["intensity"];return a.pace&&b.push("pace"),a.duration&&b.push("duration"),a.distance&&b.push("distance"),c.format(a,b)}}};d.$watchCollection("intervals",h)}var e=['<div class="eoIntervalOverview">','<div class="js-chart eoIntervalOverview-inner"></div>',"</div>"].join("");return{template:e,scope:{intervals:"="},link:d}}a.$inject=["ui.chart.common.ChartConfig","ui.chart.interval.IntervalChartUtils","ui.chart.common.TooltipFormatter"],angular.module("endo.ui.chart").directive("eoIntervalOverview",a)}(),function(){function a(a,b){function c(a){this.node=a}c.prototype.update=function(a){this.destroy();var c=b.create();c.chart.renderTo=this.node,c.series=[{type:"column",data:a}];var d=this;c.plotOptions.series.point.events.mouseOver=function(){angular.isFunction(d.mouseOver)&&d.mouseOver.call(d,this)},c.plotOptions.series.point.events.mouseOut=function(){angular.isFunction(d.mouseOut)&&d.mouseOut.call(d,this)},this.chart=new Highcharts.Chart(c)};var d=10;return c.prototype.reflow=function(){function b(){return c.chart?c.chart.renderTo.clientWidth?void c.chart.reflow():void(++e<=d&&a(b,0,!1)):void 0}var c=this,e=0;b()},c.prototype.destroy=function(){this.chart&&(this.chart.destroy(),this.chart=null)},c}a.$inject=["$timeout","ui.chart.lap.LapChartOptions"],angular.module("endo.ui.chart").factory("ui.chart.lap.LapChart",a)}(),function(){function a(a,b,c,d,e,f,g,h){function i(){var b,c=this.value,d=this.chart.series[0].points;return d&&(b=d[d.length-1]),c=b&&this.isLast&&b.isPartial&&!b.isManual?f.char.LTE+a.round(c+.5,0):a.round(c)}function j(){function a(a){b(a);var c={min:f.char.TURTLE,max:f.char.HARE},d=g.plotX+e.plotLeft-k/2,h=g.plotY+e.plotTop+1.75*k,i={color:"white",fontFamily:"endomondo",fontSize:k};e["$"+a]=e.renderer.text(c[a],d,h).css(i).attr({zIndex:5}).add()}function b(a){e["$"+a]&&(e["$"+a].destroy(),e["$"+a]=null)}function c(){e.$min&&e.$min.destroy(),e.$max&&e.$max.destroy()}function d(){e.$normalizedPath&&(e.$normalizedPath.destroy(),e.$normalizedPath=null);var a=g.plotX+e.plotLeft,b=g.plotY+e.plotTop,c=g.pointWidth;c>m&&(c=m);var d=c/4;e.$normalizedPath=e.renderer.path(["M",a-2*d,b,"l",d,d,"l",d,-d,"l",d,d,"l",d,-d,"Z"]).attr({fill:"#f8f8f8",zIndex:5}).add()}var e=this.series.chart,g=this.point,i=this.series.points,j=i.length,k=11;j>2&&g.pointWidth>k+1?g.isSlowest?a.call(this,"min"):g.isFastest&&a.call(this,"max"):c();var l=i[i.length-1];return g===l&&g.isNormalized&&d(g),g.pointWidth>5.5?h(this.point.split,!1):""}function k(){return g.format(this.point,["lap",["lapDistance",c.label.distance],["lapDuration",c.label.duration],g.SEPARATOR,"speed","pace",g.SEPARATOR,["distance","∑ "+c.label.distance],["duration","∑ "+c.label.duration]])}function l(){return angular.copy(b.merge(e,n))}var m=36,n={chart:{spacingLeft:24,spacingRight:24,spacingTop:48},xAxis:{type:"category",labels:{formatter:i,style:{color:f.dataLabel.COLOR}},tickLength:0},yAxis:{labels:{enabled:!1}},plotOptions:{series:{point:{events:{}}},column:{animation:!1,color:f.color.LAP,borderWidth:0,maxPointWidth:m,dataLabels:{enabled:!0,rotation:270,align:"left",style:{color:f.dataLabel.COLOR},y:-6,formatter:j},stickyTracking:!0}},series:[],tooltip:{animation:!1,formatter:k,positioner:function(a,b,c){var d=this.chart,e=d.plotBox,f=d.plotLeft+c.plotX,g=10;return f+a>e.x+e.width&&(f+=e.x+e.width-(f+a)),{x:f,y:g}}}};return{create:l}}a.$inject=["core.math","core.lang.object","common.unit.UNITS","core.math.conversion.distance","ui.chart.common.ResetOptions","ui.chart.common.ChartConfig","ui.chart.common.TooltipFormatter","durationFilter"],angular.module("endo.ui.chart").factory("ui.chart.lap.LapChartOptions",a)}(),function(){function a(a,b,c,d,e,f){function g(f,g,i){function j(a,b,c){var e={lap:a.index,name:a.cumulativeDistance,y:a.pace,split:a.duration,distance:a.cumulativeDistance,duration:a.cumulativeDuration,lapDistance:a.distance,lapDuration:a.duration,speed:a.speed,pace:a.pace,polylines:a.polyline,isSlowest:a.isSlowest,isFastest:a.isFastest,isPartial:a.isPartial};return c.length>2&&(a.isSlowest&&(e.color=d.color.LAP_SLOWEST),a.isFastest&&(e.color=d.color.LAP_FASTEST)),e}function k(a,b,c){var e={lap:b+1,name:b+1,y:a.pace,split:a.duration,distance:a.cumulativeDistance,duration:a.cumulativeDuration,lapDistance:a.distance,lapDuration:a.duration,speed:a.speed,pace:a.pace,polylines:a.polyline,isSlowest:a.isSlowest,isFastest:a.isFastest,isPartial:a.isPartial,isManual:!0};return c.length>2&&(a.isSlowest&&(e.color=d.color.LAP_SLOWEST),a.isFastest&&(e.color=d.color.LAP_FASTEST)),e}function l(a){var b=1.25,c=a[a.length-1];if(a.length<=1||!c.isPartial)return a;var d;return a.forEach(function(a){a.isSlowest&&(d=a)}),d&&c.speed*b<d.speed&&(a[a.length-1].y=d.pace*b,a[a.length-1].isNormalized=!0),a}function m(){f.distanceGroups=[]}function n(a){f.distanceGroups=f.distanceGroups||[],f.distanceGroups.push({distance:a,label:e.append.distance(a)})}function o(){var a=0===f.groupBy&&r&&r.length,b=q;if(a&&(b=r.filter(function(a){return 0!==a.distance})),void 0!==b){var d=c.groupLaps(b,f.groupBy).map(a?k:j);a||(d=l(d)),p.update(d),p.reflow()}}var p,q,r,s=g[0].querySelector(".js-chart");p=new b(s),p.mouseOver=function(a){f.$apply(function(){f.hub={polyline:a.polylines}})},p.mouseOut=function(a){f.$apply(function(){f.hub=null})},f.$watch("visible",function(a){a&&p.reflow()});var t=!0;f.$watch("fullscreen",function(b){return t?void(t=!1):void a(function(){p.reflow()},100)}),f.$watch("groupBy",function(a,b){void 0!==b&&o()}),f.$watch("workout",function(a){q=a.getLaps(e.getViewerUnitSystem()),r=a.getLaps("manual"),m(),r&&r.length&&(f.distanceGroups.push({distance:0,label:h("laps.groupBy.manualLaps")}),f.groupBy=0),q.length>=1&&(n(1),q.length>2&&n(2),q.length>5&&n(5),q.length>10&&n(10),f.groupBy=1,q.length>=52&&(f.groupBy=2),q.length>=100&&(f.groupBy=5),q.length>=150&&(f.groupBy=10)),o()}),f.$on("$destroy",function(){p.destroy()})}var h=f.require("ui.chart"),i=['<div class="eoLapChart">','<div class="eoLapChart-groupBy" ng-show="distanceGroups.length > 1 || distanceGroups.length == 1 && groupBy ==0">','<select ng-model="groupBy" ng-options="group.distance as group.label for group in distanceGroups"></select>',"</div>",'<div class="eoLapChart-inner js-chart"></div>',"</div>"].join("");return{template:i,scope:{workout:"=",hub:"=",visible:"=",fullscreen:"="},link:g}}a.$inject=["$timeout","ui.chart.lap.LapChart","model.workout.LapProcessor","ui.chart.common.ChartConfig","common.unit.UNITS","common.i18n.Translation"],angular.module("endo.ui.chart").directive("eoLapChart",a)}(),function(){function a(a,b,c,d,e,f){return{chart:{alignTicks:!1,zoomType:"x",spacingRight:12,spacingLeft:12,ignoreHiddenSeries:!1,backgroundColor:"#f8f8f8",type:"spline"},title:{text:null},credits:{text:null},legend:{enabled:!1},tooltip:{shared:!0,shape:"square",backgroundColor:" rgba(255, 255, 255, 0.95)",borderWidth:1,borderColor:"#e6e6e6",shadow:!1,crosshairs:[{dashStyle:"ShortDash"},!1],formatter:function(){var b=this.points,c=["duration"],d={duration:b[0].point.model.duration/1e3};b[0].point.model.distance&&(c.push("distance"),d.distance=b[0].point.model.distance),angular.forEach(b,function(a){if(a.series&&a.series.name){var b=a.series.name;d[b]=a.y,"pace"===b&&(d[b]=f(d[b]).kilometersPerHour.toMinutesPerKilometer(),d[b]*=60),c.push(b)}});var e=a.format(d,c);return e},positioner:function(a,b,c){var d=this.chart.plotWidth,e=c.plotX+a/2+6,f=20;return c.plotX+a>d&&(e=c.plotX-a/2-12),{x:e,y:f}}},plotOptions:{series:{animation:!1,marker:{enabled:!1},states:{hover:{enabled:!1}}},areaspline:{fillColor:"rgba(100, 122, 183, .25)",threshold:null}},xAxis:[],yAxis:[],series:[]}}a.$inject=["ui.chart.common.TooltipFormatter","durationFilter","distanceFilter","speedFilter","paceFilter","core.math.conversion.speed"],angular.module("endo.ui.chart").factory("ui.chart.point.defaults",a)}(),function(){angular.module("endo.ui.chart").directive("eoPointChart",["$timeout","core.lang.object","core.lang.string","ui.chart.point.options",function(a,b,c,d){return{scope:{points:"=",hub:"=",visible:"=",sport:"=",fullscreen:"="},templateUrl:"tpl://ui/chart/point/eoPointChart.en.html",link:function(e,f,g){function h(a){return c.snakeCase(a).toUpperCase()+"_SERIES"}function i(a){var b=String(a).replace("_SERIES","").toLowerCase();return c.camelCase(b)}function j(){e.$watch("points",function(){e.checkbox={speed:!0,pace:!0,altitude:!0,heartRate:!0,cadence:!0,power:!0},e.checkbox.distance=e.points.hasDistance(),e.checkbox.duration=!e.checkbox.distance,p()}),e.$watch("xAxisOver",p),r=!0}function k(){var a=this.model;e.$evalAsync(function(){e.hub=a})}function l(){e.$evalAsync(function(){e.hub=null})}function m(){e.hub=null,e.xAxisOver=e.checkbox.distance?"distance":"duration",e.usePace=e.sport.pace;var a=d(e.points,e.xAxisOver,e.usePace,s),c="plotOptions.series.point.events";b.set(a,c+".mouseOver",k,{merge:!0}),b.set(a,c+".mouseOut",l,{merge:!0}),a.series.forEach(function(a){a.visible=e.checkbox[i(a.id)]}),q=new Highcharts.Chart(a,function(a){try{a.tooltip.label.attr({zIndex:21})}catch(b){}}),n()}function n(){function b(){return q?q.renderTo.clientWidth?void q.reflow():void(++c<=u&&a(b,0,!1)):void 0}var c=0;b()}function o(){q&&(q.destroy(),q=null)}function p(){o(),a(m,0,!1)}var q,r=!1,s=f[0].querySelector(".js-chart");angular.element(s).on("mouseleave",function(){e.$apply(function(){e.hub=null})}),e.$watch("visible",function(a){if(a){if(!r)return void j();n()}});var t=!0;e.$watch("fullscreen",function(b){return t?void(t=!1):void a(n,100)}),e.selectSeries=function(a){var b=e.checkbox[a]=!e.checkbox[a],c=q.get(h(a));c&&c[b?"show":"hide"]()},e.selectXAxis=function(a){if(!e.checkbox[a]){e.checkbox[a]=!e.checkbox[a],e.xAxisOver=a;var b="distance"==a?"duration":"distance";e.checkbox[b]=!e.checkbox[a]}};var u=10;e.$on("$destroy",function(){o()})}}}])}(),function(){function a(a,b){function c(c){return{latitude:c.latitude,longitude:c.longitude,duration:c.duration,distance:a.locale.isMetric()?c.distance:b(c.distance).kilometers.toMiles()}}return{fromPoint:c}}a.$inject=["viewer","core.math.conversion.distance"],angular.module("endo.ui.chart").factory("ui.chart.point.field.Model",a)}(),function(){angular.module("endo.ui.chart").factory("ui.chart.point.field.altitude",["viewer","core.math","core.math.conversion.distance","ui.chart.common.ChartConfig","ui.chart.point.field.Model","common.unit.UNITS",function(a,b,c,d,e,f){var g="ALTITUDE_AXIS",h="ALTITUDE_SERIES",i="#647ab7",j={id:g,allowDecimals:!1,startOnTick:!0,endOnTick:!0,showEmpty:!1,labels:{style:{fontSize:d.axis.FONT_SIZE,color:i},y:4},lineWidth:1,tickWidth:1,title:{style:{fontSize:d.axis.FONT_SIZE,color:i},text:f.append.altitude("")},opposite:!0,lineColor:i,tickColor:i,reversed:!1,gridLineWidth:0};angular.extend(j,d.axis.disableLabels);var k={id:h,name:"altitude",color:i,type:"areaspline",zIndex:0,yAxis:g};return{axis:j,series:k,data:function(d,f){f=f||"distance";var g=[],h=d.filter(function(a){if(void 0===a[f])return!1;var b=a.altitude;return b||0===b}).map(function(d){var h=d.altitude;a.locale.isImperial()&&(h=c(h).meters.toFeet()),h=b.round(h,0),g.push(h);var i=e.fromPoint(d);return{x:i[f],y:h,model:i}}),i=200,k=Math.min.apply(null,g),l=Math.max.apply(null,g);return j.min=k,j.max=i>l-k?k+i:l,h}}}])}(),function(){angular.module("endo.ui.chart").factory("ui.chart.point.field.cadence",["core.math","ui.chart.common.ChartConfig","ui.chart.point.field.Model","common.unit.UNITS",function(a,b,c,d){var e="CADENCE_AXIS",f="CADENCE_SERIES",g="#11a9cc",h={id:e,allowDecimals:!1,startOnTick:!1,endOnTick:!0,showEmpty:!1,labels:{style:{fontSize:b.axis.FONT_SIZE,color:g},y:4},lineWidth:1,tickWidth:1,title:{style:{fontSize:b.axis.FONT_SIZE,color:g},text:d.append.cadence("")},opposite:!0,lineColor:g,tickColor:g,tickPixelInterval:28,reversed:!1,gridLineWidth:0};angular.extend(h,b.axis.disableLabels);var i={id:f,name:"cadence",color:g,zIndex:1,yAxis:e};return{axis:h,series:i,data:function(b,d){d=d||"distance";var e=[],f=b.filter(function(a){if(void 0===a[d])return!1;var b=a.sensorData&&a.sensorData.cadence;return b||0===b}).map(function(b){var f=c.fromPoint(b),g=a.round(b.sensorData.cadence);return e.push(g),{x:f[d],y:g,model:f}}),g=50,i=Math.min.apply(null,e),j=Math.max.apply(null,e);return h.max=1.25*j,h.min=j-i>=g?i:j-g,h.min<0&&(h.min=0),f}}}])}(),function(){function a(a,b,c){var d={type:"linear",lineColor:c.axis.COLOR,tickColor:c.axis.COLOR,minTickInterval:1,tickLength:0,showFirstLabel:!1,labels:{formatter:function(){return b.append.distance(this.value)}}};return d}a.$inject=["core.lang.number","common.unit.UNITS","ui.chart.common.ChartConfig"],angular.module("endo.ui.chart").factory("ui.chart.point.field.distance",a)}(),function(){function a(a,b){var c={type:"datetime",minRange:3e4,lineColor:b.axis.COLOR,tickColor:b.axis.COLOR,tickLength:0,showFirstLabel:!1,labels:{formatter:function(){return a(this.value/1e3,!1)}}};return c}a.$inject=["durationFilter","ui.chart.common.ChartConfig"],angular.module("endo.ui.chart").factory("ui.chart.point.field.duration",a)}(),function(){angular.module("endo.ui.chart").factory("ui.chart.point.field.heartRate",["core.math","ui.chart.common.ChartConfig","ui.chart.point.field.Model","common.unit.UNITS",function(a,b,c,d){var e="HEART_RATE_AXIS",f="HEART_RATE_SERIES",g="#9C1B43",h={id:e,allowDecimals:!1,startOnTick:!1,endOnTick:!0,showEmpty:!1,labels:{style:{fontSize:b.axis.FONT_SIZE,color:g},x:6,y:4},lineWidth:1,tickWidth:1,tickLength:4,title:{style:{fontSize:b.axis.FONT_SIZE,color:g},text:d.append.heartRate("")},opposite:!0,lineColor:g,tickColor:g,tickPixelInterval:28,reversed:!1,minRange:5,gridLineWidth:0},i={id:f,name:"heartRate",color:g,zIndex:4,yAxis:e};return{axis:h,series:i,data:function(b,d){return d=d||"distance",b.filter(function(a){if(void 0===a[d])return!1;var b=a.sensorData&&a.sensorData.heartRate;return b||0===b}).map(function(b){var e=c.fromPoint(b),f=a.round(b.sensorData.heartRate);return{x:e[d],y:f,model:e}})}}}])}(),function(){angular.module("endo.ui.chart").factory("ui.chart.point.field.pace",["viewer","core.math","core.math.conversion.speed","durationFilter","ui.chart.common.ChartConfig","ui.chart.point.field.Model","common.unit.UNITS",function(a,b,c,d,e,f,g){var h="PACE_AXIS",i="PACE_SERIES",j="#11924e",k={id:h,type:"linear",allowDecimals:!1,startOnTick:!1,endOnTick:!0,showEmpty:!1,labels:{style:{fontSize:e.axis.FONT_SIZE,color:j},x:-6,y:4,formatter:function(){var a=c(this.value).kilometersPerHour.toMinutesPerKilometer();return isFinite(a)?d(60*a,!1):""}},tickPixelInterval:50,lineWidth:1,tickWidth:1,tickLength:4,title:{style:{fontSize:e.axis.FONT_SIZE,color:j},text:g.append.pace("",a.locale.units())},opposite:!1,lineColor:j,tickColor:j,reversed:!1,gridLineWidth:0},l={id:i,name:"pace",color:j,zIndex:3,yAxis:h};return{axis:k,series:l,data:function(d,e){return e=e||"distance",d.filter(function(a){if(void 0===a[e])return!1;var b=a.speed;if(b||0===b)return!0;var c=a.sensorData;return c&&(c.speed||0===c.speed)}).map(function(d){var g=d.speed;a.locale.isImperial()&&(g=c(g).kilometersPerHour.toMilesPerHour());var h=f.fromPoint(d);return g=b.round(g,1),{x:h[e],y:g,model:h}})}}}])}(),function(){angular.module("endo.ui.chart").factory("ui.chart.point.field.power",["core.math","ui.chart.common.ChartConfig","ui.chart.point.field.Model","common.unit.UNITS",function(a,b,c,d){var e="POWER_AXIS",f="POWER_SERIES",g="#f4b400",h={id:e,allowDecimals:!1,startOnTick:!1,endOnTick:!0,showEmpty:!1,labels:{style:{fontSize:b.axis.FONT_SIZE,color:g},y:4},lineWidth:1,tickWidth:1,title:{style:{fontSize:b.axis.FONT_SIZE,color:g},text:d.append.cadence("")},opposite:!0,lineColor:g,tickColor:g,tickPixelInterval:28,reversed:!1,gridLineWidth:0};angular.extend(h,b.axis.disableLabels);var i={id:f,name:"power",color:g,zIndex:1,yAxis:e};return{axis:h,series:i,data:function(b,d){d=d||"distance";var e=[],f=b.filter(function(a){if(void 0===a[d])return!1;var b=a.sensorData&&a.sensorData.power;return b||0===b}).map(function(b){var f=c.fromPoint(b),g=a.round(b.sensorData.power);return e.push(g),{x:f[d],y:g,model:f}}),g=50,i=Math.min.apply(null,e),j=Math.max.apply(null,e);return h.max=1.25*j,h.min=j-i>=g?i:j-g,h.min<0&&(h.min=0),f}}}])}(),function(){angular.module("endo.ui.chart").factory("ui.chart.point.field.speed",["viewer","core.math","core.math.conversion.speed","ui.chart.common.ChartConfig","ui.chart.point.field.Model","common.unit.UNITS",function(a,b,c,d,e,f){var g="SPEED_AXIS",h="SPEED_SERIES",i="#11924e",j={id:g,allowDecimals:!1,startOnTick:!1,endOnTick:!0,showEmpty:!1,labels:{style:{fontSize:d.axis.FONT_SIZE,color:i},x:-6,y:4},lineWidth:1,tickWidth:1,tickLength:4,title:{style:{fontSize:d.axis.FONT_SIZE,color:i},text:f.append.speed("",a.locale.units())},opposite:!1,lineColor:i,tickColor:i,tickPixelInterval:28,reversed:!1,minRange:5,gridLineWidth:0},k={id:h,name:"speed",color:i,zIndex:3,yAxis:g};return{axis:j,series:k,data:function(d,f){return f=f||"distance",d.filter(function(a){if(void 0===a[f])return!1;var b=a.speed;if(b||0===b)return!0;var c=a.sensorData;return c&&(c.speed||0===c.speed)}).map(function(d){var g=d.speed;a.locale.isImperial()&&(g=c(g).kilometersPerHour.toMilesPerHour());var h=e.fromPoint(d);return g=b.round(g,1),{x:h[f],y:g,model:h}})}}}])}(),function(){function a(a,b,c,d,e,f,g,h,i,j){function k(k,n,o,p){var q=[];k.hasSpeed()&&q.push(o?f:e),k.hasHeartRate()&&q.push(g),k.hasPower()&&q.push(j),k.hasCadence()&&q.push(i),k.hasAltitude()&&q.push(h);var r=n===l,s=angular.copy(b);return a.set(s,"chart.renderTo",p,{merge:!0}),s.xAxis.push(r?d:c),angular.forEach(q,function(a){var b=a.data(k,r?l:m);if(b.length){s.yAxis.push(angular.copy(a.axis));var c=angular.copy(a.series);c.data=b,s.series.push(c)}}),s}var l=k.DISTANCE="distance",m=k.DURATION="duration";return k}a.$inject=["core.lang.object","ui.chart.point.defaults","ui.chart.point.field.duration","ui.chart.point.field.distance","ui.chart.point.field.speed","ui.chart.point.field.pace","ui.chart.point.field.heartRate","ui.chart.point.field.altitude","ui.chart.point.field.cadence","ui.chart.point.field.power"],angular.module("endo.ui.chart").factory("ui.chart.point.options",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){function a(a,b,c){return["<div>",c?'<div class="eoRecordChart-pb"><i class="icon icon-award"></i></div>':"",'<div class="eoRecordChart-dataLabel">','<span class="eoRecordChart-dataLabel-key">',a,"</span>",'<span class="eoRecordChart-dataLabel-value">',b,"</span>","</div>","</div>"].join("")}var d=this.point,e=d.model,i=d.record;if(this.y===d.low)return"";var j=q("label."+i.toString(),void 0);if(void 0===j)if(e.distanceBased){j=i.isMetric?i.quantity:b.round(c(i.quantity).kilometers.toMiles(),0);var k=i.isMetric?f.METRIC:f.IMPERIAL;j+=" "+f.append.distance("",k)}else j=h(i.quantity);var l=e.distanceBased?h(e.value):g(e.value,2);return a(j,l,e.personalBest)}var o="#94d8e8",p="#d2edf3",q=e.require("common.data.records"),r={chart:{type:"columnrange",inverted:!0,backgroundColor:k.chart.BACKGROUND_COLOR,spacingTop:8,spacingBottom:8,spacingLeft:30,spacingRight:30},title:{text:null},credits:{text:null},xAxis:{categories:[],labels:{enabled:!1},lineWidth:0,tickLength:0,minorTickLength:0},yAxis:{title:{text:null},min:0,startOnTick:!1,endOnTick:!1,showFirstLabel:!1,allowDecimals:!1,gridLineWidth:1,minorGridLineWidth:0,tickPixelInterval:30,labels:{enabled:!0,formatter:function(){return f.append.distance(this.value)}},lineWidth:1,lineColor:"#d8d8d8"},series:[{dataLabels:{enabled:!0,inside:!0,verticalAlign:"middle",useHTML:!0,formatter:n,crop:!1,overflow:"none"},data:[]}],legend:{enabled:!1},tooltip:{shape:"square",backgroundColor:"none",borderWidth:0,shadow:!1,useHTML:!0,formatter:function(){var b,c=this.point.model,e=l.get(c.type),h=c.value;b=c.distanceBased?e.quantity/(h/3600):h/(e.quantity/3600);var i,j=a.locale.isMetric()?"toMinutesPerKilometer":"toMinutesPerMile";i=60*d(b).kilometersPerHour[j](),a.locale.isImperial()&&(b=d(b).kilometersPerHour.toMilesPerHour());var k={speed:b,pace:i,startDistance:c.startDistance,endDistance:c.endDistance},n=m.format(k,["▸ "+f.label.distance+m.SEPARATOR+g(c.startDistance,2),"■ "+f.label.distance+m.SEPARATOR+g(c.endDistance,2),"speed","pace"]);return'<div class="eoRecordChart-tooltip">'+n+"</div>"}},plotOptions:{columnrange:{animation:!1,pointWidth:30,color:o,borderColor:"none",point:{events:{}},states:{hover:{color:p}}},series:{cursor:"default"}}};return r}a.$inject=["viewer","core.math","core.math.conversion.distance","core.math.conversion.speed","common.i18n.Translation","common.unit.UNITS","distanceFilter","durationFilter","paceFilter","speedFilter","ui.chart.common.ChartConfig","api.workout.RecordEnum","ui.chart.common.TooltipFormatter"],angular.module("endo.ui.chart").factory("ui.chart.record.RecordChartOptions",a)}(),function(){function a(a,b,c,d){function e(e){var f=[];angular.forEach(e,function(d){if(angular.isObject(d)){var e=b.get(d.type),g=d.startDistance,h=d.endDistance;if(!e.isAggregated){0===g&&0===h&&(h=d.distanceBased?e.quantity:d.value);var i={low:a.locale.isMetric()?g:c(g).kilometers.toMiles(),high:a.locale.isMetric()?h:c(h).kilometers.toMiles(),model:d,record:e};f.push(i)}}});var g=8;return g<f.length&&(f=f.filter(function(b){if(b.record.isMetric&&b.record.isImperial)return!0;var c=b.record.isMetric?d.METRIC:d.IMPERIAL;return a.locale.units()===c})),g<f.length&&(f=f.slice(f.length-g)),f}return{createPoints:e}}a.$inject=["viewer","api.workout.RecordEnum","core.math.conversion.distance","common.unit.UNITS"],angular.module("endo.ui.chart").factory("ui.chart.record.RecordChartUtils",a)}(),function(){function a(a,b,c){function d(d,e,f){function g(){d.$watch("workout",k),o=!0}function h(){var c=d.workout,e=b.createPoints(c.records),f=e.map(function(a){return a.record.toString()}),g=a;g.chart.renderTo=p,g.plotOptions.columnrange.point.events.mouseOver=l,g.plotOptions.columnrange.point.events.mouseOut=m,g.series[0].data=e,g.xAxis.categories=f,n=new Highcharts.Chart(g),i()}function i(){function a(){return n?n.renderTo.clientWidth?void n.reflow():void(++b<=r&&c(a,0,!1)):void 0}var b=0;a()}function j(){n&&(n.destroy(),n=null)}function k(){j(),h()}function l(){var a=this.model.encodedPolyline;d.$apply(function(){d.hub={polyline:a}})}function m(){d.$apply(function(){d.hub=null})}var n,o=!1,p=e[0].querySelector(".js-chart");d.$watch("visible",function(a){if(a){if(!o)return void g();i()}});var q=!0;d.$watch("fullscreen",function(a){return q?void(q=!1):void c(i,100)});var r=10;d.$on("$destroy",function(){j()})}var e=['<div class="eoRecordChart">','<div class="eoRecordChart-inner js-chart"></div>',"</div>"].join("");return{scope:{workout:"=",hub:"=",visible:"=",fullscreen:"="},template:e,link:d}}a.$inject=["ui.chart.record.RecordChartOptions","ui.chart.record.RecordChartUtils","$timeout"],angular.module("endo.ui.chart").directive("eoRecordChart",a)}(),function(){function a(a){function b(a){this.node=a}return b.prototype.update=function(b,c){this.destroy();var d=a.create();d.chart.renderTo=this.node,d.series=b,d.xAxis.categories=c,this.chart=new Highcharts.Chart(d)},b.prototype.destroy=function(){this.chart&&(this.chart.destroy(),this.chart=null)},b}a.$inject=["ui.chart.summary.MonthSummaryChartOptions"],angular.module("endo.ui.chart").factory("ui.chart.summary.MonthSummaryChart",a)}(),function(){function a(a,b,c,d,e,f,g){function h(){var a=this.value;return g(a).getHours()+c.short.hours}function i(){return this.point.duration=this.point.y,f.format(this.point,[this.point.series.name,"duration"])}function j(){return angular.copy(b.merge(d,k))}var k={chart:{type:"column",spacingLeft:12,spacingRight:12,spacingTop:12,height:200},xAxis:{tickLength:0,categories:[],lineColor:"#e6e6e6",style:{color:"#b3b3b3"}},yAxis:{min:0,labels:{enabled:!0,formatter:h,style:{"text-transform":"uppercase",color:"#b3b3b3"}},tickInterval:3600},plotOptions:{column:{stacking:"normal",maxPointWidth:40}},tooltip:{animation:!1,formatter:i},series:[]};return{create:j}}a.$inject=["core.math","core.lang.object","common.unit.UNITS","ui.chart.common.ResetOptions","ui.chart.common.ChartConfig","ui.chart.common.TooltipFormatter","core.math.duration"],angular.module("endo.ui.chart").factory("ui.chart.summary.MonthSummaryChartOptions",a)}(),function(){function a(a,b,c,d,e,f){function g(a,g,h){function i(){s.forEach(function(a){var b=a.firstDate.getDate(),c=a.lastDate.getDate();u.push(b+(c===b?"":"-"+c))})}function j(a){return{name:f.getTitle(a.sport),color:a.sport.color,data:a.intervalTotals.map(function(a){return a?a.duration:null})}}function k(){t=e.intervalTotalsBySport(m,s),i();var a=[];for(var b in t)a.push(j(t[b]));l.update(a,u)}var l=void 0,m=void 0,n=g[0].querySelector(".js-chart"),o=c().startOf("day"),p=o.toDate(),q=p.getFullYear(),r=p.getMonth(),s=b.weeks.forMonth(r,q,!0),t={},u=[];l=new d(n);for(var v=0;v<s.length&&o.isAfter(s[v].lastDate);)v++;s.splice(v+1,s.length),a.$on("$destroy",function(){l.destroy()}),a.$watchCollection("workouts",function(a){a&&a.length&&(m=a,k())})}var h='<div class="eoMonthSummaryChart">\n        <div class="eoMonthSummaryChart-inner js-chart"></div>\n      </div>';return{template:h,scope:{workouts:"="},link:g}}a.$inject=["ui.chart.common.ChartConfig","ui.calendar.CalendarUtils","common.vendor.moment","ui.chart.summary.MonthSummaryChart","model.workout.SummaryProccessor","common.data.SportTranslate"],angular.module("endo.ui.chart").directive("eoMonthSummaryChart",a)}(),function(){function a(a,b){var c=null,d={show:function(d,e){e=e||a,c||(e.$broadcast("toast",{content:d}),c=b(function(){e.$broadcast("toast",{content:d}),c=null},7e3))}};return d}a.$inject=["$rootScope","$timeout"],angular.module("endo.ui.control").factory("ui.control.Toast",a)}(),function(){angular.module("endo.ui.control").directive("eoScrollbar",["$timeout","common.vendor.iscroll","core.dom.media",function(a,b,c){var d=200;return{replace:!1,restrict:"AE",scope:{scrollRefreshOn:"=",deactivateOnMobile:"="},link:function(e,f,g){var h={mouseWheel:!0,scrollbars:!0,interactiveScrollbars:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|A|SPAN|IMG)$/}};e.deactivateOnMobile&&c.getBreakpointName()===c.XSMALL&&(h.eventPassthrough=!0,h.disableTouch=!0,h.disableMouse=!0,h.mouseWheel=!1),a(function(){e.iscroll=b.getInstance(f[0],h)},d),e.$watchCollection("scrollRefreshOn",function(b){a(function(){void 0!==e.iscroll&&e.iscroll.refresh()},0)})}}}])}(),function(){function a(){return{restrict:"AE",template:e,link:c,controller:["$scope",function(a){a.$on("toast",function(b,c){angular.isFunction(b.stopPropagation)&&b.stopPropagation(),a.message=c.content,a.isVisible?a.hide():a.show()})}]}}function b(){return{restrict:"AE",template:e,link:c,controller:["$scope","$rootScope",function(a,b){b.$on("toast",function(b,c){angular.isFunction(b.stopPropagation)&&b.stopPropagation(),a.message=c.content,a.isVisible?a.hide():a.show()})}]}}var c,d=angular.module("endo.ui.control"),e=['<div class="eoToast js-eoToast-root">','<div class="eoToast-inner js-eoToast-inner">','<div class="eoToast-content">{{ message }}</div>',"</div>","</div>"].join("");d.run(["$transition",function(a){c=function(b,c,d){function e(){k.css({display:"block"}),m.removeClass(o),m.addClass(n)}function f(){m.removeClass(n),m.addClass(o)}function g(){b.isVisible||(a(m,e,{animation:!0}),b.isVisible=!0)}function h(){b.isVisible&&(a(m,f,{animation:!0}).then(function(){k.css({display:"none"})}),b.isVisible=!1)}var i=c[0],j=i.querySelector(".js-eoToast-root"),k=angular.element(j),l=i.querySelector(".js-eoToast-inner"),m=angular.element(l),n="animated flipInX",o="animated flipOutX";b.isVisible=!1,b.show=g,b.hide=h}}]),d.directive("eoToast",a),d.directive("eoToaster",b)}(),function(){var a=angular.module("endo.ui.datetime");a.directive("eoRelativeTime",["$parse","$filter","common.i18n.Translation",function(a,b,c){var d=c.fromUrl("ui/datetime/eoRelativeTime.i18n.json");return{replace:!0,restrict:"A",link:function(c,e,f){function g(a){var c=e[0];c.textContent=b("uppercase")(a)}c.$watch(f.eoRelativeTime,function(d){g(b("relativeTime")(a(f.eoRelativeTime)(c),c.strings))}),d.then(function(d){c.strings=d,g(b("relativeTime")(a(f.eoRelativeTime)(c),c.strings))},function(a){})}}}])}(),function(){var a=angular.module("endo.ui.datetime");a.filter("relativeTime",["common.vendor.moment","core.lang.string","dateFilter",function(a,b,c){var d="--",e="HH:mm",f=function(f,g){if(void 0===g)return d;var h=a(f),i=a(Date.now()),j=i.clone().subtract(1,"days").startOf("day"),k=c(f,e);return j.isSame(h,"day")?b.substitute(g.yesterday,[k]):i.diff(h,"seconds")<45?g.s:i.diff(h,"seconds")<120?g.m:i.diff(h,"minutes")<60?b.substitute(g.mm,[i.diff(h,"minutes")]):1===i.diff(h,"hours")?g.h:i.diff(h,"hours")<24?b.substitute(g.hh,[i.diff(h,"hours")]):i.isSame(h,"week")?b.substitute(g.week,{day:c(f,"EEEE"),time:k}):i.isSame(h,"year")?b.substitute(g.date,{date:c(f,"dayMonth"),time:k}):b.substitute(g.date,{date:c(f,"longDate"),time:k})};return f}])}(),function(){function a(a){return{restrict:"A",priority:99,compile:function(c,d){var e=a(d.eoEnterDown,null,!0);return function(a,c){
function d(c){c.which===b&&e(a,{$event:c})}c.on("keydown",d)}}}}var b=13;a.$inject=["$parse"],angular.module("endo.ui.event").directive("eoEnterDown",a)}(),function(){function a(){function a(a,b,c){function d(b){a.$evalAsync(c.eoLoad,{$event:b})}var e=b[0];e.addEventListener("load",d,!1),a.$on("$destroy",function(){e.removeEventListener("load",d)})}return{restrict:"A",link:a}}angular.module("endo.ui.event").directive("eoLoad",a)}(),function(){angular.module("endo.ui.event").directive("eoScrollIn",["$parse","$window","core.dom.viewport",function(a,b,c){return{compile:function(d,e){var f=a(e.eoScrollIn),g="eoKeepListener"in e;return function(a,d,e){var h=function i(){c.contains(d)&&(g||angular.element(b).off("scroll resize",i),a.$apply(function(){f(a)}))};angular.element(b).on("scroll resize",h)}}}}])}(),function(){function a(a,b){function c(a,c,d){function e(b){a.$evalAsync(d.eoTransitionEnd,{$event:b})}var f=c[0],g=b.findEventName();f.addEventListener(g,e,!1),a.$on("$destroy",function(){f.removeEventListener(g,e)})}return{restrict:"A",link:c}}a.$inject=["$parse","core.dom.transition"],angular.module("endo.ui.event").directive("eoTransitionEnd",a)}(),function(){function a(a){function b(b,c,d){b.showMenu=b.feed.canDelete(),b.feedUrl=a.buildFeedUrl({id:b.feed.id})}return{scope:{feed:"=model",onHide:"&?",action:"=?"},templateUrl:"tpl://ui/feed/common/eoFeed.html",require:"^?eoFeedFactory",restrict:"E",transclude:!0,link:b}}angular.module("endo.ui.feed.common").directive("eoFeed",a),a.$inject=["urlBuilder"]}(),function(){function a(a){function b(a){return"eo-feed-"+a.toString().toLowerCase().replace(/_/g,"-")}function c(c,d,e){var f=b(c.feed.type),g=a("<"+f+' model="::feed"/>')(c);d.append(g)}function d(a){this.hide=function(b){a.onHide(b)}}return{link:c,scope:{feed:"=model",onHide:"&"},controller:["$scope",d]}}angular.module("endo.ui.feed.common").directive("eoFeedFactory",a),a.$inject=["$compile"]}(),function(){function a(){function a(a,b,c){a.doAction=function(){a.actionPromise=a.action.onClick(a.feed)}}return{scope:{feed:"=model",action:"=?"},templateUrl:"tpl://ui/feed/common/eoFeedFooter.en.html",require:"^?eoFeed",restrict:"EA",transclude:!0,link:a}}angular.module("endo.ui.feed.common").directive("eoFeedFooter",a)}(),function(){angular.module("endo.ui.feed.common").directive("eoFeedHeader",function(){var a=['<div class="feedItem-header" ng-class="::{ \'text-center\' : centerContent }">','<h3 class="txt-title" ng-if="::title"> {{ ::title }}</h3>',"<div ng-transclude></div>","</div>"].join("");return{restrict:"AE",template:a,transclude:!0,scope:{title:"@",centerContent:"="}}})}(),function(){angular.module("endo.ui.feed.common").directive("eoFeedHeadline",["common.i18n.Translation","model.feed.FeedType","urlBuilder","model.user.UserUtils",function(a,b,c,d){function e(e,g,h){var i=a.require(f);e.transformMap={},e.substituteMap={},e.template="",e.transformMap.name=function(a){var b=c.buildProfileUrl(e.feed.author);return'<a href="'+b+'" target="_self">'+a+"</a>"},e.transformMap.friend=function(a){var b=c.buildProfileUrl(e.feed.friend);return'<a href="'+b+'" target="_self">'+a+"</a>"},e.transformMap.challenge=function(a){var b=c.buildChallengeUrl(e.feed.challenge);return'<a href="'+b+'" target="_self">'+a+"</a>"},e.transformMap.team=function(a){var b=c.buildTeamUrl(e.feed.team);return'<a href="'+b+'" target="_self">'+a+"</a>"};var j=c.buildPremiumUrl();e.transformMap.premium=function(a){return'<a href="'+j+'">'+a+"</a>"},e.transformMap.connect=function(a){return'<a href="/settings/connect" target="_self">'+a+"</a>"};var k=e.$watch("feed",function(a){if(!angular.isUndefined(a)){var c=a.type.toString();switch(a.type!==b.CHALLENGE_FINISHED&&(c+="."+d.genderToString(a.author)),e.template=i(c),a.type){case b.FRIENDSHIP:e.substituteMap.friend=a.friend.name;break;case b.CHALLENGE_JOINED:case b.CHALLENGE_CREATED:case b.CHALLENGE_FINISHED:e.substituteMap.challenge=a.challenge.name;break;case b.TEAM_JOINED:case b.TEAM_CREATED:e.substituteMap.team=a.team.name;break;case b.STATUS:e.template=""}k()}})}var f="tpl://ui/feed/common/eoFeedHeadline.en.html";return{scope:{feed:"=model"},restrict:"E",templateUrl:f,link:e}}])}(),function(){angular.module("endo.ui.feed.common").directive("eoFeedMenu",["$timeout","$parse",function(a,b){return{require:"^?eoFeedFactory",restrict:"E",templateUrl:"tpl://ui/feed/common/eoFeedMenu.en.html",transclude:!0,link:function(c,d,e,f,g){var h=angular.element(d[0].querySelector(".js-content"));h.replaceWith(g(c)),c.hideText=e.hideText,c.hideFromMenu=function(d){if(a(function(){f&&f.hide&&f.hide(d)}),e.onHide){var g=b(e.onHide);g(c)}}}}}])}(),function(){function a(a,b,c,d,e,f){function g(g,i,j){function k(){return c.joinChallenge(g.feed.challenge).then(function(c){a(function(){g.action.visible=!1,b.location=e.buildChallengeUrl({id:g.feed.challenge.id})},500)})}var l=d.require(h);g.isNotIE=!f("browser-ie"),g.hasCover=g.feed.challenge.isFeatured&&g.feed.challenge.coverPicture&&g.feed.challenge.coverPicture.url,g.action={visible:!g.feed.challenge.viewerJoined,onClick:k,text:l("action")}}var h="tpl://ui/feed/types/eoFeedChallengeCreated.en.html";return{restrict:"E",templateUrl:h,scope:{feed:"=model"},link:g}}angular.module("endo.ui.feed").directive("eoFeedChallengeCreated",a).directive("eoFeedChallengeJoined",a),a.$inject=["$timeout","$window","api.challenge.ChallengeResource","common.i18n.Translation","urlBuilder","core.has"]}(),function(){function a(a){scope.feedUrl=a.buildFeedUrl({id:scope.feed.id});var b=['<div class="feedItem">',"<div eo-feed-header>",'<div class="feedItem-header-content clearfix">','<div class="feedItem-header-avatar pull-left square-frame" eo-challenge-link="feed.challenge">','<img ng-src="{{ ::feed.challenge.picture.url }}">',"</div>",'<div class="feedItem-header-status">','<eo-feed-headline model="feed"></eo-feed-headline>',"<br>",'<a href="{{ feedUrl }}" class="feedItem-timestamp-link">','<time class="txt-caption feedItem-timestamp" eo-relative-time="::feed.timestamp" timestamp="{{feed.timestamp}}"></time>',"</a>","</div>","</div>","</div>",'<div class="feedItem-body">','<eo-challenge-ranking model="::feed.challenge"></eo-challenge-ranking>',"</div>",'<div class="feedItem-footer" eo-feed-footer model="::feed"></div>',"</div>"].join("");return{restrict:"E",template:b,scope:{feed:"=model"}}}angular.module("endo.ui.feed").directive("eoFeedChallengeFinished",a),a.$inject=["urlBuilder"]}(),function(){function a(){function a(a,b,c){a.action={link:"/settings/connect",text:"Connect",visible:!0}}return{restrict:"E",template:'<eo-feed model="feed" action="action"></eo-feed>',scope:{feed:"=model"},link:a}}angular.module("endo.ui.feed").directive("eoFeedConnectGarmin",a).directive("eoFeedConnectNikeplus",a).directive("eoFeedConnectFitbit",a).directive("eoFeedConnectMfp",a).directive("eoFeedConnectMmf",a).directive("eoFeedConnectWithings",a)}(),function(){function a(a,b,c,d){function e(e,g,h){function i(){return b.befriend(e.feed.friend).then(function(b){a(function(){e.action.visible=!1,e.feed.friend.requestSent=!0},500)})}var j=c.require(f);e.isNotIE=!d("browser-ie"),e.action={visible:!e.feed.friend.requestSent&&!e.feed.friend.isViewer,onClick:i,text:j("action")}}var f="tpl://ui/feed/types/eoFeedFriendship.en.html";return{restrict:"E",templateUrl:f,scope:{feed:"=model"},link:e}}angular.module("endo.ui.feed").directive("eoFeedFriendship",a),a.$inject=["$timeout","api.user.UserResource","common.i18n.Translation","core.has"]}(),function(){function a(a,b){function c(c,e,f){var g=b.require(d);c.action={visible:!a.premium,text:g("action"),link:"/premium",classes:"button-default"}}var d="tpl://ui/feed/types/eoFeedPremiumSignup.en.html";return{restrict:"E",templateUrl:d,scope:{feed:"=model"},link:c}}angular.module("endo.ui.feed").directive("eoFeedPremiumSignup",a),a.$inject=["user","common.i18n.Translation"]}(),function(){function a(a){function b(b,c,d){b.isNotIE=!a("browser-ie")}return{restrict:"E",template:['<eo-feed model="feed">','<div class="feedItem-profilePicture">','<div class="feedItem-profilePicture-inner text-center" ng-style="expression">',"<div class=\"feedItem-blurry\" ng-if=\"::isNotIE\" ng-style=\"{ 'background-image': 'url('+feed.author.picture.url+')' }\"></div>",'<eo-avatar class="feedItem-profilePicture-avatar" user="feed.author" avatar-size="large" include-link="true"></eo-avatar>',"</div>","</div>","</eo-feed>"].join(""),scope:{feed:"=model"},link:b}}angular.module("endo.ui.feed").directive("eoFeedProfilePicture",a),a.$inject=["core.has"]}(),function(){function a(){var a=['<eo-feed model="feed">','<div class="feedItem-status">','<div class="feedItem-message" ng-if="::feed.message" ng-class="::{ hasContent: hasContent }" ng-bind-html="::feed.message | unescape | linky:\'_blank\' | tags"></div>','<div class="feedItem-status-video embed-responsive embed-responsive-16by9" ng-if="::feed.status.video">','<iframe class="embed-responsive-item" ng-src="{{::videoUrl}}" frameborder="0" allowfullscreen></iframe>',"</div>",'<div class="feedItem-status-picture" ng-if="::feed.pictures.length">','<eo-picture-tiles pictures="::feed.pictures">',"</div>",'<div class="feedItem-status-link clearfix" ng-if="::feed.status.link">','<a ng-href="{{::feed.status.link.url}}" target="_blank">','<img class="pull-left feedItem-status-link-thumbnail" ng-if="::feed.status.link.thumbnail" ng-src="{{feed.status.link.thumbnail}}">','<img class="pull-left feedItem-status-link-icon" ng-if="::feed.status.link.icon" ng-src="{{feed.status.link.icon}}">','<h4 class="feedItem-status-title txt-subhead">',"{{::feed.status.link.title}}","</h4>",'<span class="txt-caption" ng-if="::feed.status.link.description">{{::feed.status.link.description}}</span>',"</a>","</div>","</div>","</eo-feed>"].join("");return{restrict:"E",template:a,scope:{feed:"=model"},controller:["$scope","common.video.YoutubeLink",function(a,b){var c=a.$watch("feed",function(d){if(d){if(a.hasContent=angular.isDefined(a.feed.status.video)||a.feed.pictures&&a.feed.pictures.length,a.feed.status.video){var e=b.parse(a.feed.status.video.url);e&&(a.videoUrl=e.getEmbedUrl())}c()}})}]}}angular.module("endo.ui.feed").directive("eoFeedStatus",a)}(),function(){function a(a,b,c,d){function e(a){var e=d.require(f);a.planUrl=b.buildTraningPlanUrl({userId:a.feed.author.id}),a.action={link:b.buildTraningPlanUrl(),visible:!0,text:e("action")},a.goalName=c.goalName(a.feed.trainingPlan)}var f="tpl://ui/feed/types/eoFeedTrainingplanCreated.en.html";return{restrict:"E",templateUrl:f,scope:{feed:"=model"},link:e}}angular.module("endo.ui.feed").directive("eoFeedTrainingplanCreated",a),a.$inject=["user","urlBuilder","ui.trainingplan.TrainingPlanTranslate","common.i18n.Translation"]}(),function(){function a(a,b,c,d,e,f,g){function h(b,c,h){b.model={},b.model.feed=b.feed,b.feed.workout.author=b.feed.author,b.model.workout=b.feed.workout,b.hasPictures=b.feed.pictures.length>0,b.hasPictures&&(b.splitContent=!0),b.model.workout.records&&b.model.workout.records.length&&f.get(b.model.workout.records[0].type)&&(b.model.workout.personalBest=b.model.workout.records[0],b.hasPB=!0),b.feedUrl=g.buildFeedUrl({id:b.feed.id}),b.showMenu=b.feed.canDelete(),b.hasContent=!0,b.model.workout.mapKey&&b.model.workout.hasMap()&&!b.hasPictures&&!function(){var c=e.getMapUrl(b.model.workout.smallEncodedPolyline,b.model.workout.mapKey);a.get(c).then(function(a){b.hasMap=!0,b.splitContent=!0,b.staticMapUrl=c}).catch(function(a){})}(),b.setWorkoutPrivacy=function(a){var c={showWorkout:a.valueOf()};return a.valueOf()>b.model.workout.showMap.valueOf()&&(c.showMap=a.valueOf()),d.update(b.model.feed.author.id,b.model.workout.id,c).then(function(){c.showMap&&(b.model.workout.showMap=a)})},b.setMapPrivacy=function(a){var c={showMap:a.valueOf()};return d.update(b.model.feed.author.id,b.model.workout.id,c)}}return{restrict:"E",templateUrl:"tpl://ui/feed/types/eoFeedWorkout.en.html",scope:{feed:"=model"},link:h}}angular.module("endo.ui.feed").directive("eoFeedWorkout",a),a.$inject=["$http","user","api.feed.FeedResource","api.workout.WorkoutResource","ui.map.StaticMap","api.workout.RecordEnum","urlBuilder"]}(),function(){angular.module("endo.ui.form").factory("ui.form.FormDecorator",["$q","core.lang.string",function(a,b){function c(a){return!!(angular.isObject(a.config)&&angular.isFunction(a.headers)&&angular.isObject(a.data)&&angular.isNumber(a.status))}function d(a){var c={};return angular.forEach(a,function(a){if(angular.isObject(a)){var d=a.params;2==a.type&&angular.isArray(d)&&d.length&&angular.forEach(d,function(d){d=b.camelCase(d),angular.isArray(c[d])||(c[d]=[]),c[d].push({code:a.code,message:a.message})})}}),c}return{decorate:function(b){angular.isFunction(b.prototype.$$$fields)||(b.prototype.$$$fields=function(){var a=[];return angular.forEach(this,function(b,c){"$"!==c[0]&&a.push(b)}),a}),angular.isFunction(b.prototype.$$$validate)||(b.prototype.$$$validate=function(){if(this.$valid)return!0;var a=this.$$$fields();return angular.forEach(a,function(a){angular.isFunction(a.$$$revalidate)&&a.$$$revalidate(),a.$$$revalidated=!0}),!1}),angular.isFunction(b.prototype.$$$revalidate)||(b.prototype.$$$revalidate=function(b){function e(a){if(angular.isObject(a)&&(c(a)&&(a=a.data),angular.isArray(a.errors))){var b=d(a.errors),e=!1;f.$$$invalidRemote=!1;var g=f.$$$fields();angular.forEach(g,function(a){a.$$$invalidRemote=!1,b[a.$name]&&(a.$$$invalidRemote=e=!0,a.$setValidity("remote",!1),angular.isArray(a.$$$remoteMessages)||(a.$$$remoteMessages=[]),a.$$$remoteMessages=a.$$$remoteMessages.concat(b[a.$name]))}),f.$$$invalidRemote=e,f.$$$revalidated=!0,f.$$$validate()}}var f=this;a.when(b).then(e,e)})}}}])}(),function(){function a(a){function b(a,b,c,d){function e(){var a=b.val();d.$pristine&&f!==a&&d.$setViewValue(a)}var f=b.val();a.$on("autofill:update",e)}return{require:"ngModel",link:b}}a.$inject=["$timeout"],angular.module("endo.ui.form").directive("eoAutoFill",a)}(),function(){angular.module("endo.ui.form").directive("eoControl",["$q","$document","$compile","$timeout","$position","core.dom.transition","ui.form.FormDecorator",function(a,b,c,d,e,f,g){function h(a){var b=a.split("-");return b[b.length-1]}var i='<span class="icon-error form-control-feedback" style="display:none;"></span>',j=['<span class="validator-tooltip">','<span class="validator-tooltip-content"></span>','<span class="validator-tooltip-arrow"></span>',"</span>"].join("");return{restrict:"A",priority:100,require:"^form",compile:function(a,b){function c(){a.addClass("d-control"),o.addClass("form-control"),o.attr("name",m),o.attr("id")||o.attr("id",m)}function d(){angular.forEach(a.find("validator"),function(a){var b=a.innerHTML.trim();angular.forEach(a.attributes,function(c){var d=a.getAttribute("key")||h(c.name);o.attr(c.name,c.value),n[d]=b}),a.parentNode.removeChild(a)})}function e(){k=angular.element(i),l=angular.element(j),o.after(k),k.after(l)}var k,l,m=b.eoControl,n={},o=a.find("input").eq(0);return c(),d(),e(),function(a,b,c,d){function e(a){return angular.element(b[0].querySelector(a))}function h(){var a,b=[];u.$error.remote&&u.$$$remoteMessages.length?a=u.$$$remoteMessages[0].message:(angular.forEach(u.$error,function(a,c){a===!0&&b.push(u.$$$errorMessages[c])}),a=b[0]),t.children().eq(0).html(a)}function i(){t.css({opacity:1,display:""})}function j(){t.css({opacity:.5,display:"none"})}function k(){b.addClass("has-feedback").addClass("has-error"),s.css({display:""})}function l(){b.removeClass("has-feedback").removeClass("has-error"),s.css({display:"none"})}function m(a){return u.$valid?(l(),void j()):void((v||x)&&(k(),w?i():j(),a&&f(b,function(){b.addClass("shake").addClass("animated--fast")},{animation:!0}).then(function(){b.removeClass("shake").removeClass("animated--fast")})))}function o(){v=!0,w=!1,m()}function p(){w=!0,m()}function q(){a.$apply(function(){u.$error.remote&&(u.$setValidity("remote",!0),u.$$$remoteMessages.length=0)})}var r=b.find("input").eq(0),s=e(".form-control-feedback"),t=e(".validator-tooltip"),u=r.controller("ngModel"),v=!1,w=!1,x=!1;u.$$$errorMessages=n,u.$$$remoteMessages=[],u.$$$revalidate=function(){x=!0,h(),m(!0)},g.decorate(d.constructor),r.on("blur",o),r.on("focus",p),r.on("input",q),a.$watchCollection(function(){return u.$error},function(a){m(),u.$invalid&&h()}),a.$on("$destroy",function(){r.off("blur",o),r.off("focus",p),r.off("input",q)})}}}}])}(),function(){angular.module("endo.ui.form").directive("eoValidate",[function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){function e(b){return angular.isString(b)?void a.$watch(b,function(){angular.forEach(g,function(a){a(d.$modelValue)})}):angular.isArray(b)?void angular.forEach(b,function(b){a.$watch(b,function(){angular.forEach(g,function(a){a(d.$modelValue)})})}):void(angular.isObject(b)&&angular.forEach(b,function(b,c){angular.isString(b)&&a.$watch(b,function(){g[c](d.$modelValue)}),angular.isArray(b)&&angular.forEach(b,function(b){a.$watch(b,function(){g[c](d.$modelValue)})})}))}var f,g={},h=a.$eval(c.eoValidate);h&&(angular.isString(h)&&(h={validator:h}),angular.forEach(h,function(b,c){f=function(e){var f=a.$eval(b,{$value:e});return angular.isObject(f)&&angular.isFunction(f.then)?(f.then(function(){d.$setValidity(c,!0)},function(){d.$setValidity(c,!1)}),e):f?(d.$setValidity(c,!0),e):(d.$setValidity(c,!1),e)},g[c]=f,d.$formatters.push(f),d.$parsers.push(f)}),c.eoValidateWatch&&e(a.$eval(c.eoValidateWatch)))}}}])}(),function(){angular.module("endo.ui.form").directive("form",["ui.form.FormDecorator","core.dom.transition",function(a,b){return{restrict:"E",priority:100,require:"form",link:function(b,c,d,e){a.decorate(e.constructor)}}}])}(),function(){angular.module("endo.ui.form").directive("datepickerPopup",function(){return{restrict:"EAC",require:"ngModel",link:function(a,b,c,d){d.$formatters.shift()}}})}(),function(){function a(){var a=this;a.handleClick=function(){a.disabled||a.pending||a.onClick()}}var b='\n    <button\n      class="eoButton"\n      ng-class="{\'eoButton--block\': $ctrl.block, \'eoButton--disabled\': $ctrl.disabled, \'eoButton--pending\': $ctrl.pending}"\n      ng-click="$ctrl.handleClick()"\n    >\n      <span ng-class="{\'eoButton-label--pending\': $ctrl.pending}" ng-transclude></span>\n      <div ng-if="$ctrl.pending">\n        <spinner class="eoButton-spinner" size="22" color="\'#fff\'"></spinner>\n      </div>\n    </button>\n  ';angular.module("endo.ui.form").component("eoButton",{template:b,controller:a,bindings:{pending:"<",disabled:"<",block:"<",onClick:"&"},transclude:!0})}(),function(){function a(){var a=null;this.open=function(b){a&&a!==b&&(a.isOpen=!1),b.isOpen=!0,a=b},this.close=function(b){a===b&&(b.isOpen=!1,a=null)}}function b(a){function b(a){a.datepickerOptions={formatYear:"yy",startingDay:1,showWeeks:!1}}function c(b,c,d,e){c[0].querySelector("input");b.isOpen=!1,b.toggle=function(a){b[b.isOpen?"close":"open"](a)},b.open=function(c){a.open(b)},b.close=function(c){a.close(b)},b.reset=function(a){a.preventDefault(),a.stopPropagation(),b.date=void 0},b.hasDate=function(){return angular.isDate(b.date)},b.$watch("date",function(a){e.$setViewValue(a)}),e.$render=function(){b.date=e.$viewValue}}var d=['<div class="eoDateInput">','<div class="eoDateInput-reset" ng-click="reset($event)" ng-show="hasDate()">','<span class="icon-false"></span>',"</div>",'<div class="input-group">',"<input",' type="text"',' class="form-control eoDateInput-input"',' placeholder="YYYY-MM-DD"',' ng-model="date"'," datepicker-popup",' datepicker-options="datepickerOptions"',' is-open="isOpen"',' show-button-bar="false"',' on-open-focus="false"',' ng-focus="open($event)"'," ng-class=\"{ 'eoDateInput-input--reset': hasDate() }\"",">",'<span class="input-group-addon eoIconAddon" ng-click="toggle($event)">','<span class="icon-calendar"></span>',"</span>","</div>","</div>"].join("");return{require:"ngModel",restrict:"E",template:d,scope:{},link:{pre:b,post:c}}}b.$inject=["dateInputService"],angular.module("endo.ui.form").service("dateInputService",a).directive("eoDateInput",b)}(),function(){function a(a){var b=(new Date).getFullYear()-30;return{require:"ngModel",scope:{placeholder:"@",required:"@"},template:'<select class="form-control" name="day" ng-required="required" ng-model="model.value" ng-change="updateDay()" ng-options="day.number as (day.date | date:\'dd\') for day in days"><option ng-show="placeholder" value="" label="{{placeholder}}"></option></select>',link:function(c,d,e,f){function g(d){c.days=[];for(var e=d?d.getFullYear():b,f=d?d.getMonth():0,g=d?a.days.lastOfMonth(d):31,h=1;g>=h;h++)c.days.push({number:h,date:new Date(e,f,h)})}c.model={},c.days=[],f.$render=function(){c.model.value=f.$modelValue?f.$modelValue.getDate():null,g(f.$modelValue)},c.updateDay=function(){if(isNaN(c.model.value))return void f.$setViewValue(null);var a=f.$modelValue||new Date(b,0,1);f.$setViewValue(new Date(a.getFullYear(),a.getMonth(),c.model.value))}}}}a.$inject=["core.lang.date"],angular.module("endo.ui.form").directive("eoDayPicker",a)}(),function(){angular.module("endo.ui.form").directive("eoDistanceInput",["common.unit.UNITS","core.regexp",function(a,b){return{require:"ngModel",restrict:"A",link:function(c,d,e,f){var g=a.getViewerDistanceUnit(),h=a.getViewerUnitSystem(),i=a.distance.METRIC.kilometers.name;e.eoDistanceInput!==a.distance.METRIC.centimeters.name&&e.eoDistanceInput!==a.distance.METRIC.meters.name&&e.eoDistanceInput!==a.distance.METRIC.kilometers.name||(g=a.getViewerDistanceUnit(e.eoDistanceInput),i=e.eoDistanceInput),f.$formatters.push(function(b){if(!b)return b;var c=a.convertDistance(b,i,a.METRIC,h);return parseFloat(c.toFixed(2))}),f.$parsers.push(function(c){if(void 0===c||""===c)return"";if(!b.FLOAT.test(c))return c;var d=a.convertDistance(c,g,h,a.METRIC);return parseFloat(d)})}}}])}(),function(){function a(a,b){function c(c,d,e,f){f.$formatters.push(function(c){if(angular.isNumber(c)){var d=b(c,b.HOURS),e=d.getHours(),f=d.getMinutes();if(e||f)return e+":"+a.zeroPad(f)}}),f.$parsers.push(function(a){if(""===a)return null;var b=/^(\d+):([0-5]?[0-9])$/,c=b.exec(a);if(null!==c){var d=Number(c[1]),e=Number(c[2]),f=3600*d+60*e;return f}})}return{restrict:"A",require:"ngModel",link:c}}angular.module("endo.ui.form").constant("durationInputConfig",{readonlyInput:!1,mousewheel:!0}).controller("DurationInputController",["$scope","$log","$attrs","core.math.duration","durationInputConfig",function(a,b,c,d,e){function f(a){return angular.isDefined(a)&&a.toString().length<2?"0"+a:a}function g(a){h(),n.$setViewValue(m.getSecondsTotal()),i(a)}function h(){n.$setValidity("duration",!0),a.invalidHours=!1,a.invalidMinutes=!1,a.invalidSeconds=!1}function i(b){var c=m.getHours(),d=m.getMinutes(),e=m.getSeconds();a.hours="h"===b?c:f(c),a.minutes="m"===b?d:f(d),a.seconds="s"===b?e:f(e)}function j(){var b=parseInt(a.hours,10);if(!(isNaN(b)||0>b))return b}function k(){var b=parseInt(a.minutes,10);if(!(isNaN(b)||0>b||b>59))return b}function l(){var b=parseInt(a.seconds,10);if(!(isNaN(b)||0>b||b>59))return b}var m=d(0,d.HOURS),n={$setViewValue:angular.noop};this.init=function(b,d){n=b,n.$render=this.render;var f=d.eq(0),g=d.eq(1),h=d.eq(2);a.readonlyInput=angular.isDefined(c.readonlyInput)?a.$parent.$eval(c.readonlyInput):e.readonlyInput,this.setupInputEvents(f,g,h)},this.render=function(){var a=parseFloat(n.$modelValue,10);isNaN(a)?(n.$setValidity("duration",!1),b.error('eoDurationInput directive: "ng-model" value must be a number')):(m=d(a,d.HOURS),h(),i())},this.setupInputEvents=function(b,c,d){if(a.readonlyInput)return a.updateHours=angular.noop,void(a.updateMinutes=angular.noop);var e=function(b,c,d){n.$setViewValue(null),n.$setValidity("duration",!1),angular.isDefined(b)&&(a.invalidHours=b),angular.isDefined(c)&&(a.invalidMinutes=c),angular.isDefined(d)&&(a.invalidSeconds=d)};a.updateHours=function(){var a=j();angular.isDefined(a)?(m.setHours(a),g("h")):e(!0)},b.bind("blur",function(b){!a.invalidHours&&a.hours<10&&a.$apply(function(){a.hours=f(a.hours)})}),a.updateMinutes=function(){var a=k();angular.isDefined(a)?(m.setMinutes(a),g("m")):e(void 0,!0)},c.bind("blur",function(b){!a.invalidMinutes&&a.minutes<10&&a.$apply(function(){a.minutes=f(a.minutes)})}),a.updateSeconds=function(){var a=l();angular.isDefined(a)?(m.setSeconds(a),g("s")):e(void 0,void 0,!0)},d.bind("blur",function(b){!a.invalidSeconds&&a.seconds<10&&a.$apply(function(){a.seconds=f(a.seconds)})})}}]).directive("eoDurationInput",function(){return{require:["eoDurationInput","?^ngModel"],restrict:"E",replace:!0,scope:{},controller:"DurationInputController",templateUrl:"tpl://ui/form/input/eoDurationInput.html",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f,b.find("input"))}}}).directive("eoDurationInput",a),a.$inject=["core.lang.number","core.math.duration"]}(),function(){function a(a,e,f,g,h,i){function j(b,h,i,j){function m(){return i.unitSystem?i.unitSystem===f.METRIC:a.locale.isMetric()}function n(a,c){b.isMetric=m()}function o(){var a=b.model.inches+12*b.model.feet,c=g(a).inches.toCentimeters();b.model.centimeters=c}function p(){var a=g(b.model.centimeters).centimeters.toInches();b.model.feet=Math.floor(a/12),b.model.inches=Math.round(a%12,1),12===b.model.inches&&(b.model.inches=11)}if(b.isMetric=m(),e.subscribe(a.EVENTS.UNITS_CHANGE,n),i.$observe("unitSystem",function(a){return b.isMetric=m()}),b.system={METRIC:f.METRIC,IMPERIAL:f.IMPERIAL},b.isMetric){var q=h[0].querySelector(".js-centimeter-input");l.forEach(function(a){i[a]&&q.setAttribute(a,i[a])})}b.model={},b.labels={cm:k("distance.METRIC.centimeters.short"),ft:k("distance.IMPERIAL.feet.short"),"in":k("distance.IMPERIAL.inches.short")},b.feetIncrements=[1,2,3,4,5,6,7,8],b.inchIncrements=[0,1,2,3,4,5,6,7,8,9,10,11],b.minHeight=c,b.maxHeight=d,j.$render=function(){isNaN(j.$modelValue)||(b.model.centimeters=j.$modelValue,p())},b.updateMetric=o,b.updateImperial=p,b.$watch("model.centimeters",function(a,c){j.$setViewValue(b.model.centimeters)}),b.$on("$destroy",function(){e.unsubscribe(a.EVENTS.UNITS_CHANGE,n)})}var k=i.require("common/units/units.i18n.json"),l=["min","max","required"];return{template:b,require:"ngModel",scope:{name:"@"},link:j}}var b=["<div>",'<div class="" ng-show="!isMetric">','<div class="row">','<div class="col-xs-6 half-gutter-right">','<div class="input-group">','<select class="form-control" ng-options="incr for incr in feetIncrements" ng-model="model.feet" name="feet" ng-change="updateMetric()"></select>','<span class="input-group-addon eoUnitLabel" id="centimetersUnit">{{ ::labels.ft }}</span>',"</div>","</div>",'<div class="col-xs-6 half-gutter-left">','<div class="input-group">','<select class="form-control" ng-options="incr for incr in inchIncrements" ng-model="model.inches" name="inches" ng-change="updateMetric()"></select>','<span class="input-group-addon eoUnitLabel" id="centimetersUnit">{{ ::labels.in }}</span>',"</div>","</div>","</div>","</div>",'<div class="input-group" ng-show="isMetric">','<input class="form-control js-centimeter-input" ng-model="model.centimeters" name="{{name}}" type="number" min="{{minHeight}}" max="{{maxHeight}}" aria-describedby="centimetersUnit" ng-change="updateImperial()">','<span class="input-group-addon eoUnitLabel" id="centimetersUnit">{{ ::labels.cm }}</span>',"<div>","</div>"].join(""),c=56,d=272;a.$inject=["viewer","core.event.topic","common.unit.UNITS","core.math.conversion.distance","core.math","common.i18n.Translation"],angular.module("endo.ui.form").directive("eoHeightInput",a)}(),function(){function a(){var a=(new Date).getFullYear()-30;return{require:"ngModel",scope:{placeholder:"@",required:"@"},template:'<select class="form-control" name="month" ng-model="model.value" ng-required="required" ng-change="updateMonth()" ng-options="month.number as (month.date | date:\'MMM\') for month in months"><option ng-show="placeholder" value="" label="{{placeholder}}"></option></select>',link:function(b,c,d,e){b.model={},b.months=[],e.$render=function(){b.model.value=e.$modelValue?e.$modelValue.getMonth():null};for(var f=0;12>f;f++)b.months.push({date:new Date(a,f,1),number:f});b.updateMonth=function(){if(isNaN(b.model.value))return void e.$setViewValue(null);var c=e.$modelValue||new Date(a,0,1);e.$setViewValue(new Date(c.getFullYear(),b.model.value,c.getDate()))}}}}angular.module("endo.ui.form").directive("eoMonthPicker",a)}(),function(){function a(a,b){function c(c,d,e,f){e.$observe("required",function(a){c.required=!!a}),c.sports=a.filter(function(a){return!a.isHPB}).map(function(a){return{id:a.valueOf(),title:b.getTitle(a)}}),c.$watch("sportId",function(b){return b||0===b?void f.$setViewValue(a.get(b)):void f.$setViewValue(null)}),f.$render=function(){return a.is(f.$viewValue)?void(c.sportId=f.$viewValue.valueOf()):void(c.sportId=void 0)}}var d=['<div class="eoSportInput">',"<select",' class="form-control"'," ng-class=\"{ 'eoSportInput-select--null': sportId == undefined }\"",' ng-options="item.id as item.title for item in sports"',' ng-model="sportId"',">",'<option value="" ng-hide="required">{{ nullOptionTitle }}</option>',"</select>","</div>"].join("");return{require:"ngModel",restrict:"E",template:d,scope:{nullOptionTitle:"="},link:c}}a.$inject=["api.workout.SportEnum","common.data.SportTranslate"],angular.module("endo.ui.form").directive("eoSportInput",a)}(),function(){function a(){return{require:"ngModel",scope:{id:"@"},template:['<input  class="form-control eoToggle" id="{{:: id}}" type="checkbox" ng-model="model.value" ng-change="update()">','<label for="{{:: id}}"></label>'].join(""),link:function(a,b,c,d){a.model={},b.removeAttr("id"),d.$render=function(){return void 0===d.$modelValue||null===d.$modelValue?void(a.model.value=null):void(a.model.value=d.$modelValue)},a.update=function(){void 0!==d.$modelValue&&null!==d.$modelValue&&d.$setViewValue(a.model.value)}}}}angular.module("endo.ui.form").directive("eoToggle",a)}(),function(){function a(a,b,c,d,e){return{require:"ngModel",restrict:"A",link:function(f,g,h,i){function j(a,b){h.unitSystem||k(b)}function k(a){n=a,g.val(l(i.$modelValue))}function l(a){return a?n===c.METRIC?parseFloat(a.toFixed(2)):parseFloat(d(a).kilograms.toPounds().toFixed(1)):a}function m(a){return a&&e.FLOAT.test(a)?n===c.METRIC?parseFloat(a):d(a).pounds.toKilograms():a}var n=h.unitSystem||c.getViewerUnitSystem();b.subscribe(a.EVENTS.UNITS_CHANGE,j);var o=!0;h.$observe("unitSystem",function(a){return o?void(o=!1):(a=a||c.getViewerUnitSystem(),void k(a))}),i.$formatters.push(l),i.$parsers.push(m),f.$on("$destroy",function(){b.unsubscribe(a.EVENTS.UNITS_CHANGE,j)})}}}a.$inject=["viewer","core.event.topic","common.unit.UNITS","core.math.conversion.unitConvert","core.regexp"],angular.module("endo.ui.form").directive("eoWeightInput",a)}(),function(){function a(){var a=2007,b=(new Date).getFullYear()-30;return{require:"ngModel",scope:{startYear:"=?",endYear:"=?",placeholder:"@",required:"@"},template:'<select class="form-control" name="year" ng-model="model.value" ng-required="required" ng-change="updateYears()" ng-options="year for year in years | orderBy:year:true"><option ng-show="placeholder" value="" label="{{placeholder}}"></option></select>',link:function(c,d,e,f){function g(a){var b=c.years[c.years.length-1];if(!(b>=a))for(var d=b+1;a>=d;d++)c.years.push(d)}c.model={},c.years=[],f.$render=function(){c.model.value=f.$modelValue?f.$modelValue.getFullYear():null,g(c.model.value)},c.startYear=c.startYear||a,c.endYear=c.endYear||(new Date).getFullYear();for(var h=c.startYear;h<=c.endYear;h++)c.years.push(h);c.updateYears=function(){if(isNaN(c.model.value))return void f.$setViewValue(null);var a=f.$modelValue||new Date(b,0,1);f.$setViewValue(new Date(c.model.value,a.getMonth(),a.getDate()))}}}}angular.module("endo.ui.form").directive("eoYearPicker",a)}(),function(){var a="<div class=\"radioComponent\" ng-class=\"{ 'radioComponent--checked': $ctrl.checked, 'radioComponent--disabled': $ctrl.disabled }\"></div>";angular.module("endo.ui.form").component("radio",{template:a,bindings:{checked:"<",disabled:"<"
}})}(),function(){function a(a){var b=this,c={enable:function(){b.disabled=!1},disable:function(){b.disabled=!0},toggle:function(){b.value=!b.value}};b.$onInit=function(){b.id=b.id||a()},b.change=function(){b.onUpdate({$name:b.name,$value:b.value,$control:c})}}var b='\n    <input\n      class="form-control eoToggle"\n      type="checkbox"\n      id="{{:: $ctrl.id }}"\n      ng-model="$ctrl.value"\n      ng-change="$ctrl.change()"\n      ng-disabled="$ctrl.disabled"\n    >\n    <label for="{{:: $ctrl.id }}"></label>\n  ';a.$inject=["core.util.uuid"];var c={template:["$element",function(a){return a.removeAttr("id"),b}],controller:a,bindings:{name:"@",id:"@",value:"<",disabled:"<",onUpdate:"&"}};angular.module("endo.ui.form").component("toggle",c)}(),function(){angular.module("endo.ui.form").directive("ngModel",["core.dom.transition",function(a){return{retrict:"A",priority:100,require:"ngModel",link:function(b,c,d,e){function f(){b.$apply(function(){e.$error.remote&&(e.$setValidity("remote",!0),e.$$$remoteMessages.length=0)})}e&&(b.$watch(function(){return e.$$$revalidated},function(b){b&&e.$invalid?a(c,function(){c.addClass("shake").addClass("animated--fast"),c.addClass("force-feedback")},{animation:!0}).then(function(){c.removeClass("shake").removeClass("animated--fast"),e.$$$revalidated=!1}):e.$$$revalidated=!1}),c.on("input",f))}}}])}(),function(){angular.module("endo.ui.form.validation").directive("eoFloatValidator",["core.regexp",function(a){return{require:"ngModel",restrict:"A",link:function(b,c,d,e){e.$validators.float=function(b,c){return e.$isEmpty(b)?!0:!!a.FLOAT.test(c)}}}}])}(),function(){function a(a,b,c,d,e){function f(b,f,h){b.xs={},b.sm={},b.$watch("workout.id",function(f){if(f){var h=b.workout,i=c(h.startTime);b.xs.superscript=i,h.distance?b.xs.text=a.substitute(g("distanceInDuration"),{duration:e(h.duration),distance:d(h.distance)}):b.xs.text=e(h.duration),h.title?(b.sm.text=h.title,h.route?b.sm.superscript=a.substitute(g("dateFollowingRoute"),{date:i,route:h.route.name}):b.sm.superscript=i):(b.sm.text=i,h.route?b.sm.superscript=a.substitute(g("followingRoute"),{route:h.route.name}):b.superscriptless=!0)}})}var g,h="tpl://ui/grid/eoWorkoutCell.en.html";return{restrict:"E",templateUrl:h,scope:{workout:"=model"},compile:function(){return g=b.require(h),f}}}a.$inject=["core.lang.string","common.i18n.Translation","dateFilter","distanceFilter","durationFilter"],angular.module("endo.ui").directive("eoWorkoutCell",a)}(),function(){angular.module("endo.ui").directive("eoHeroFixed",["$rootScope","$window","$document","core.dom.viewport","core.dom.geometry",function(a,b,c,d,e){return{link:function(f,g,h){function i(){var a=angular.element("<div></div>")[0];k[0].parentNode.insertBefore(a,k[0]);var b=e.getClipRect(a);return a.parentNode.removeChild(a),b}function j(){var a=d.getSize().height,b=i().top;g.css("height",a-b+"px"),g.css("top",b+"px"),l.css("marginTop",a-b+"px")}var k=angular.element(c[0].querySelector(".js-main")),l=angular.element(c[0].querySelector(h.eoHeroFixed));angular.element(b).on("resize",j),j();var m=a.$on("layout",function(a,b){"hero"===b&&j()});f.$on("$destroy",function(){angular.element(b).off("resize",j),m()})}}}])}(),function(){angular.module("endo.ui").directive("eoHeroStatic",["$rootScope","$window","$document","core.dom.viewport","core.dom.geometry",function(a,b,c,d,e){return{link:function(f,g,h){function i(){var a=angular.element("<div></div>")[0];k[0].parentNode.insertBefore(a,k[0]);var b=e.getClipRect(a);return a.parentNode.removeChild(a),b}function j(){var a=d.getSize().height,b=i().top;g.css("height",a-b+"px")}var k=angular.element(c[0].querySelector(".js-main"));angular.element(b).on("resize",j),j();var l=a.$on("layout",function(a,b){"hero"===b&&j()});f.$on("$destroy",function(){angular.element(b).off("resize",j),l()})}}}])}(),function(){function a(a,b,c,d,e,f){function g(b){var d=this,g=[],h=void 0;d.resize=function(){var d=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];if(h){var e=h.position(),g={height:e.height+"px"},i={top:-e.top+"px"};return d?a.all([c.animate(b.rootElement,{},g),c.animate(b.innerElement,{},i)]):a.all([f(b.rootElement,g,{noTransition:!0}),f(b.innerElement,i,{noTransition:!0})])}},d.select=function(a){e(function(){var b=g[a];if(b){var c=angular.isDefined(h);h=b,g.forEach(function(b){return b.visible(b===g[a])}),d.resize(c).then(function(){return h.onSelect()})}},0)},d.addPane=function(a){return g.push(a)}}function h(a,b,c,e){function f(){e.resize()}var g=b[0].querySelector(".eoPaneSet"),h=b[0].querySelector(".eoPaneSet-inner");a.rootElement=angular.element(g),a.innerElement=angular.element(h),a.$watch("pane",function(a){return e.select(a)}),d.addEventListener("resize",f),a.$on("$destroy",function(){d.removeEventListener("resize",f)})}var i='\n      <div class="eoPaneSet">\n        <div class="eoPaneSet-inner">\n          <ng-transclude/>\n        </div>\n      </div>\n    ';return g.$inject=["$scope"],{restrict:"E",transclude:!0,require:"eoPaneSet",template:i,scope:{pane:"="},controller:g,link:h}}function b(a){function b(b,c,d,e){b.position=function(){return a.position(c)},b.visible=function(a){return c.css({visibility:a?"visible":"hidden"})},e.addPane(b)}return{restrict:"E",require:"^eoPaneSet",scope:{onSelect:"&"},link:b}}a.$inject=["$q","$position","$animate","$window","$timeout","core.dom.transition"],b.$inject=["$position"],angular.module("endo.ui").directive("eoPaneSet",a).directive("eoPane",b)}(),function(){function a(a){function b(b,c,d){var e=b.$eval(d.eoChallengeLink);e&&b.$watchCollection(d.eoChallengeLink,function(b){if(b){var d=a.buildChallengeUrl({id:b.id});c.wrap('<a href="'+d+'" target="_self"></a>')}})}return{restrict:"A",link:b}}a.$inject=["urlBuilder"],angular.module("endo.ui").directive("eoChallengeLink",a)}(),function(){function a(a){function b(b,c,d){var e=b.$eval(d.eoWorkoutLink);e&&b.$watchCollection(d.eoWorkoutLink,function(b){var d=b.id||b.workoutId,e=b.author?b.author.id:b.authorId||b.userId;if(d&&e){var f=a.buildWorkoutUrl({workoutId:d,userId:e});c.wrap('<a href="'+f+'"></a>')}})}return{restrict:"A",link:b}}a.$inject=["urlBuilder"],angular.module("endo.ui").directive("eoWorkoutLink",a)}(),function(){function a(){function a(a){if(angular.isUndefined(a))throw new Error("gmaps API object is undefined");b={};var c=20,d=20,e="/gfx/map/distance-markers-2.png",f=new a.Size(c,d);b.MAP_DEFAULTS={scrollwheel:!1,zoom:10,panControl:!1,streetViewControl:!1,mapTypeId:a.MapTypeId.ROADMAP,zoomControlOptions:{style:a.ZoomControlStyle.SMALL},styles:[{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"poi.government",stylers:[{visibility:"off"}]},{featureType:"poi.school",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]}]},b.MARKER_IMG={emptyMileIcon:{url:"/gfx/map/distance-markers.png",size:f,origin:new a.Point(40,200),anchor:new a.Point(10,10)},pathStartIcon:{url:e,size:f,origin:new a.Point(0,0),anchor:new a.Point(10,10)},pathPauseIcon:{url:e,size:f,origin:new a.Point(0,0),anchor:new a.Point(10,10)},pathResumeIcon:{url:e,size:f,origin:new a.Point(0,0),anchor:new a.Point(10,10)},pathEndIcon:{url:e,size:f,origin:new a.Point(0,0),anchor:new a.Point(10,10)},graphMarkerIcon:{url:"/gfx/map/CursorMarker.png",size:f,origin:new a.Point(0,0),anchor:new a.Point(10,10)},mileMarkerIcons:[]};var g,h,i,j,k=new a.Point(10,10);for(g=0;100>g;g++)h=parseInt(g/10),i=g%10,j=new a.Point(i*c,h*d),b.MARKER_IMG.mileMarkerIcons[g]={url:e,size:f,origin:j,anchor:k};for(g=0;100>g;g++)h=parseInt(g/10)+10,i=g%10,j=new a.Point(i*c,h*d),b.MARKER_IMG.mileMarkerIcons[10*g+100]={url:e,size:f,origin:j,anchor:k};b.PATH_WIDGET={strokeWeight:5,strokeColor:"#4385F5",strokeOpacity:1},b.MULTI_PATH_WIDGET={pathStrokeWeight:b.PATH_WIDGET.strokeWeight,pathStrokeColor:b.PATH_WIDGET.strokeColor,pathStrokeOpacity:b.PATH_WIDGET.strokeOpacity,zIndex:10},b.WORKOUT_WIDGET={pathStrokeWeight:b.PATH_WIDGET.strokeWeight,pathStrokeColor:b.PATH_WIDGET.strokeColor,pathStrokeOpacity:b.PATH_WIDGET.strokeOpacity,lapDistance:1,visible:!0},b.DISTANCE_MARKERS={lapDistance:1,markerIcon:b.MARKER_IMG.emptyMileIcon,labelClass:"distanceMarker",labelAnchor:new a.Point(5,6),markerMinZoom:11,zIndex:20},b.ROUTE_DETAILS_WIDGET={polyStrokeColor:"#4385F5",polyStrokeOpacity:1,polyStrokeWeight:3,polyVisibility:!1},b.INFO_BOX={zIndex:15,pixelOffset:new a.Size(5,-5)}}var b;return{getSettings:function(c){return angular.isUndefined(b)&&a(c),b}}}var b=angular.module("endo.ui.map");b.factory("GmapsSettingsFactory",a)}(),function(){var a=angular.module("endo.ui.map");a.directive("eoWorkoutMap",["$timeout","common.loader.maps","WorkoutWidgetFactory","GmapsSettingsFactory","common.unit.UNITS",function(a,b,c,d,e){var f=['<div class="workoutMap">','<div class="workoutMap-container" id="wokoutMapContainer"></div>','<div class="workoutMap-fullscreenToggle hidden-xs" title="Fullscreen" ng-click="toggleFullscreen()" ng-show="showFullscreenToggle && mapLoaded"></div>',"<div>"].join("");return{scope:{workout:"=",hub:"=",fullscreenToggle:"=",options:"=?"},restrict:"E",template:f,replace:!0,link:function(f,g,h){f.showFullscreenToggle=f.options?f.options.showFullscreenToggle:!0,b.then(function(b){function h(){b.event.trigger(l,"resize"),n.fitBounds()}var i=g[0].querySelector("#wokoutMapContainer"),j=d.getSettings(b),k=angular.extend({},j.MAP_DEFAULTS,f.options);k.center=new b.LatLng(-34.397,150.644);var l=new b.Map(i,k),m=e.getViewerUnitSystem().toLowerCase(),n=c.createInstance(b,l,void 0,m);window.fitMap=h,f.mapLoaded=!1,f.toggleFullscreen=function(){f.fullscreenToggle.active=!f.fullscreenToggle.active;var c=f.fullscreenToggle.active;a(function(){h(),l.setOptions({zoomControlOptions:{style:c?b.ZoomControlStyle.DEFAULT:b.ZoomControlStyle.SMALL},panControl:c,streetViewControl:c,scrollwheel:c})},100)},f.$watch("workout",function(a){if(a){if(a.showMap&&!a.showMap.isVisible(a.author))return n.setSummaryPath(null),void n.setWorkout(null);n.setSummaryPath(a.smallEncodedPolyline),a.hasLaps()&&n.setSummaryPath(null),n.setWorkout(a),n.fitBounds()}}),f.$watch("hub.point",function(a){return void 0!==a?null===a?void n.pointHighlight(null,null):void n.pointHighlight(a.latitude,a.longitude):void 0}),f.$watch("hub.lap",function(a){if(void 0!==a){if(null===a||!a.polyline)return void n.lapHighlight(null);var b=a.polyline;b=Array.isArray(b)?b:[b],n.lapHighlight(a.polyline)}}),f.$watch("hub.record",function(a){return void 0!==a?null===a?void n.lapHighlight(null):void(a.polyline&&n.lapHighlight([a.polyline])):void 0}),f.$watch("fullscreenToggle.active",function(){return a(h,500)}),b.event.addListener(l,"tilesloaded",function(){f.$apply(function(){f.mapLoaded=!0})})})}}}])}(),function(){function a(a,b){var c,d=function(d){function e(){this.set("enabled",!0),this.setValues(c.DISTANCE_MARKERS);var a=b.createInstance(d);this.set("info",a)}function f(a,b){var d=null;return d=a==b?c.MARKER_IMG.pathEndIcon:c.MARKER_IMG.mileMarkerIcons[a]}function g(a,b,c,e,g,h,i,j){var k=new d.Marker;void 0!==b&&(b.unbindAll(),b.set("map",null),d.event.clearInstanceListeners(b),b=null),k.bindTo("map",a),k.set("icon",f(i,j)),k.bindTo("visible",a,"marker_visible"),k.bindTo("zIndex",a);var l=a.get("info"),m=a,n=new d.LatLng(c.get("endLatitude"),c.get("endLongitude"));return k.set("position",n),d.event.addListener(k,"mouseover",function(){l.setContent(e/1e3,g,h/1e3),l.open(m.get("map"),k)}),d.event.addListener(k,"mouseout",function(){l.close()}),k}if(void 0===d)throw new Error("cannot instantiate object with undefined google maps API");return c=a.getSettings(d),e.prototype=new d.MVCObject,e.prototype.map_changed=function(){this.unbind("map_zoom"),this.bindTo("map_zoom",this.get("map"),"zoom")},e.prototype.workout_changed=function(){var a=this.get("markers")||[],b=this.get("workout");if(void 0!==b){var c,e;c=e=0;for(var f=b.get("laps"),h=Math.min(1e3,f.length),i=0,j=[],k=1;h>=k;k++){var l=f[k-1];c+=l.duration,e+=l.distance,i=h>99?i+l.duration:l.duration,h>99&&k%10||(a[k]=g(this,a[k],l,c,e,i,k,h),j.push(k),h>99&&k%10===0&&(i=0))}a.forEach(function(a,b){~j.indexOf(b)||(a.unbindAll(),a.set("map",null),d.event.clearInstanceListeners(a))}),this.set("markers",a)}},e.prototype.map_zoom_changed=function(){var a=this.get("map_zoom"),b=this.get("enabled");this.set("marker_visible",b&&a>this.get("markerMinZoom"))},e.prototype.enabled_changed=function(){this.set("marker_visible",this.get("enabled"))},e.prototype.getBounds=function(){var a=this.get("paths");if(void 0===a||0===a.length)return null;for(var b=new d.LatLngBounds,c=0;c<a.length;c++)b.union(a[c].getBounds());return b},new e};return{createInstance:d}}var b=angular.module("endo.ui.map");a.$inject=["GmapsSettingsFactory","InfoBoxFactory"],b.factory("DistanceMarkersFactory",a)}(),function(){function a(){}a.prototype.decodePath=function(a,b){if(void 0===a)throw new Error("google maps api undefined");return a.geometry.encoding.decodePath(b)},a.prototype.computeBounds=function(a,b){var c=b.getArray();if(0===c.length)return null;for(var d=new a.LatLngBounds,e=0;e<c.length;e++)d.extend(c[e]);return d};var b=angular.module("endo.ui.map");b.service("GmapsUtil",a)}(),function(){function a(a,b){var c=function(c){function d(){this.set("zIndex",e.INFO_BOX.zIndex)}if(void 0===c)throw new Error("cannot instantiate object with undefined google maps API");var e=b.getSettings(c),f=angular.element('<div class="map-info-window"></div>'),g=null,h=null;return d.prototype=new c.OverlayView,d.prototype.draw=function(){var a=(h.getIcon(),f[0].clientHeight);this.position=this.getProjection().fromLatLngToDivPixel(h.getPosition()),f.css("top",this.position.y-a+e.INFO_BOX.pixelOffset.height+"px"),f.css("left",this.position.x+e.INFO_BOX.pixelOffset.width+"px")},d.prototype.onAdd=function(){g=angular.element(this.getPanes().floatPane),g.append(f[0])},d.prototype.onRemove=function(){f.remove()},d.prototype.open=function(a,b){h=b,this.setMap(a)},d.prototype.close=function(){this.setMap(null)},d.prototype.setContent=function(b,c,d){var e="<div class='time'>"+a("duration")(b)+"</div><div class='lapTime'>"+a("duration")(d)+"</div><div class='distance'>"+a("distance")(c)+"</div>";f.html(e)},new d};return{createInstance:c}}var b=angular.module("endo.ui.map");a.$inject=["$filter","GmapsSettingsFactory"],b.factory("InfoBoxFactory",a)}(),function(){function a(a,b){var c,d=function(d){function e(){this.set("paths",[]),this.setValues(c.MULTI_PATH_WIDGET)}function f(a,c){var e=new b.createInstance(d,c);return e.bindTo("map",a),e.bindTo("strokeColor",a,"pathStrokeColor"),e.bindTo("strokeOpacity",a,"pathStrokeOpacity"),e.bindTo("strokeWeight",a,"pathStrokeWeight"),e.bindTo("visible",a),e.set("zIndex",a.get("zIndex")),e}if(void 0===d)throw new Error("cannot instantiate object with undefined google maps API");return c=a.getSettings(d),e.prototype=new d.MVCObject,e.prototype.tracks_changed=function(){var a=this.get("paths")||[],b=this.get("tracks");if(void 0===b)return void this.set("paths",b);for(var c=0;c<b.length;c++){var d=b[c],e=a[c];void 0===e?e=a[c]=f(this,d):e.set("path",d)}var g=a.splice(b.length,a.length-b.length);for(c=0;c<g.length;c++){var h=g[c];h.unbindAll(),h.set("map",null)}this.set("paths",a)},e.prototype.getBounds=function(){var a=this.get("paths");if(void 0===a||0===a.length)return null;for(var b=new d.LatLngBounds,c=0;c<a.length;c++){var e=a[c].getBounds();b.union(e)}return b},new e};return{createInstance:d}}var b=angular.module("endo.ui.map");a.$inject=["GmapsSettingsFactory","PathWidgetFactory"],b.factory("MultiPathWidgetFactory",a)}(),function(){function a(a,b){var c,d=function(d,e){function f(a){g.bindTo("map",this),g.bindTo("strokeColor",this),g.bindTo("strokeOpacity",this),g.bindTo("strokeWeight",this),g.bindTo("visible",this),g.bindTo("zIndex",this),this.setValues(c.PATH_WIDGET),this.set("path",a)}if(void 0===d)throw new Error("cannot instantiate object with undefined google maps API");c=a.getSettings(d),f.prototype=new d.MVCObject;var g=new d.Polyline;return f.prototype.getPolyline=function(){return g},f.prototype.path_changed=function(){var a=this.get("path");this.getPolyline().setPath(a)},f.prototype.getBounds=function(){return b.computeBounds(d,this.get("path"))},new f(e)};return{createInstance:d}}var b=angular.module("endo.ui.map");a.$inject=["GmapsSettingsFactory","GmapsUtil"],b.factory("PathWidgetFactory",a)}(),function(){function a(a){var b=function(b,c,d){function e(c){var e=[],f=[];if(this.set("has_distance",!1),this.set("has_duration",!1),!c||!c.hasLaps())return this.set("tracks",e),void this.set("laps",f);var g=c.laps[d];if(Array.isArray(g)&&0!==g.length){for(var h=0;h<g.length;h++){var i=new b.MVCObject;i.setValues(g[h]),f.push(i);var j=a.decodePath(b,g[h].smallEncodedPolyline);e.push(new b.MVCArray(j))}var k,l=g[0].beginLatitude,m=g[0].beginLongitude,n=g[g.length-1].endLatitude,o=g[g.length-1].endLongitude;void 0!==l&&void 0!==m&&(k=new b.LatLng(l,m),this.set("startLatLng",k)),void 0!==n&&void 0!==o&&(k=new b.LatLng(n,o),this.set("endLatLng",k)),this.set("laps",f),this.set("tracks",e),this.set("id",c.id)}}if(void 0===b)throw new Error("cannot instantiate object with undefined google maps API");if(void 0===c)throw new Error("cannot create instance of undefined workout object");return e.prototype=new b.MVCObject,new e(c)};return{createInstance:b}}var b=angular.module("endo.ui.map");a.$inject=["GmapsUtil"],b.factory("WorkoutMVCFactory",a)}(),function(){function a(a,b,c,d,e,f){var g,h=function(h,i,j,k){function l(a,c){this.setValues(g.WORKOUT_WIDGET),this.set("map",a),void 0!==c&&this.set("workout",e.createInstance(h,c,v)),t=b.createInstance(h),t.set("pathStrokeColor","#ff4b55"),t.set("zIndex",15),t.set("visible",!0)}function m(a){var c=b.createInstance(h);return c.bindTo("map",a),c.bindTo("tracks",a.get("workout")),c.bindTo("pathStrokeColor",a),c.bindTo("pathStrokeOpacity",a),c.bindTo("pathStrokeWeight",a),c.bindTo("visible",a),c.bindTo("zIndex",a),c}function n(a){var b=d.createInstance(h);return b.bindTo("map",a),b.bindTo("lapDistance",a),b}function o(a){var b=new h.Marker({icon:g.MARKER_IMG.pathStartIcon});return b.bindTo("map",a),b.bindTo("visible",a),b}if(void 0===h)throw new Error("cannot instantiate object with undefined google maps API");g=a.getSettings(h),l.prototype=new h.MVCObject;var p=null,q=null,r=null,s=null,t=null,u=null,v=k;return l.prototype.setWorkout=function(a){this.set("workout",e.createInstance(h,a,v))},l.prototype.getLapMarkers=function(){return null===r&&(r=n(this)),r},l.prototype.workout_changed=function(){var a=this.get("workout");null===p?p=m(this):(p.unbind("tracks"),p.bindTo("tracks",a)),null===q&&(q=o(this)),q.set("position",a.get("startLatLng")),this.getLapMarkers().set("workout",a),null===s&&(s=o(this)),s.set("position",a.get("endLatLng"))},l.prototype.setLapMarkersEnabled=function(a){getLapMarkers().set("enabled",a)},l.prototype.getBounds=function(){return null!==p?p.getBounds():null},l.prototype.fitBounds=function(){var a=this.getBounds();a=null===a&&null!==u?u.getBounds():a,null!==a&&this.get("map").fitBounds(a)},l.prototype.pointHighlight=function(a,b){var c=this.get("highlightPoint");return null===a&&c?(c.unbindAll(),c.setMap(null),void this.set("highlightPoint",null)):(c||(c=new h.Marker({icon:g.MARKER_IMG.graphMarkerIcon}),c.bindTo("map",this),c.bindTo("visible",this)),c.set("position",new h.LatLng(a,b)),void this.set("highlightPoint",c))},l.prototype.lapHighlight=function(a){if(void 0===a||null===a)return t.unbindAll(),void t.set("map",null);for(var b=[],c=0;c<a.length;c++)b.push(f.decodePath(h,a[c]));t.set("tracks",b),t.bindTo("map",this)},l.prototype.setSummaryPath=function(a){if(u&&(u.unbindAll(),u.set("map",null)),a){var b=new h.MVCArray(f.decodePath(h,a));u?u.set("path",b):u=c.createInstance(h,b),u.bindTo("map",this),u.bindTo("visible",this)}},new l(i,j)};return{createInstance:h}}var b=angular.module("endo.ui.map");a.$inject=["GmapsSettingsFactory","MultiPathWidgetFactory","PathWidgetFactory","DistanceMarkersFactory","WorkoutMVCFactory","GmapsUtil"],b.factory("WorkoutWidgetFactory",a)}(),function(){function a(a,b){function c(b,c,e,f){var g=a.getBreakpointName();g=g&&"lg"!==g?g:"md";var h=d[g];return e=e||h.width,f=f||h.height,b=encodeURIComponent(b),c=encodeURIComponent(c),"/map/?polyline="+b+"&hash="+c+"&width="+e+"&height="+f}var d={xs:{width:705,height:154},sm:{width:308,height:154},md:{width:276,height:138}};return{getMapUrl:c}}a.$inject=["core.dom.media","$urlMatcherFactory"];var b=angular.module("endo.ui.map");b.factory("ui.map.StaticMap",a)}(),function(){function a(a){function b(b,c,d,e){function f(f){f.preventDefault(),a.cancel(e.closePromise),c.hasClass("disabled")||d.disabled||e.isOpen()||b.$apply(function(){e.toggle(!0)})}function g(b){b.preventDefault(),a.cancel(e.closePromise),c.hasClass("disabled")||d.disabled||(e.closePromise=a(function(){e.isOpen()&&e.toggle(!1)},100))}e&&(e.closePromise=null,c.bind("mouseenter",f),c.bind("mouseleave",g),b.$on("$destroy",function(){c.unbind("mouseenter",f),c.unbind("mouseleave",g)}))}return{restrict:"A",require:"^?dropdown",link:b}}a.$inject=["$timeout"],angular.module("endo.ui").directive("eoDropdownHover",a)}(),function(){function a(a,b){function c(c,d,e,f){function g(b){b.preventDefault(),a.cancel(f.closePromise),d.hasClass("disabled")||e.disabled||c.$apply(function(){f.toggle()})}if(f&&b){f.closePromise=null;var h=b(d[0]);h.on("tap",g),c.$on("$destroy",function(){h.off("tap",g),h=null})}}return{restrict:"A",require:"^?dropdown",link:c}}a.$inject=["$timeout","common.vendor.hammer"],angular.module("endo.ui").directive("eoDropdownTap",a)}(),function(){function a(a,b,c){function f(a,b){a.close=b.close,a.dismiss=b.dismiss}function g(a,g,h){var i=c.$new(!0);return i.templateUrl=a,i.TYPE_ALERT=d,i.TYPE_CONFIRM=e,i.type=g,b.open({scope:i,template:"<eo-msgbox></eo-msgbox>",controller:f,backdrop:g===d?!0:"static",size:"sm",windowClass:h})}function h(b,c){var e=a.defer();return g(b,d,c).result.finally(e.resolve),e.promise}function i(b,c){var d=a.defer();return g(b,e,c).result.then(d.resolve).catch(d.reject),d.promise}function j(a){return b.open({templateUrl:a,controller:["$scope","$modalInstance",function(a,b){a.resolve=function(){b.close()},a.reject=function(){b.dismiss()}}],backdrop:"static",size:"sm"}).result}return f.$inject=["$scope","$modalInstance"],{alert:h,confirm:i,open:j}}function b(a,b,c,d,e){function f(f,g,h){function i(a){var c=b("<div>"+a+"</div>")(f);j.empty(),j.append(c)}var j=angular.element(g[0].querySelector(".modal-body"));f.$watch("templateUrl",function(b){var g=d.get(e(b));return g?(i(g),void f.$applyAsync("templateLoaded = true")):(i("<eo-progress-indicator/>"),void c(b).then(function(b){a(function(){i(b),f.templateLoaded=!0},0)}))})}var g=["<div class=\"msgBox\" ng-class=\"{ 'msgBox-alert':type == TYPE_ALERT, 'msgBox-confirm':type == TYPE_CONFIRM}\">",'<div class="modal-header" ng-show="templateLoaded">','<h3 class="modal-title">',"{{ title }}","</h3>","</div>",'<div class="modal-body msgBox-content">',"</div>",'<div class="modal-footer msgBox-footer" ng-show="templateLoaded">','<div ng-if="type == TYPE_ALERT">','<button class="button button-default msgBox-button" ng-click="close()">',"{{ resolveButton }}",'<span class="icon-success" ng-if="!resolveButton"></span>',"</button>","</div>",'<div ng-if="type == TYPE_CONFIRM">','<div class="msgBox-footer-leading">','<button class="button button-muted button-block msgBox-button" ng-click="dismiss()">',"{{ rejectButton }}",'<span class="icon-error" ng-if="!rejectButton"></span>',"</button>","</div>",'<div class="msgBox-footer-trailing">','<button class="button button-default button-block msgBox-button" ng-click="close()">',"{{ resolveButton }}",'<span class="icon-success" ng-if="!resolveButton"></span>',"</button>","</div>","</div>","</div>","</div>"].join("");return{restrict:"E",template:g,link:f}}function c(){function a(a,b,c){a.title=c.title,(c.button||c.buttonResolve)&&(a.resolveButton=c.button||c.buttonResolve),c.buttonReject&&(a.rejectButton=c.buttonReject)}return{restrict:"E",link:a}}var d=0,e=1;a.$inject=["$q","$modal","$rootScope"],b.$inject=["$timeout","$compile","$templateRequest","$templateCache","common.asset.templateUrl"],angular.module("endo.ui").factory("ui.MsgBox",a).directive("eoMsgbox",b).directive("eoMsgboxOptions",c)}(),function(){function a(a,b,c,d){function e(b){switch(b.which){case 39:a.$apply(i);break;case 37:a.$apply(j);break;case 38:a.$apply(i);break;case 40:a.$apply(j)}}var f=d.imageIndex,g=d.imageUrls;a.imageLoadingInProgress=!1,a.imageCount=g.length,a.allowNavigate=g.length>1;var h=function(){a.imageLoadingInProgress=!0,a.currentImageUrl=d.imageUrls[f].url,a.currentIndex=f+1};a.imageOnLoad=function(b){a.imageLoadingInProgress=!1},h();var i=a.next=function(){a.allowNavigate&&(f<g.length-1?f++:f=0,h())},j=a.prev=function(){a.allowNavigate&&(f>0?f--:f=g.length-1,h())};a.dismiss=function(){b.dismiss()},c.bind("keydown",e),a.$on("$destroy",function(){c.unbind("keydown",e)})}a.$inject=["$scope","$modalInstance","$document","params"],angular.module("endo.ui.picture").controller("ImageLightBoxController",a)}(),function(){function a(a,b,c){function d(d,f){var g=a.defer();if(angular.isUndefined(d))throw new Error('Cannot open ImageLightBox without "imageUrls" as a parameter!');return(angular.isUndefined(f)||0>f||f>d.length-1)&&(f=0),e=b.open({templateUrl:c("tpl://ui/picture/ImageLightBox.html"),controller:"ImageLightBoxController",backdrop:!0,resolve:{params:function(){return{imageUrls:d,imageIndex:f}}},windowClass:"imageLightBox-window"}),e.result.then(function(){g.resolve()}).catch(function(){g.reject()}),g.promise}var e=null;return{open:function(a,b){return d(a,b)}}}a.$inject=["$q","$modal","common.asset.templateUrl"],angular.module("endo.ui.picture").factory("ImageLightBox",a)}(),function(){function a(a,c,d,e,f,g){function h(h,i,j){var k,l=c();i.attr("id",l);var m=g.search();if(!b.some(function(a){return angular.isDefined(m[""+a])})){var n=[],o=e.getForDateOfBirth(a.dateOfBirth),p=f.get(a.gender);o!==e.ALL&&n.push({key:"age_group",value:o.name}),p!==f.UNSPECIFIED&&n.push({key:"gender",value:p.toString().toLowerCase()}),d.cmd.push(function(){k=d.defineSlot(h.path,h.size,l),k.addService(d.pubads()),h.args&&angular.forEach(h.args,function(a,b){k.setTargeting(b,a)}),n.forEach(function(a){k.setTargeting(a.key,a.value)}),d.pubads().collapseEmptyDivs(!0),d.pubads().enableSingleRequest(),d.enableServices(),d.display(l)}),d.cmd.push(function(){d.pubads().refresh([k])})}}return{restrict:"E",scope:{path:"=",size:"=",args:"="},link:h}}var b=["email"];a.$inject=["user","core.util.uuid","common.vendor.GooglePublisherTag","model.uacf.AgeGroupEnum","model.user.GenderEnum","$location"],angular.module("endo.ui.picture").directive("eoAd",a)}(),function(){function a(a){var b=['<div class="eoAvatar-wrapper" ng-class="::avatarSize">','<img class="eoAvatar-image" ng-class="::{ beneath : showBackground }" ng-src="{{ ::picUrl }}"></img>','<div class="eoAvatar-premiumBadge" ng-show="::hasBadge"></div>',"</div>"].join(""),c='<a class="eoAvatar-link" target="_self" ng-href="{{ ::href }}"></a>';return{restrict:"EA",scope:{user:"=",includeLink:"@",avatarSize:"@",showBadge:"@"},template:b,compile:function(b,d){var e="true"===d.includeLink||"::true"===d.includeLink;if(e){var f=angular.element(c);b.children().wrap(f)}return function(b,c,d){b.hasBadge="true"===b.showBadge||void 0===b.showBadge;var e=b.$watch("user",function(c){c&&(b.picUrl=c?c.avatarUrl||(c.picture||{}).url:void 0,b.showBackground=angular.isUndefined(b.picUrl),b.hasBadge=b.hasBadge&&c&&(c.premium||c.isPremium),b.href=a.buildProfileUrl({id:b.user.id}),e())})}}}}a.$inject=["urlBuilder"],angular.module("endo.ui.picture").directive("eoAvatar",a)}(),function(){function a(a){var b=this;b.$onChanges=function(c){c.user&&(b.getUrl=b.user.picture.url,b.putUrl=a.profilePictureUrl(b.user.id))},b.onUpload=function(a){b.inProgress=!0},b._onSuccess=function(a){b.getUrl=a.data.url,b.onSuccess({response:a})},b._onError=function(a){b.onError({response:a})},b.onComplete=function(a){b.inProgress=!1}}var b=['<div class="eoAvatarUploader">','<div class="eoAvatarUploader-background"></div>','<img class="eoAvatarUploader-image" ng-src="{{ $ctrl.getUrl }}">',"<div",' class="eoAvatarUploader-upload button-upload"'," upload-button",' method="PUT"',' url="{{ $ctrl.putUrl }}"',' on-upload="$ctrl.onUpload(files)"',' on-success="$ctrl._onSuccess(response)"',' on-error="$ctrl._onError(response)"',' on-complete="$ctrl.onComplete(response)"',"></div>",'<div eo-round-progress-button="$ctrl.inProgress">','<div class="eoAvatarUploader-progress"></div>',"</div>","</div>"].join("");a.$inject=["api.user.UserResource"];var c={template:b,controller:a,bindings:{user:"<",placeholder:"@",onSuccess:"&",onError:"&"}};angular.module("endo.ui.picture").component("eoAvatarUploader",c)}(),function(){angular.module("endo.ui").directive("eoPictureTiles",["ImageLightBox",function(a){return{templateUrl:"tpl://ui/picture/eoPictureTiles.html",restrict:"AE",scope:{pictures:"="},link:function(b,c,d){b.$watchCollection("pictures",function(c){b.images=c,b.imgs5up=b.images.length>5,b.imgs1st5=b.images.slice(0,5),b.openImageLightBox=function(b){a.open(c,b)}})},replace:!0,transclude:!0}}])}(),function(){function a(a){function b(b,c,d,e){function f(b){h&&c.removeClass(h.icon),h=a.get(b),c.addClass(h.icon),c.css({backgroundColor:h.color})}function g(a){a?parseInt(a)==a&&(a+="px"):a="auto",c.css({fontSize:a})}var h=void 0,i=e?"$parent.sport":"sport";b.$watch(i,f),d.$observe("size",g)}return{restrict:"E",require:"?eoSportIconTooltip",scope:{sport:"="},link:b}}function b(a,b,c){function d(d,e,f){e.attr("tooltip","{{ tooltip }}"),e.attr("tooltip-animation","false"),e.attr("tooltip-append-to-body","true"),e.removeAttr("eo-sport-icon-tooltip"),a(e)(d),d.$watch("sport",function(a){void 0!==a&&(a=b.get(a),d.tooltip=c.getTitle(a))})}return{restrict:"A",priority:100,terminal:!0,scope:{sport:"="},controller:angular.noop,link:d}}a.$inject=["api.workout.SportEnum"],b.$inject=["$compile","api.workout.SportEnum","common.data.SportTranslate"],angular.module("endo.ui.picture").directive("eoSportIcon",a).directive("eoSportIconTooltip",b)}(),function(){var a=angular.module("endo.ui.picture");a.directive("eoThumbnail",function(){var a=['<a class="thumbnail-link" href="{{ thumbnailLink }}">','<img class="thumbnail-image" ng-src="{{ pictureUrl }}"></img>',"</a>"].join("");return{replace:!0,restrict:"E",scope:{pictureUrl:"@",thumbnailLink:"@"},template:a}})}(),function(){function a(a,b,c,d,e){function f(a,b){this.isVisible=!1,this.options=angular.extend({},i,b),this.scope=this.options.scope||e.$new(!0),this.element=angular.element(h);var f=d(a)(this.scope);this.containerNode=this.element[0].querySelector(".js-popover-container"),this.containerNode.appendChild(f[0]),this.options.appendTo.appendChild(this.element[0]),this.resizeHandler=this.resizeHandler.bind(this),this.options.handleWindowResize&&c.addEventListener("resize",this.resizeHandler)}function g(a){var b=this.containerNode.querySelectorAll("svg *");Array.prototype.slice.call(b).forEach(function(b){b.setAttribute("visibility",a)})}var h=['<div class="popover bottom uiPopover">','<div class="arrow"></div>','<div class="js-popover-container uiPopover-container"></div>',"</div>"].join(""),i={appendTo:b[0].body,offsetTop:0,offsetLeft:0,handleWindowResize:!1};return f.prototype.resizeHandler=function(){this.isVisible&&this.position()},f.prototype.position=function(){var b=a.positionElements(this.targetElement,this.element,"bottom",!0),c=this.options.offsetTop+b.top+"px",d=this.options.offsetLeft+b.left+"px",e={top:c,left:d};return this.element.css(e),this},f.prototype.show=function(a){a=a||this.targetElement,this.targetElement=a,this.position(),this.element.css({visibility:"visible"}),g.call(this,"visible"),this.isVisible=!0},f.prototype.hide=function(){this.element.css({visibility:"hidden"}),g.call(this,"hidden"),this.isVisible=!1;
},f.prototype.destroy=function(){c.removeEventListener("resize",this.resizeHandler),this.element.remove()},f}a.$inject=["$position","$document","$window","$compile","$rootScope"],angular.module("endo.ui").factory("ui.Popover",a)}(),function(){function a(a,b,c,d){function e(b){return g=a.open({template:h,backdrop:!0,keyboard:!0,windowClass:"eoPopup",resolve:{model:function(){return b}},controller:["$scope","model","$modalInstance",function(a,b,c){a.model=b,a.dismiss=function(){return c.dismiss()}}]}),g.result.finally(function(){c.markAsSeen(d.id,b.id)}),g.result}function f(){return c.getPromotions(d.id).then(function(a){return a&&a.length?e(a[0]):null})}var g=void 0,h='\n        <div class="eoPopup-inner">\n          <div class="eoPopup-close" ng-click="dismiss()">\n            <i class="icon icon-close"></i>\n          </div>\n          <img ng-src="{{ ::model.imageUrl }}">\n          <a class="eoPopup-link" ng-href="{{ ::model.buttonLinkUrl }}" alt="" target="_self"></a>\n        </div>\n    ';return{tryToOpen:f}}a.$inject=["$modal","common.asset.templateUrl","api.PromoResource","user"],angular.module("endo.ui").factory("ui.PopoupDialog",a)}(),function(){var a=angular.module("endo.ui.progress");a.directive("eoProgressBar",["$interval","core.dom.transition","ui.progress.incrementer",function(a,b,c){var d=['<div class="d-progressBar">','<div class="d-progressBar-bar">','<div class="d-progressBar-peg"></div>',"</div>","<div>"].join("");return{scope:{},replace:!0,template:d,controller:["$scope","ui.progress.progressBar",function(a,b){a.api=b,a.$watch("api.state",function(){if(angular.isObject(a.api.state)){var b=a.api.state;if(b.id===a.id)switch(b.action){case"start":a.start();break;case"end":a.end()}}})}],link:function(d,e,f){function g(){n!==l&&(n=l,h(0,!0),b(e,{opacity:1},{noTransition:!0}),j=a(function(){h(c(m))},250))}function h(a,c){var d=b(o,{width:100*a+"%"},{noTransition:c});return m=a,d}function i(){n!==k&&(n=k,a.cancel(j),h(1).then(function(){e.css({opacity:0})}))}var j,k="idle",l="progress",m=0,n=k,o=angular.element(e[0].querySelector(".d-progressBar-bar"));d.id=f.eoProgressBar,d.start=g,d.end=i}}}]),a.factory("ui.progress.progressBar",[function(){function a(a){this.state={id:a,action:"start"}}function b(a){this.state={id:a,action:"end"}}return{state:null,start:a,end:b}}])}(),function(){var a=angular.module("endo.ui.progress");a.directive("eoProgressButton",["$interval","$timeout","$document","$window","core.dom.transition","ui.progress.incrementer",function(a,b,c,d,e,f){function g(a,b){var c=d.getComputedStyle(a[0],null),e=["paddingTop","paddingBottom","paddingLeft","paddingRight","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth"];e.forEach(function(a){b[0].style[a]=c[a]})}function h(a){return"button-progress-state-"+a}function i(a){var b,c,d;this.isInitialized=!1,this.element=a,this._html=a.html(),Object.defineProperty(this,"state",{get:function(){return b},set:function(a){if(~j.indexOf(a)){this.element.removeClass(h(b)).addClass(h(a));var c=~[m,n].indexOf(b)&&this.message;this.messageNode.css("visibility",c?"hidden":"visible"),a===k?this.enable():this.disable(),b=a}}}),Object.defineProperty(this,"progress",{get:function(){return c},set:function(a){a=function(a){return isNaN(a)||0>a?0:a>1?1:a}(Number(a)),e(this.barNode,{width:100*a+"%"},{noTransition:0===a}),c=a}}),Object.defineProperty(this,"message",{get:function(){return d},set:function(a){d=a,this.isInitialized&&(d?(this.messageNode.html(d),this.element.addClass(p)):(this.messageNode.html(""),this.element.removeClass(p)))}})}var j=["idle","progress","success","error","message"],k="idle",l="progress",m="success",n="error",o="button-progress",p="button-progress-state-message";return i.prototype.create=function(){if(!this.isInitialized){this.element.addClass(o);var a=this.element.css("position");for("static"!==a&&""!==a&&"undefined"!=typeof a||this.element.css("position","relative"),this.root=angular.element('<span class="button-progress-root"></span>'),this.contentNode=angular.element('<span class="button-progress-content"></span>'),g(this.element,this.contentNode);this.element[0].firstChild;)this.contentNode.append(this.element[0].removeChild(this.element[0].firstChild));this.root.append(this.contentNode),this.placeholderNode=angular.element('<span class="button-progress-placeholder"></span>'),this.placeholderNode.html(this._html),this.element.append(this.placeholderNode),this.barNode=angular.element('<span class="button-progress-bar"></span>'),this.root.append(this.barNode),this.successNode=angular.element('<span class="button-progress-success"><span class="icon icon-success"></span></span>'),g(this.element,this.successNode),this.root.append(this.successNode),this.errorNode=angular.element('<span class="button-progress-error"><span class="icon icon-error"></span></span>'),g(this.element,this.errorNode),this.root.append(this.errorNode),this.messageNode=angular.element('<span class="button-progress-message">'+this.message+"</span>"),g(this.element,this.messageNode),this.root.append(this.messageNode),this.element.append(this.root),this.isInitialized=!0,this.state=this.state||"idle",this.progress=this.progress||0,this.message=this.message||""}},i.prototype.destroy=function(){if(this.isInitialized){for(var a=c[0].createDocumentFragment();this.contentNode[0].firstChild;)a.appendChild(this.contentNode[0].removeChild(this.contentNode[0].firstChild));this.element.empty(),this.element.append(a),this.element.removeClass(o),j.forEach(function(a){this.element.removeClass(h(a))},this),this.isInitialized=!1}},i.prototype.start=function(){if(this.create(),this.state!==l){this.state=l;var b=this;this._promise=a(function(){b.progress=f(b.progress)},250,100)}},i.prototype._stop=function(c,d){if(this.state===l&&this._promise){a.cancel(this._promise),this._promise=null;var f,g=this;e(this.barNode,function(){g.progress=1}).then(function(){e(d,function(){g.state=c,g.progress=0}).then(function(){f=b(function(){e(g.contentNode,function(){g.state=k}).then(function(){g.destroy()})},2e3)})})}},i.prototype.resolve=function(){this._stop(m,this.successNode)},i.prototype.reject=function(){this._stop(n,this.errorNode)},i.prototype.enable=function(){this.root[0].removeAttribute("disabled"),this.element[0].removeAttribute("disabled")},i.prototype.disable=function(){this.root[0].setAttribute("disabled",""),this.element[0].setAttribute("disabled","")},{link:function(a,b,c){var d=a.$eval(c.eoProgressButton);if(!angular.isUndefined(d)){var e=new i(b);a.$watchCollection(c.eoProgressButton,function(a){a.promise&&a.promise.then&&(a.message&&(e.message=a.message),e.start(),a.promise.then(function(){e.resolve()}).catch(function(){e.reject()}))})}}}}])}(),function(){var a=angular.module("endo.ui.progress");a.factory("ui.progress.incrementer",[function(){function a(a){var b=0;return a>=0&&.25>a?b=(3*Math.random()+3)/100:a>=.25&&.65>a?b=3*Math.random()/100:a>=.65&&.9>a?b=2*Math.random()/100:a>=.9&&.99>a&&(b=.005),a+b}return a}])}(),function(){angular.module("endo.ui.progress").directive("eoProgressIndicator",[function(){var a=['<div class="d-progressIndicator">','<div class="d-progressIndicator-bounce1"></div>','<div class="d-progressIndicator-bounce2"></div>','<div class="d-progressIndicator-bounce3"></div>',"</div>"].join("");return{template:a}}])}(),function(){function a(a,c,d){var e=this,f=a(angular.element(b))(d.$new(!0));e.$onInit=function(){c[0].body.appendChild(f[0])},e.$onDestroy=function(){f[0].parentNode.removeChild(f[0])}}var b=['<div class="progressOverlay">','<div class="progressOverlay-progress">',"<eo-progress-indicator></eo-progress-indicator>","</div>","</div>"].join("");a.$inject=["$compile","$document","$rootScope"],angular.module("endo.ui.progress").component("progressOverlay",{template:"<div></div>",controller:a})}(),function(){function a(a,b,c,d,e,f,g,h){function i(i,j,k){function l(a){function b(){u.style.strokeDashoffset=w*(1-q)}if(a!==q)return q=a,0===q||1===q?g("browser-ie")?(b(),c(angular.noop,250)):e(v,b,{noTransition:0===q}):(b(),q)}function m(){function a(){i.progressVisible=!0,o||(o=d(function(){q>=1&&(d.cancel(o),o=null),l(h(q))},250))}var b=f.get(i.eoOptions,"delay")||0;b>0?p=c(a,b):a()}function n(){p&&(c.cancel(p),p=null),o&&(d.cancel(o),o=null,a.when(l(1)).finally(function(){i.progressVisible=!1,l(0)}))}var o,p,q,r=j[0],s=r.querySelector(".js-transclude").children[0],t=r.querySelector(".js-progress"),u=r.querySelector(".js-path"),v=angular.element(u),w=u.getTotalLength();if(u.style.strokeDasharray=w,l(0),f.get(i.eoOptions,"handleColor")!==!1){var x=b.getComputedStyle(s,null),y=x.getPropertyValue("border-color");y||(y=x.getPropertyValue("border-top-color")),u.style.stroke=y}i.progressVisible=!1,i.$watch("eoRoundProgressButton",function(a){if(null!==r.offsetParent){if("number"==typeof a)return i.progressVisible=!0,void l(a);a===!0&&m(),a===!1&&n()}}),i.$watch("progressVisible",function(a){t.style.display=a?"block":"none"})}var j=['<div class="eoRoundProgressButton">','<div class="eoRoundProgressButton-inner" ng-class="progressVisible ? eoOptions.progressClass : \'\'">','<div class="js-transclude" ng-transclude></div>','<div class="js-progress">','<svg class="eoRoundProgressButton-svg" viewBox="0 0 28 28" preserveAspectRatio="xMinYMin meet">','<path class="eoRoundProgressButton-progressBar js-path" d="M 14 14 m 0 -12 a 12,12 0 0,1 0,24 a -12,-12, 0 0,1 0,-24"/>',"</svg>","</div>","</div>","</div>"].join("");return{restrict:"A",template:j,transclude:!0,replace:!0,scope:{eoRoundProgressButton:"=",eoOptions:"="},link:i}}a.$inject=["$q","$window","$timeout","$interval","core.dom.transition","core.lang.object","core.has","ui.progress.incrementer"],angular.module("endo.ui.progress").directive("eoRoundProgressButton",a)}(),function(){function a(){var a=this;a.$onInit=function(){a.size=a.size||18,a.color=a.color||"#000"}}var b=["<div class=\"privacyIcon\" ng-style=\"{width: $ctrl.size, height: $ctrl.size, display: 'inline-block', verticalAlign: 'text-bottom'}\">",'<svg xmlns="http://www.w3.org/2000/svg" ng-attr-width="{{$ctrl.size}}" ng-attr-height="{{$ctrl.size}}" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">','<rect x="0" y="0" width="100" height="100" fill="none" />','<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(0 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="0s" repeatCount="indefinite" />',"</rect>",'<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(30 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="0.125s" repeatCount="indefinite" />',"</rect>",'<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(60 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="0.25s" repeatCount="indefinite" />',"</rect>",'<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(90 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="0.375s" repeatCount="indefinite" />',"</rect>",'<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(120 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="0.5s" repeatCount="indefinite" />',"</rect>",'<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(150 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="0.625s" repeatCount="indefinite" />',"</rect>",'<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(180 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="0.75s" repeatCount="indefinite" />',"</rect>",'<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(210 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="0.875s" repeatCount="indefinite" />',"</rect>",'<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(240 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="1s" repeatCount="indefinite" />',"</rect>",'<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(270 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="1.125s" repeatCount="indefinite" />',"</rect>",'<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(300 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="1.25s" repeatCount="indefinite" />',"</rect>",'<rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" ng-attr-fill="{{$ctrl.color}}" transform="rotate(330 50 50) translate(0 -30)">','<animate attributeName="opacity" from="1" to="0" dur="1.5s" begin="1.375s" repeatCount="indefinite" />',"</rect>","</svg>","<div>"].join("");angular.module("endo.ui.progress").component("spinner",{template:b,controller:a,bindings:{size:"<",color:"<"}})}(),function(){angular.module("endo.ui.social.buttons").directive("eoCommentButton",["user",function(a){var b=['<div class="eoCommentButton" ng-class="{  commented : feed.commentByMe }" >','<i class="icon-comment"></i>',"</div>"].join("");return{scope:{feed:"="},restrict:"E",template:b,replace:!0}}])}(),function(){angular.module("endo.ui.social.buttons").directive("eoFriendshipButton",["$timeout","user","api.user.UserResource",function(a,b,c){return{scope:{user:"=",onSuccess:"&"},restrict:"E",templateUrl:"tpl://ui/social/buttons/eoFriendshipButton.en.html",replace:!0,link:function(d,e,f){d.isVisible=!b.isGuest()&&1===d.user.viewerFriendship&&d.user.id!==b.id,d.addFriend=function(){d.user.friendshipPromise=c.befriend(d.user).then(function(b){a(function(){d.user.viewerFriendship=2,d.isVisible=!1,d.onSuccess&&"function"==typeof d.onSuccess&&d.onSuccess()},1e3)})}}}}])}(),function(){angular.module("endo.ui.social.buttons").directive("eoLikeButton",["api.feed.FeedResource",function(a){var b=['<div class="eoLikeButton" ng-class="{ liked : feed.likeByMe, disabled : !feed.canLike }" ng-click="likeOrUnlike()">','<i class="icon-like"></i>',"</div>"].join("");return{scope:{feed:"=model"},restrict:"E",template:b,replace:!0,link:function(b,c,d){b.likeOrUnlike=function(){!angular.isUndefined(b.feed.canLike)&&b.feed.canLike&&(b.feed.likeByMe?a.dislike(b.feed):a.like(b.feed))}}}}])}(),function(){function a(a,b,c,d,e,f,g){a.users=c,a.title=f,a.more=d-c.length,a.viewer=e,a.dismiss=function(){b.dismiss()},a.loadMore=function(){"function"==typeof g&&g().then(function(){a.more=d-c.length})}}a.$inject=["$scope","$modalInstance","userList","totalCount","user","dialogTitle","onLoadMore"],angular.module("endo.ui.social").controller("PeopleDialogController",a)}(),function(){function a(a,b,c,d){function e(c,e,g,h){var i=a.defer();if(angular.isUndefined(c))throw new Error('Cannot open PeopleDialog without "userList" as a parameter');return f=b.open({templateUrl:d("tpl://ui/social/dialogs/PeopleDialog.en.html"),controller:"PeopleDialogController",backdrop:!0,windowClass:"peopleDialog-window",backdropClass:"peopleDialog-modal-backdrop",resolve:{userList:function(){return c},totalCount:function(){return e},dialogTitle:function(){return g},onLoadMore:function(){return h}}}),f.result.then(function(){i.resolve()}).catch(function(){i.reject()}),i.promise}var f=null;return{open:function(a,b,c,d){return e(a,b,c,d)}}}a.$inject=["$q","$modal","user","common.asset.templateUrl"],angular.module("endo.ui.social").factory("PeopleDialog",a)}(),function(){function a(a,b){function c(){return d?void 0:(d=a.open({templateUrl:b("tpl://ui/social/dialogs/TwitterConnection.en.html"),controller:["$scope","$modalInstance",function(a,b){a.dismiss=function(){b.dismiss()}}]}),d.result.finally(function(){d=null}),d.result)}var d=null;return{open:c}}a.$inject=["$modal","common.asset.templateUrl"],angular.module("endo.ui.social").factory("ui.social.TwitterConnectionDialog",a)}(),function(){angular.module("endo.ui.social").directive("eoComments",["user","view.auth.AuthDialog","api.feed.FeedResource",function(a,b,c){var d=10;return{scope:{feed:"=model"},restrict:"E",replace:!0,templateUrl:"tpl://ui/social/eoComments.en.html",link:function(e,f,g){e.user=a,e.comm={text:""},e.more=0;var h=0;e.$watchCollection("feed.comments",function(a){angular.isUndefined(a)||(h=a.length,e.more=e.feed.commentsCount?e.feed.commentsCount-h:0,e.more=e.more<d?e.more:d)}),e.postComment=function(a,b){b&&b.preventDefault(),!a.$invalid&&e.comm.text&&(c.postComment(e.feed,e.comm.text),e.comm.text="")},e.loadMore=function(){c.listComments(e.feed,h,d)},e.login=function(){b.login().then(function(a){})},e.deleteComment=function(a){c.deleteComment(e.feed,a)}}}}])}(),function(){function a(a){return a.startsWith("#")?a.slice(1,a.length):a}var b,c=6;angular.module("endo.ui.social").directive("eoHashtags",["api.workout.WorkoutResource","api.user.UserResource",function(d,e){return{scope:{tags:"=",workout:"=",edit:"=?"},restrict:"E",templateUrl:"tpl://ui/social/eoHashtags.en.html",replace:!0,link:function(f,g,h){function i(a,b){function d(a,b){return b&&b.length<=1?a.startsWith(b):~a.indexOf(b)}var e=0;return a.filter(function(f){return b=angular.lowercase(b),a=angular.lowercase(a),d(f,b)&&++e<=c})}f.edit=angular.isUndefined(f.edit)?!0:f.edit,f.tags=f.tags||[],f.addTag=function(b){return b.name=a(b.name),angular.isUndefined(f.workout)?!1:(d.postHashtag(f.workout,b.name).then(function(a){},function(a){for(var c,d=0;d<f.tags.length&&!c;d++)c=f.tags[d].name===b.name;return c&&f.tags.splice(d-1,1),!1}),!0)},f.removeTag=function(a){return angular.isUndefined(f.workout)?!1:(d.deleteHashtag(f.workout,a.name).then(function(a){return!0},function(b){for(var c,d=0;d<f.tags.length&&!c;d++)c=f.tags[d].name===a.name;c||f.tags.splice(0,0,a)}),!0)},f.searchTags=function(a){return b?i(b,a):e.listWorkoutHashtags(f.workout.author).then(function(c){return b=c,i(b,a)})}}}}])}(),function(){angular.module("endo.ui.social").directive("eoLikes",["common.i18n.Translation","user","PeopleDialog","api.feed.FeedResource","urlBuilder",function(a,b,c,d,e){var f,g=10,h="tpl://ui/social/eoLikes.en.html";return{scope:{feed:"=model"},restrict:"E",replace:!0,templateUrl:h,link:function(i,j,k){function l(){return d.listLikes(i.feed,i.feed.likes.length,g)}f=a.require(h),i.$watchCollection("feed.likes",function(a){if(!angular.isUndefined(a)){if(0===i.feed.likeCount)return void(i.mode="NONE");i.feed.likeByMe?1===i.feed.likeCount?i.mode="ME":i.mode="MEANDOTHERS":b.isGuest()?i.mode="PEOPLE":1===i.feed.likeCount?i.mode="USER":i.mode="USERANDOTHERS",i.user1=a[0]}}),i.wrapHtml=function(a,b){if("user"===b){var c=e.buildProfileUrl({id:a.id});return"<a href="+c+' target="_self">'+a.name+"</a>"}return'<b class="eoLikes-clickable">'+a+"</b>"},i.openUsersDialog=function(a){(!a.target||"A"!==a.target.nodeName&&"a"!==a.target.nodeName)&&c.open(i.feed.likes,i.feed.likeCount,f("dialogTitle"),l)}}}}])}(),function(){angular.module("endo.ui.social").directive("eoPeptalks",["api.feed.FeedResource",function(a){var b=10;return{scope:{feed:"=model"},restrict:"E",replace:!0,templateUrl:"tpl://ui/social/eoPeptalks.en.html",link:function(c,d,e){c.more=0;var f=0;c.$watchCollection("feed.peptalks",function(a){angular.isUndefined(a)||(f=a.length,c.more=c.feed.peptalksCount-c.feed.peptalks.length,c.more=c.more<b?c.more:b)}),c.loadMore=function(){a.listPeptalks(c.feed,f,b)}}}}])}(),function(){function a(a,b,c){return{replace:!0,template:['<ul class="eoPrivacySwitch list-unstyled" >','<li ng-repeat="type in privacyTypes" class="eoPrivacySwitch-item" title="{{ type.title }}" ng-class="{ selected: privacy == type.privacy, disabled: type.disabled }" ng-click="setPrivacy(type.privacy)">','<i class="{{ type.privacy.icon }} eoPrivacySwitch-icon icon" ></i>',"</li>","</ul>"].join(""),scope:{privacy:"=",onChange:"&",minPrivacy:"="},link:function(d,e,f){var g=c.require("common.data.privacy");d.privacyTypes=[],d.canEdit=!0,angular.forEach(b,function(a){var b=g(a.toString(),"--");this.push({title:b,privacy:a,disabled:d.minPrivacy?a.valueOf()<d.minPrivacy.valueOf():!1})},d.privacyTypes),d.setPrivacy=function(b){d.privacy!==b&&(d.privacyTypes[b.valueOf()].disabled||a.when(d.onChange({privacy:b})).then(function(){return d.privacy=b}))},d.$watch("minPrivacy",function(a){a&&d.privacyTypes.forEach(function(b){b.disabled=b.privacy.valueOf()<a.valueOf()})})}}}a.$inject=["$q","api.PrivacyEnum","common.i18n.Translation"],angular.module("endo.ui.social").directive("eoPrivacySwitch",a)}(),function(){angular.module("endo.ui.social.links").directive("eoProfileLink",["user","urlBuilder",function(a,b){return{scope:{user:"="},restrict:"E",replace:!0,template:'<a ng-href="{{::profileUrl(user.id)}}" target="_self">{{::user.name}}</a>',link:function(a,c,d){a.profileUrl=function(a){return b.buildProfileUrl({id:a})}}}}])}(),function(){angular.module("endo.ui.social.links").directive("eoTaggedWith",["common.i18n.Translation","user","PeopleDialog","urlBuilder",function(a,b,c,d){var e,f="tpl://ui/social/links/eoTaggedWith.en.html";return{scope:{taggedUsers:"="},restrict:"E",replace:!0,templateUrl:f,link:function(g,h,i){e=a.require(f),g.$watchCollection("taggedUsers",function(a){if(!angular.isUndefined(a)){if(0===a.length)return void(g.mode="NONE");var c=a.contains(b);c?1===a.length?g.mode="ME":g.mode="MEANDOTHERS":b.isGuest()?g.mode="PEOPLE":1===a.length?g.mode="USER":g.mode="USERANDOTHERS",g.user1=a[0]}}),g.wrapHtml=function(a,b){if("user"===b){var c=a.name,e=d.buildProfileUrl(a);return"<a href="+e+' target="_self">'+c+"</a>"}return'<b class="eoLikes-clickable">'+a+"</b>"},g.openUsersDialog=function(a){(!a.target||"A"!==a.target.nodeName&&"a"!==a.target.nodeName)&&c.open(g.taggedUsers,g.taggedUsers.length,e("dialogTitle"))}}}}])}(),function(){function a(a,b,c){function d(a){return a&&a.goalType?a.goalType!==b.GOAL_CUSTOM?e("goal."+a.goalType.toString()):c(a.goalValue):"--"}var e=a.require("common.data.trainingplan");return{goalName:d}}a.$inject=["common.i18n.Translation","model.trainingplan.TrainingGoalEnum","distanceFilter"],angular.module("endo.ui.trainingplan").factory("ui.trainingplan.TrainingPlanTranslate",a)}(),function(){function a(a){function b(){return c=a.open({templateUrl:"tpl://ui/trial/MonthTrialPopup.en.html",backdrop:"static",keyboard:!0,windowClass:"MonthTrialPopup",resolve:{hasArmourFonts:["$q","common.loader.FontFaceObserver",function(a,b){var c=a.defer(),d=new b("Armour"),e=new b("Armour-Condensed");return a.all([d.load(),e.load()]).then(function(){return c.resolve(!0)}).catch(function(){return c.resolve(!1)}),c.promise}]},controller:["$scope","$state","$modalInstance","SubscriptionDialog","PremiumWelcomeDialog","hasArmourFonts",function(a,b,c,d,e,f){a.dismiss=function(){return c.dismiss()},a.premium=function(){c.dismiss(),b.go("premium")},a.subscribe=function(){c.dismiss(),d.subscribe().then(function(){return e.open()})}}]}),c.result}var c=void 0;return{open:b}}a.$inject=["$modal"],angular.module("endo.ui.trial").factory("ui.trial.MonthTrialPopup",a)}(),function(){function a(a,e,f,g,h,i){function j(a){return"user"+a.id+".popup.monthTrial.snoozedDate"}function k(){var k=a.defer();if(e.isGuest())return a.reject("isGuest");if(e.premium)return a.reject("isPremium");var l=new h(j(e)),m=d?d:l.get(),n="number"==typeof m?f.days.diff(new Date,new Date(m))<=b:!1;return n?(m&&(d=m),a.reject("isSnoozed")):c?(c=!1,g.isEligibleForFreeTrial().then(function(a){k.resolve(JSON.stringify(a)),i.open().finally(function(){l.set(Date.now()),d=null})}).catch(function(a){k.reject("isNotEligibleForTrial")}),k.promise):a.reject("shouldNotCallRestAgain")}return{execute:k}}var b=7,c=!0,d=null;a.$inject=["$q","user","core.lang.date","api.premium.plan","common.pref.IntegerPreference","ui.trial.MonthTrialPopup"],angular.module("endo.ui.trial").factory("ui.trial.MonthTrialService",a)}(),function(){function a(){function a(a,b,c){a.toggleUser=function(b){b.$checked=!b.$checked,a.onToggle&&a.onToggle(b)},a.dismissUser=function(b){a.onDismiss&&a.onDismiss({user:b}).then(function(){var c=a.users.indexOf(b);~c&&a.users.splice(c,1)})}}var b='\n      <div class="eoUserTiles">\n        <div class="eoUserTiles-inner clearfix">\n          <div class="eoUserTiles-user"\n            ng-repeat="user in users\n            | limitTo:limit track by user.id"\n            ng-click="toggleUser(user)" tooltip="{{::user.name}}" tooltip-append-to-body="::true"\n            ng-class="userClass">\n              <img class="img-responsive eoUserTiles-avatar" ng-show="::user.picture.url" ng-src="{{::user.picture.url}}">\n              <div class="eoUserTiles-user-placeholder" ng-show="::!user.picture.url"></div>\n              <span class="eoUserTiles-user-name text-center" ng-show="::!user.picture.url">{{::user.name}}</span>\n              <div class="eoUserTiles-checkbox">\n                <input class="eoCheckbox" type="checkbox" id="{{::\'tagUser\'+ $index}}" ng-model="user.$checked" disabled="true">\n                <label class="eoCheckbox-label" for="{{::\'tagUser\'+ $index}}"></label>\n              </div>\n              <a class="eoUserTiles-dismiss" ng-click="dismissUser(user)" eo-stop-click-propagation>\n                <i class="icon icon-false"></i>\n              </div>\n          </div>\n        </div>\n      </div>\n    ';return{restrict:"E",template:b,scope:{users:"=",limit:"=?",onToggle:"&",userClass:"=?",onDismiss:"&"},link:a}}angular.module("endo.ui").directive("eoUserTiles",a)}(),function(){function a(a,b,c,d,e,f,g){a.copyWorkout=function(){a.copyPromise=f.copy(e.workout).then(function(b){c(function(){a.workoutLink=d.buildWorkoutUrl({workoutId:b.id,userId:g.id})},600)})},a.dismiss=function(){b.dismiss()}}a.$inject=["$scope","$modalInstance","$timeout","urlBuilder","model","api.workout.WorkoutResource","user"],angular.module("endo.ui.workout").controller("WorkoutCopyController",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k){var l=h.require("common.data.privacy");a.fix=function(){d("os-ios")&&setTimeout(function(){window.scrollTo(document.body.scrollLeft,0)},0)},a.formData={name:"",sport:f.workout.sport.allowRoute?f.workout.sport.valueOf():j.OTHER.valueOf(),privacy:k.ONLY_ME.valueOf()},a.routeSports=j.filter(function(a){return a.allowRoute}).map(function(a){return{id:a.valueOf(),title:i.getTitle(a)}}),a.privacyTypes=[{id:k.ONLY_ME.valueOf(),title:l(k.ONLY_ME.toString())},{id:k.EVERYONE.valueOf(),title:l(k.EVERYONE.toString())}],a.createRoute=function(b){b.$$$validate()&&(a.createPromise=g.createRoute(f.workout,a.formData).then(function(b){c(function(){a.routeLink=e.buildRouteUrl({id:b.id})},600)}))},a.dismiss=function(){b.dismiss()}}a.$inject=["$scope","$modalInstance","$timeout","core.has","urlBuilder","model","api.workout.WorkoutResource","common.i18n.Translation","common.data.SportTranslate","api.workout.SportEnum","api.PrivacyEnum"],angular.module("endo.ui.workout").controller("WorkoutCreateRouteController",a)}(),function(){function a(a,b,c,d,e){a.deleteWorkout=function(){a.deletePromise=e.delete(d.workout).then(function(){b.close()})},a.dismiss=function(){b.dismiss()}}a.$inject=["$scope","$modalInstance","$timeout","model","api.workout.WorkoutResource"],angular.module("endo.ui.workout").controller("WorkoutDeleteController",a)}(),function(){function a(a,b,c,d){a.formData={format:"TCX"},a.$watch("formData.format",function(b){b&&(a.exportLink=d.getExportUrl(c.workout,b))}),a.dismiss=function(){b.dismiss()}}a.$inject=["$scope","$modalInstance","model","api.workout.WorkoutResource"],angular.module("endo.ui.workout").controller("WorkoutExportController",a)}(),function(){function a(a,b,c,d,e,f){function g(a){var b=a.getTimezoneOffset(),c=0>b?"-":"+",d=Math.floor(Math.abs(b)/60),e=Math.abs(b)%60;return c+=f.zeroPad(d)+f.zeroPad(e)}a.model=d,a.uploadUrl=c.getPictureUploadUrl(a.model.workout),a.deleteInProgress=!1,a.formData={offset:g(new Date)};var h;a.dismiss=function(){e.dismiss()},a.close=function(){e.close()},a.onUpload=function(){h=b.defer(),a.uploadPromise=h.promise},a.onUploadSuccess=function(b){if(!b.data.url)return void h.reject(b);h.resolve(b);var c={url:b.data.url,id:b.data.id||b.data.url};a.model.workout.pictures.add(c)},a.onUploadError=function(a){h.reject(a)},a.deletePicture=function(b){a.deleteInProgress||(a.deleteInProgress=!0,c.deletePicture(a.model.workout,b).finally(function(){a.deleteInProgress=!1}))}}a.$inject=["$scope","$q","api.workout.WorkoutResource","model","$modalInstance","core.lang.number"],angular.module("endo.ui.workout").controller("EditPicturesViewController",a)}(),function(){function a(a,b,c,d,e,f,g,h,i){function j(){c(function(){i.close()},1e3)}a.model=h;var k,l=500,m=3;a.search={active:!1,finished:!0,list:[]},a.taggedUsers=new g,a.$watchCollection("model.workout.taggedUsers",function(b){angular.forEach(b,function(b){b.isTagged=!0,a.taggedUsers.add(b)})}),f.getSuggestedFriends(h.workout).then(function(b){var c=b.data;angular.forEach(c,function(b){a.taggedUsers.contains(b)&&(b.isTagged=!0),a.taggedUsers.add(b)})}),a.search=function(b){return k&&c.cancel(k),!b||b.length<m?(a.search.list=[],void(a.search.active=!1)):(a.search.active=!0,a.search.finished=!1,void(k=c(function(){e.queryFriends(d,void 0,void 0,b).then(function(b){a.search.list=b,angular.forEach(a.search.list,function(b){var c=a.taggedUsers.find(b);c>-1&&a.taggedUsers[c].isTagged&&(b.isTagged=!0)}),a.search.finished=!0})},l)))},a.tagOrUntag=function(a){a.isTagged=!a.isTagged},a.tagOrUntagFromSearch=function(b){b.isTagged=!b.isTagged;var c=a.taggedUsers.find(b);0>c?a.taggedUsers.add(b):a.taggedUsers[c].isTagged=b.isTagged},a.finish=function(){var b=new g;angular.forEach(a.taggedUsers,function(a){a.isTagged&&this.push(a)},b),a.tagPromise=f.tagUsers(a.model.workout,b).then(function(a){j()})},a.dismiss=function(){i.dismiss()}}a.$inject=["$scope","$q","$timeout","user","api.user.UserResource","api.workout.WorkoutResource","model.ModelCollection","model","$modalInstance"],angular.module("endo.ui.workout").controller("TagUsersViewController",a)}(),function(){function a(a,b){function c(c){return a.open({templateUrl:b("tpl://ui/workout/edit/WorkoutEditView.en.html"),controller:"WorkoutEditController",backdrop:"static",size:"md",resolve:{model:function(){return c}}}).result}return{open:c}}a.$inject=["$modal","common.asset.templateUrl"],angular.module("endo.ui.workout").factory("ui.workout.WorkoutEditDialog",a)}(),function(){function a(a,b,c,d,e,f,g,h){function i(){b(function(){c.close()},1e3)}function j(a){var b={};return k.forEach(function(c){angular.isDefined(a[c])&&(b[c]=a[c])},b),b.startTime=a.startTime.toISOString(),a.sport==d.STEP_COUNTER&&(b.steps=Math.floor(a.steps)),b}a.STEP_COUNTER_ID=d.STEP_COUNTER.valueOf(),a.model=e,a.model.workoutCopy=e.workout.clone(),a.model.workoutCopy.sport=e.workout.sport.valueOf(),a.model.workoutCopy.updateCalories=!0,a.dateFormat="MMM d, yyyy",a.cannotClose=!1,a.datePickerToggle={open:!1},a.sports=[],a.sports=d.filter(function(a){return!a.isHPB||a===e.workout.sport}).map(function(a){return{id:a.valueOf(),title:g.getTitle(a)}}),a.dateOptions={formatYear:"yy",startingDay:1,showWeeks:!1},a.distanceUnitName=f.short.distance,a.elevationUnitName=f.short.elevation,a.hrUnitName=f.short.heartRate,a.hrMaxLabel=f.label.heartRateMax,a.hrAvgLabel=f.label.heartRateAvg,a.ascentLabel=f.label.ascent,a.descentLabel=f.label.descent,a.distanceLabel=f.label.distance,a.stepsUnitName=angular.lowercase(f.plural.steps);var k=["startTime","sport","distance","duration","ascent","descent","heartRateAvg","heartRateMax","updateCalories"];a.model.workout.adminRejected||k.push("includeInStats"),
a.openDatePicker=function(b){b.preventDefault(),b.stopPropagation(),a.datePickerToggle.open=!0},a.dismiss=function(){c.dismiss()},a.updateWorkout=function(b){if(b.$$$validate()){var c=j(a.model.workoutCopy);a.cannotClose=!0,a.updatePromise=h.update(a.model.workoutCopy.author.id,a.model.workoutCopy.id,c).then(function(a){i()}).finally(function(){a.cannotClose=!1}),b.$$$revalidate(a.updatePromise)}}}a.$inject=["$scope","$timeout","$modalInstance","api.workout.SportEnum","model","common.unit.UNITS","common.data.SportTranslate","api.workout.WorkoutResource"],angular.module("endo.ui.workout").controller("WorkoutEditController",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k){var l="tpl://ui/workout/edit/eoWorkoutEditMenu.en.html";return{scope:{model:"="},retrict:"E",replace:!0,templateUrl:l,link:function(m,n,o){function p(a,c,d){return b.open({templateUrl:i(a),controller:c,backdrop:"static",size:d||"sm",resolve:{model:function(){return m.model}}}).result}h.require(l);m.openEdit=function(){j.open(m.model).then(function(){d.publish("workout/reload")})},m.editPictures=function(){p("tpl://ui/workout/edit/EditPicturesView.en.html","EditPicturesViewController","md")},m.editTagged=function(){p("tpl://ui/workout/edit/TagUsersView.en.html","TagUsersViewController","md")},m.deleteWorkout=function(){p("tpl://ui/workout/actions/WorkoutDeleteView.en.html","WorkoutDeleteController").then(function(){var b={userId:g.id,workoutId:e.LATEST_WORKOUT_ID};a.transitionTo("top.workouts.info.byId",b,{reload:!0,location:!0})})},m.detach=function(){var a=m.model.workout.author.id,b=m.model.workout.plannedWorkoutId;b&&f.unlink(a,b).finally(function(){d.publish("workout/reload")})},m.setWorkoutPrivacy=function(a){var b={showWorkout:a.valueOf()};return a.valueOf()>m.model.workout.showMap.valueOf()&&(b.showMap=a.valueOf()),e.update(m.model.workout.author.id,m.model.workout.id,b).then(function(){b.showMap&&(m.model.workout.showMap=a)})},m.setMapPrivacy=function(a){var b={showMap:a.valueOf()};return e.update(m.model.workout.author.id,m.model.workout.id,b)},m.copyWorkout=function(){p("tpl://ui/workout/actions/WorkoutCopy.en.html","WorkoutCopyController")},m.createRoute=function(){p("tpl://ui/workout/actions/WorkoutCreateRoute.en.html","WorkoutCreateRouteController")},m.linkRoute=function(){var a=k.buildLinkRouteUrl({workoutId:m.model.workout.id});c.location=a},m.untagViewer=function(){m.model.workout.taggedUsers.clone();e.untagUser(m.model.workout,g).then(function(){m.model.workout.taggedUsers.remove(g),m.model.$viewerTagged=!1})},m.exportWorkout=function(){p("tpl://ui/workout/actions/WorkoutExportView.en.html","WorkoutExportController")}}}}a.$inject=["$state","$modal","$window","core.event.topic","api.workout.WorkoutResource","api.workout.PlannedWorkoutResource","user","common.i18n.Translation","common.asset.templateUrl","ui.workout.WorkoutEditDialog","urlBuilder"],angular.module("endo.ui.workout").directive("eoWorkoutEditMenu",a)}(),function(){function a(a){return angular.isObject(a)?isFinite(a.month)?c.MONTHLY:isFinite(a.year)?c.YEARLY:c.ALL_TIME:void 0}function b(b,c){var d=this;d.isValid=!0,d.$onInit=function(){if(!angular.isObject(d.model)||!b.get(d.model.type))return void(d.isValid=!1);var e=b.get(d.model.type);d.title=c.record(e,d.model.value),d.scope=c.scope(d.model.year,d.model.month),d.scopeClass=["monthly","yearly","allTime"][a(d.model)],d.improvement=c.improvement(e,d.model.improvement)}}var c={MONTHLY:0,YEARLY:1,ALL_TIME:2},d='\n    <div\n      class="eoRecordBanner"\n      ng-show="$ctrl.isValid"\n      ng-class="\'eoRecordBanner-\' + $ctrl.scopeClass"\n    >\n      <div class="eoRecordBanner-inner">\n        <div class="eoRecordBanner-title">\n          {{ $ctrl.title }}\n        </div>\n        <div class="eoRecordBanner-content">\n          <span class="eoRecordBanner-scope">\n            {{ $ctrl.scope }}\n          </span>\n          <span class="eoRecordBanner-separator" ng-show="$ctrl.model.improvement">&nbsp;|&nbsp;</span>\n          <span class="eoRecordBanner-improvement" ng-show="$ctrl.model.improvement">\n            {{ $ctrl.improvement }}\n          </span>\n        </div>\n      </div>\n    </div>\n  ';b.$inject=["api.workout.RecordEnum","common.i18n.RecordTranslate"];var e={template:d,controller:b,bindings:{model:"<"}};angular.module("endo.ui.workout").component("eoRecordBanner",e)}(),function(){function a(a,b,c){function d(d,e,f){function g(e){if(d.recordsBySport={},!angular.isUndefined(e)){e.filter(function(a){return c.get(a.type)}).forEach(function(c){void 0===d.recordsBySport[c.sport]&&(d.recordsBySport[c.sport]={sportTitle:b.getTitle(c.sport),records:[]}),d.recordsBySport[c.sport].records.push(c),c.label=a.label(c.type),c.valueText=a.value(c.type,c.value)});var f=[];angular.forEach(d.recordsBySport,function(a,b){f.push(a)}),d.recordsBySport=f}}d.limit=2,d.viewMore=function(){d.limit++},d.$watchCollection("user.personalBests",g)}return{scope:{user:"=model"},restrict:"E",templateUrl:"tpl://ui/workout/eoUserPersonalBests.en.html",link:d}}angular.module("endo.ui.workout").directive("eoUserPersonalBests",a),a.$inject=["common.i18n.RecordTranslate","common.data.SportTranslate","api.workout.RecordEnum"]}(),function(){angular.module("endo.ui.workout").directive("eoWorkoutHeadline",["urlBuilder","common.data.SportTranslate","core.lang.string",function(a,b,c){var d='<span class="eoWorkoutHeadline">\n          <eo-profile-link class="eoWorkoutHeadline-author" user="::workout.author"></eo-profile-link>\n          <a class="eoWorkoutHeadline-link" ng-href="{{::url}}" class="eoWorkoutHeadline-link" ng-bind-html="::content | markdown"></a>\n        </span>';return{scope:{workout:"=",owner:"="},restrict:"E",replace:!0,template:d,link:function(c,d,e){var f=c.$watch("workout",function(d){angular.isUndefined(d)||(d.author=d.author||c.owner,c.url=a.buildWorkoutUrl({userId:d.author.id,workoutId:c.workout.id}),c.content=b.getAction(d),f())})}}}])}(),function(){function a(a,b,c){function d(d,e,f){function g(){i&&i.focus&&i.focus()}function h(){i&&i.blur&&i.blur()}d.pep={text:""},d.doPeptalk=!1;var i=e[0].querySelector(".js-peptalk-input");d.$watch("model.feed",function(a){a&&(d.model.author=a.author||d.model.workout.author)});var j=d.$watch("model.workout",function(a){a&&(d.showHeadline&&(d.action=c.getAction(a,!1)),d.model.author=a.author,j())});d.closePeptalk=function(){d.pep.text||(d.doPeptalk=!1)},d.openPeptalk=function(){d.doPeptalk=!0,d.showFeedback=!1,d.animate=!0,a(g,500)},d.postPeptalk=function(c){if(c.preventDefault(),d.pep.text){var e=d.model.feed;d.doPeptalk=!1,b.postPeptalk(e,d.pep.text).then(function(){d.pep.text="",d.showFeedback=!0,a(function(){d.showFeedback=!1},4e3),h()})}}}return{link:d,templateUrl:"tpl://ui/workout/eoWorkoutLiveBanner.en.html",scope:{model:"=",showHeadline:"="}}}angular.module("endo.ui.workout").directive("eoWorkoutLiveBanner",a),a.$inject=["$timeout","api.feed.FeedResource","common.data.SportTranslate"]}(),function(){function a(a,b,c,d){function e(a,b){return 5>a?b.night:9>a?b.earlyMorning:12>a?b.morning:13>a?b.noon:17>a?b.afterNoon:21>a?b.evening:24>a?b.lateEvening:void 0}function f(f){var g=f.title,h=f.sport,i=f.localStartTime||f.startTime,j=f.distance,k=f.duration;if(g)return g;var l=b.getActivity(h);if(!l)return b.getTitle(h);var m;if(j){var n=a.convertDistance(j,a.distance.METRIC.kilometers.name,a.distance.METRIC.name,a.getViewerUnitSystem());n=n.toFixed(1),n.endsWith("0")&&(n=Number(n).toFixed(0)),m=a.append.distance(n)}else m=c(k);var o=e(i.getHours(),l);return d(o,{distanceOrTime:m})}return f}a.$inject=["common.unit.UNITS","common.data.SportTranslate","durationFilter","substituteFilter"],angular.module("endo.ui.workout").factory("ui.workout.headline",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k){function l(){c.inProgress=!0;var a={workoutId:c.selectedWorkout,plannedWorkoutId:j.id};c.savePromise=h.link(i,a).then(n).finally(o)}function m(){c.inProgress=!0,c.savePromise=h.report(i,j.id,c.reportedValue).then(n).finally(o)}function n(){e.publish("workout/reload"),b(function(){d.close()},1e3)}function o(){c.inProgress=!1}c.plannedWorkout=j,c.suggestedWorkouts=k,c.duration=g(720),c.distanceUnit=f.getViewerDistanceUnit(),c.inProgress=!1,c.save=function(){("other"==c.selectedWorkout?m:l)()},c.postpone=function(){c.inProgress=!0,c.postponePromise=h.postpone(i,j.id).then(n).finally(o)},c.skip=function(){c.inProgress=!0,c.skipPromise=h.skip(i,j.id).then(n).finally(o)},c.dismiss=function(){d.dismiss()}}a.$inject=["$q","$timeout","$scope","$modalInstance","core.event.topic","common.unit.UNITS","durationFilter","api.workout.PlannedWorkoutResource","userId","plannedWorkout","suggestedWorkouts"],angular.module("endo.ui.workout").controller("ui.workout.suggester.SuggesterDialog",a)}(),function(){function a(a,b,c){function d(a,d,e){var f={templateUrl:c("tpl://ui/workout/suggester/SuggesterDialog.en.html"),controller:"ui.workout.suggester.SuggesterDialog",resolve:{userId:function(){return a},plannedWorkout:function(){return d},suggestedWorkouts:function(){return e}}};b.open(f)}return{open:d}}a.$inject=["$q","$modal","common.asset.templateUrl"],angular.module("endo.ui.workout").factory("ui.workout.suggester.SuggesterDialog",a)}(),function(){function a(a){var b=this;b.$onInit=function(){a.require()}}var b='\n    <div class="SuggesterItem-inner">\n      <eo-sport-icon sport="$ctrl.workout.sport" size="20"></eo-sport-icon>\n      <div class="SuggesterItem-textWrapper">\n        <span>{{ $ctrl.workout.startTime | date:"MMM d" }}</span>\n        <span class="hidden-xs">{{ $ctrl.workout.startTime | date:"HH:mm" }}</span>\n        <span class="pull-right">\n          <span class="hidden-xs">\n            <span class="icon-duration SuggesterItem-icon"></span>\n            <span>{{ $ctrl.workout.duration | duration }}</span>\n          </span>\n          <span>\n            <span class="icon-distance SuggesterItem-icon"></span>\n            <span>{{ $ctrl.workout.distance | distance:2 }}</span>\n          </span>\n        </span>\n      </div>\n    </div>\n  ';a.$inject=["common.data.SportTranslate"];var c={template:b,controller:a,bindings:{workout:"<"}};angular.module("endo.ui.workout").component("suggesterItem",c)}(),function(){var a=angular.module("endo.view.about");a.controller("AboutViewController",["$scope","$modal",function(a,b){a.playVideo=function(){b.open({template:'<div class="front-video-wrapper"><iframe width="100%" height="100%" src="//www.youtube.com/embed/vnngimwuu3A?rel=0&autoplay=1" frameborder="0" allowfullscreen></iframe></div>',windowClass:"front-video",size:"lg"})},a.transformMap={},a.transformMap.email=function(a){return'<a href="mailto:media@endomondo.com">'+a+"</a>"},a.recruitingEmailLink="mailto:recruiting@endomondo.com"}])}(),function(){function a(a,b,c,d,e){function f(){var f=arguments.length<=0||void 0===arguments[0]?k:arguments[0],g=arguments.length<=1||void 0===arguments[1]?{backdrop:!0,closeable:!0}:arguments[1];if(l)return l.result;l=a.open({templateUrl:e.templateUrl,controller:"view.auth.AuthController",size:"sm",windowClass:"authDialog",backdrop:g.backdrop,resolve:{mode:function(){return f},translations:["$q","model.CountryTranslate",function(a,b){return a.all({countries:b.load()})}],consentCollection:["$q","api.auth.account","model.auth.ConsentFallbackCollection",function(a,b,c){return a(function(a,d){b.listCountries().then(function(b){return a(b)}).catch(function(){return a(new c)})})}],facebook:["common.loader.facebook",function(a){return a.load(),!0}]}});var h=['<div class="auth-progress">',"<eo-progress-indicator></eo-progress-indicator>","</div>"].join(""),i=b(angular.element(h))(d.$new(!0));c[0].body.appendChild(i[0]),l.opened.finally(function(){i[0].parentNode.removeChild(i[0])});var j=l.result;return j.finally(function(){return l=null}),j}function g(a){return f(i,a)}function h(a){return f(j,a)}var i=e.pane.LOGIN,j=e.pane.SIGNUP,k=i,l=void 0;return{MODE_LOGIN:i,MODE_SIGNUP:j,open:f,login:g,signup:h}}a.$inject=["$modal","$compile","$document","$rootScope","view.auth.locals"],angular.module("endo.view.auth").factory("view.auth.AuthDialog",a)}(),function(){function a(){var a=function(){function a(){var b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];_classCallCheck(this,a),this.append(b)}return a.prototype.set=function(a,b){return this[a]=b,this},a.prototype.get=function(a){return this[a]},a.prototype.append=function(a){return angular.extend(this,a),this},a.prototype.toObject=function(){return angular.copy(this)},a}();return a}angular.module("endo.view.auth").factory("view.auth.Params",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){var m=l.require(f.templateUrl);j.require(),a.model={consent:e},a.pane=angular.copy(f.pane),a.pane.active=c,a.countries=[],e.forEach(function(b){var c=j.name(b.countryCode);c&&a.countries.push({id:b.countryCode,label:c})});var n=d.get("locale.country.id");n&&e.findCountry(n)&&(a.countryCode=n),a.transformations={privacy:'<a href="https://account.underarmour.com/privacy" target="_blank">${text}</a>',tos:'<a href="https://account.underarmour.com/terms-and-conditions" target="_blank">${text}</a>'},a.setTitle=function(b){return a.title=b},a.toggle=function(){a.pane.active=a.pane.active===f.pane.LOGIN?f.pane.SIGNUP:f.pane.LOGIN},a.close=function(){return b.close()},a.dismiss=function(){return b.dismiss()},a.$account=new g,a.$select=function(b){return a.pane.active=b},a.$fail=function(b,c){var d=m(b);angular.isDefined(c)&&(d=h.substitute(d,c)),k.show(d,a)}}a.$inject=["$scope","$modalInstance","mode","config","consentCollection","view.auth.locals","view.auth.Params","core.lang.string","model.CountryEnum","model.CountryTranslate","ui.control.Toast","common.i18n.Translation"],angular.module("endo.view.auth").controller("view.auth.AuthController",a)}(),function(){function a(a,b,c){function d(b){a.$account.set("uaNewsletter",b).set("endomondoNewsletter",b),a.$select(c.pane.SIGNUP_CONFIRM)}a.consent=function(){return d(!0)},a.skip=function(){return d(!1)}}a.$inject=["$scope","$state","view.auth.locals"],angular.module("endo.view.auth").controller("view.auth.CanadaConsentController",a)}(),function(){function a(a,b,c,d,e,f,g,h,i){function j(a){return d(b.close,500),200===a.status?void c.go("home"):(i.trackEvent("SignupSuccess","success"),void c.go("boarding.profile",c.params))}function k(){(c.is("invite.welcome")||c.params.id)&&b.$account.append({sponsorKey:c.params.id,sponsorGroupId:c.params.group,sponsorGroupType:c.params.type})}function l(){var a=b.$account.toObject().type,c="errors.signupFail";"FACEBOOK"===a&&(c="errors.facebookSignup"),"GOOGLE"===a&&(c="errors.googleSignup"),b.$fail(c)}var m={tos:!1,uaNewsletter:!1,endomondoNewsletter:!1};b.$watch("$account.countryCode",function(a){e.requiresCanadaConsent="CA"===a,b.requiresCanadaConsent=e.requiresCanadaConsent;var c=b.model.consent.findCountry(a);return c?void(b.consent=angular.extend({},m,{tos:"OPT_OUT"===c.termsConsentType,uaNewsletter:"OPT_OUT"===c.marketingConsentType,endomondoNewsletter:"OPT_OUT"===c.marketingConsentType,version:c.consentTextVersion||1})):void(b.consent=angular.copy(m))}),b.confirm=function(){var c=b.$account.toObject(),d=e.requiresCanadaConsent?c.get("uaNewsletter"):b.consent.uaNewsletter,i=e.requiresCanadaConsent?c.get("endomondoNewsletter"):b.consent.endomondoNewsletter;"FACEBOOK"===c.type&&(c=g.signup()),"GOOGLE"===c.type&&(c=h.signup()),a.resolve(c).then(function(a){var c=b.$account.append(a).set("uaNewsletter",d).set("endomondoNewsletter",i);k();var e=f.create(c.toObject());b.signupPromise=e,e.then(j).catch(l)}).catch(l)}}a.$inject=["$q","$scope","$state","$timeout","view.auth.locals","api.auth.account","api.auth.facebook","api.auth.google","common.tracker"],angular.module("endo.view.auth").controller("view.auth.ConfirmController",a)}(),function(){function a(a,b){a.form={countryCode:a.countryCode},this.onCountryChange=function(){a.$account.set("countryCode",a.form.countryCode)},this.submit=function(c){if(c.$$$validate()){var d=b.requiresCanadaConsent?b.pane.SIGNUP_CONSENT_CANADA:b.pane.SIGNUP_CONFIRM;a.$select(d)}}}a.$inject=["$scope","view.auth.locals"],angular.module("endo.view.auth").controller("view.auth.CountryController",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(b){a.$account.append(b),a.$select(d.pane.SIGNUP_COUNTRY)}a.form={email:"",password:"",fullName:"",countryCode:a.countryCode},a.$watch("form.countryCode",function(b){return a.$account.set("countryCode",b)}),a.facebook=function(){try{k.require()}catch(b){return m.captureMessage("Facebook SDK failed to load.",{tags:{source:"facebook"},extra:{action:"signup"}}),a.$fail("errors.facebookLoad")}var c={type:"FACEBOOK"};i.getLoginStatus().then(function(b){g.login(b).then(function(){e.publish("login/success"),a.close()}).catch(function(a){return n(c)})}).catch(function(a){return n(c)})},a.google=function(){var b={type:"GOOGLE"};j.getLoginStatus().then(function(c){g.login(c).then(function(){e.publish("login/success"),a.close()}).catch(function(a){return n(b)})}).catch(function(a){return n(b)})},a.email=function(i){if(i.$$$validate()){if(!f.validateDateOfBirth(a.form.dateOfBirth))return a.$fail("errors.dateOfBirth",{age:f.LEGAL_AGE});var j=b.defer();a.validationPromise=j.promise;var k=h.validate(a.form);i.$$$revalidate(k),k.then(function(){return a.$account.append(a.form)}).then(function(){j.resolve(),c(function(){var b=d.requiresCanadaConsent?d.pane.SIGNUP_CONSENT_CANADA:d.pane.SIGNUP_CONFIRM;a.$select(b)},500)}).catch(function(){var b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return b.status===h.VALIDATION_CONFLICT?g.login({email:a.form.email,password:a.form.password,remember:!1}).then(function(){j.resolve(),e.publish("login/success"),a.close()}).catch(function(){j.reject(),a.$fail("errors.emailTaken")}):(j.reject(),i.$$$revalidate(b.data),void a.$fail("errors.signupFail"))})}}}a.$inject=["$scope","$q","$timeout","view.auth.locals","core.event.topic","model.auth.AuthUtils","api.auth.session","api.auth.account","api.auth.facebook","api.auth.google","common.loader.facebook","model.CountryEnum","Raven"],angular.module("endo.view.auth").controller("view.auth.CredentialsController",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j){function k(b){d.publish("login/success"),a.close()}a.loginFormData={email:"",password:"",remember:!0},a.login=function(b){if(a.$broadcast("autofill:update"),b.$$$validate()){var c=e.login(a.loginFormData);b.$$$revalidate(c),a.loginPromise=c,c.then(k).catch(function(){return a.$fail("errors.loginIncorrect")})}},a.facebookLogin=function(){function b(){var a=f.buildAuthorizeUrl(j.returnUrl);window.location=a}try{h.require(),f.getLoginStatus().then(function(c){e.login(c).then(function(){d.publish("login/success"),a.close()}).catch(b)}).catch(b)}catch(c){b()}},a.googleLogin=function(){var a=g.buildAuthorizeUrl(j.returnUrl);window.location=a}}a.$inject=["$scope","$window","view.auth.locals","core.event.topic","api.auth.session","api.auth.facebook","api.auth.google","common.loader.facebook","Raven","$stateParams"],angular.module("endo.view.auth").controller("view.auth.LoginController",a)}(),function(){function a(a,b,c,d,e,f,g){function h(e,f,h,i){if(j)return j.result;e=e.split("?")[0],j=a.open({templateUrl:"tpl://view/auth2/login/LoginDialog.html",controllerAs:"$ctrl",controller:function(){this.heading=f,this.body=h,this.returnUrl=g.addCallbackParam(e),i&&(this.object=JSON.stringify(i)),this.emailLoginSuccess=function(a){i&&(a=Object.assign(a,i)),j.close(a)}},size:"sm",windowClass:"loginDialog",animation:!0});var k=['<div class="auth-progress">',"<eo-progress-indicator></eo-progress-indicator>","</div>"].join(""),l=b(angular.element(k))(d.$new(!0));c[0].body.appendChild(l[0]),j.opened.finally(function(){l[0].parentNode.removeChild(l[0])});var m=j.result;return m.finally(function(){return j=null}),m}function i(){var a=e.search();return e.url(e.path()),Object.keys(a).length>0&&a.type&&("FACEBOOK"===a.type||"GOOGLE"===a.type)?a:null}var j=void 0;return{open:h,getAuthData:i}}a.$inject=["$modal","$compile","$document","$rootScope","$location","core.io.url","urlBuilder"],angular.module("endo.view.auth2.login").factory("view.auth2.login.LoginDialog",a)}(),function(){function a(a,b,c,d,e,f,g,h,i){var j=this,k={form:{email:"",password:"",remember:!1},pending:!1};j.state=k,j.isConfirmation&&(j.state.form.email=d.email,delete j.state.form.remember),j.authorizeEmail=function(b){if(a.$broadcast("autofill:update"),b.$$$validate()){k.pending=!0;var d=f.login(k.form);b.$$$revalidate(d),d.then(function(){j.isConfirmation?j.emailLoginSuccess&&j.emailLoginSuccess(j.state.form):e.publish("login/success",j.returnUrl)}).catch(function(a){i.open("email-login-error.html")}).finally(function(){c(400).then(function(){return k.pending=!1})})}},j.authorizeFacebook=function(){var a=g.buildLoginUrl(j.returnUrl,j.object,j.isConfirmation);b.location=a},j.authorizeGoogle=function(){var a=h.buildLoginUrl(j.returnUrl,j.object);b.location=a}}a.$inject=["$scope","$window","$timeout","user","core.event.topic","api.auth.session","api.auth.facebook2","api.auth.google2","ui.MsgBox"],angular.module("endo.view.auth2.login").component("login",{templateUrl:"tpl://view/auth2/login/login.en.html",bindToController:!0,controller:a,bindings:{returnUrl:"<",isConfirmation:"<?",emailLoginSuccess:"<?",object:"<?"}})}(),function(){function a(a,b,c,d,e,f,g,h){var i=this,j={email:"",password:"",firstName:"",lastName:"",dateOfBirth:void 0,countryCode:void 0,consent:!1};angular.isObject(i.user)&&(j=angular.extend(j,i.user,{consent:!1}));var k={form:j,pending:!1};i.state=k,i.transformations={privacy:'<a href="https://account.underarmour.com/privacy" target="_blank">${text}</a>',tos:'<a href="https://account.underarmour.com/terms-and-conditions" target="_blank">${text}</a>'},i.authorizeFacebook=function(){k.pending=!0;var b=c.buildSignupUrl(i.returnUrl);a.location=b},i.authorizeGoogle=function(){k.pending=!0;var b=d.buildSignupUrl(i.returnUrl);a.location=b},i.authorizeEmail=function(a){function c(){b.go("consent.signup",{user:{email:i,password:j,firstName:l,lastName:m,dateOfBirth:n,countryCode:o},confirm:void 0})}k.pending=!0;var d=k.form,i=d.email,j=d.password,l=d.firstName,m=d.lastName,n=d.dateOfBirth,o=d.countryCode,p=void 0;e.fetchAllConsentsPerCountry().then(function(a){p=new f(a)}).finally(function(){if(!p)return c();var a=p.findCountry(o);if(!a)return c();var b=a.minAge;return b?g.years.diff(n,new Date)<b?(k.pending=!1,void h.open("email-signup-error.html")):void c():c()})}}a.$inject=["$window","$state","api.auth.facebook2","api.auth.google2","api.consent.ConsentResource","model.consent.ConsentCollection","core.lang.date","ui.MsgBox"],angular.module("endo.view.auth2.signup").component("signup",{templateUrl:"tpl://view/auth2/signup/signup.en.html",controller:a,bindings:{user:"<",countries:"<",returnUrl:"<"}})}(),function(){function a(a,b,c,d,e,f){a.model={},a.model.user=d,a.maxStep=e.length,a.currentStep=e.indexOf(c.current.name)+1,a.progress=a.currentStep/a.maxStep*100+"%";var g=f.fromCurrentStateTree().$parent;a.nextText=g.next,a.savingText=g.saving,a.nextStep=function(){a.currentStep++,a.currentStep>a.maxStep||(a.progress=a.currentStep/a.maxStep*100+"%",c.go(e[a.currentStep-1]))},a.$on("$stateChangeStart",function(c,d,f,g,h){if(e.indexOf(d.name)<0&&g.name!==e[e.length-1])return b.$emit("$stateChangeSuccess"),void c.preventDefault();var i=e.indexOf(d.name);i>-1&&(a.currentStep=i+1,a.progress=a.currentStep/a.maxStep*100+"%")})}a.$inject=["$scope","$rootScope","$state","userProfile","boardingStates","common.i18n.Translation"],angular.module("endo.view.boarding").controller("BoardingViewController",a)}(),function(){function a(a,b,c,d){function e(b){a.userWidthClass=g+"--"+b}function f(b){a.contentWidthClass="boarding-content--"+b}var g="boardingFriends-user";a.model.user.suggestedFriends=a.model.user.suggestedFriends.filter(function(a){return 1===a.viewerFriendship});var h=a.model.user.suggestedFriends.length;d.getBreakpointName()===d.XSMALL?(a.limit=6,f(null)):h>=12?(a.limit=12,f(400),e("fourth")):h>=10?(a.limit=10,f(500),e("fifth")):h>=8?(a.limit=8,f(400),e("fourth")):(a.limit=6,f(300),e("third")),a.limit>6&&(a.userWidth=2/a.limit*100+"%"),a.toggleFriend=function(a){a.checked=!a.checked},a.saveFriends=function(){var d=a.model.user.suggestedFriends.some(function(a){return a.checked});if(!d)return void a.nextStep();var e=[];a.model.user.suggestedFriends.forEach(function(a){a.checked&&e.push(a.id)}),a.updatePromise=c.addFriends(a.model.user.id,e).then(function(){b(a.nextStep,500)})}}a.$inject=["$scope","$timeout","api.user.UserResource","core.dom.media"],angular.module("endo.view.boarding").controller("BoardingFriendsController",a)}(),function(){function a(a,b,c,d,e){function f(){a.model.user.height=a.formData.height,a.model.user.weight=a.formData.weight}var g=new Date;a.endYear=g.getFullYear()-13;new Date(a.endYear,g.getMonth(),g.getDate());a.weightUnit=d.short.weight,a.heightUnit=d.short.height,a.distanceLabel=d.label.distance,a.durationLabel=d.label.duration,a.caloriesLabel=d.label.energy,a.distance=10.3,a.duration=3121,a.calories=814,a.formData={height:a.model.user.height,weight:a.model.user.weight},a.submit=function(d){return d.$pristine?void a.nextStep():void(d.$$$validate()&&(a.updatePromise=c.update(a.model.user.id,a.formData).then(function(c){f(),b(a.nextStep,500)}),d.$$$revalidate(a.updatePromise)))}}a.$inject=["$scope","$timeout","api.user.UserResource","common.unit.UNITS","durationFilter"],angular.module("endo.view.boarding").controller("BoardingMetricsController",a)}(),function(){function a(a,b,c,d,e,f){function g(){a.model.user.firstName=f.firstName=a.formData.firstName,a.model.user.lastName=f.lastName=a.formData.lastName,a.model.user.gender=f.gender=a.formData.gender}a.formData={firstName:a.model.user.firstName,lastName:a.model.user.lastName,gender:a.model.user.gender!==e.GENDER.UNSPECIFIED?a.model.user.gender:null},a.gender=e.GENDER;var h;a.submit=function(c){c.$$$validate()&&(a.updatePromise=d.update(a.model.user.id,a.formData).then(function(c){g(),b(a.nextStep,500)}),c.$$$revalidate(a.updatePromise))},a.profilePictureUrl=d.profilePictureUrl(a.model.user.id),a.onPictureUpload=function(){h=c.defer(),a.model.pictureUploading=!0,a.updatePicturePromise=h.promise},a.onPictureUploadSuccess=function(b){return b.data.url?void d.getAbstract(a.model.user.id).then(function(c){a.model.user.picture=c.picture,f.avatarUrl=c.picture.url,a.model.pictureUploading=!1,h.resolve(b)}):void h.reject(b)},a.onPictureUploadError=function(b){h.reject(b),a.model.pictureUploading=!1}}a.$inject=["$scope","$timeout","$q","api.user.UserResource","model.user.UserUtils","user"],angular.module("endo.view.boarding").controller("BoardingProfileController",a)}(),function(){var a=angular.module("endo.view.business");a.controller("BusinessViewController",["$scope",function(a){a.email="adsales@endomondo.com"}])}(),function(){function a(a,b,c,d,e,f){function g(a){return Array.isArray(a)?a.some(function(a){return a.hasLaps()}):!1}var h="top.history.params";a.workouts=d,a.hasChart=g(d),a.back=function(){var a=f.get();return a&&a.state.name===h?void f.go():void e.go(h,{userId:b.id})}}a.$inject=["$scope","user","viewer","workouts","$state","common.router.previousState"],angular.module("endo.view.compare").controller("view.compare.CompareController",a)}(),function(){angular.module("endo.view.consent").component("consentEmails",{templateUrl:"tpl://view/consent/consent-emails/consent-emails.en.html",bindings:{onResolve:"&",onReject:"&"}})}(),function(){function a(a,b){var c=this,d=a(c.onResolve);c.$onInit=function(){c.form={dateOfBirth:c.dateOfBirth,country:c.country}},c.isValid=function(){var a=c.form,d=a.dateOfBirth,e=a.country;return b.isDate(d)&&e},c.proceed=function(){d({$dateOfBirth:c.form.dateOfBirth,$country:c.form.country})}}a.$inject=["$parse","core.lang.date"],angular.module("endo.view.consent").component("consentLocation",{templateUrl:"tpl://view/consent/consent-location/consent-location.en.html",controller:a,bindings:{dateOfBirth:"<",country:"<",countries:"<",pending:"<",onResolve:"&"}})}(),function(){function a(){var a=this;a.proceed=function(){a.onResolve()}}angular.module("endo.view.consent").component("consentTerms",{templateUrl:"tpl://view/consent/consent-terms/consent-terms.en.html",controller:a,bindings:{pending:"<",onResolve:"&"}})}(),function(){var a='\n    <div class="consentToggle" ng-class="{\'consentToggle--checked\': $ctrl.checked}" ng-click="$ctrl.onClick()">\n      <span class="icon-true"></span>\n    </div>\n  ';angular.module("endo.view.consent").component("consentToggle",{template:a,bindings:{checked:"<",onClick:"&"}})}(),function(){function a(a){var b=this;b.learnMore=function(){var c='\n        <div class="consentType-learnMore">\n          <div class="consentType-learnMore-titleBar">\n            '+b.linkLabel+'\n            <div class="consentType-learnMore-dismiss" ng-click="dismiss()"><span class="icon-close"></span></div>\n          </div>\n          <div class="consentType-learnMore-content">\n            '+b.description+"\n          </div>\n        </div>\n      ";a.open({template:c,controller:["$scope","$modalInstance",function(a,b){a.dismiss=function(){b.close()}}]})}}var b='\n    <div class="consentType">\n      <div class="consentType-textWrapper">\n        <div class="consentType-copyWrapper" ng-click="$ctrl.onClick()">\n          <div class="consentType-title">{{$ctrl.headline}}</div>\n          <div class="consentType-summary">{{$ctrl.summary}}</div>\n        </div>\n        <div class="consentType-linkWrapper">\n          <a class="consentType-descriptionLink" href="javascript:;" ng-click="$ctrl.learnMore()">{{$ctrl.linkLabel}}</a>\n        </div>\n      </div>\n      <div class="consentType-toggleWrapper" ng-click="$ctrl.onClick()">\n        <consent-toggle class="consentType-toggle" checked="$ctrl.checked"></consent-toggle>\n      </div>\n    </div>\n  ';a.$inject=["$modal"],angular.module("endo.view.consent").component("consentType",{template:b,controller:a,bindings:{headline:"<",summary:"<",description:"<",checked:"<",linkLabel:"@",onClick:"&"}})}(),function(){function a(a){var b=this,c=a(b.onResolve);b.$onInit=function(){b.acceptedConsents=[]},b.handleClick=function(a){var c=b.acceptedConsents.indexOf(a);return-1===c?void b.acceptedConsents.push(a):void b.acceptedConsents.splice(c,1)},b.proceed=function(){c({$consents:b.acceptedConsents})}}a.$inject=["$parse"],angular.module("endo.view.consent").component("consentTypes",{templateUrl:"tpl://view/consent/consent-types/consent-types.en.html",controller:a,bindings:{consents:"<",pending:"<",onResolve:"&"}})}(),function(){function a(a,c,d,e,f){function g(e){h.state.pending=!0;var g=h.state.userChanged?j(h.state.user):a.resolve();g.then(function(){k(e).then(function(a){d.grantConsent(),c.go(h.returnState.name,h.returnState.params).then(function(){h.state.pending=!1})}).catch(function(a){h.state.pending=!1,h.state.currentView=b.LOCATION,f.open("consent-requirements-error.html")})}).catch(function(a){f.open("consent-network-error.html"),h.state.pending=!1})}var h=this,i=h.consentResolver,j=h.saveUser,k=h.saveConsents;h.$onInit=function(){var a=h.dateOfBirth,c=h.country;h.state={user:{dateOfBirth:a,country:c},requiredConsents:[],currentView:b.LOCATION,pending:!1}},h.handleLocation=function(a,c){h.state.currentView=b.TERMS,h.state.user.dateOfBirth=a,h.state.user.country=c,h.state.requiredConsents=i.getRequiredConsents(c)||[],h.state.userChanged=h.country!==c||!(e.isDate(h.dateOfBirth)&&e.days.equal(h.dateOfBirth,a))},h.handleTerms=function(){return Array.isArray(h.state.requiredConsents)&&h.state.requiredConsents.length>0?void(h.state.currentView=b.TYPES):void g([])},h.handleTypes=function(a){g(a)}}var b={LOCATION:"LOCATION",TERMS:"TERMS",TYPES:"TYPES"},c='\n    <div class="consent" ng-switch="$ctrl.state.currentView">\n      <div ng-switch-when="'+b.LOCATION+'">\n        <consent-location\n          date-of-birth="$ctrl.state.user.dateOfBirth"\n          country="$ctrl.state.user.country"\n          countries="$ctrl.countries"\n          pending="$ctrl.state.pending"\n          on-resolve="$ctrl.handleLocation($dateOfBirth, $country)"\n        ></consent-location>\n      </div>\n      <div ng-switch-when="'+b.TERMS+'">\n        <consent-terms\n          pending="$ctrl.state.pending"\n          on-resolve="$ctrl.handleTerms()"\n        ></consent-terms>\n      </div>\n      <div ng-switch-when="'+b.TYPES+'">\n        <consent-types\n          consents="$ctrl.state.requiredConsents"\n          pending="$ctrl.state.pending"\n          on-resolve="$ctrl.handleTypes($consents)"\n        ></consent-types>\n      </div>\n    </div>\n    ';
a.$inject=["$q","$state","user","core.lang.date","ui.MsgBox"],angular.module("endo.view.consent.GDPRLoginConsentFlow").component("gdprLoginConsentFlow",{template:c,controller:a,bindings:{returnState:"<",dateOfBirth:"<",country:"<",countries:"<",consentResolver:"<",saveUser:"<",saveConsents:"<"}})}(),function(){function a(a,c){function d(b,d,f){e.state.pending=!0;var h=angular.extend({},b,{consents:d,uaNewsletter:f,endomondoNewsletter:f});b.firstName&&b.lastName&&(h.fullName=h.firstName+" "+h.lastName,delete h.firstName,delete h.lastName),g(h).then(function(b){return 200===b.status?void a.go("home"):void a.go("boarding.profile",a.params)}).catch(function(d){function e(){var c=void 0;angular.isObject(b)&&void 0===b.type&&(c={user:angular.copy(b)}),a.go("auth.signup",c)}return angular.isObject(d)&&400===d.status?void c.open("tpl://view/consent/error/consent-error.en.html").finally(e):void c.open("tpl://view/consent/error/generic-error.en.html").finally(e)}).finally(function(){e.state.pending=!1})}var e=this,f=e.consentResolver,g=e.createAccount;e.$onInit=function(){if(e.state={user:angular.extend({},e.user,e.confirm),requiredConsents:[],acceptedConsents:[],currentView:b.LOCATION,pending:!1},!e.confirm){var a=e.state.user.countryCode;e.state.currentView=b.TERMS,e.state.requiredConsents=f.getRequiredConsents(a)||[]}},e.handleLocation=function(a,c){e.state.currentView=b.TERMS,e.state.user.dateOfBirth=a,e.state.user.countryCode=c,e.state.requiredConsents=f.getRequiredConsents(c)||[]},e.handleTerms=function(){return Array.isArray(e.state.requiredConsents)&&e.state.requiredConsents.length>0?void(e.state.currentView=b.TYPES):void(e.state.currentView=b.EMAILS)},e.handleTypes=function(a){e.state.acceptedConsents=a,e.state.currentView=b.EMAILS},e.handleEmails=function(a){d(e.state.user,e.state.acceptedConsents,a)}}var b={LOCATION:"LOCATION",TERMS:"TERMS",TYPES:"TYPES",EMAILS:"EMAILS"},c='\n    <div class="consent" ng-switch="$ctrl.state.currentView">\n      <div ng-switch-when="'+b.LOCATION+'">\n        <consent-location\n          date-of-birth="$ctrl.state.user.dateOfBirth"\n          country="$ctrl.state.user.countryCode"\n          countries="$ctrl.countries"\n          pending="$ctrl.state.pending"\n          on-resolve="$ctrl.handleLocation($dateOfBirth, $country)"\n        ></consent-location>\n      </div>\n      <div ng-switch-when="'+b.TERMS+'">\n        <consent-terms\n          pending="$ctrl.state.pending"\n          on-resolve="$ctrl.handleTerms()"\n        ></consent-terms>\n      </div>\n      <div ng-switch-when="'+b.TYPES+'">\n        <consent-types\n          consents="$ctrl.state.requiredConsents"\n          pending="$ctrl.state.pending"\n          on-resolve="$ctrl.handleTypes($consents)"\n        ></consent-types>\n      </div>\n      <div ng-switch-when="'+b.EMAILS+'">\n        <consent-emails\n          on-resolve="$ctrl.handleEmails(true)"\n          on-reject="$ctrl.handleEmails(false)"\n        ></consent-emails>\n      </div>\n    </div>\n  ';a.$inject=["$state","ui.MsgBox"],angular.module("endo.view.consent.GDPRSignupConsentFlow").component("gdprSignupFacebookFlow",{template:c,controller:a,bindings:{user:"<",confirm:"<",countries:"<",consentResolver:"<",createAccount:"<"}})}(),function(){var a=angular.module("endo.view.download");a.controller("DownloadFeaturesController",["$scope","$state","core.dom.scroll",function(a,b,c){a.getTitle=function(a){var c=b.current.name;return c in a?a[c]:"Endomondo"},a.scrollTop=function(){c.to(0)}}])}(),function(){var a=angular.module("endo.view.download");a.directive("eoImageBox",[function(){return{scope:{imageClass:"@",otherClass:"@",imageLink:"@"},replace:!0,templateUrl:"tpl://view/download/imageBox.tpl.html",controller:["$scope",function(a){a.boxVisible=!1}]}}])}(),function(){var a=angular.module("endo.view.download");a.directive("eoImageHoverBox",[function(){return{scope:{imageClass:"@",boxClass:"@",otherClass:"@",boxTitle:"@",boxContent:"@",imageLink:"@"},replace:!0,templateUrl:"tpl://view/download/imageHoverBox.tpl.html",controller:["$scope",function(a){a.boxVisible=!1}]}}])}(),function(){var a=angular.module("endo.view.front");a.controller("FrontViewController",["$scope","$modal","$timeout","$state","core.dom.scroll",function(a,b,c,d,e){a.heroScrollerVisible=!0,a.heroScrollerAnimated=!1,c(function(){a.heroScrollerAnimated=!0},1e3),a.scroll=function(a){e.toElement(a,-42)},a.signup=function(){d.go("auth.signup")},a.playVideo=function(){b.open({template:'<div class="front-video-wrapper"><iframe width="100%" height="100%" src="//www.youtube.com/embed/vnngimwuu3A?rel=0&autoplay=1" frameborder="0" allowfullscreen></iframe></div>',windowClass:"front-video",size:"lg"})}}])}(),function(){function a(a){function b(a,b){this.selection=a||[],this.selectionLimit=b||0}return b.prototype.select=function(a){return this.selectionLimit&&this.selection.length>=this.selectionLimit?!1:(this.selection.push(a),a)},b.prototype.deselect=function(b){for(var c,d=0;d<this.selection.length;d++)if(this.selection[d].id==b.id){c=d;break}return a.isInteger(c)?this.selection.splice(c,1)[0]:!1},b.prototype.isSelected=function(a){for(var b,c=0;c<this.selection.length;c++)if(this.selection[c].id==a.id){b=a.id;break}return!!b},b.prototype.toArray=function(){return this.selection},b}a.$inject=["core.lang.number"],angular.module("endo.view.history").factory("view.history.WorkoutSelector",a)}(),function(){function a(a,b,c,d,e,f,g,h){function i(a){var c=b.camelCase(a.toString().toLowerCase());return j("grid."+c)}var j=g(f.fromCurrentStateTree().$parent);a.headers=[],a.columns=e.map(function(a,b){var e=c.map(function(a){return{self:a,label:i(a)}});return e.pref=new d(b,a),e.pref.header=i(e.pref.get()),e}),a.set=function(a,b){a.set(b),a.header=i(b)}}a.$inject=["$scope","core.lang.string","view.history.ColumnEnum","view.history.ColumnPref","view.history.ColumnDefaults","common.i18n.Translation","common.i18n.translateFactory","distanceFilter"],angular.module("endo.view.history").controller("view.history.ColumnConfigController",a)}(),function(){function a(a){return[a.DISTANCE,a.DURATION,a.SPEED,a.CALORIES]}a.$inject=["view.history.ColumnEnum"],angular.module("endo.view.history").factory("view.history.ColumnDefaults",a)}(),function(){function a(a){var b=["DISTANCE","DURATION","CALORIES","SPEED","PACE","AVG_HR","MAX_HR","SPORT","TITLE","ROUTE"];return a(b)}a.$inject=["core.lang.enumeration"],angular.module("endo.view.history").factory("view.history.ColumnEnum",a)}(),function(){function a(a,b,c,d,e,f,g){var h=f.map(function(a,b){return new e(b,a)});a.prefs=h,a.format=function(a,e){var f="";switch(a.get()){case d.DISTANCE:f=b("distance")(e.distance,2);break;case d.DURATION:f=b("duration")(e.duration);break;case d.CALORIES:f=e.calories?b("energy")(e.calories):"";break;case d.SPEED:f=b("speed")(e.speedAvg,1);break;case d.PACE:f=b("pace")(e.speedAvg,"short");break;case d.AVG_HR:f=e.heartRateAvg?c.round(e.heartRateAvg):"";break;case d.MAX_HR:f=e.heartRateMax?c.round(e.heartRateMax):"";break;case d.SPORT:f=g.getTitle(e.sport);break;case d.ROUTE:f=(e.route||{}).name||"";break;case d.TITLE:f=e.title}return f}}a.$inject=["$scope","$filter","core.math","view.history.ColumnEnum","view.history.ColumnPref","view.history.ColumnDefaults","common.data.SportTranslate"],angular.module("endo.view.history").controller("view.history.ColumnFormatController",a)}(),function(){function a(a,b){var c=function(a){function c(b,d){return _classCallCheck(this,c),b="history.column."+b,_possibleConstructorReturn(this,a.call(this,b,d))}return _inherits(c,a),c.prototype._serialize=function(a){var c=b.get(a);return b.has(c)?c.toString():null},c.prototype._deserialize=function(a){return b.get(a)},c}(a);return c}a.$inject=["common.pref.Preference","view.history.ColumnEnum"],angular.module("endo.view.history").factory("view.history.ColumnPref",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){function t(a){return a.id}function u(){return(b.workouts.getMetadata()||{}).paginator}function v(b){a.form={},b&&A.forEach(function(c){angular.isDefined(b[c])&&(a.form[c]=b[c])})}function w(b){b=b||i.getBreakpointName();var c=4;switch(b){case i.XSMALL:break;case i.SMALL:c=10;break;case i.MEDIUM:case i.LARGE:c=15}a.pagination.maxSize=c}function x(){var b=i.getBreakpointName();a.$apply(function(){w(b)}),a.collapse&&b!=i.XSMALL&&a.$apply(function(){a.collapse=!1})}function y(a){a=angular.extend({},B,a),f.premium||(a.tags=void 0),c.go("top.history.params",a)}var z=a.SELECTION_LIMIT=3,A=["after","before","fromDistance","toDistance","fromDuration","toDuration","title","route","tags","sport"],B={};A.forEach(function(a){B[a]=void 0});var C,D=s.get();D&&"top.compare"===D.state.name?b.selection=b.selection||[]:b.selection=[],a.model=b,a.user=f,a.hasSearchServiceTesterRole=f.hasRole("SEARCH_SERVICE_TESTER"),a.selection=b.selection;var E=new p(a.selection,z);a.tags=[],a.DEBOUNCE=350,a.DISTANCE_UNIT=k.append.distance(""),a.distance=l,a.duration=m;var F=i.getBreakpointName();a.collapse=F==i.XSMALL,a.pagination={},v(b.params),w(F),setTimeout(function(){d.scrollTo(0,0)}),a.createGetterSetter=function(a){return function(b){return void 0===b?E.isSelected(a):!0===b?void E.select(a):void E.deselect(a)}};var G="history.hintDismissed";a.hintDismissed=!!Number(g.get(G)),a.dismissHint=function(){g.set(G,1),a.hintDismissed=!0},a.compareParams=function(){return{userId:b.params.userId,workoutId:a.selection.map(t)}},a.merge=function(){var d=a.selection.map(t),e={userId:b.params.userId,workoutIds:d};a.mergePromise=j.canMerge(e),a.mergePromise.then(function(){n.open(e).result.then(function(a){c.reload("top.history.params"),o.confirm("tpl://view/merge/mergeSuccess.en.html").then(function(){c.go("top.workouts.info.byId",{userId:b.params.userId,workoutId:a})})})}),a.mergePromise.catch(function(){o.alert("tpl://view/merge/mergeError.en.html")}),a.mergePromise.finally(function(){a.mergePromise=null})},a.reset=function(){a.tags=[],a.form={}},a.onTagsChange=function(){if(Array.isArray(a.tags)){var b=a.tags.map(function(a){return a.text});h.equal(b,a.form.tags)||(a.form.tags=b)}},a.loadTags=function(){C||(C=q.listWorkoutHashtags({id:b.params.userId}))},a.searchTags=function(a){var b=e.defer();return e.resolve(C).then(function(c){var d=c.filter(function(b){return new RegExp("^"+a,"i").test(b)});b.resolve(d)}),b.promise},a.$watchCollection("form",function(b){b&&(Array.isArray(b.tags)&&!h.equal(b.tags,C)&&(a.tags=angular.copy(b.tags)),y(b))}),a.$watch("model.routes",function(b){Array.isArray(b)&&(a.routes=b.map(function(a){return{id:a.routeId,label:a.name}}))}),a.$watch("model.sports",function(b){b&&b.length&&(a.sports=b.map(function(a){return{id:String(a.valueOf()),label:r.getTitle(a)}}))}),a.$watch("pagination.page",function(b,c){if(void 0!==b){b-=1;var d=u();if(d){var e=d.page();e!==b&&j.search.page(a.model.workouts,b).catch(function(){a.$applyAsync(function(){a.pagination.page=c})})}}}),a.$watchCollection("model.params",function(b){a.pagination.page=1;var c=u();c&&(a.pagination.perPage=c.limit(),a.pagination.total=c.total(),a.pagination.count=c.count())}),d.addEventListener("resize",x),a.$on("$destroy",function(){d.removeEventListener("resize",x)})}a.$inject=["$scope","model","$state","$window","$q","user","localStorage","core.lang.array","core.dom.media","api.workout.WorkoutResource","common.unit.UNITS","distanceFilter","durationFilter","view.merge.MergeDialog","ui.MsgBox","view.history.WorkoutSelector","api.user.UserResource","common.data.SportTranslate","common.router.previousState"],angular.module("endo.view.history").controller("view.history.HistoryController",a)}(),function(){angular.module("endo.view.home").controller("HomeViewController",["$timeout","$scope","$state","$window","user","config","model","model.workout.SummaryProccessor","model.CountryEnum","api.feed.FeedResource","api.challenge.ChallengeResource","api.user.UserResource","api.workout.PlannedWorkoutResource","api.workout.WorkoutResource","common.data.SportTranslate","common.i18n.Translation","common.vendor.moment","ui.MsgBox","ui.PopoupDialog","common.unit.UNITS","urlBuilder","dateFilter","core.event.topic","view.home.homeAds","common.lang.Languages","model.uacf.EcomLinks","core.lang.date",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){function B(){b.model.status={message:void 0,pictureKeys:[]},b.photoPreview={},b.postContent=!1}function C(){b.uaStoreLink=z.get(G,z.POSITION_FOOTER,e.gender,!e.isGuest())}function D(){a(C)}function E(){c.reload()}b.model=g,b.loadMoreVisible=j.subscriptions.hasNext(b.model.feeds),b.distanceLabel=t.label.distance,b.durationLabel=t.label.duration,b.energyLabel=t.label.energy,b.ads=x.getAds();var F=p.fromCurrentState();b.model.searchText="",b.searchOptions={debounce:250},b.searching=!1,setTimeout(function(){return d.scrollTo(0,0)}),b.model.searchResults=[],B(),b.feedPictureUploadUrl=j.getPictureUrl(e.id),b.statsUrl=u.buildStatsUrl(),b.settingsUrl=u.buildSettingsUrl(),b.trainingPlanUrl=u.buildTraningPlanUrl(),b.profileComplete=g.user.profileCompleteness>=1;var G=f.get("viewerCountry"),H=i.get(G);b.showAdChoices=H==i.US;var I=[i.IS,i.FO,i.NO,i.LI,i.CH];b.isEligibleForJob=H&&(H.isEuropeanUnionMember()||-1!=I.indexOf(H)),w.subscribe("user/change",D),b.$on("$destroy",function(){return w.unsubscribe("user/change",D)}),C(),s.tryToOpen();var J=y.supportedLanguages();b.languages=[];for(var K in J)b.languages.push({id:K,name:J[K]});b.selectedLanguage=y.viewerLanguage();var L=q().startOf("day").toDate(),M=L.getFullYear(),N=L.getMonth();b.monthName=v(L,"MMMM");var O=0;b.model.user.summary&&(b.totalsBySport=[],b.totalsBySport.push(b.model.user.summary),b.totalsBySport[0].label=F.summary.allSports,b.totalsBySport[0].index=O++,b.selectedSportTotals=0),b.model.user.summaryBySport&&b.model.user.summaryBySport.forEach(function(a){a.label=o.getTitle(a.sport),a.index=O++,b.totalsBySport.push(a)}),k.userChallenges(e.id).then(function(a){return b.ongoingChallenges=a}),k.featured(e.id).then(function(a){return b.featuredChallenges=a}),l.suggestedFriends(e.id).then(function(a){b.suggestedFriends=a,b.suggestedFriendsLimit=a.length>=6?6:3});var P={after:new Date(M,N,1),before:new Date(M,N+1,1)};n.query(e.id,P).then(function(a){b.model.monthWorkouts=a.includedInStats();var c=h.totalsBySport(b.model.monthWorkouts);b.model.summaryBySport=[];for(var d in c)b.model.summaryBySport.push(c[d]);1===b.model.monthWorkouts.length&&(b.model.lastWorkout=a[0],b.model.lastWorkout.title=a[0].title||o.getTitle(a[0].sport))});var Q=q.utc().startOf("day").toDate(),R={after:q(Q).subtract(1,"days").toDate(),before:q(Q).add(7,"days").toDate()};e.premium&&m.query(e.id,R).then(function(a){var c=new Date,d=a.filter(function(a){return!a.workoutId&&A.days.diff(a.plannedDate,c)>=0});b.plannedWorkout=d[d.length-1]}),b.changeLanguage=function(){d.location=y.generateLanguageUrl(b.selectedLanguage)},b.hideFeed=function(a){r.confirm("tpl://view/home/dialogs/feedDelete.en.html").then(function(){return j.delete(a)}).then(function(){var c=b.model.feeds.indexOf(a);~c&&b.model.feeds.splice(c,1)})},b.removeChallenge=function(c){var d=b.featuredChallenges.indexOf(c);~d&&a(function(){return b.featuredChallenges.splice(d,1)},500)},b.addFriends=function(){var a=b.suggestedFriends.filter(function(a){return a.$checked});b.updatePromise=l.addFriends(e.id,a.map(function(a){return a.id})).then(function(){a.forEach(function(a){var c=b.suggestedFriends.indexOf(a);~c&&b.suggestedFriends.splice(c,1),b.suggestedFriendsLimit=b.suggestedFriends.length>=6?6:3})})},b.rejectSuggestion=function(a){return l.rejectSuggestion(e.id,a.id)},b.loadMore=function(){b.loading||(b.loading=!0,j.subscriptions.next(b.model.feeds).finally(function(){b.loading=!1,b.loadMoreVisible=j.subscriptions.hasNext(feeds)}))},b.search=function(a){return l.queryFriends(e,10,null,a)},b.searchSelect=function(a,b,d){a&&a.id&&c.go("top.workouts.info.byId",{userId:a.id,workoutId:"latest"})},b.searchSubmit=function(a){a.preventDefault(),d.location=u.buildSearchUrl({key:b.model.searchText})},b.postStatus=function(a){a.$$$validate()&&(b.model.status.pictureKeys.length||b.model.status.message)&&(b.postPromise=j.postStatus(e.id,b.model.status).then(function(a){b.model.feeds.splice(0,0,a),B()}))},b.onPictureUpload=function(a){if(b.postProccesing=!0,b.photoPreview.src="",d.FileReader){var c=new d.FileReader;c.onloadend=function(){return b.$apply(function(a){a.photoPreview.src=c.result})},a&&a[0]&&c.readAsDataURL(a[0])}},b.onPictureUploadSuccess=function(a){b.postProccesing=!1,b.postContent=!0,b.model.status.pictureKeys.push(a.data.id)},b.onPictureUploadError=function(a){b.postProccesing=!1},b.clearStatus=function(a){B()},b.dismissDownloadBox=function(){return l.update(e.id,{hasDismissedDownloadBox:!0}).then(function(){return b.model.user.hasDismissedDownloadBox=!0})},w.subscribe("login/success",E),b.$on("$destroy",function(){return w.unsubscribe("login/success",E)})}])}(),function(){function a(a,b,c){var d={xs:{other:{path:"/17729925/UACF_W/Endo/Workout",size:[320,50],args:{pos:"top"}}},sm:{other:{path:"/17729925/UACF_W/Endo/Training",size:[728,90],args:{pos:"top"}}},md:{other:{path:"/17729925/UACF_W/Endo/Training",size:[728,90],args:{pos:"top"}},dk:{path:"/17729925/UACF_W/Endo/Training_DK",size:[930,180],args:{pos:"top"}},pl:{path:"/17729925/UACF_W/Endo/Training_PL",size:[750,200],args:{pos:"top"}}}},e={free:{path:"/17729925/UACF_W/Endo/Promobox_F",size:[240,240]},premium:{path:"/17729925/UACF_W/Endo/Promobox_P",size:[240,240]}},f={sharethrough:{path:"/17729925/UACF_W/Endo/Newsfeed",size:[320,50],args:{strnativekey:"317d24bc"}},normal:{path:"/17729925/UACF_W/Endo/ScanNewsfeed",size:[320,320]}};return{getAds:function(){var g=b.getBreakpointName(),h=String(a.get("locale.country.id")).toLowerCase(),i={};return g=g&&"lg"!==g?g:"md",i.top=d[g][h]||d[g].other,i.promo=c.premium?e.premium:e.free,i.newsfeed=f.sharethrough,i}}}a.$inject=["config","core.dom.media","user"],angular.module("endo.view.home").service("view.home.homeAds",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){function m(){p=d.defer(),a.acceptPromise=p.promise;var b;switch(a.inviteType){case j.FRIENDS:b=f.befriend(a.model.user,c.id);break;case j.CHALLENGE:b=g.joinChallenge(e.challenge,c.id);break;case j.COMMITMENT:b=h.motivate(a.model.user.id,c.group,c.id)}b.then(o).catch(n)}function n(a){p.reject(a)}function o(a){b.current&&b.current.name.startsWith("boarding")||(a&&a.success?(p.resolve(a),b.transitionTo("invite.success",c,{reload:!0,location:!0})):p.reject(a))}switch(a.model=e,a.inviteType=c.type,a.inviteTypes=j,a.favoriteSporName=a.model.user.favoriteSport?k(a.model.user.favoriteSport.toString()+".title"):void 0,a.canJoin=i.isGuest(),a.inviteType){case j.FRIENDS:a.canJoin=a.canJoin||!e.user.isFriend;break;case j.CHALLENGE:a.canJoin=a.canJoin||e.challenge&&!e.challenge.viewerJoined;break;case j.COMMITMENT:a.canJoin=a.canJoin||e.commitment&&!e.commitment.isViewerMotivator}var p;a.accept=function(){i.isGuest()?l.signup().then(m):m()}}a.$inject=["$scope","$state","$stateParams","$q","model","api.user.UserResource","api.challenge.ChallengeResource","api.commitment.CommitmentResource","user","inviteTypes","translateSports","view.auth.AuthDialog"],angular.module("endo.view.invite").controller("InviteViewController",a)}(),function(){function a(a,b,c,d,e,f,g){a.model=d,a.inviteType=c.type,a.inviteTypes=f,a.challengeUrl=a.model.challenge?g.buildChallengeUrl({id:a.model.challenge.id}):null,a.viewer=e}a.$inject=["$scope","$state","$stateParams","model","user","inviteTypes","urlBuilder"],angular.module("endo.view.invite").controller("InviteSuccessViewController",a)}(),function(){function a(a,b){var c=this;c.logout=function(){a.logout().finally(function(){b.publish("logout")})}}a.$inject=["api.auth.session","core.event.topic"],angular.module("endo.view.layout").component("authLayout",{templateUrl:"tpl://view/layout/auth/auth-layout.en.html",controller:a,bindings:{hasLogoutLink:"<"}})}(),function(){var a=angular.module("endo.view.layout");a.controller("CookiesWarningViewController",["$scope","$rootScope","$timeout","$document","$state","config","user","core.io.cookies","common.tracker","model.CountryEnum",function(a,b,c,d,e,f,g,h,i,j){var k="acceptCookies",l=j.get(f.get("locale.country.id")),m=l?l.isEuropeanUnionMember():!1;a.warningVisible=g.isGuest()&&m&&!h.has(k),a.acceptCookies=function(){i.enable(),a.warningVisible=!1,h.set(k,"1",1/0,"/"),c(function(){b.$broadcast("layout","hero")})},angular.element(d[0]).one("click",function(){a.$apply(function(){a.acceptCookies()})})}])}(),function(){function a(a,b,c,d,e,f){function g(){return angular.element(a[0].querySelector(n))}function h(){if(!l)return 0;var a=g();return a.length&&a[0].clientHeight?a[0].clientHeight:0}function i(){var b=angular.element(a[0].querySelector(o));b.length&&b.css({height:h()+"px"})}function j(a,b){var e=g();e.length&&(b=b||d.$new(!0),e.empty(),e.append(c(a)(b)))}function k(a){if(l!==a){a?angular.element(e).bind("resize",i):angular.element(e).unbind("resize",i);var c={display:a?"":"none"},d=g();return d.length?(d.css(c),l=a,void i()):void b(function(){var b=g();b.css(c),l=a,i()},0)}}var l,m,n=".js-layout-cta",o=".js-layout-cta-placeholder";return f.subscribe("cta/rendered",i),{selector:n,setContent:j,getHeight:h,show:function(){m||k(!0)},hide:function(){k(!1)},manualHide:function(){k(!1),m=!0},isVisible:function(){return l}}}a.$inject=["$document","$timeout","$compile","$rootScope","$window","core.event.topic"],angular.module("endo.view.layout").service("cta",a)}(),function(){function a(a,b){return{transclude:!0,replace:!0,link:function(c,d,e,f,g){g(function(c,d){d.dismissCta=function(){a.manualHide()},a.setContent(c,d),a.show(),b.publish("cta/rendered")})}}}a.$inject=["cta","core.event.topic"],angular.module("endo.view.layout").directive("eoCta",a)}(),function(){function a(a,b,c,d,e,f){return{replace:!0,templateUrl:"tpl://view/layout/cta/eoEmailCta.en.html",scope:{},link:function(d,g,h){d.settingsUrl=b.buildEmailSettingsUrl(),d.substituteMap={name:c.firstName,email:c.email},d.resendConfirmation=function(){d.sendingPromise=f.sendConfirmationEmail(c.id).then(function(a){d.checkEmail=!0})},a(function(){return e.publish("cta/rendered")},200)}}}a.$inject=["$timeout","urlBuilder","user","cta","core.event.topic","api.user.UserResource"],angular.module("endo.view.layout").directive("eoEmailCta",a)}(),function(){function a(a,b,c){return{replace:!0,templateUrl:"tpl://view/layout/cta/eoGuestCta.en.html",scope:{},link:function(d,e,f){function g(){b.hide()}d.signup=function(){a.signup()},d.hide=function(){b.manualHide()},c.publish("cta/rendered"),c.subscribe("login/success",g),d.$on("$destroy",function(){c.unsubscribe("login/success",g)})}}}a.$inject=["view.auth.AuthDialog","cta","core.event.topic"],angular.module("endo.view.layout").directive("eoGuestCta",a)}(),function(){var a=angular.module("endo.view.layout");a.controller("FooterViewController",["$scope","$window","config","model.uacf.EcommerceLink","common.lang.Languages","model.CountryEnum","user","core.event.topic","$timeout","model.uacf.EcomLinks",function(a,b,c,d,e,f,g,h,i,j){function k(){a.uaLink=j.get(p,j.POSITION_FOOTER,g.gender,!g.isGuest())}function l(){i(k)}var m=e.supportedLanguages(),n=[];for(var o in m)n.push({id:o,name:m[o]});a.languages=n,a.selectedLanguage=e.viewerLanguage();var p=c.get("viewerCountry");h.subscribe("user/change",l),a.$on("$destroy",function(){return h.unsubscribe("user/change",l)}),k(),a.showAdChoices=f.get(p)==f.US,a.changeLanguage=function(){b.location=e.generateLanguageUrl(a.selectedLanguage)}}])}(),function(){var a=angular.module("endo.view.layout");a.service("footer",["$document","$rootScope",function(a,b){function c(){return angular.element(a[0].querySelector(e))}function d(a){if(f!==a){var d={display:a?"":"none"},e=c();if(e.length)return e.css(d),void(f=a);var g=b.$on("$includeContentLoaded",function(b,e){angular.isString(e)&&e.startsWith("tpl://view/layout/footer/footer.")&&(c().css(d),f=a,g())})}}var e=".layout-footer",f=void 0;return{selector:e,show:function(){d(!0)},hide:function(){d(!1)}}}])}(),function(){var a=angular.module("endo.view.layout");a.controller("HeaderViewController",["$scope","$state","$window","user","config","api.auth.session","core.dom.scroll","api.notifications.notificationService","core.event.topic","model.uacf.EcommerceLink","$location","$document","$timeout","model.uacf.EcomLinks",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){a.uaLink=n.get(s,n.POSITION_HEADER,d.gender,!d.isGuest())}function p(){m(o)}function q(){angular.isDefined(document.hidden)&&document.hidden||d.isGuest()||a.notificationsToggle.show||r||(r=!0,h.getPending().finally(function(){r=!1}))}var r=null;a.isGuest=d.isGuest(),a.menuVisible=!1,a.profileMenuVisible=!1,a.notificationsToggle={show:!1},a.user=d,a.notificationsCounters=h.getCounters();var s=e.get("viewerCountry");i.subscribe("user/change",p),a.$on("$destroy",function(){return i.unsubscribe("user/change",p)}),o(),a.hasBenchmarkRole=d.hasRole("PEER_BENCHMARK_USER"),a.$watch(function(){return d.isGuest()},function(b,c){a.isGuest=b,q()}),l.on("visibilitychange",q),a.login=function(){b.go("auth.login")},a.signup=function(){b.go("auth.signup")},a.logout=function(){f.logout().finally(function(){i.publish("logout")})},a.toggleNotifications=function(){a.notificationsToggle.show=!a.notificationsToggle.show,a.menuVisible=!1},a.toggleMenu=function(){a.menuVisible=!a.menuVisible},a.hideMenu=function(){a.menuVisible=!1},a.closeNotifications=function(){a.notificationsToggle.show=!1},a.front=function(){return b.is("front")?void g.to(0):void b.go("front")},a.getDisplayName=function(){var a=[d.firstName,d.lastName].join(" ");return d.firstName||d.lastName?a:d.email},a.$on("$destroy",function(){stopRefreshPending(),l.off("visibilitychange",q)})}])}(),function(){var a=angular.module("endo.view.layout");a.service("header",["$document","$rootScope",function(a,b){function c(){return angular.element(a[0].querySelector(f))}function d(){return angular.element(a[0].querySelector(g))}function e(a){if(h!==a){var e={display:a?"":"none"},f=c(),g=d();if(f.length&&g.length)return f.css(e),g.css(e),void(h=a);var i=b.$on("$includeContentLoaded",function(b,f){angular.isString(f)&&f.startsWith("tpl://view/layout/header/header.")&&(c().css(e),d().css(e),h=a,i())})}}var f=".layout-header",g=".layout-header-placeholder",h=void 0;return{show:function(){e(!0)},hide:function(){e(!1)}}}])}(),function(){var a=angular.module("endo.view.layout");a.directive("eoNotificationDrawer",["$document","api.notifications.notificationService","core.dom.media","core.dom.viewport",function(a,b,c,d){return{replace:!1,restrict:"E",scope:{toggle:"=",user:"="},templateUrl:"tpl://view/layout/notifications/notificationDrawer.en.html",controller:"NotificationDrawerCtrl",link:function(e,f,g){function h(){e.$apply(function(){e.toggle.show&&(e.toggle.show=!1)})}e.notificationList=[];var i=function(){if(c.getBreakpointName()===c.XSMALL){var a=d.getSize().height-82;angular.element(f[0].querySelector("#notificationsScrollWrap")).css("max-height",a+"px")}};i(),f.on("click",function(a){a.stopPropagation()}),e.$watch("toggle.show",function(c,d){return!c&&d?void b.markAllAsSeen():void(c&&(e.finishedLoading=!1,i(),b.list().then(function(a){e.notificationList=a,e.finishedLoading=!0},function(a){}).finally(function(){a.one("click",h)})))})}}}]),a.controller("NotificationDrawerCtrl",["$scope","api.notifications.NOTIFICATION_TYPE","api.notifications.notificationService","$window",function(a,b,c,d){a.types=b,a.notificationList=[],a.finishedLoading=!1,a.newNotificationsCount=0,a.notificationCounters=c.getCounters(),a.acceptRequest=function(a){c.acceptRequest(a)},a.declineRequest=function(a){c.declineRequest(a)},a.toggleNotifications=function(){a.showData=!a.showData},a.getLink=function(a){return c.getLink(a)},a.notificationClick=function(a,b){a.preventDefault(),c.markAllAsSeen().then(function(){void 0!==b&&(d.location=b)})}}])}(),function(){function a(a,b,c,d,e){a.form={option:0},a.$watch("form.option",function(a){}),a.merge=function(){var f=angular.copy(d);a.form.option&&(f.deleteOriginals=a.form.option),a.mergePromise=e.merge(f).then(function(a){b(function(){c.close(a)},1e3)})},a.cancel=function(){c.dismiss()}}a.$inject=["$scope","$timeout","$modalInstance","params","api.workout.WorkoutResource"],angular.module("endo.view.merge").controller("view.merge.MergeDialogController",a)}(),function(){function a(a,b){function c(c){return d=a.open({templateUrl:b("tpl://view/merge/MergeDialog.en.html"),controller:"view.merge.MergeDialogController",size:"sm",resolve:{params:function(){return c}}})}var d;return{open:c}}a.$inject=["$modal","common.asset.templateUrl"],angular.module("endo.view.merge").factory("view.merge.MergeDialog",a)}(),function(){function a(a,b,c,d,e,f,g){function h(a){d.show(k)}function i(a){var b={},c=g.isGuest()||g.email!==j.emailAddress;return m.forEach(function(d){var e=a[d];b[d]={value:e!==l.NOT_SET,pending:e===l.PENDING},b[d].disabled=c&&!b[d].value,j.anyPending=j.anyPending||b[d].pending}),b}var j=this,k=f(e.fromCurrentState())("errors.generic"),l={NOT_SET:0,PENDING:1,CONFIRMED:2},m=["newFeature","companyNews","challenge","store","ua","periodicActivity","tipsAndTricks"];j.anyPending=!1,j.$onInit=function(){j.settings={},j.params=j.params||{},j.emailAddress=j.params.email||j.newsletters.email,j.settings=i(j.newsletters)},j.submit=function(b){var c={};angular.forEach(j.settings,function(a,b){c[b]=a.value}),j.pendingSent=!1,j.submitPromise=a.when(j.onSubmit({data:c,form:b})).then(function(a){angular.isObject(a)&&(j.settings=i(a),j.pendingSent=j.anyPending,b.$setPristine())}).catch(function(a){j.settings=i(j.newsletters),h(a)})}}a.$inject=["$q","$state","api.settings.NewslettersResource","ui.control.Toast","common.i18n.Translation","common.i18n.translateFactory","user"];var b={templateUrl:"tpl://view/newsletters/newsletters.en.html",controller:a,bindings:{newsletters:"<",params:"<",onSubmit:"&"}};angular.module("endo.view.newsletters").component("newsletters",b)}(),function(){angular.module("endo.view.premium").controller("PremiumViewController",["$scope","$window","$timeout","$stateParams","$modal","user","core.has","core.dom.scroll","core.dom.viewport","api.premium.banner","FEATURES","SubscriptionDialog","PremiumWelcomeDialog","common.tracker","isEligibleForFreeTrial",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){var b=42,c=i.getSize().height,d=i.getOffset().top;a.$apply(function(){a.ctaSticky=b>c-d})}function q(){var a="Get Premium",b="PurchaseComplete";n.trackEvent(a,b)}a.isEligibleForFreeTrial=o,angular.element(b).on("scroll resize",p),c(p),a.$on("$destroy",function(){angular.element(b).off("scroll",p)}),a.$watch(function(){return f.premium},function(b,c,d){a.isPremium=b}),a.hasBanner=!1;var r;if(null!==d.campaign){var s=parseInt(d.campaign);!isNaN(s)&&angular.isNumber(s)&&(r=s)}j.get(r).then(function(b){var c=b.data;a.hasBanner=!!(c&&c.title&&c.description&&c.imageUrl),a.banner=c}),c(function(){a.animateFeatures=!0},300),a.features=k,a.scroll=function(a){h.toElement(a)},a.upgrade=function(){var b={coupon:d.coupon,plan:d.plan};a.hasBanner&&(b.bannerId=a.banner.id),l.subscribe(b).then(q).then(function(){m.open()}).catch(function(){})},d.nopopup||!d.plan&&!d.coupon||a.upgrade()}])}(),function(){angular.module("endo.view.premium").factory("PremiumWelcomeDialog",["$q","$modal","common.asset.templateUrl",function(a,b,c){var d=null;return{open:function(){d=b.open({templateUrl:c("tpl://view/premium/welcome/welcome.en.html"),controller:"PremiumWelcomeController",windowClass:"premiumWelcome-window"})}}}])}(),function(){angular.module("endo.view.premium").controller("PremiumWelcomeController",["$scope","$state","$modalInstance","user",function(a,b,c,d){a.avatarUrl=d.avatarUrl,a.close=function(){c.close(),b.go("home")}}])}(),function(){function a(a,b,c){var d=this;d.notConsented=b.consentNeeded,d.email=b.email,d.changePassword=function(){c.open()}}a.$inject=["$scope","user","view.settings.PasswordDialog"],
angular.module("endo.view.settings").component("accountSettingsView",{templateUrl:"tpl://view/settings/account/account.en.html",controller:a})}(),function(){function a(a,b,c,d,e,f){function g(){return e.getJobStatus(c.id).then(function(a){var b=a.state,c=a.payload;return{missing:d.isMissing(b),pending:d.isPending(b),finished:d.isFinished(b),data:c}}).catch(function(){return!1})}function h(a,c){g().then(function(d){return d.missing&&c?void b(function(){h(a)},j):void f.get().finally(function(){return a.resolve(d)})})}function i(b){var c=a.defer();return h(c,b),c.promise}var j=1e4;return{getArchiveJob:g,waitForArchiveJob:i}}a.$inject=["$q","$timeout","user","model.job.JobStateEnum","api.settings.ArchiveResource","api.auth.session"],angular.module("endo.view.settings.archive").factory("view.settings.archive.ArchiveJob",a)}(),function(){angular.module("endo.view.settings.archive").directive("eoIncluded",[function(){return{restrict:"E",replace:!0,templateUrl:"tpl://view/settings/account/archive/archive-included/eoIncluded.en.html"}}])}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(b){var c=a.defer();return w.jobInfo().then(function(){h.waitForArchiveJob(b).then(function(a){z=a,c.resolve()}).catch(function(a){return c.reject(a)})}).catch(function(a){return c.reject(a)}),c.promise}function o(a,c,d,e){b.title=x(a+".heading"),c&&c.title&&(b.title=f.substitute(b.title,c.title)),b.body=x(a+".body"),c&&c.body&&(b.body=f.substitute(b.body,c.body)),b.button=x(a+".button"),c&&c.button&&(b.button=f.substitute(b.button,c.button)),b.disableButton=e,b.click=d,b.display=b.title&&b.body&&b.button}function p(b){var c=a.defer();if(!y)return y=m.confirm("tpl://view/settings/account/archive/archive-confirm/archive-confirm.en.html").then(function(){g.makeArchiveRequest(e.id,b).then(function(a){var b=a.success;return c.resolve(b)}).catch(function(a){return c.reject(a)})}).finally(function(){y=null,s()}),c.promise}function q(a){p(a).then(function(a){a&&v(!0)}).catch(function(a){l.show(x("error.request")),s()})}function r(){i.open(c.absUrl(),x("reauthenticate.heading"),x("reauthenticate.body")).then(function(a){a.type="PASSWORD",q(a)})}function s(){o("default",null,r,!1)}function t(){var a=z.data.userEmail;o("pending",{body:{email:a}},null,!0)}function u(){b.archiveUrl=z.data.downloadUrl,o("finished",null,null,!1),d.location=b.archiveUrl}function v(a){b.display=!1,n(a).then(function(){z.pending?t():z.finished?u():s()}).catch(function(a){l.show(x("error.status")),s()})}var w=this,x=k(j.fromCurrentState()),y=void 0,z=void 0,A=i.getAuthData();A?q(A):v()}a.$inject=["$q","$scope","$location","$window","user","core.lang.string","api.settings.ArchiveResource","view.settings.archive.ArchiveJob","view.auth2.login.LoginDialog","common.i18n.Translation","common.i18n.translateFactory","ui.control.Toast","ui.MsgBox"],angular.module("endo.view.settings.archive").component("archivePage",{templateUrl:"tpl://view/settings/account/archive/archive-page/archive-page.en.html",controller:a,bindings:{jobInfo:"<"}})}(),function(){function a(a,b,c,d,e,f){function g(){return e.getJobStatus(c.id).then(function(a){var b=a.state,c=a.payload;return{missing:d.isMissing(b),pending:d.isPending(b),finished:d.isFinished(b),data:c}}).catch(function(){return!1})}function h(a,c){g().then(function(d){return d.missing&&c?void b(function(){h(a)},j):void f.get().finally(function(){return a.resolve(d)})})}function i(b){var c=a.defer();return h(c,b),c.promise}var j=1e4;return{waitForDeleteJob:i}}a.$inject=["$q","$timeout","user","model.job.JobStateEnum","api.settings.DeleteResource","api.auth.session"],angular.module("endo.view.settings.delete").factory("view.settings.delete.DeleteJob",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){var b=a.defer();return y.jobInfo().then(function(){j.waitForDeleteJob().then(function(a){B=a,b.resolve()}).catch(function(a){return b.reject(a)})}).catch(function(a){return b.reject(a)}),b.promise}function q(a,c,d,e){e&&(b.title=z(a+".heading"),b.body=z(a+".body")),b.giveReason=!e,b.button=z(a+".button"),b.disableButton=d,b.click=c,b.display=(b.giveReason||b.title&&b.body)&&b.button}function r(b){var c=a.defer();return i.makeDeleteRequest(e.id,b).then(function(a){var b=a.success;return c.resolve(b)}).catch(function(a){return c.reject(a)}),c.promise}function s(a){r(a).then(function(a){if(w(),a){if(A)return;A=o.alert("tpl://view/settings/account/delete/delete-confirm/delete-confirm.en.html").then(function(){g.logout().finally(function(){h.publish("logout")})})}else n.show(z("error.pending"))}).catch(function(a){n.show(z("error.request")),u()})}function t(){k.open(c.absUrl(),z("reauthenticate.heading"),z("reauthenticate.body"),b.reason).then(function(a){a.type="PASSWORD",s(a)})}function u(){q("default",v,!0,!1),b.$watch("reason",function(a){b.disableButton=!a})}function v(){b.reason&&(q("continue",t,!1,!0),b.deleteButton=!0)}function w(){q("pending",null,!0,!0),b.deleteButton=!1}function x(){b.display=!1,p().then(function(){B.pending?w():u()}).catch(function(a){n.show(z("error.status")),u()})}var y=this,z=m(l.fromCurrentState()),A=void 0,B=void 0,C=k.getAuthData();C?s(C):x()}a.$inject=["$q","$scope","$location","$window","user","core.lang.string","api.auth.session","core.event.topic","api.settings.DeleteResource","view.settings.delete.DeleteJob","view.auth2.login.LoginDialog","common.i18n.Translation","common.i18n.translateFactory","ui.control.Toast","ui.MsgBox"],angular.module("endo.view.settings.delete").component("deletePage",{templateUrl:"tpl://view/settings/account/delete/delete-page/delete-page.en.html",controller:a,bindings:{jobInfo:"<"}})}(),function(){var a={NOTINTOSPORTS:"NOTINTOSPORTS",NOTUSEFULL:"NOTUSEFULL",DONTKNOWHOWTOUSE:"DONTKNOWHOWTOUSE",TOOMANYEMAIL:"TOOMANYEMAIL",PRIVACY:"PRIVACY",OTHERPROFILE:"OTHERPROFILE",OTHER:"OTHER"};angular.module("endo.view.settings.delete").directive("eoReason",["$window",function(b){return{templateUrl:"tpl://view/settings/account/delete/delete-reason/eoReason.en.html",restrict:"E",scope:{reason:"="},link:function(b,c,d){function e(c,d){c&&(b.reasonValue=c,b.reason={reason:b.reasonValue,platform:"WEBSITE"},c===a.OTHER&&(f.focus(),b.reason.comment=d||f.value))}var f=window.document.getElementById("otherText");b.reasons=a,b.$watch("reasonValue",function(a){e(a)}),b.$watch("otherText",function(a){e(b.reasonValue,a)}),b.focusOther=function(){e(a.OTHER)}},replace:!0,transclude:!0}}])}(),function(){function a(a){var b=this;b.$onInit=function(){b.navTitle&&a(function(){return b.navbarCtrl.setTitle(b.navTitle)})},b.$onDestroy=function(){b.navbarCtrl.setTitle("")}}a.$inject=["$timeout"],angular.module("endo.view.settings").component("settingsNavbarTitle",{require:{navbarCtrl:"^settingsNavbar"},controller:a,bindings:{navTitle:"@"}})}(),function(){var a=["<div>",'<div class="settings-navbar">','<div class="settings-navbar-back" ng-click="$ctrl.onBack()">','<span class="icon-chevron-left"></span>',"<span>{{ $ctrl.back }}</span>","</div>",'<div class="settings-navbar-title">',"{{ $ctrl.navTitle }}","</div>","</div>","<ng-transclude />","</div>"].join("");angular.module("endo.view.settings").component("settingsNavbar",{template:a,controller:function(){var a=this;this.setTitle=function(b){a.navTitle=b}},bindings:{back:"@",navTitle:"@",onBack:"&"},transclude:!0})}(),function(){function a(a,b,c,d,e,f){function g(b){a.go("settings.connect",{connectionResult:b})}function h(a,b){f.captureMessage("ConnectError: type => '"+a+"'",{tags:{source:"connect"},extra:b})}if(!this.connectionType)return h(null,{error:"NULL TYPE"}),void g({success:!1});var i=this.connectionType.toString(),j={type:i},k={type:this.connectionType},l=b.search();if(l.error)return k.success=!1,k.error=l.error,h(i,{error:l.error}),void g(k);switch(this.connectionType){case d.TWITTER:case d.GARMIN:j.authToken=l.oauth_token,j.oauthVerifier=l.oauth_verifier;break;case d.MMF:case d.MYFITNESSPAL:case d.FITBIT2:case d.WITHINGS2:case d.POLAR:j.code=l.code}e.connect(c.id,j).then(function(a){k.success=!0}).catch(function(a){k.success=!1,h(i,{error:a})}).finally(function(){g(k)})}a.$inject=["$state","$location","user","model.connection.ConnectionType","api.settings.ConnectionsResource","Raven"],angular.module("endo.view.settings").component("connectCallbackView",{controller:a,bindings:{connectionType:"<"}})}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(a){for(var b=void 0,c=0;c<v.userConnections.length&&!b;c++)v.userConnections[c].type===a&&(b=v.userConnections[c]);b?v.siteConnections[""+b.type.toString()]=b:v.siteConnections[""+a.toString()]={type:a,connected:!1}}function r(a){n.show(w)}function s(a){var b=f.FACEBOOK.toString(),c={type:b};return c.authToken=a.accessToken,c.accesTokenExpires=a.expiresIn,g.connect(e.id,c).then(function(a){a.type=f.get(a.type),v.siteConnections[""+b]=a,t(f.FACEBOOK)}).catch(function(){return u(f.FACEBOOK)})}function t(a){v.connectionResult={type:a,success:!0}}function u(a){v.connectionResult={type:a,success:!1}}var v=this;v.siteConnections={};var w=p(o.fromCurrentStateTree().$parent)("errors.generic");v.$onInit=function(){v.visibleConnections.forEach(q),v.oauthConnections=v.userConnections.filter(function(a){return a.type===f.OTHER}),v.connectionResult=a.connectionResult,v.fbLoadPromise=j.load()},v.connect=function(a){if(a.type===f.OTHER)return window.location=a.connectUrl,c(function(){},1e4);var h=a.type.toString(),i=a.type.callback;i=i?d.location.origin+i:b.href("callback",{connectionType:a.type},{inherit:!1,lossy:!1,absolute:!0});var j={type:h,callbackUrl:i};return g.authorize(e.id,j).then(function(b){var e="function"==typeof a.type.authorizeUrl?a.type.authorizeUrl(b.authorizeUrl,d.location.toString()):b.authorizeUrl;return window.location=e,c(function(){},1e4)}).catch(r)},v.connectFacebook=function(){var a=i.sync.getAuthResponse();if(a){var b=i.sync.getPermissions();return~b.indexOf(i.PERMISSIONS.FRIENDS)||~b.indexOf(i.PERMISSIONS.PROFILE)?s(a):i.authorize(i.PERMISSIONS.PROFILE,i.PERMISSIONS.FRIENDS).then(s).catch(function(){return u(f.FACEBOOK)})}return i.authorize(i.PERMISSIONS.PROFILE,i.PERMISSIONS.FRIENDS).then(s).catch(function(){return u(f.FACEBOOK)})},v.connectGoogle=function(){var a=f.GOOGLE.toString(),b={type:a};return k.authorize().then(function(c){return b.authToken=c.accessToken,b.accesTokenExpires=c.expires,b.code=c.code,g.connect(e.id,b).then(function(b){b.type=f.get(b.type),v.siteConnections[""+a]=b,t(f.GOOGLE)})}).catch(function(){return u(f.GOOGLE)})},v.disconnect=function(a){return g.deauthorize(e.id,a.id).then(function(){return a.connected=!1}).catch(r)},v.changeOption=function(a,b,c,d){var f,h=(f={type:d.type.toString()},f[a]=b,f);return c.disable(),g.update(e.id,d.id,h).then(function(){return d[a]=b}).catch(function(a){c.toggle(),r(a)}).finally(function(){return c.enable()})},v.changeFitbitOption=function(a,b,c){return v.changeOption(a,b,c,v.siteConnections.FITBIT2)};var x=!1;v.changeFitbitSharing=function(a,b,c){return b===!0?x?void c.toggle():(x=!0,m.open().result.then(function(){return v.changeOption(a,b,c,v.siteConnections.FITBIT2)}).catch(function(){return c.toggle()}).finally(function(){return x=!1})):v.changeOption(a,b,c,v.siteConnections.FITBIT2)}}a.$inject=["$stateParams","$state","$timeout","$window","user","model.connection.ConnectionType","api.settings.ConnectionsResource","api.user.UserResource","api.auth.facebook","common.loader.facebook","api.auth.google","ui.MsgBox","view.settings.WeightDialog","ui.control.Toast","common.i18n.Translation","common.i18n.translateFactory"],angular.module("endo.view.settings").component("connectSettingsView",{templateUrl:"tpl://view/settings/connect/connect.en.html",controller:a,bindings:{userConnections:"<",visibleConnections:"<"}})}(),function(){function a(a,b,d,e,f){var g=this;g.user=b,g.weightUnit=d.short.weight,g.weightLabel=d.label.weight,g.save=function(d){d.$$$validate()&&(g.updatePromise=f.update(b.id,{weight:g.user.weight}).then(function(){return c.close()}).catch(function(){return e.show(translation("errors.invalidPassword"),a)}))},g.dismiss=function(){return c.dismiss()}}function b(b){function d(){return c=b.open({templateUrl:"tpl://view/settings/connect/dialogs/WeightDialog.en.html",controller:a,controllerAs:"$ctrl",size:"sm",resolve:{userProfile:["api.user.UserResource","user","common.unit.UNITS",function(a,b,c){return c.load(),a.get(b.id)}]}})}return{open:d}}var c=void 0;a.$inject=["$scope","userProfile","common.unit.UNITS","ui.control.Toast","api.user.UserResource"],b.$inject=["$modal"],angular.module("endo.view.settings").factory("view.settings.WeightDialog",b)}(),function(){function a(a,b){var c=this;c.connectPromise=null;var d=null;c.$onInit=function(){c.connection=c.model,c.canDisconnect=void 0===c.canDisconnect||"true"===c.canDisconnect,c.loadingSdk=void 0!==c.sdkPromise,c.sdkLoaded=void 0===c.sdkPromise,c.loadingSdk&&a.when(c.sdkPromise).then(function(){return c.sdkLoaded=!0}).catch(function(){return c.sdkError=!0}).finally(function(){return c.loadingSdk=!1})},c.connect=function(){c.connectPromise=a.when(c.onConnect({connection:c.model}))},c.disconnect=function(){d||(d=b.confirm("tpl://view/settings/connect/dialogs/disconnect.en.html","js-settingsDiscconect").then(function(){c.disconnectPromise=a.when(c.onDisconnect({connection:c.model}))}).finally(function(){return d=null}))}}a.$inject=["$q","ui.MsgBox"],angular.module("endo.view.settings").component("eoConnection",{templateUrl:"tpl://view/settings/connect/eoConnection.en.html",controller:a,transclude:!0,bindings:{model:"<",onConnect:"&",onDisconnect:"&",canDisconnect:"<",sdkPromise:"<",manageLink:"@"}})}(),function(){function a(a,b,c,d,e,f){function g(){c.show(j)}function h(){i.secondaryEmail.primary=!0,i.primaryEmail.primary=!1;var a=i.secondaryEmail;i.secondaryEmail=i.primaryEmail,i.primaryEmail=a,i.setAsPrimary=!0}var i=this,j=void 0;i.$onInit=function(){i.primaryEmail=i.emails.filter(function(a){return a.primary})[0];var a=i.emails.filter(function(a){return!a.primary});i.secondaryEmail=a.length?a[0]:null,i.setAsPrimary=!1,j=e(d.fromCurrentStateTree().$parent)("errors.generic")},i.save=function(c){c.$$$validate()&&(i.savePromise=b.add(a.id,i.newEmail).then(function(a){i.secondaryEmail=a,i.confirmationSent=!0,i.emailToConfirm=a.email}).catch(function(a){409===a.status?(c.secondaryEmail.$setValidity("used",!1),c.$$$validate()):g()}))},i.clearInvalid=function(a){a.$setValidity("used",!0)},i.delete=function(c){i.deletePromise=b.delete(a.id,c.id).then(function(){i.secondaryEmail=null,i.confirmationSent=!1}).catch(g)},i.verify=function(c){i.emailToConfirm=c.email,i.verifyPromise=b.verify(a.id,c.id).then(function(){return i.confirmationSent=!0}).catch(g)},i.verifyPrimary=function(){i.emailToConfirm=i.primaryEmail.email,i.verifyPromise=f.sendConfirmationEmail(a.id).then(function(){return i.confirmationSent=!0}).catch(g)},i.makePrimary=function(c){i.primaryPromise=b.makePrimary(a.id,c.id).then(h).catch(g)}}a.$inject=["user","api.settings.EmailsResource","ui.control.Toast","common.i18n.Translation","common.i18n.translateFactory","api.user.UserResource"];var b={templateUrl:"tpl://view/settings/emails/emails.en.html",controller:a,bindings:{emails:"<"}};angular.module("endo.view.settings").component("emailsSettingsView",b)}(),function(){function a(a,b,c,d,e,f,g,h){var i=this,j=void 0;i.$onInit=function(){i.copy={},i.copy=angular.copy(i.zones),j=f(e.fromCurrentStateTree().$parent)("errors.generic"),i.bpm=g.short.heartRate;var a=h.buildAccountSettingsUrl();i.links={settings:function(b){return'<a href="'+a+'">'+b+"</a>"},monitors:function(a){return'<a href="https://www.endomondo.com/uaecom?page=UAHeartRate&CID=MMF%7CREF%7CEndo%7CSite%7CSettings%7C%7CHeartRate" target="_blank">'+a+"</a>"}}},i.discard=function(){i.copy=angular.copy(i.zones)},i.save=function(e){e.$$$validate()&&(i.savePromise=d(function(d,e){a.save(b.id,i.copy).then(function(){i.zones=angular.copy(i.copy),d()}).catch(function(a){400!==a.status&&c.show(j),e(a)})}))}}a.$inject=["api.settings.HeartrateResource","user","ui.control.Toast","$q","common.i18n.Translation","common.i18n.translateFactory","common.unit.UNITS","urlBuilder"],angular.module("endo.view.settings").component("heartrateSettingsView",{bindings:{zones:"<"},controller:a,templateUrl:"tpl://view/settings/heartrate/heartrate.en.html"})}(),function(){function a(a,b,c,d,e){function f(a){k=a.max-a.rest,j.restWidth=(a.zone1Start-a.rest)/k*100,j.z1Start=j.restWidth,j.z1Width=(a.zone2Start-a.zone1Start)/k*100,j.z2Start=j.z1Start+j.z1Width,j.z2Width=(a.zone3Start-a.zone2Start)/k*100,j.z3Start=j.z2Start+j.z2Width,j.z3Width=(a.zone4Start-a.zone3Start)/k*100,j.z4Start=j.z3Start+j.z3Width,j.z4Width=(a.zone5Start-a.zone4Start)/k*100,j.z5Start=j.z4Start+j.z4Width,j.z5Width=(a.max-a.zone5Start)/k*100}function g(a){return a.rest<a.zone1Start&&a.zone1Start<a.zone2Start&&a.zone3Start<a.zone4Start&&a.zone4Start<a.zone5Start&&a.zone5Start<a.max}function h(a){if(j.zoneSelected){var b=j.zones;if(!(a.pageX<m||a.pageX>m+n)){var d=100*(a.pageX-m)/n,e=Math.floor(k*d/100+j.zones.rest);switch(j.zoneSelected){case 1:if(e<b.rest+l||e>b.zone2Start-l)return;b.zone1Start=e;break;case 2:if(e<b.zone1Start+l||e>b.zone3Start-l)return;b.zone2Start=e;break;case 3:if(e<b.zone2Start+l||e>b.zone4Start-l)return;b.zone3Start=e;break;case 4:if(e<b.zone3Start+l||e>b.zone5Start-l)return;b.zone4Start=e;break;case 5:if(e<b.zone4Start+l||e>b.max-l)return;b.zone5Start=e}g(b)&&c.$apply(function(){return f(b)}),a.stopPropagation()}}}function i(){j.zoneSelected=null}var j=this,k=void 0,l=3,m=void 0,n=void 0;j.$onInit=function(){f(j.zones),j.bpm=e.short.heartRate},j.pickSlider=function(a){j.zoneSelected=a},j.$postLink=function(){var c=a[0].querySelector(".js-wrapper");j.zoneSelected=null,m=d.getClipRect(c).left,n=c.clientWidth,b.on("mousemove",h),b.on("mouseup",i)},j.$onChanges=function(a){g(j.zones)&&f(j.zones)},j.$onDestroy=function(){b.off("mousemove",h),b.off("mouseup",i)}}a.$inject=["$element","$document","$scope","core.dom.geometry","common.unit.UNITS"],angular.module("endo.view.settings").component("heartrateZoneSlider",{bindings:{zones:"<",max:"<",rest:"<"},controller:a,templateUrl:"tpl://view/settings/heartrate/heartrateZoneSlider.en.html"})}(),function(){function a(a,b,c,d){var e=this;e.submit=function(a,b){return b.$pristine?void 0:d.put({},a)}}a.$inject=["$q","user","api.settings.NotificationsResource","api.settings.NewslettersResource"];var b={templateUrl:"tpl://view/settings/newsletters/newsletters.en.html",controller:a,bindings:{newsletters:"<"}};angular.module("endo.view.settings").component("newslettersSettingsView",b)}(),function(){function a(a){var b=this,c={enable:function(){b.disabled=!1},disable:function(){b.disabled=!0},toggle:function(){b.value=!b.value}};b.$onInit=function(){b.id=a()},b.change=function(){b.onUpdate({$name:b.name,$value:b.value,$control:c})}}var b='\n    <input\n      class="eoCheckbox"\n      type="checkbox"\n      id="{{ $ctrl.id }}"\n      ng-model="$ctrl.value"\n      ng-change="$ctrl.change()"\n      ng-disabled="$ctrl.disabled"\n    >\n    <label class="eoCheckbox-label" for="{{ $ctrl.id }}"></label>\n  ';a.$inject=["core.util.uuid"];var c={template:b,controller:a,bindings:{name:"@",value:"<",disabled:"<",onUpdate:"&"}};angular.module("endo.view.settings").component("notificationCheckbox",c)}(),function(){function a(a,b,c,d,e,f){function g(b,d){var e;return c.patch(a.id,(e={},e[b]=d,e))}var h=this,i=(f(e.fromCurrentState()),f(e.fromCurrentStateTree().$parent)("errors.generic"));h.change=function(a,b,c){c.disable(),g(a,b).catch(function(){d.show(i),c.toggle()}).finally(function(){return c.enable()})}}a.$inject=["user","core.func.throttle","api.settings.NotificationsResource","ui.control.Toast","common.i18n.Translation","common.i18n.translateFactory"],angular.module("endo.view.settings").component("notificationsSettingsView",{templateUrl:"tpl://view/settings/notifications/notifications.en.html",controller:a,bindings:{notifications:"<"}})}(),function(){function a(a,b,d,e,f){var g=this;g.title=b("title"),g.success=function(){c.close(),e.logout().finally(function(){f.publish("logout")})},g.failure=function(c){var e=8,f=c===e?"errors.invalidPassword":"errors.generic";d.show(b(f),a)},g.dismiss=function(){return c.dismiss()}}function b(b){function e(){return c=b.open({template:d,controller:a,controllerAs:"$ctrl",size:"sm",resolve:{translation:["$injector","$templateRequest","common.i18n.Translation",function(a,b,c){var d=a.get("passwordSettingsViewDirective")[0],e=d.templateUrl;return b(e).then(function(){return c.require(e)})}]}})}return{open:e}}var c=void 0,d=["<div>",'<div class="modal-header">',"<eo-toast></eo-toast>",'<button type="button" class="close" ng-click="$ctrl.dismiss()">','<span aria-hidden="true">&times;</span>',"</button>",'<h3 class="modal-title">{{ $ctrl.title }}</h3>',"</div>",'<div class="modal-body">',"<password-settings-view",' on-success="$ctrl.success()"',' on-failure="$ctrl.failure($code)"',' on-dismiss="$ctrl.dismiss()"',">","</div>","</div>"].join("");a.$inject=["$scope","translation","ui.control.Toast","api.auth.session","core.event.topic"],b.$inject=["$modal"],angular.module("endo.view.settings").factory("view.settings.PasswordDialog",b)}(),function(){function a(a,b,c,d){function e(a){function b(a){a.$isEmpty(a.$viewValue)&&(a.$setTouched(),a.$setValidity("required",!1),d.push(!1))}var c=6,d=[],e=a.oldPassword,f=a.newPassword,g=a.confirmPassword;b(e),b(f),b(g);var h=!(f.$viewValue&&f.$viewValue.length<c);if(f.$setValidity("minlength",h),d.push(h),!f.$isEmpty(f.$viewValue)&&!g.$isEmpty(g.$viewValue)){var i=f.$viewValue===g.$viewValue;g.$setValidity("match",i),d.push(i)}return d.every(function(a){return a===!0})}var f=this;f.dismiss=f.onDismiss,f.save=function(a){if(e(a)){var g=d.changePassword(c.id,f.oldPassword,f.newPassword);f.progress=g,g.then(function(){b(f.onSuccess,500)}).catch(function(a){var b=void 0;a.data&&Array.isArray(a.data.errors)&&(b=(a.data.errors[0]||{}).code),f.onFailure({$code:b})})}},f.change=function(a){angular.forEach(a.$error,function(b,c){return a.$setValidity(c,!0)})}}a.$inject=["$scope","$timeout","user","api.user.AccountResource"];var b={templateUrl:"tpl://view/settings/password/password.en.html",controller:a,bindings:{onSuccess:"&",onFailure:"&",onDismiss:"&"}};angular.module("endo.view.settings").component("passwordSettingsView",b)}(),function(){function a(a,b){function c(a){f&&a.stopPropagation()}var d=this,e="privacy-switch-disabled",f=!1,g=void 0;d.$onInit=function(){a[0].addEventListener("click",c,!0)},d.$onDestroy=function(){a[0].removeEventListener("click",c,!0)};var h={enable:function(){f=!1,a.removeClass(e)},disable:function(){f=!0,a.addClass(e)},revert:function(){b.$applyAsync(function(){return d.value=g})}};d.change=function(a){g=d.value,d.onUpdate({$name:d.name,$value:a.valueOf(),$control:h})}}var b='\n    <eo-privacy-switch\n      privacy="$ctrl.value"\n      on-change="$ctrl.change(privacy)"\n      min-privacy="$ctrl.minPrivacy"\n    />\n  ';a.$inject=["$element","$scope"],angular.module("endo.view.settings").component("privacySwitch",{template:b,controller:a,bindings:{name:"@",value:"<",onUpdate:"&",minPrivacy:"<"}})}(),function(){function a(a,b,c,d,e,f){var g=this,h=e(d.fromCurrentStateTree().$parent)("errors.generic"),i=d.require("common.data.privacy");g.$onInit=function(){"undefined"!=typeof g.rules.showProfile&&(g.rules.showProfile=String(g.rules.showProfile)),"undefined"!=typeof g.rules.allowComments&&(g.rules.allowComments=f.get(g.rules.allowComments),g.rules.allowComments=g.rules.allowComments===f.EVERYONE?f.FRIENDS:g.rules.allowComments),"undefined"!=typeof g.rules.allowPeptalks&&(g.rules.allowPeptalks=f.get(g.rules.allowPeptalks),g.rules.allowPeptalks=g.rules.allowPeptalks===f.EVERYONE?f.FRIENDS:g.rules.allowPeptalks),g.FRIENDS=f.FRIENDS,g.publicLabel=i("EVERYONE"),g.friendsLabel=i("FRIENDS"),g.privateLabel=i("ONLY_ME")},g.onUpdate=function(d,e,f){var g;f.disable(),b.patch(a.id,(g={},g[d]=e,g)).catch(function(){c.show(h),f.revert()}).finally(f.enable)},g.onProfileUpdate=function(){var d=Number(g.rules.showProfile);g.profileDisabled=!0,b.patch(a.id,{showProfile:d}).catch(function(){c.show(h),g.rules.showProfile=String(3===d?0:3)}).finally(function(){return g.profileDisabled=!1})},g.hasRules=function(){var a=Object.keys(g.rules);return!(0===a.length||1===a.length&&"showProfile"===a[0])},g.rulesCount=function(){return Object.keys(g.rules).length}}a.$inject=["user","api.settings.PrivacyResource","ui.control.Toast","common.i18n.Translation","common.i18n.translateFactory","api.PrivacyEnum"],angular.module("endo.view.settings").component("privacySettingsView",{templateUrl:"tpl://view/settings/privacy/privacy.en.html",controller:a,bindings:{rules:"<"}})}(),function(){function a(a){function b(b){return a.open({templateUrl:b,controller:["$scope","$modalInstance",function(a,b){a.resolve=function(){b.close()},a.reject=function(){b.dismiss()}}],backdrop:"static",size:"sm"}).result}return{confirm:b}}a.$inject=["$modal"],angular.module("endo.view.settings.privacy").factory("view.settings.privacy.PrivacyConfirm",a)}(),function(){function a(a,b,c,d,e,f,g){function h(){return e.getPrivateUserJob(c.id).then(function(a){var b=a.state;return d.isPending(b)}).catch(function(){return!0})}function i(a){h().then(function(c){return c?void b(function(){i(a)},n):void f.get().finally(function(){return a.resolve()})})}function j(){var b=a.defer();return i(b),b.promise}function k(){return e.getWorkoutPrivacySyncJob(c.id).then(function(a){var b=a.state;return d.isPending(b)}).catch(function(){return!0})}function l(a){k().then(function(c){return c?void b(function(){l(a)},n):void a.resolve()})}function m(){var b=a.defer();return l(b),b.promise}var n=1e4;return{waitForPrivateUserJob:j,waitForWorkoutPrivacySyncJob:m}}a.$inject=["$q","$timeout","user","model.job.JobStateEnum","api.settings.PrivacyResource","api.auth.session","model.job.JobEnum"],angular.module("endo.view.settings.privacy").factory("view.settings.privacy.PrivacyJob",a)}(),function(){function a(a){for(var b in a)delete a[b]}function b(b,c,d,e,f,g){var h=function(){function b(a){_classCallCheck(this,b),this.state={byId:{},selectedPreset:f.CUSTOM,pendingRules:{},pendingPresets:[],pendingJobs:[],defaults:{disabledOptions:[]}},this.sync(a)}return b.prototype.getState=function(){return this.state},b.prototype.sync=function(b){b&&(a(this.state.byId),this.state.byId=angular.extend(this.state.byId,b),b[e.DEFAULT_WORKOUT]===d.FRIENDS?this.state.defaults.disabledOptions=[d.PUBLIC]:b[e.DEFAULT_WORKOUT]===d.PRIVATE?this.state.defaults.disabledOptions=[d.PUBLIC,d.FRIENDS]:this.state.defaults.disabledOptions=[],this.state.selectedPreset=g.exec(b)),c.isPrivateUser()&&(this.state.selectedPreset=f.PRIVATE)},b.prototype.requestRuleUpdate=function(a,b){var c=this.state.pendingRules;Array.isArray(c[a])||(c[a]=[]),-1===c[a].indexOf(b)&&c[a].push(b)},b.prototype.resolveRuleUpdate=function(a,b,c){this.sync(c);var d=this.state.pendingRules;if(Array.isArray(d[a])){var e=d[a].indexOf(b);e>-1&&d[a].splice(e,1)}},b.prototype.requestPresetUpdate=function(a){var b=this.state.pendingPresets;-1===b.indexOf(a)&&b.push(a)},b.prototype.resolvePresetUpdate=function(a,b){this.sync(b);var c=this.state.pendingPresets,d=c.indexOf(a);d>-1&&c.splice(d,1)},b.prototype.requestJob=function(a){var b=this.state.pendingJobs,c=b.indexOf(a);-1===c&&b.push(a)},b.prototype.resolveJob=function(a){var b=this.state.pendingJobs,c=b.indexOf(a);c>-1&&b.splice(c,1)},b}();return h}b.$inject=["user","viewer","model.privacy.PrivacyLevelEnum","model.privacy.PrivacyRuleEnum","model.privacy.PrivacyPresetEnum","model.privacy.PrivacyPresetMatcher"],angular.module("endo.view.settings.privacy").factory("view.settings.privacy.PrivacyStore",b)}(),function(){var a=['<div class="privacyBanner">','<div class="privacyBanner-title" >{{$ctrl.title}}</div>','<div class="privacyBanner-description">{{$ctrl.description}}</div>',"</div>"].join("");angular.module("endo.view.settings.privacy").component("privacyBanner",{template:a,bindings:{title:"@",description:"@"}})}(),function(){function a(){var a=this;a.handleClick=function(){a.disabled||a.onClick()}}var b=['<div class="privacyButton" ng-click="$ctrl.handleClick()" ng-class="{\'privacyButton--disabled\':$ctrl.disabled, \'privacyButton--block\':$ctrl.block}">',"{{$ctrl.label}}","</div>"].join("");angular.module("endo.view.settings.privacy").component("privacyButton",{template:b,controller:a,bindings:{label:"@",block:"<",disabled:"<",onClick:"&"}})}(),function(){var a=['<div class="privacyCategory">','<div class="privacyCategory-title" ng-class="{\'privacyCategory-title--disabled\':$ctrl.disabled}">{{$ctrl.title}}</div>','<div class="privacyCategory-description">{{$ctrl.description}}</div>',"</div>"].join("");angular.module("endo.view.settings.privacy").component("privacyCategory",{template:a,bindings:{title:"@",description:"@",disabled:"<"}})}(),function(){function a(){var a=this;a.handleClick=function(){a.disabled||a.onClick()}}var b=['<div class="privacyCollapsibleTrigger" ng-click="$ctrl.handleClick()">','<div class="privacyCollapsibleTrigger-label" ng-class="{\'privacyCollapsibleTrigger--disabled\':$ctrl.disabled}">{{$ctrl.label}}</div>','<div class="privacyCollapsibleTrigger-toggle" ng-class="{\'privacyCollapsibleTrigger--disabled\':$ctrl.disabled}">','<div class="privacyCollapsibleTrigger-icon" ng-class="{\'privacyCollapsibleTrigger-icon--collapsed\':$ctrl.collapsed}">','<span class="icon-chevron-up"></span>',"</div>","</div>","</div>"].join("");angular.module("endo.view.settings.privacy").component("privacyCollapsibleTrigger",{template:b,controller:a,bindings:{label:"@",collapsed:"<",disabled:"<",onClick:"&"}})}(),function(){function a(){var a=this;a.$onInit=function(){a.size=a.size||18}}var b=['<div class="privacyIcon" ng-style="{width: $ctrl.size, height: $ctrl.size}">','<svg xmlns="http://www.w3.org/2000/svg" ng-attr-width="{{$ctrl.size}}" ng-attr-height="{{$ctrl.size}}" viewBox="0 0 18 18">','<path fill="#222628" fillRule="evenodd" d="M9.124 9.15c.219-.089.45-.166.692-.226.24.342.833.63 1.527.63.693 0 1.285-.287 1.526-.628 1.388.342 2.47 1.155 2.845 2.228v.098a5.52 5.52 0 0 1-3.925 2.09l-.097-.303c-.41-1.29-1.549-2.327-3.095-2.845l.067-.104c.184-.292.338-.61.46-.94zm.096-3.863C9.22 3.849 10.164 3 11.329 3s2.11.849 2.11 2.287-.945 3.146-2.11 3.146-2.11-1.708-2.11-3.146zM2 13.423c.307-1.143 1.356-2.01 2.774-2.366.24.342.833.63 1.527.63.693 0 1.285-.287 1.526-.627 1.418.349 2.517 1.189 2.868 2.296a5.523 5.523 0 0 1-4.374 2.138c-1.751 0-3.31-.81-4.321-2.07zM4.178 7.42c0-1.438.944-2.287 2.11-2.287 1.164 0 2.109.85 2.109 2.287 0 1.438-.945 3.147-2.11 3.147s-2.11-1.709-2.11-3.147z" />',"</svg>","</div>"].join("");angular.module("endo.view.settings.privacy").component("privacyFriendsIcon",{template:b,controller:a,bindings:{size:"<"}})}(),function(){function a(){var a=this;a.$onInit=function(){a.size=a.size||18}}var b=['<div class="privacyIcon" ng-style="{width: $ctrl.size, height: $ctrl.size}">','<svg xmlns="http://www.w3.org/2000/svg" ng-attr-width="{{$ctrl.size}}" ng-attr-height="{{$ctrl.size}}" viewBox="0 0 18 18">','<path fill="#222628" fillRule="evenodd" d="M10.531 10.152c1.467.386 2.605 1.315 2.969 2.539-1.043 1.437-2.683 2.364-4.528 2.364-1.812 0-3.426-.896-4.472-2.29.318-1.263 1.403-2.223 2.871-2.616.249.378.862.698 1.58.698.718 0 1.33-.318 1.58-.695zm-1.513-.545c-1.228 0-2.223-1.889-2.223-3.479S7.79 3.6 9.018 3.6c1.228 0 2.223.938 2.223 2.528s-.995 3.479-2.223 3.479z" />',"</svg>","</div>"].join("");angular.module("endo.view.settings.privacy").component("privacyPrivateIcon",{template:b,controller:a,bindings:{size:"<"}})}(),function(){function a(){var a=this;a.$onInit=function(){a.size=a.size||18}}var b=['<div class="privacyIcon" ng-style="{width: $ctrl.size, height: $ctrl.size}">','<svg xmlns="http://www.w3.org/2000/svg" ng-attr-width="{{$ctrl.size}}" ng-attr-height="{{$ctrl.size}}" viewBox="0 0 18 18">','<path fill="#222628" fillRule="evenodd" d="M9 14.76c-.097 0-.192-.009-.288-.014-.023-.065-.025-.127.038-.17.243-.164.668-.317.852-.54.184-.223.06-.393.257-.597.198-.205.651-.102.789-.349s-.056-.51.116-.77c.174-.257.42-.672.368-.88-.052-.21-1.05-.127-1.337-.438-.288-.312-.256-.524-.462-.706-.206-.182-.425-.065-.606-.192-.18-.129-.37-.425-.596-.476-.227-.051-.193.055-.426-.064-.232-.12-.308-.21-.495-.26-.16-.042-.454.132-.482.313-.02.14.04.29-.1.654-.138.364-.353.682-.23 1.086.122.404.347.907.574 1.058.228.152.634.23.74.514.093.242.067 1.283.501 1.771C5.41 14.315 3.24 11.91 3.24 9c0-1.513.59-2.887 1.548-3.916-.046.31-.119.66-.237.82-.232.317-.479.731-.478 1.166.001.435.278.813.271 1.079-.007.267.18.578.76.835.58.256.61.495.754.533.145.04.194-.291.062-.41-.132-.12-.29-.177-.312-.363-.022-.188.24-.366.046-.413-.193-.046-.185.34-.49.362-.304.02-.52-.649-.178-1.032.343-.383.268-.328.427-.387.16-.06.513-.19.643-.162.13.028.208.391.337.31.13-.08-.043-.374.197-.522.24-.148.414-.088.601-.327.187-.24-.015-.454.235-.667.25-.213.743-.49 1.01-.483.266.007.316-.103.396-.409.08-.306.629-.29.662-.066.033.222-.103.285.152.34.256.056.12-.15.028-.314s-.09-.616-.385-.66c-.294-.045-.33.083-.459-.17-.128-.254-.222-.185-.408-.063-.186.123-.352.885-.802.837-.24-.025-.104-.237-.27-.268-.294-.054-.433-.078-.369-.218.1-.22.098-.202.384-.327.286-.124.497.143.663.035.167-.11.75-.54.988-.336-.257.227-.035.229.194.263.228.035.395-.072.398-.206.004-.134-.627-.212-.623-.297.006-.121.116-.225.237-.314.33.013.654.048.967.114.057.337.343 1.108.62.962.345-.182.388-.258 1.506-.022.006.002.009.002.015.002.318.227.61.484.876.769-.077.067-.125.16-.03.28.183.229.784.79.5.78-.282-.01-.45-.002-.24.264.21.266.32.3.46-.164a.234.234 0 0 1 .08-.127c.19.327.35.673.474 1.037-.311-.175-.653-.316-.827-.215-.366.212.04.29-.08.524-.118.232-.635.406-.701 1.066-.067.66.384 1.245.822 1.445.437.2.501-.442.675-.265.174.177.103.534.082.782-.007.085-.006.253.005.439-.794 2.233-2.923 3.84-5.425 3.84M9 2.7A6.307 6.307 0 0 0 2.7 9c0 3.474 2.826 6.3 6.3 6.3 3.474 0 6.3-2.826 6.3-6.3 0-3.474-2.826-6.3-6.3-6.3" />',"</svg>","</div>"].join("");
angular.module("endo.view.settings.privacy").component("privacyPublicIcon",{template:b,controller:a,bindings:{size:"<"}})}(),function(){function a(a){var b=this,c=a(b.onClick);b.handleClick=function(a){c({$level:a})}}var b=['<div class="privacyMasterRulePicker">','<div class="privacyMasterRulePicker-text">','<div class="privacyMasterRulePicker-label" ng-class="{\'privacyMasterRulePicker-label--disabled\':$ctrl.disabled}">{{$ctrl.label}}</div>','<div class="privacyMasterRulePicker-description">{{$ctrl.description}}</div>',"</div>",'<div class="privacyMasterRulePicker-buttons">','<privacy-toggle-button class="privacyMasterRulePicker-button" label="{{$ctrl.options[0]}}" checked="$ctrl.level == 0" pending="$ctrl.pending.indexOf(0) > -1" disabled="$ctrl.disabled || $ctrl.disabledOptions.indexOf(0) > -1" on-click="$ctrl.handleClick(0)"></privacy-toggle-button>','<privacy-toggle-button class="privacyMasterRulePicker-button" label="{{$ctrl.options[1]}}" checked="$ctrl.level == 1" pending="$ctrl.pending.indexOf(1) > -1" disabled="$ctrl.disabled || $ctrl.disabledOptions.indexOf(1) > -1" on-click="$ctrl.handleClick(1)"></privacy-toggle-button>','<privacy-toggle-button class="privacyMasterRulePicker-button" label="{{$ctrl.options[2]}}" checked="$ctrl.level == 2" pending="$ctrl.pending.indexOf(2) > -1" disabled="$ctrl.disabled || $ctrl.disabledOptions.indexOf(2) > -1" on-click="$ctrl.handleClick(2)"></privacy-toggle-button>',"</div>","</div>"].join("");a.$inject=["$parse"],angular.module("endo.view.settings.privacy").component("privacyMasterRulePicker",{template:b,controller:a,bindings:{label:"@",description:"@",level:"<",options:"<",pending:"<",disabled:"<",onClick:"&"}})}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l){function m(){q.requestJob(f.PRIVATE_USER),h.waitForPrivateUserJob().then(function(){q.resolveJob(f.PRIVATE_USER),q.resolvePresetUpdate(c.PRIVATE)})}function n(){q.requestJob(f.WORKOUT_PRIVACY_SYNC),h.waitForWorkoutPrivacySyncJob().then(function(){q.resolveJob(f.WORKOUT_PRIVACY_SYNC)})}var o=this,p=k(j.fromCurrentState()),q=new g(o.rules),r=[String(d.DURATION),String(d.DEFAULT_WORKOUT),String(d.DEFAULT_MAP),String(d.DEFAULT_TRANSPORTATION)];o.isPrivateUserJobPending&&(q.requestPresetUpdate(c.PRIVATE),m()),o.isWorkoutPrivacySyncJobPending&&n(),o.state=q.getState(),o.PrivacyLevel=b,o.PrivacyPreset=c,o.Job=f,o.collapsed=!0,o.hasWorkoutDefaultsChanged=!1,o.handleRuleClick=function(a,b){o.hasWorkoutDefaultsChanged===!1&&r.indexOf(a)>-1&&(o.hasWorkoutDefaultsChanged=!0),q.requestRuleUpdate(a,b),o.onRuleClick(a,b).then(function(c){q.resolveRuleUpdate(a,b,c)}).catch(function(c){q.resolveRuleUpdate(a,b,rules),l.show(p("error.save"))})},o.handlePresetClick=function(a){return a===c.PRIVATE?void i.confirm("privacy-confirm-private-user.html").then(function(){q.requestPresetUpdate(a),o.onPresetClick(a).then(function(){m()}).catch(function(){q.resolvePresetUpdate(a),l.show(p("error.save"))})}).catch(angular.noop):(q.requestPresetUpdate(a),void o.onPresetClick(a).then(function(b){q.resolvePresetUpdate(a,b);var d=void 0;a===c.PUBLIC&&(d="privacy-confirm-public-preset.html"),a===c.FRIENDS&&(d="privacy-confirm-friends-preset.html"),void 0!==d&&i.confirm(d).then(function(){o.onWorkoutPrivacySyncJob().then(function(){n()}).catch(function(){l.show(p("error.save"))})}).catch(angular.noop)}).catch(function(){q.resolvePresetUpdate(a),l.show(p("error.save"))}))},o.handleCollapseClick=function(){o.collapsed=!o.collapsed},o.handleApplyToAllClick=function(){i.confirm("privacy-confirm-workout-defaults.html").then(function(){o.onWorkoutPrivacySyncJob().then(function(){a.scrollTo(0,0),n()}).catch(function(){l.show(p("error.save"))})}).catch(angular.noop)}}a.$inject=["$window","model.privacy.PrivacyLevelEnum","model.privacy.PrivacyPresetEnum","model.privacy.PrivacyRuleEnum","model.privacy.PrivacyPresetMatcher","model.job.JobEnum","view.settings.privacy.PrivacyStore","view.settings.privacy.PrivacyJob","view.settings.privacy.PrivacyConfirm","common.i18n.Translation","common.i18n.translateFactory","ui.control.Toast"],angular.module("endo.view.settings.privacy").component("privacyPage",{templateUrl:"tpl://view/settings/privacy2/privacy-page/privacy-page.en.html",controller:a,bindings:{rules:"<",isPrivateUserJobPending:"<",isWorkoutPrivacySyncJobPending:"<",onRuleClick:"<",onPresetClick:"<",onWorkoutPrivacySyncJob:"<"}})}(),function(){function a(){var a=this;a.onClick()}var b='\n    <div class="privacyPresetItem" ng-click="$ctrl.onClick()">\n      <div class="privacyPresetItem-inner">\n        <div class="privacyPresetItem-title">{{$ctrl.title}}</div>\n        <div class="privacyPresetItem-description">{{$ctrl.description}}</div>\n      </div>\n      <div class="privacyPresetItem-radio">\n      </div>\n    </div>\n  ';angular.module("endo.view.settings.privacy").component("privacyPresetItem",{template:b,controller:a,bindings:{title:"@",description:"@",selected:"<",pending:"<",disabled:"<",onClick:"&"}})}(),function(){var a='<div class="preset-picker">privacy-preset-picker</div>';angular.module("endo.view.settings.privacy").component("privacyPresetPicker",{template:a})}(),function(){function a(){var a=this;a.handleClick=function(){a.checked||a.disabled||a.onClick()}}var b=['<div class="privacyRuleButton" ng-class="{\'privacyRuleButton--checked\': $ctrl.checked, \'privacyRuleButton--disabled\': $ctrl.disabled}" ng-click="$ctrl.handleClick()">','<div ng-if="!$ctrl.pending">','<div class="privacyRuleButton-icon" ng-transclude></div>',"</div>",'<div ng-if="$ctrl.pending">','<div class="privacyRuleButton-icon"><spinner size="22"></spinner></div>',"</div>","</div>"].join("");angular.module("endo.view.settings.privacy").component("privacyRuleButton",{template:b,controller:a,bindings:{checked:"<",pending:"<",disabled:"<",onClick:"&"},transclude:!0})}(),function(){function a(a){var b=this,c=a(b.onClick);b.handleClick=function(a){c({$level:a})}}var b=['<div class="privacyRulePicker">','<div ng-if="!$ctrl.description">','<div class="privacyRulePicker-label" ng-class="{\'privacyRulePicker-label--disabled\': $ctrl.disabled}">{{$ctrl.label}}</div>',"</div>",'<div class="privacyRulePicker-textWrapper" ng-if="$ctrl.description">','<div class="privacyRulePicker-labelWithDescription" ng-class="{\'privacyRulePicker-label--disabled\': $ctrl.disabled}">{{$ctrl.label}}</div>','<div class="privacyRulePicker-description">{{$ctrl.description}}</div>',"</div>",'<div class="privacyRulePicker-options">','<privacy-rule-button checked="$ctrl.level == 0" pending="$ctrl.pending.indexOf(0) > -1" disabled="$ctrl.disabled || $ctrl.disabledOptions.indexOf(0) > -1" on-click="$ctrl.handleClick(0)">','<privacy-public-icon size="24"></privacy-public-icon>',"</privacy-rule-button>",'<privacy-rule-button checked="$ctrl.level == 1" pending="$ctrl.pending.indexOf(1) > -1" disabled="$ctrl.disabled || $ctrl.disabledOptions.indexOf(1) > -1" on-click="$ctrl.handleClick(1)">','<privacy-friends-icon size="24"></privacy-friends-icon>',"</privacy-rule-button>",'<privacy-rule-button checked="$ctrl.level == 2" pending="$ctrl.pending.indexOf(2) > -1" disabled="$ctrl.disabled || $ctrl.disabledOptions.indexOf(2) > -1" on-click="$ctrl.handleClick(2)">','<privacy-private-icon size="24"></privacy-private-icon>',"</privacy-rule-button>","</div>","</div>"].join("");a.$inject=["$parse"],angular.module("endo.view.settings.privacy").component("privacyRulePicker",{template:b,controller:a,bindings:{label:"@",description:"@",level:"<",pending:"<",disabled:"<",disabledOptions:"<",onClick:"&"}})}(),function(){var a='<div class="privacySeparator"></div>';angular.module("endo.view.settings.privacy").component("privacySeparator",{template:a})}(),function(){function a(){var a=this;a.handleClick=function(){a.disabled||a.onClick()}}var b=['<div class="privacyToggleButton" ng-click="$ctrl.handleClick()" ng-class="{\'privacyToggleButton--disabled\':$ctrl.disabled}">','<div class="privacyToggleButton-button" ng-class="{\'privacyToggleButton-button--checked\':$ctrl.checked}">','<div class="privacyToggleButton-label" ng-class="{\'privacyToggleButton-label--pending\':$ctrl.pending}">{{$ctrl.label}}</div>',"</div>",'<div ng-if="$ctrl.pending" class="privacyToggleButton-spinner">','<spinner size="22"></spinner>',"</div>","</div>"].join("");angular.module("endo.view.settings.privacy").component("privacyToggleButton",{template:b,controller:a,bindings:{label:"@",checked:"<",pending:"<",disabled:"<",onClick:"&"}})}(),function(){function a(a){var b=this,c=a(b.onClick);b.handleClick=function(){b.disabled||c({$checked:b.checked})}}var b=['<div class="privacyToggle" ng-class="{\'privacyToggle--disabled\': $ctrl.disabled}" ng-click="$ctrl.handleClick()">','<div class="privacyToggle-inner">','<div class="privacyToggle-label" ng-class="{\'privacyToggle-label--disabled\': $ctrl.disabled}" ng-transclude></div>','<div class="privacyToggle-description">{{ $ctrl.description }}</div>',"</div>",'<div class="privacyToggle-radio">','<div class="privacyToggle-radioInner" ng-if="!$ctrl.pending">','<radio checked="$ctrl.checked" disabled="$ctrl.disabled"></radio>',"</div>",'<div class="privacyToggle-radioInner" ng-if="$ctrl.pending">','<spinner size="22"></spinner>',"</div>","</div>","</div>"].join("");a.$inject=["$parse"],angular.module("endo.view.settings.privacy").component("privacyToggle",{template:b,controller:a,bindings:{description:"@",checked:"<",pending:"<",disabled:"<",onClick:"&"},transclude:!0})}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){s.form={},w.forEach(function(a){return s.form[a]=s.user[a]}),i.is(s.form.favoriteSport)&&(s.form.favoriteSport=s.form.favoriteSport.valueOf())}function r(){w.forEach(function(a){return s.user[a]=s.form[a]})}var s=this;k.require(),l.require();var t=n(m.fromCurrentState()),u=m.require("common/units/units.i18n.json"),v=n(m.fromCurrentStateTree().$parent)("errors.generic"),w=["firstName","lastName","country","dateOfBirth","gender","unitSystem","weight","height","favoriteSport","timeZone"];s.$onInit=function(){q();var a=s.countries;s.countries=[],a.forEach(function(a){var b=k.name(a.countryCode);b&&s.countries.push({id:a.countryCode,label:b})}),s.weightUnit=h.short.weight,s.sports=i.filter(function(a){return!a.isHPB}).map(function(a){return{id:a.valueOf(),label:l.getTitle(a)}}),s.timezones=j.map(function(a){return{id:a.valueOf(),label:a.toString()}}),b.$watch("$ctrl.form.unitSystem",function(a,b){a!==b&&(s.weightUnit=u("weight."+a+".short"))})},s.submit=function(b){if(!b.$pristine&&b.$$$validate()){var h={};w.forEach(function(a){return h[a]=s.form[a]});var i=a.defer();s.promise=i.promise,g.update(e.id,h).then(function(){b.$setPristine(),f.locale.units()!==h.unitSystem&&f.locale.units(h.unitSystem),r(),p.isConsentRequired(e.id).then(function(a){a&&(e.revokeConsent(),d(400).then(function(){c.go("consent.login",{returnState:{name:"home",params:{}}})}))}).finally(function(){i.resolve()})}).catch(function(a){return i.reject(),400==a.status?void b.$$$revalidate(a):void o.show(v)})}},s.discard=q,s.onUploadSuccess=function(a){a.data&&a.data.url&&(e.avatarUrl=a.data.url)},s.onUploadError=function(a){o.show(t("errors.upload"))}}a.$inject=["$q","$scope","$state","$timeout","user","viewer","api.user.UserResource","common.unit.UNITS","api.workout.SportEnum","model.TimezoneEnum","model.CountryTranslate","common.data.SportTranslate","common.i18n.Translation","common.i18n.translateFactory","ui.control.Toast","api.consent.ConsentResource"],angular.module("endo.view.settings").component("profileSettingsView",{templateUrl:"tpl://view/settings/profile/profile.en.html",controller:a,bindings:{user:"<",countries:"<"}})}(),function(){function a(a,b,c,d){var e=this;b.isFrontendTester=c.isFrontendTester(),e.user=c,e.isApiClient=d.get("isApiClient"),e.username=[c.firstName,c.lastName].join(" "),e.username.trim()||(e.username=c.email),e.year=new Date(c.createdDate).getFullYear(),e.isNavigation=function(){return a.is("settings")},e.onBack=function(){a.go("settings")}}a.$inject=["$state","$scope","user","config"],angular.module("endo.view.settings").component("settingsView",{templateUrl:"tpl://view/settings/settings.en.html",controller:a})}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){switch(o.injury=null,o.preferredApp=null,o.preferredDevice=null,o.notNeeded=null,o.reasonPlaceholder=null,o.mainReason){case s.LOST_MOTIVATION:o.reasonPlaceholder=q("reason.motivation");break;case s.PREFER_OTHER_APP:o.reasonPlaceholder=q("reason.preferOther");break;case s.MISSING_FEATURE:o.reasonPlaceholder=q("reason.missing");break;case s.MISSING_INTEGRATION:o.reasonPlaceholder=q("reason.integration");break;case s.GOAL_REACHED:o.reasonPlaceholder=q("reason.goal");break;default:o.reasonPlaceholder=q("reason.other")}}var o=this,p=f(e.fromCurrentStateTree().$parent)("errors.generic"),q=f(e.fromCurrentState()),r=500,s={UNKNOWN:0,LOST_MOTIVATION:1,GOT_INJURED:2,DONT_NEED_PREMIUM:3,DONT_WANT_TO_USE_ENDOMONDO:4,TO_EXPENSIVE:5,MISSING_FEATURE:6,OTHER:7,CANNOT_MANAGE_SUSBSCRIPTION:8,PREFER_OTHER_APP:9,MISSING_INTEGRATION:10,GOAL_REACHED:11},t={RUNNING:0,OTHER_SPORT:1,NON_SPORT:2},u={POLAR:0,APPLE_WATCH:1,GARMIN_WATCH:2,FITBIT:3,SUUNTO:4,OTHER:5},v={RUNKEEPER:0,NIKE_PLUS:1,ADIDAS:2,RUNTASTIC:3,STRAVA:4,OTHER:5},w={INFREQUENT_WORKOUTS:0,NOT_ENOUGH_TIME:1,FREE_GOOD_ENOUGH:2,TOO_EXPENSIVE:3,CANNOT_AFFORD:4,NOT_WORTH:5,OTHER:6};o.$onInit=function(){return o.subscription&&o.subscription.id?(o.step=1,o.reasons=s,o.mainReason=null,o.injuryType=t,o.appType=v,o.deviceType=u,o.notNeededType=w,o.reasonMessage=null,o.commentMessage=null,o.links={stats:j.buildStatsUrl(),trainingplan:j.buildTraningPlanUrl(),workouts:j.buildWorkoutsUrl(),heartrate:j.buildHeartrateSettingsUrl()},void n()):void c.go("settings.subscription")},b.$watch("$ctrl.mainReason",n),o.confirm=function(){l.to(0),o.step=2},o.unsubscribe=function(){var b={reason:o.mainReason||s.UNKNOWN,injury:o.injury,preferredApp:o.preferredApp,preferredDevice:o.preferredDevice,notNeeded:o.notNeeded,reasonMessage:o.reasonMessage,commentMessage:o.commentMessage};o.unsubscribePromise=a(function(a,c){d.cancel(o.subscription.id,b).then(function(){d.get().then(function(a){o.subscription=a,o.subscription.type=m.get(a.type)}).finally(function(){a(),k(function(){l.to(0),o.step=4},r)})}).catch(function(){c(),h.show(p)})})},o.reactivate=function(){o.reactivatePromise=a(function(b,e){d.reactivate(o.subscription.id).then(function(b){return b&&b.success===!1?a.reject():void 0}).then(function(){b(),k(function(){c.go("settings.subscription")},r)}).catch(function(){e(),h.show(q("error.reactivate"))})})}}a.$inject=["$q","$scope","$state","api.premium.subscription","common.i18n.Translation","common.i18n.translateFactory","ui.MsgBox","ui.control.Toast","core.lang.enumeration","urlBuilder","$timeout","core.dom.scroll","api.premium.SubscriptionType"],angular.module("endo.view.settings").component("subscriptionCancelView",{templateUrl:"tpl://view/settings/subscription/cancel/cancel.en.html",controller:a,bindings:{subscription:"<"}})}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k){function l(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],b=void 0,c=function(a){return g("number")(a/100,2)},d=function(a,b){return f.substitute(a,[c(b)])};switch(a.code){case e.PLAN_TYPE_MONTHLY:case e.PLAN_TYPE_MONTHLY_2M_TRIAL:case e.PLAN_TYPE_MONTHLY_3M_TRIAL:case e.PLAN_TYPE_MONTHLY_1M_TRIAL:case e.PLAN_TYPE_MONTHLY_12M_TRIAL:case e.PLAN_TYPE_MONTHLY_24M_TRIAL:case e.PLAN_TYPE_MONTHLY_6M_TRIAL:case e.PLAN_TYPE_MONTHLY_7D_TRIAL:b=[d(p("pricing.monthly"),a.price)];break;case e.PLAN_TYPE_YEARLY:case e.PLAN_TYPE_YEARLY_2M_TRIAL:case e.PLAN_TYPE_YEARLY_3M_TRIAL:case e.PLAN_TYPE_YEARLY_1M_TRIAL:case e.PLAN_TYPE_YEARLY_12M_TRIAL:case e.PLAN_TYPE_YEARLY_24M_TRIAL:case e.PLAN_TYPE_YEARLY_6M_TRIAL:case e.PLAN_TYPE_YEARLY_7D_TRIAL:case e.PLAN_TYPE_YEARLY_PRO:b=[d(p("pricing.yearly"),a.price),d(p("pricing.yearlyPerMonth"),a.price/12)];break;default:if(angular.isString(a.code)){if(a.code.startsWith("monthly")){b=[d(p("pricing.monthly"),a.price)];break}a.code.startsWith("yearly")&&(b=[d(p("pricing.yearly"),a.price),d(p("pricing.yearlyPerMonth"),a.price/12)])}}return b}function m(c){n.subscription=c,c.type=b.get(c.type),n.noSubscription=c.type===b.NULL||c.type===b.UNKNOWN||c.type!==b.RECURLY_PREMIUM_MEMBER&&c.active===!1,c.type.canManage&&c.subscriptionPlan&&(c.subscriptionPlan.name=l(c.subscriptionPlan),n.newPlanCode=c.subscriptionPlan.code),Array.isArray(c.planChoices)&&(n.planChoices={},c.planChoices.slice().reverse().forEach(function(a){n.planChoices[""+a.code]=a,a.name=l(a)})),c.active&&(n.showSpinner=!0,a.getRenewalDate(c.id).then(function(a){return c.renewalDate=a}).finally(function(){return n.showSpinner=!1})),c.active||(n.showSpinner=!0,a.getExpiryDate(c.id).then(function(a){return c.expiryDate=a}).finally(function(){return n.showSpinner=!1})),c.subscriptionEndsAt&&(c.subscriptionEndsAt=new Date(c.subscriptionEndsAt))}var n=this,o=d(c.fromCurrentStateTree().$parent)("errors.generic"),p=d(c.fromCurrentState()),q=null;n.$onInit=function(){m(n.subscription)},n.changePlan=function(){q||(q=i.confirm("tpl://view/settings/subscription/changeDialog.en.html","js-subscriptionChangeDialog"),q.then(function(){n.changePromise=h(function(b,c){a.changePlan(n.subscription.id,n.newPlanCode).then(function(c){a.get().then(m),b(c)}).catch(function(a){j.show(o),c(a)})})}).finally(function(){return q=null}))},n.reactivate=function(){n.reactivatePromise=h(function(b,c){a.reactivate(n.subscription.id).then(function(c){a.get().then(m),b(c)}).catch(function(a){j.show(o),c(a)})})}}a.$inject=["api.premium.subscription","api.premium.SubscriptionType","common.i18n.Translation","common.i18n.translateFactory","api.premium.plan","core.lang.string","$filter","$q","ui.MsgBox","ui.control.Toast","$state"],angular.module("endo.view.settings").component("subscriptionSettingsView",{templateUrl:"tpl://view/settings/subscription/subscription.en.html",controller:a,bindings:{subscription:"<"}})}(),function(){function a(a,b,c){a.viewer=b,a.resendConfirmation=function(){a.sendingPromise=c.sendConfirmationEmail(b.id).then(function(b){a.checkEmail=!0})}}a.$inject=["$scope","user","api.user.UserResource"],angular.module("endo.view.shutout").controller("view.merge.EmailShutoutController",a)}(),function(){function a(a,b){function c(c){return c=c||{},d=a.open({templateUrl:b("tpl://view/shutout/EmailShutoutDialog.en.html"),controller:"view.merge.EmailShutoutController",size:"sm",backdrop:c.closeable?!0:"static",keyboard:!!c.closeable})}var d;return{open:c}}a.$inject=["$modal","common.asset.templateUrl"],angular.module("endo.view.shutout").factory("view.shutout.EmailShutoutDialog",a)}(),function(){function a(a,b){function c(a,b,c,d){d.viewTerms(c.id),a.accept=function(){return a.promise=d.acceptTerms(c.id).then(function(){return b.location="/"})},a.termsSummaryUrl=d.termsSummaryUrl(c.id),a.loading=!0}function d(d){return d=d||{},e=a.open({templateUrl:b(f),controller:c,size:"sm",backdrop:d.closeable?!0:"static",keyboard:!!d.closeable})}var e=void 0,f="tpl://view/shutout/TermsDialog.en.html";return c.$inject=["$scope","$window","user","api.user.UserResource"],{open:d}}a.$inject=["$modal","common.asset.templateUrl"],angular.module("endo.view.shutout").factory("view.shutout.TermsDialog",a)}(),function(){function a(a,b,c){switch(a.transformations={steps:'<span class="applemusic-steps">${text}</span>'},a.language=b.get("locale.language"),a.language){case"DE":a.countryCode="de";break;case"DA":a.countryCode="dk";break;case"ES":a.countryCode="es";break;case"FR":a.countryCode="fr";break;case"IT":a.countryCode="it";break;case"PL":a.countryCode="pl";break;default:a.countryCode="us"}}a.$inject=["$scope","config","core.lang.string"],angular.module("endo.view.static.applemusic").controller("view.static.applemusic.AppleMusicViewController",a)}(),function(){angular.module("endo.view.subscription").factory("ChallengeDialog",["$q","$modal","common.asset.templateUrl",function(a,b,c){function d(d){var f=a.defer();return e=b.open({templateUrl:c("tpl://view/subscription/challengeSubscription.html"),controller:"ChallengeDialogController",backdrop:"static",resolve:{params:function(){return d}}}),e.rendered.then(function(){var a=document.querySelector("#threeDSecureContainer");d.attach(a),d.on("error",function(a){f.reject(),e.close()}),d.on("token",function(a){f.resolve(a.id),e.close()})}),e.result.then(function(){f.resolve()}).catch(function(){f.reject()}),f.promise}var e=null;return{challenge:function(a){return d(a)}}}])}(),function(){angular.module("endo.view.subscription").factory("SubscriptionDialog",["$q","$modal","user","view.auth.AuthDialog","common.asset.templateUrl",function(a,b,c,d,e){function f(){var d=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(c.premium===!0)return a.reject();var f,h,i=a.defer();return angular.isObject(d)?(f="monthly"==d.plan?"monthly":"yearly",h=d.coupon):f="yearly",g=b.open({templateUrl:e("tpl://view/subscription/subscription.en.html"),controller:"SubscriptionViewController",backdrop:"static",resolve:{params:function(){return{planType:f,coupon:h,bannerId:d.bannerId}}}}),g.result.then(function(){i.resolve()}).catch(function(){i.reject()}),i.promise}var g=null;return{subscribe:function(b){return c.isGuest()?d.login().then(function(){return f(b)}).catch(function(){return a.reject()}):f(b)}}}])}(),function(){angular.module("endo.view.subscription").controller("ChallengeDialogController",["$scope","$modalInstance",function(a,b){a.close=function(){b.dismiss()}}])}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){function w(c){var d;return c===!0&&(d=a.planModel.coupon),k.get(a.planModel.plan,d).then(function(c){return c.price.couponType===k.COUPON_TYPE_FREE?(b.go("redeem",{coupon:d}),c):(E=c,E.price.coupon=d,F=E.price,a.prices={monthly:e("number")(c.monthly.price/100,2),yearly:e("number")(c.yearly.price/100,2),yearlyPerMonth:e("number")(c.yearly.price/100/12,2),total:c.price.total},E)}).catch(function(a){u.log(a)})}function x(){a.visibility.invalidCoupon=!1,a.visibility.discountCoupon=!1,a.visibility.trialPeriodCoupon=!1,a.visibility.cancelTrialError=!1,a.visibility.freeTrial=!1}function y(){var a=Date.UTC(2015,0,1)<=Date.now();return a}function z(b){var c=!0;switch(b.price.couponType){case k.COUPON_TYPE_ERROR:a.visibility.invalidCoupon=!0,c=!1;break;case k.COUPON_TYPE_DISCOUNT:a.visibility.discountCoupon=!0,a.coupon.discount=b.price.discount;break;case k.COUPON_TYPE_FREE_TRIAL:a.visibility.freeTrial=!0;case k.COUPON_TYPE_TRIAL:a.visibility.trialPeriodCoupon=!0,a.coupon.trialPeriodDays=b.price.trialPeriodDays,a.coupon.trialPeriodMonths=b.price.trialPeriodMonths}return c}function A(){O||(O=f.open({scope:P,templateUrl:"tpl://view/subscription/message/euVatValidationError.en.html",backdrop:"static"}))}function B(){O&&(O.close(),O=null)}function C(){var a={hitType:"pageview",title:"premium.welcome",page:"/premium/welcome",location:p.parse(q.location).origin+"/premium/welcome"};o.track(a),j.get().then(function(){g.close()})}function D(b){var c=!1,d=s.get(b,"errors");return Array.isArray(d)?(d.forEach(function(b){switch(b.code){case 8:c=!0;break;case 9:a.visibility.cancelTrialError=!0;break;default:a.visibility.otherError=!0}}),void(c&&y()&&A())):void(a.visibility.otherError=!0)}var E,F,G="subscription";a.countries=[],r.forEach(function(b){b.isSanctioned()||a.countries.push({id:b.toString(),name:b.name})}),a.subscriptionFormSubmitted=0,a.shakeElement=!1,a.visibility={overlay:!1,totalPriceProgress:!1,invalidCoupon:!1,discountCoupon:!1,trialPeriodCoupon:!1,cancelTrialError:!1,otherError:!1,freeTrial:!1},a.email={card:i.email,paypal:i.email},a.emailVerified=i.emailVerified,a.coupon={trialPeriod:0,discount:0},a.prices={monthly:"--",yearly:"--",yearlyPerMonth:"--",total:"--"};var H="card",I="paypal";a.PAYMENT_METHOD_CARD=H,a.PAYMENT_METHOD_PAYPAL=I,a.paymentMethod=H;for(var J=(new Date).getMonth()+1,K=(new Date).getFullYear(),L=[],M=0;11>M;M++){var N=K+M;L.push({id:N,name:N})}a.years=L,a.months=[1,2,3,4,5,6,7,8,9,10,11,12],a.subscriptionModel={first_name:i.firstName,last_name:i.lastName,number:"",cvv:"",month:J,year:K},a.planModel={plan:h.planType,coupon:h.coupon},function(){a.visibility.overlay=!0,n.start(G),w(!!h.coupon).then(function(b){a.visibility.overlay=!1,n.end(G),z(b)})}(),a.euVatValidationEnabled=y,a.dismiss=function(){g.dismiss()},a.$watch("subscriptionModel.country",function(b){b=r.get(b),a.isEuCountry=b?b.isEuropeanUnionMember():!1}),a.applyCoupon=function(b){x();var d=c.defer();a.couponPromise=d.promise,w(!0).then(function(a){return z(a)?void d.resolve():void d.reject()}).catch(function(){d.reject()})},a.changePlan=function(){function b(){var b=d===k.PLAN_TYPE_MONTHLY;a.planModel.plan=b?k.PLAN_TYPE_YEARLY:k.PLAN_TYPE_MONTHLY}function c(){a.visibility.totalPriceProgress=!1}var d=a.planModel.plan,e=E[d].code;switch(a.visibility.totalPriceProgress=!0,F.couponType){case k.COUPON_TYPE_FREE_TRIAL:case k.COUPON_TYPE_TRIAL:case k.COUPON_TYPE_NONE:l.price(e).then(function(b){F.total=b.now.total,F.planType=d,F.planCode=e,a.prices.total=F.total}).catch(b).finally(c);break;case k.COUPON_TYPE_DISCOUNT:case k.COUPON_TYPE_ERROR:x(),w(!!a.planModel.coupon).then(z).catch(b).finally(c)}},a.$watch("subscriptionFormSubmitted",function(b){b&&(a.shakeElement=!0,d(function(){a.shakeElement=!1},750))}),a.subscribe=function(b){if(u.log(F),a.subscriptionFormSubmitted++,b.$$$validate()){var c;F.couponType===k.COUPON_TYPE_DISCOUNT&&(c=F.coupon);var d=i.email;i.emailVerified||(d=a.email.card);var e={planCode:F.planCode,recurlyCoupon:c,premiumBannerId:h.bannerId,email:d,billingCountry:a.subscriptionModel.country},f=l.token(b),g=m.create(f,a.subscriptionModel,e,v);a.subscriptionPromise=g,g.then(C).catch(D)}};var O,P=a.$new(!0);P.closeEuValidationError=B,a.subscribePaypal=function(b){function c(b,c){if(!b){var d;F.couponType===k.COUPON_TYPE_DISCOUNT&&(d=F.coupon);var e=i.email;i.emailVerified||(e=a.email.paypal);var f={planCode:F.planCode,recurlyCoupon:d,premiumBannerId:h.bannerId,email:e,billingCountry:a.subscriptionModel.country},g=m.create(c.id,c.id,f);a.paypalSubscriptionPromise=g,g.then(C).catch(D)}}if(a.subscriptionFormSubmitted++,b.$$$validate()){var d={monthly:"Endomondo Premium Monthly",yearly:"Endomondo Premium Annual"}[F.planType];m.validateEUSync(a.subscriptionModel.country)?l.api.paypal({description:d},c):A()}},a.dismissSuccessPanel=function(){g.close()},a.changePaymentMethod=function(b){a.paymentMethod=b}}a.$inject=["$scope","$state","$q","$timeout","$filter","$modal","$modalInstance","params","user","api.auth.session","api.premium.plan","api.premium.recurly","api.premium.subscription","ui.progress.progressBar","common.tracker","core.io.url","$window","model.CountryEnum","core.lang.object","Raven","$log","ChallengeDialog"],angular.module("endo.view.subscription").controller("SubscriptionViewController",a)}(),function(){function a(a,b,c,d){var e=function(){function e(a,b){_classCallCheck(this,e),this.workout=a,this.interval=b,this.userId=this.workout.author.id,this.workoutId=this.workout.id,this.feedId=this.workout.feedId}return e.prototype.start=function(e){var f=this;if(!this.isRunning){var g=void 0,h=void 0,i=function(){g&&g.resolve(),h&&h.resolve(),g=a.defer();var b={timeout:g.promise};if(d.get(f.userId,f.workoutId,b).then(function(a){return e(a)}),f.feedId){h=a.defer();var i={timeout:h.promise},j={userId:f.userId,feedId:f.feedId};c.getUserFeed(j,i).then(function(a){return e(void 0,a)})}};this.isRunning=!0,this.promise=b(i,this.interval)}},e.prototype.stop=function(){b.cancel(this.promise),this.isRunning=!1},e}();return e}a.$inject=["$q","$interval","api.feed.FeedResource","api.workout.WorkoutResource"],angular.module("endo.view.workout").factory("view.workout.WorkoutRefresher",a)}(),function(){function a(a){a.$watch("model.workout.id",function(){a.tabs={points:{active:!1},laps:{active:!1},records:{active:!1},intervals:{active:!1}};var b="";a.hasPointChart?b="points":a.hasLapChart?b="laps":a.hasRecordChart?b="records":a.hasIntervalChart&&(b="intervals"),b&&(a.tabs[b].active=!0)})}a.$inject=["$scope"],angular.module("endo.view.workout").controller("view.workout.ChartsController",a)}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){function b(b){var d=b.url,e=4201,f=c.defer();return a.facebookSdk.ui({method:"share",href:d},function(a){var b=a.error_code;if(b){if(b===e)return f.resolve(null);f.reject(a)}}),f.promise}a.facebookSharing=!0,i.shareUrl(a.model.workout).then(function(b){return a.facebookSharing=!1,b}).then(b).catch(function(a){return j.show(r.errors.facebookSharingError),null}).then(function(b){return null!==b?i.sharedToFacebook(a.model.workout,b):void 0})}function q(){function a(){d.resolve()}function b(){d.reject()}var d=c.defer();if(f.sync.isConnected()){var e=f.sync.getPermissions();~e.indexOf(f.PERMISSIONS.FRIENDS)||~e.indexOf(f.PERMISSIONS.PROFILE)?a():f.authorizeFriends().then(a).catch(b)}else f.authorizeFriends().then(a).catch(b);return d.promise}var r=o.fromCurrentStateTree().$parent.headline;a.facebookSdk=null,a.facebookSharing=!1,a.twitterSharing=!1,g.load(2e4).then(function(b){a.facebookSdk=b}),a.$watch("facebookSdk",function(){a.canShareFacebook=null!==a.facebookSdk&&a.model.workout.author.id===h.id}),a.$watch("model.workout.id",function(){a.canShareFacebook=null!==a.facebookSdk&&a.model.workout.author.id===h.id,a.canShareTwitter=a.model.workout.author.id===h.id,a.canEdit=a.model.workout.author.id===h.id,a.hasActions=a.canEdit||a.model.workout.isMapVisible()||void 0===a.model.workout.canCopy||a.model.workout.canCopy===!0,a.facebookShared=a.model.workout.isSharedToFacebook(),a.twitterShared=a.model.workout.isSharedToTwitter()}),a.shareFacebook=function(){if(!a.facebookSharing){var b=a.model.workout;a.facebookShared&&b.canFbShareViaBackend||q().then(function(a){p()}).catch(function(a){return j.show(r.errors.facebookSharingError)})}},a.shareTwitter=function(){function b(){a.twitterShared=!0}function c(b){return a.twitterShared=!1,b&&b.data&&b.data.errors&&b.data.errors[0]&&b.data.errors[0].code==e.UNAUTHORIZED?void n.open():void j.show(r.errors.twitterSharingError)}function d(){a.twitterSharing=!1}a.twitterSharing||a.twitterShared||(a.twitterSharing=!0,i.shareToTwitter(a.model.workout).then(b).catch(c).finally(d))},a.updateTitle=function(){if(a.title!=a.personalisedTitle){var b={};return b.title=a.title,i.update(a.model.workout.author.id,a.model.workout.id,b).then(function(){i.getHashtags(a.model.workout).then(function(b){a.model.workout.hashtags=b})})}},a.editWorkout=function(){l.open(a.model).then(function(){d.publish("workout/reload")})},a.$watchGroup(["model.workout.sport","model.workout.startTime","model.workout.distance","model.workout.duration","model.workout.title"],function(b){a.planName=m.goalName(a.model.workout.trainingplan),a.title=a.personalisedTitle=k(a.model.workout)})}a.$inject=["$scope","$state","$q","core.event.topic","api.ResponseCodeEnum","api.auth.facebook","common.loader.facebook","user","api.workout.WorkoutResource","ui.control.Toast","ui.workout.headline","ui.workout.WorkoutEditDialog","ui.trainingplan.TrainingPlanTranslate","ui.social.TwitterConnectionDialog","common.i18n.Translation"],angular.module("endo.view.workout").controller("view.workout.HeadlineController",a)}(),function(){function a(a,b,c){function d(b,d){var e={};return e[d]=b,c.update(a.model.workout.author.id,a.model.workout.id,e).then(function(){c.getHashtags(a.model.workout).then(function(b){a.model.workout.hashtags=b})})}a.dot={},a.onBlur=function(b,c){b!=a.model.workout[c]&&d(b,c)},a.onDeleteNote=function(){var b=a.model.workout.author.id,d=a.model.workout.id;c.update(b,d,{notes:""}).then(function(){a.dot.notes=a.model.workout.notes,a.model.workout.notes=""})},a.onUndeleteNote=function(){var b=a.model.workout.author.id,d=a.model.workout.id;c.update(b,d,{notes:a.dot.notes}).then(function(){a.model.workout.notes=a.dot.notes,a.dot.notes=""})},a.$watch("model.workout.id",function(b){
b&&(a.dot.message=a.model.workout.message,a.hasInputs=a.model.$canEdit||a.model.workout.notes||a.model.workout.message||a.model.workout.hashtags&&a.model.workout.hashtags.length)}),a.$watch("model.feed.id",function(b){b&&(a.hasLikes=a.model.feed.canLike||a.model.feed.likeCount>0)})}a.$inject=["$scope","core.lang.html","api.workout.WorkoutResource"],angular.module("endo.view.workout").controller("view.workout.SocialController",a)}(),function(){angular.module("endo.view.workout").controller("view.workout.StatsController",["$scope","api.workout.WeatherEnum","user",function(a,b,c){a.$watch("model.workout",function(c){c&&(a.weather=b.get(a.model.workout.weather?a.model.workout.weather.type:void 0),c.weather?(a.weatherText=a.translateWeather(a.weather.toString(),"--"),a.windDirection=b.windDirection(c.weather.windDirection)):a.weatherText="--",a.hasPace=c.sport.pace)})}])}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){b.reload()}function q(){return!a.model.workout.$error&&a.model.workout.startTime?a.model.workout.startTime.valueOf():void 0}function r(b){a.isSelf=e.workout.$userId==d.id||b.id===d.id,a.isFriend=0===b.viewerFriendship,a.model.$canEdit=a.isSelf||d.hasRole("ADMIN"),a.showCta=!d.isGuest()&&1===b.viewerFriendship&&!a.isSelf}function s(b){a.model.feed=b}function t(b){b?a.model.workout=b:b=a.model.workout,void 0===b.$userId&&(b.$userId=b.author.id),a.showNotFound=b.$error&&404==b.$error.status&&!b.$latest,a.showNoWorkout=b.$error&&404==b.$error.status&&b.$latest,a.showAds=!d.isGuest()&&!d.premium,r(a.model.workout.author),b&&(a.model.$viewerTagged=b.taggedUsers.contains(d),a.hasMap=b.hasMap(),a.hasPointChart=b.hasPoints()&&b.points.hasSensorData(),a.hasLapChart=b.hasLaps()||b.hasManualLaps(),a.hasRecordChart=b.hasRecords(),a.hasIntervalChart=b.plannedIntervals&&b.plannedIntervals.length,a.hasCharts=a.hasPointChart||a.hasLapChart||a.hasRecordChart||a.hasIntervalChart,a.showHashtags=!b.isLive&&(a.isSelf||a.isFriend&&b.hashtags&&b.hashtags.length>0))}a.model=e,a.viewer=d,a.translateSports=i.sports,a.translateWeather=i.weather,a.translateUnits=i.units,a.ads=j.getAds(),a.labs=m.getBoolean("workout.labs"),a.fullscreenToggle={active:!1};var u=new Date,v=12e4,w={force:m.getBoolean("workout.live.force")||!1,interval:m.getInteger("workout.live.interval")||v},x="count",y="sum",z=new m("workout.calendar.mode",x),A=new m("workout.calendar.submode","duration");a.calendar={submode:A.get()},a.calendar.mode=z.get()==x?x:y,a.calendar.toggle=a.calendar.mode!==x,a.$watch("calendar.toggle",function(b){a.calendar.mode=b?a.calendar.submode:x,z.set(b?y:x)}),a.$watch("calendar.submode",function(b){a.calendar.mode=a.calendar.toggle?b:x,A.set(b)}),a.hub={point:null,lap:null,record:null},h.subscribe("workout/reload",p),h.subscribe("login/success",p),a.select=function(c){var d={userId:a.model.workout.$userId||a.model.workout.author.id,workoutId:c.id};b.go("top.workouts.info.byId",d)},a.goToday=function(){a.calendar.month=new Date(u.getFullYear(),u.getMonth(),1),a.calendar.isToday=!0},a.scrollToSocial=function(){var a=c[0].querySelector("#workoutCommentInput");null!==a&&(g.toElement("#workoutCommentInput"),a&&a.focus&&a.focus())},a.$watch(q,function(b){var c=b?new Date(b):new Date,d=c.getFullYear(),e=c.getMonth();a.calendar.month=new Date(d,e,1),a.calendar.isToday=u.getFullYear()===d&&u.getMonth()===e}),a.$watch("calendar.month",function(b){b&&(a.calendar.isToday=b.getFullYear()===u.getFullYear()&&b.getMonth()===u.getMonth())}),a.$watch("model.workout.feedId",function(b){if(b){var c={userId:a.model.workout.author.id,feedId:b};f.getUserFeed(c).then(function(a){s(a)})}});var B=void 0;a.$watch("model.workout.id",function(b){var c=a.model.workout;b&&(B&&B.stop(),(c.isLive||w.force)&&(B=new n(c,w.interval),B.start(function(a,b){a&&(a.isLive||w.force||B.stop(),t(a)),b&&s(b)}))),t()}),a.$watchCollection("model.workout.pictures",function(b){a.hasPictures=b&&b.length>0}),a.$on("$destroy",function(){k.hide(),h.unsubscribe("workout/reload",p),h.unsubscribe("login/success",p),B&&B.stop()})}a.$inject=["$scope","$state","$document","user","model","api.feed.FeedResource","core.dom.scroll","core.event.topic","translate","view.workout.workoutAds","cta","core.lang.date","common.pref.Preference","view.workout.WorkoutRefresher","config"],angular.module("endo.view.workout").controller("view.workout.WorkoutController",a)}(),function(){function a(a,b){return{xs:{other:{top:{path:"/17729925/UACF_W/Endo/Workout",size:[320,50],args:{pos:"top"}},bottom:{path:"/17729925/UACF_W/Endo/Workout",size:[320,50],args:{pos:"bottom"}}}},sm:{other:{top:{path:"/17729925/UACF_M/Endo/Workout",size:[728,90],args:{pos:"top"}},bottom:{path:"/17729925/UACF_M/Endo/Workout",size:[728,90],args:{pos:"bottom"}},mid:{path:"/17729925/UACF_M/Endo/Workout",size:[300,250]}}},md:{other:{top:{path:"/17729925/UACF_W/Endo/Training",size:[728,90],args:{pos:"top"}},bottom:{path:"/17729925/UACF_W/Endo/Training",size:[728,90],args:{pos:"bottom"}},mid:{path:"/17729925/UACF_W/Endo/Training",size:[300,250]}},dk:{top:{path:"/17729925/UACF_W/Endo/Training_DK",size:[930,180],args:{pos:"top"}},bottom:{path:"/17729925/UACF_W/Endo/Training_DK",size:[930,180]},mid:{path:"/17729925/UACF_W/Endo/Training",size:[300,250],args:{pos:"bottom"}}},pl:{top:{path:"/17729925/UACF_W/Endo/Training_PL",size:[750,200],args:{pos:"top"}},bottom:{path:"/17729925/UACF_W/Endo/Training_PL",size:[750,200],args:{pos:"bottom"}},mid:{path:"/17729925/UACF_W/Endo/Training",size:[300,250]}}},getAds:function(){var c=b.getBreakpointName(),d=String(a.get("locale.country.id")).toLowerCase();return c=c&&"lg"!==c?c:"md",this[c][d]||this[c].other}}}a.$inject=["config","core.dom.media"],angular.module("endo.view.workout").service("view.workout.workoutAds",a)}(),function(){angular.module("endo.view.workout").controller("view.workout.ZonesController",["$scope","user","common.i18n.Translation",function(a,b,c){function d(){var b=(f.workout,a.buckets=[]),c=f.workout.heartRateZones;if(c){var d={duration:c.restDuration/1e3,id:e[0].id,label:e[0].label,min:c.rest,max:c.zone1Start-1};b.push(d),[1,2,3,4,5].forEach(function(a,d,f){var g={min:c["zone"+a+"Start"],duration:c["zone"+a+"Duration"]/1e3,id:e[a].id,label:e[a].label};g.max=a!==f.length?c["zone"+(a+1)+"Start"]-1:c.max,b.push(g)});var g=b.reduce(function(a,b){return a+b.duration},0);b=b.map(function(a){return a.percentage=Math.round(a.duration/g*100),a})}}var e=c.fromCurrentStateTree();e=e.$parent.zones.hrZones;var f=a.model;a.viewer=b,a.$watch("model.workout.id",d)}])}(),function(){var a=["ngAnimate","ui.router","ui.router.state.events","ui.bootstrap","ngSanitize","hmTouchEvents","ngTagsInput","ngMessages","lr.upload","ui.validate","endo.core","endo.common","endo.ui","endo.model","endo.api","endo.view.layout","endo.view.splash","endo.view.front","endo.view.download","endo.view.home","endo.view.auth","endo.view.auth2","endo.view.consent","endo.view.about","endo.view.policy","endo.view.business","endo.view.premium","endo.view.store","endo.view.subscription","endo.view.boarding","endo.view.workout","endo.view.invite","endo.view.history","endo.view.merge","endo.view.compare","endo.view.shutout","endo.view.settings","endo.view.newsletters","endo.view.static"],b="endo.debug",c=!1;try{angular.module(b),a.push(b),c=!0}catch(d){}var e=angular.module("endo",a);if(e.config(["$sceDelegateProvider",function(a){a.resourceUrlWhitelist(["self","tpl://**","https://www.youtube.com/**"])}]),c){var f=document.querySelector("[ng-app]");angular.isElement(f)?(f.removeAttribute("ng-app"),angular.bootstrap(f,["endo"],{strictDi:!0})):!window.jasmine}}();})();