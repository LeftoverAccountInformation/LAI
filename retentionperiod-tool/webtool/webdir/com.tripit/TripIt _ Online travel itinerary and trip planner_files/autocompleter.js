!function(u){"use strict";var o=window.TRIPIT.components;o.AutoCompleter=function(n,i){var l,c={createElement:function(){var t,e,r=i.get(0),a=i.attr("data-itUI-autocomplete-initial")||"",o=i.attr("data-itUI-autocomplete-submit_on_select")||"";return n.submitOnSelect=0<o.length,i.removeAttr("data-itUI-autocomplete-initial").removeAttr("data-itUI-autocomplete-submit_on_select"),n.hasPhantom?(e=(t=i.parents("p.fieldBlock")).clone(),(l=e.find("input")).attr({id:l.attr("id")+"_ph",name:l.attr("name")+"_ph"}).removeClass(n.className),e.insertAfter(t.hide().addClass("itUI-stayhidden")),0<a.length&&i.val(a)):l=i,u.data(r,"current_id",a||null),u.data(r,"current_label",l.val()),c},extractArray:function(t,e){u.isFunction(t)&&(u.isArray(e)?t(e):u.isArray(e.result_map)&&t(e.result_map))},split:function(t){return t.split(/,\s*/)},extractLast:function(t){return c.split(t).pop()},attachBehavior:function(){var a=it.global_baseURL+(n.fullpath||"complete/"+n.path),t={delay:150,minLength:n.minLength,source:function(t,e){var r={query:n.isMultipleSelection?c.extractLast(t.term):t.term,limit:15};u.isFunction(n.beforeSend)&&n.beforeSend(t,r),u.getJSON(a,r,c.extractArray.curry(e))},select:function(t,e){n.hasPhantom&&i.val(e.item.id);var r=i.get(0);if(u.data(r,"current_label",e.item.label),u.data(r,"current_id",e.item.id),n.submitOnSelect&&(u('<input type="hidden" />').attr("name",i.attr("name")).val(e.item.id).insertAfter(i.removeAttr("name")),u(r.form).submit()),u.isFunction(n.selectCallback))return n.selectCallback(t,e)},focus:function(){return!1}};n.isMultipleSelection&&(t=u.extend(t,{search:function(){if(c.extractLast(this.value).length<n.minLength)return!1},select:function(t,e){var r=c.split(i.val());return r.pop(),r.push(e.item.value),r.push(""),i.val(r.join(", ")),u.data(i.get(0),"current_label",i.val()),!1}})),l.attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").addClass("itUI-autocomplete").autocomplete(t).change(function(){var t=i.get(0),e=l.val();e!==u.data(t,"current_label")&&(n.hasPhantom&&i.val(e),u.data(t,"current_id",null))}),n.cancelTab&&l.keydown(function(t){it.keys.tab(t)&&t.preventDefault()}),u.isFunction(n.renderItem)&&(l.data("ui-autocomplete")._renderItem=n.renderItem)}};return parseInt(n.minLength,10)===n.minLength&&!isNaN(n.minLength)||(n.minLength=2),c.createElement().attachBehavior(),c},o.AutoCompleter.attachBoundITUIBehaviors=function(t,e,r){var a=jQuery;(r||a(document)).find(":input."+t).each(function(){a.data(this,t+"-set-up")||(a.data(this,t+"-set-up",!0),a.data(this,t,e(a(this),t)))})},o.EmailCompleter=function(t,e){return o.AutoCompleter({path:"emailAddress",className:e,isMultipleSelection:!0,minLength:3,cancelTab:!0},t)},o.EmailCompleter.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-emailAddresses",o.EmailCompleter),o.NameAndEmailCompleter=function(t,e){return o.AutoCompleter({path:"nameAndEmailAddress",className:e,isMultipleSelection:!0,minLength:3,cancelTab:!0},t)},o.NameAndEmailCompleter.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-namesAndEmailAddresses",o.NameAndEmailCompleter),o.AirportPicker=function(t,e){return o.AutoCompleter({path:"airport",className:e},t)},o.AirportPicker.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-airportpicker",o.AirportPicker),o.AirlinePicker=function(t,e){return o.AutoCompleter({path:"airline",className:e,hasPhantom:!0},t)},o.AirlinePicker.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-airlinepicker",o.AirlinePicker),o.PointtrackerProgramCompleter=function(t,e){return o.AutoCompleter({path:"pointtracker",className:e,hasPhantom:!1,beforeSend:function(t,e){var r=u('select[name="account_type"] option:selected');0<r.length&&(e.account_type=r.val())},selectCallback:o.PointtrackerProgramCompleter.selectCallback},t)},o.PointtrackerProgramCompleter.selectCallback=function(t,e){var r=u('select[name="supplier_code"]');return r.children('option[value="'+e.item.supplier_code+'"]').prop("selected",!0),r.trigger("change"),u(t.target).val(""),it.noclick(t)},o.PointtrackerProgramCompleter.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-pointtrackerProgram",o.PointtrackerProgramCompleter),o.CountryPicker=function(t,e){return o.AutoCompleter({path:"country",className:e},t)},o.CountryPicker.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-countrypicker",o.CountryPicker),o.StatePicker=function(t,e){return o.AutoCompleter({path:"state",className:e},t)},o.StatePicker.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-statepicker",o.StatePicker),o.travelGroupCompleter=function(t,e){return o.AutoCompleter({path:"travelGroup",className:e,hasPhantom:!0},t)},o.travelGroupCompleter.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-travelGroup",o.travelGroupCompleter),o.travelGroupSetCompleter=function(t,e){return o.AutoCompleter({path:"travelGroupSet",className:e,hasPhantom:!0},t)},o.travelGroupSetCompleter.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-travelGroupSet",o.travelGroupSetCompleter),o.accountCompleter=function(t,e){var r="account",a=t.attr("data-account-completer-group-id")||"";return 0<a.length&&(r+="/group_id/"+a),o.AutoCompleter({path:r,className:e,selectCallback:o.accountCompleter.selectCallback},t)},o.accountCompleter.selectCallback=function(t,e){return It_account_showCard.doShow(e.item.id,e.item.screenname,e.item.should_show_remove_group_member,e.item.is_inner_circle_sharer),it.noclick(t)},o.accountCompleter.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-accountpicker",o.accountCompleter),o.groupSearchCompleter=function(t,e){return o.AutoCompleter({fullpath:"group/search",className:e,renderItem:function(t,e){return jQuery("<li></li>").data("item.autocomplete",e).append(jQuery("<a></a>").html(e.label)).appendTo(t)}},t)},o.groupSearchCompleter.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-groupSearch",o.groupSearchCompleter),o.AddressCompleter=function(t,e){return o.AutoCompleter({path:"address",className:e,minLength:3},t)},o.AddressCompleter.attachBoundITUIBehaviors=o.AutoCompleter.attachBoundITUIBehaviors.curry("itUI-address",o.AddressCompleter),o.AutoCompleter.completers=[o.EmailCompleter,o.NameAndEmailCompleter,o.AirportPicker,o.AirlinePicker,o.travelGroupCompleter,o.travelGroupSetCompleter,o.accountCompleter,o.groupSearchCompleter,o.AddressCompleter,o.PointtrackerProgramCompleter,o.CountryPicker,o.StatePicker],o.AutoCompleter.setup=function(){var t;for(t=0;t<o.AutoCompleter.completers.length;++t)o.AutoCompleter.completers[t].attachBoundITUIBehaviors()},u(document).ready(o.AutoCompleter.setup)}(jQuery);