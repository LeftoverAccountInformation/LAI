(new R9.logger).time("combined");(function(b,c){b.createWidgetClass("button.StyleJamButton",{options:{inactiveStlBlock:"",activeStlBlock:"",canPulse:!1},init:function(){},addEventHandlers:function(){this.options.inactiveStlBlock&&this.options.activeStlBlock&&(this.subscribe("button.deactivate",{id:this.id()},this.toggleActivation.bind(this,!1)),this.subscribe("button.activate",{id:this.id()},this.toggleActivation.bind(this,!0)));this.options.canPulse&&(this.subscribe("button.pulse",{id:this.id()},this.pulse.bind(this,!0)),this.subscribe("button.pulse.reset",
{id:this.id()},this.pulse.bind(this,!1)))},toggleActivation:function(a){this.swapClassesToggle(this.element,this.options.inactiveStlBlock,this.options.activeStlBlock,!a)},pulse:function(a){this.swapClassesToggle(this.element,"","Button--pulse",!a)}})})(R9,jQuery);(function(d,e){function h(a,b){if(a)for(var c=0,d=a.childElementCount;c<d;c++)if(a.children){var g=b?a.children[d-c-1]:a.children[c],f=g;if((f&&null!==f.getAttribute("tabindex")&&""!==f.getAttribute("tabindex")&&"-1"!==f.getAttribute("tabindex")||-1<k.indexOf(f.tagName)||"INPUT"===f.tagName&&"hidden"!==f.getAttribute("type"))&&e(f).is(":visible")||(g=h(g,b)))return g}}var k=["SELECT","A","BUTTON","TEXTAREA"];d.createWidgetClass("dialog.Dialog",{content:null,contentBody:null,closeButton:null,modalBackground:null,
focusBoundaries:null,initialFocus:null,lastFocus:null,options:{fullHeight:!1,customWidth:!1,modal:!0,blur:!1,onClose:null,onOpen:null,afterClose:null,afterOpen:null,initialFocusId:null,preventInitialFocus:!1,closeOnModalClick:!0,hasKeyboardControl:!0,openImmediately:!1,preventClose:!1,returnFocus:!0,scrollToTopOnMobile:!0,forceOpen:!1,renderInline:!1,isMobile:!1,isOpenTopZindex:!1,iframeResize:!0,iframeTopGapPercent:.08,preventClosingClickBubble:!1},topLevelComponent:null,returnElement:null,init:function(){this.resizeEventName=
"resize."+this.id();this.content=this.getChildElement("content");this.contentBody=this.getChildElement("body");this.closeButton=this.getChildElement("close");this.modalBackground=this.getChildElement("modal");this.viewport=this.getChildElement("viewport");this.modal=this.getChildElement("modal");this.modalUniqueClass="modal-class-"+this.modal.attr("id")},addEventHandlers:function(){var a=this,b=this.closeOnModalClick.bind(this);this.options.preventClose||(this.options.hasKeyboardControl&&(this.registerEvent("keydown",
e(document),function(c){a.options.preventClose||c.which!==d.globals.keyCodes.ESC||a.close(!0)}),this.registerEvent("keypress",this.closeButton,function(c){if(!a.options.preventClose)switch(c.which){case d.globals.keyCodes.RETURN:a.close(!0)}})),this.registerEvent("click",this.closeButton,function(){a.options.preventClose||a.close(!0)}));this.options.closeOnModalClick&&this.registerEvent("click",this.viewport,b);this.registerEvent("click",this.content,function(){a.viewport.off("click",b);setTimeout(function(){if(a.options.closeOnModalClick)a.viewport.on("click",
b)},50)});this.subscribe("dialogs.close",function(){a.isOpen()&&a.close()});this.options.preventClosingClickBubble&&this.registerEvent("click",this.element,function(a){a.stopPropagation()})},inlineComponentsReady:function(){var a=this;this.options.modal||this.modalBackground.hide();this.topLevelComponent=this.contentBody.children("div").eq("0");this.options.renderInline&&e("body").append(this.element);this.options.openImmediately?(this.element.addClass("animate"),d.dom.schedule(this.open.bind(this))):
setTimeout(function(){a.element.addClass("animate")},100);this.getChildElement("focusStartBoundary").focus(this.resetFocus.bind(this,!1));this.getChildElement("focusEndBoundary").focus(this.resetFocus.bind(this,!0))},closeOnModalClick:function(a){a=e(a.target).closest(".content");this.content[0]===a[0]||this.options.preventClose||this.close(!0)},calculateDimensions:function(){if(this.topLevelComponent&&this.topLevelComponent.length){var a=this.topLevelComponent[0].getBoundingClientRect(),b=this.content[0].getBoundingClientRect(),
c="number"===typeof this.topLevelComponent.outerWidth()?Math.ceil(a.width):null,a="number"===typeof this.topLevelComponent.outerHeight()?Math.ceil(a.height):null;this.options.customWidth||c===Math.ceil(b.width)||this.content.width(c);this.options.fullHeight||a===Math.ceil(b.height)||this.content.height(a)}},resetFocus:function(a){(a=a?this.closeButton:this.lastFocus?this.lastFocus:this.findFirstFocusableElement(!0))&&"function"===typeof a.focus&&a.focus();return!1},handleKeyPress:function(a){switch(a.which){case d.globals.keyCodes.ESC:this.close(!0)}},
setContentDimensions:function(a,b,c){void 0!==a&&this.content.width(a);void 0!==b&&this.content.height(b);c&&this.content.css({maxWidth:c})},setViewPortOverflow:function(a,b){this.viewport&&this.viewport.length&&(a&&this.viewport.css({overflowX:a}),b&&this.viewport.css({overflowX:b}))},setContent:function(a){this.contentBody.html(a);this.topLevelComponent=this.contentBody.children("div").eq("0")},close:function(a){if(this.isOpen()&&!this.options.forceOpen){var b,c=e("body");this.isTouchDevice()&&
(b=c.css("top").replace("-","").replace("px",""),c.css({overflow:"",position:"",width:""}));this.options.iframeResize&&window.parentIFrame&&"function"===typeof window.parentIFrame.getPageInfo&&window.parentIFrame.getPageInfo(!1);c.scrollTop(b);this.element.removeClass("visible");this.element.attr("aria-hidden",!0);d.globals.testMode&&this.element.attr("data-test-popover-open",!1);if("function"===typeof this.options.onClose)this.options.onClose(this.element,a);d.events.publish("dialog.close",{id:this.id()});
this.options.blur&&d.events.publish("pageContainer.contentBlur",!1);c.removeClass(this.modalUniqueClass);0>c.attr("class").indexOf("modal-class-")&&c.removeClass("hideOverflow modal-open");this.returnElement&&this.returnElement.length&&(this.returnElement.focus(),this.returnElement=null);e(window).off(this.resizeEventName);"function"===typeof this.options.afterClose&&this.options.afterClose()}},open:function(a){if(!this.isOpen()){this.topLevelComponent&&0!==this.topLevelComponent.length||(this.topLevelComponent=
this.contentBody.children("div").eq("0"));this.options.preventClose&&this.closeButton.hide();this.options.returnFocus&&(this.returnElement=e(document.activeElement));if(this.options.isOpenTopZindex){var b=0;this.element.siblings("[role\x3ddialog]").each(function(){var a=parseInt(e(this).css("z-index"));a&&a>b&&(b=a)});0<b&&this.element.css("z-index",b+1)}d.events.publish(["common.dropdown.closeAll","common.widgets.tooltip.closeAll"]);this.element.addClass("visible");this.element.attr("aria-hidden",
!1);d.globals.testMode&&this.element.attr("data-test-popover-open",!0);null===this.initialFocus&&this.setFocusTargets();this.options.preventInitialFocus||this.focusInitialElement();this.options.iframeResize&&window.parentIFrame&&"function"===typeof window.parentIFrame.getPageInfo&&window.parentIFrame.getPageInfo(this.positionOnIframe.bind(this));if("function"===typeof this.options.onOpen)this.options.onOpen(this.element);"function"===typeof a&&a(this.element);this.modalBackground.length&&(e("body").addClass("hideOverflow modal-open"),
e("body").addClass(this.modalUniqueClass));this.options.blur&&d.events.publish("pageContainer.contentBlur",!0);null!==this.topLevelComponent&&setTimeout(this.calculateDimensions.bind(this),1);this.isTouchDevice()&&this.options.scrollToTopOnMobile&&e("body").css({overflow:"hidden",position:"fixed",width:"100%"});e(window).off(this.resizeEventName).on(this.resizeEventName,this.calculateDimensions.bind(this));"function"===typeof this.options.afterOpen&&this.options.afterOpen()}},positionOnIframe:function(a){if(a&&
this.viewport){var b=a.clientHeight*this.options.iframeTopGapPercent,c=a.scrollTop;a=a.offsetTop;this.content.addClass("no-margin");c<a?this.viewport.css("top",0):c-a<b?this.viewport.css("top",2*(c-a)+"px"):c-a+b+this.content.height()>=this.modal.height()?this.viewport.css("top",this.modal.height()-this.content.height()+"px"):this.viewport.css("top",c-a+Math.round(b)+"px")}},focusInitialElement:function(){var a=this;setTimeout(function(){var b=a.initialFocus&&a.initialFocus.get(0);b&&"function"===
typeof b.focus&&b.focus()},501)},setFocusTargets:function(){this.focusBoundaries=this.getChildElement("focusStartBoundary").add(this.getChildElement("focusEndBoundary"));this.initialFocus=this.findFirstFocusableElement(!1);this.lastFocus=this.findFirstFocusableElement(!0)},findFirstFocusableElement:function(a){if(this.options.initialFocusId&&!a)return e("#"+this.options.initialFocusId);a=h(this.contentBody[0],a);a||(a=this.closeButton);return e(a)},isOpen:function(){return this.element.hasClass("visible")},
isTouchDevice:function(){return"ontouchstart"in window||navigator&&navigator.maxTouchPoints},destroy:function(){this.base();this.element.remove()}})})(R9,jQuery);(function(b,e){b.createComponentClass("account.v2.ProfilePhoto",{uploadDialog:void 0,deleteDialog:void 0,uploadDialogEl:void 0,uploadDialogContentEl:void 0,uploadDialogSocialWrapperEl:void 0,uploadDialogSocialImageEl:void 0,uploadTriggerEl:void 0,uploadSectionWrapperEl:void 0,previewSectionWrapperEl:void 0,previewImageEl:void 0,uploadErrEl:void 0,deleteErrEl:void 0,deletePhotoEl:void 0,fileInputEl:void 0,placeholderImgEl:void 0,twoXDim:372,profilePicEl:void 0,uploadSpinnerEl:void 0,canaryEl:void 0,
defaultPhotosLoaded:!1,validTypes:["image/jpeg","image/jpg","image/png","image/gif"],croppieWidget:void 0,options:{maxFileSizeInMb:10,userImgUrl:void 0,userSocialImgUrl:void 0,showDefaultOptions:!1,doCropClientSide:!0,croopieWidth:200},msg:{errReadingImg:void 0,errUploadAbort:void 0,errFileSize:void 0,invalidTypeMsg:void 0},init:function(){this.msg=this.options.msg;this.profilePicEl=this.getChildElement("userImg");this.uploadDialogEl=this.getChildElement("uploadDialog");this.uploadDialogContentEl=
this.getChildElement("uploadDialog-content");this.uploadDialogSocialWrapperEl=this.getChildElement("socialImageSection");this.uploadDialogSocialImageEl=this.uploadDialogEl.find(".socialImage");this.uploadDialog=this.uploadDialogEl.dialog({}).getWidget();this.deleteDialog=this.getChildElement("deleteDialog").dialog({}).getWidget();this.uploadSectionWrapperEl=this.getChildElement("uploadSectionWrapper");this.uploadTriggerEl=this.getChildElement("uploadTrigger");this.previewSectionWrapperEl=this.getChildElement("previewSectionWrapper");
this.fileInputEl=this.getChildElement("fileInput");this.deleteErrEl=this.getChildElement("deleteErr");this.uploadErrEl=this.uploadDialogEl.find(".uploadErr");this.deletePhotoEl=this.element.find(".removePhoto");this.uploadSpinnerEl=this.getChildElement("uploadSpinner");this.placeholderImgEl=this.getChildElement("placeholderImg");this.canaryEl=this.getChildElement("canary");this.options.showDefaultOptions&&this.getChildElement("petCarousel").slick({centerPadding:"16px",arrows:!0,infinite:!1,mobileFirst:!0,
speed:300,slidesToShow:3,slidesToScroll:3,prevArrow:this.getChildElement("prevPet"),nextArrow:this.getChildElement("nextPet"),responsive:[{breakpoint:368,settings:{slidesToShow:4,slidesToScroll:4}}]})},addEventHandlers:function(){var a=this;this.registerEvent("click",this.element.find(".js-photoContainer"),this.handleDialogOpen.bind(this));this.registerEvent("click",this.element.find(".removePhoto"),this.handleDeleteDialogOpen.bind(this));this.registerEvent("change",this.fileInputEl,this.handleFileInputChange.bind(this));
this.registerEvent("click",this.getChildElement("uploadButton"),this.handlePhotoUploadClick.bind(this));this.registerEvent("click",this.getChildElement("cancel"),this.handleDialogClose.bind(this));this.registerEvent("click",this.getChildElement("save"),this.handleSaveProfilePicture.bind(this));this.registerEvent("click",this.getChildElement("cancelDelete"),this.handleCancelDelete.bind(this));this.registerEvent("click",this.getChildElement("confirmDelete"),this.handleConfirmDelete.bind(this));this.registerEvent("click",
this.uploadDialogSocialImageEl,this.handleSetSocialAsPrimary.bind(this));this.registerEvent("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",this.canaryEl,this.handleUploadLayoutChange.bind(this));this.registerEvent("click",this.getChildElement("rotateRight"),this.handleRotateImgRight.bind(this));this.registerEvent("click",this.getChildElement("rotateLeft"),this.handleRotateImgLeft.bind(this));this.registerEvent("click",this.uploadDialogEl.find(".js-pet"),this.handleSetDefaultImg.bind(this));
this.registerEvent("click",this.getChildElement("back"),this.handleGoBack.bind(this));this.registerEvent("keydown",this.getChildElement("editPhoto"),this.handleEditPhotoKeydown.bind(this));this.addPhotoDragHandlers();this.subscribe(["googleauth.link.success","fbauth.link.success"],this.handleSocialLink.bind(this));this.subscribe(["googleauth.unlink.success","fbauth.unlink.success"],this.handleSocialUnlink.bind(this));this.subscribe("dialog.close",function(b){b.id===a.id("uploadDialog")&&setTimeout(function(){a.destroyCroppie()},
500)});this.handleSocImageHover()},inlineComponentsReady:function(){b.Analytics.api.trackEvent({subPageId:"profile-photo-comp",category:"loaded"})},handleEditPhotoKeydown:function(a){a.keyCode===b.globals.keyCodes.RETURN&&this.handleDialogOpen()},handleSocImageHover:function(){var a=this.getChildElement("socImageIcon");this.getChildElement("socImage").on("hover",function(){b.dom.swapClasses(a,"","Check__Icon--visible")},function(){b.dom.swapClasses(a,"Check__Icon--visible","")})},handleRotateImgRight:function(){this.croppieWidget&&
this.croppieWidget.rotate(-90)},handleRotateImgLeft:function(){this.croppieWidget&&this.croppieWidget.rotate(90)},handleDeleteDialogOpen:function(){this.deleteErrEl.text("").hide().attr("aria-hidden",!0);this.deleteDialog.open()},handleCancelDelete:function(){this.deleteDialog.close()},handleGoBack:function(){this.previewSectionWrapperEl.hide().attr("aria-hidden",!0);this.uploadSectionWrapperEl.show().attr("aria-hidden",!1);this.clearFile();this.destroyCroppie()},handleConfirmDelete:function(){var a=
this;a.deleteUserUploadedImg(function(){b.events.publish("account.picture.changed");a.options.userImgUrl=null;a.deletePhotoEl.hide().attr("aria-hidden",!0);a.options.userSocialImgUrl?a.profilePicEl.html(b.template.render("profilePic",{url:a.options.userSocialImgUrl})):(a.profilePicEl.html("").hide(),a.placeholderImgEl.show());a.deleteDialog.close()},function(b){a.deleteErrEl.text(b.responseJSON.msg).show().attr("aria-hidden",!1)});b.Analytics.api.trackEvent({subPageId:"profile-photo",category:"delete",
action:"/click"})},deleteUserUploadedImg:function(a,c){b.ajax.execute("account/v2/action/delete-photo",{method:"POST",success:a,error:c})},handleSocialLink:function(){var a=this;b.ajax.execute("account/v2/action/get-social-photo",{success:function(c){a.options.userSocialImgUrl=c.url;a.options.userImgUrl||(a.profilePicEl.html(b.template.render("profilePic",{url:c.url})).show(),b.Analytics.api.trackEvent({subPageId:"profile-photo",category:"social",action:"/show-linked"}))}})},handleSocialUnlink:function(){this.options.userSocialImgUrl=
null;!this.options.userImgUrl&&this.profilePicEl.empty().hide()},handleDialogClose:function(){this.uploadDialog.close();this.uploadDialogSocialWrapperEl.hide().attr("aria-hidden",!0)},handleSetSocialAsPrimary:function(){this.options.userImgUrl=null;this.deleteUserUploadedImg(e.noop,e.noop);b.events.publish("account.picture.changed");this.profilePicEl.html(b.template.render("profilePic",{url:this.options.userSocialImgUrl})).show();this.deletePhotoEl.hide().attr("aria-hidden",!0);this.handleDialogClose();
b.Analytics.api.trackEvent({subPageId:"profile-photo",category:"social",action:"set-as-primary"})},handleSetDefaultImg:function(a){a=e(a.currentTarget).data("id");b.Analytics.api.trackEvent({subPageId:"profile-photo",category:"upload-default",action:a});this.uploadSpinnerEl.show().attr("aria-busy",!0);this.uploadErrEl.text("").hide().attr("aria-hidden",!0);b.ajax.execute("account/v2/action/set-default-photo",{method:"POST",data:{petId:a},success:this.uploadCallback.bind(this),error:this.uploadErrCallback.bind(this)})},
uploadCallback:function(a){a.url?(this.placeholderImgEl.hide(),this.profilePicEl.html(b.template.render("profilePic",{url:a.url})).show(),this.deletePhotoEl.show().attr("aria-hidden",!1),this.options.userImgUrl=a.url,this.handleDialogClose(),b.events.publish("account.picture.changed")):this.uploadErrCallback(a)},uploadErrCallback:function(a){this.uploadSpinnerEl.hide().attr("aria-busy",!1);a.responseJSON.msg&&this.uploadErrEl.text(a.responseJSON.msg).show().attr("aria-hidden",!1)},handleSaveProfilePicture:function(){var a=
this;b.Analytics.api.trackEvent({subPageId:"profile-photo",category:"upload",action:"/save-click"});this.uploadSpinnerEl.show().attr("aria-busy",!0);this.uploadErrEl.text("").hide().attr("aria-hidden",!0);this.croppieWidget.result({type:"blob",size:this.getCroppieResultSize(),circle:!1}).then(function(c){var d=new FormData;d.append("file",c);d.append("xhint",0);d.append("yhint",0);b.ajax.execute("account/v2/action/upload-photo",{method:"POST",data:d,enctype:"multipart/form-data",processData:!1,contentType:!1,
success:a.uploadCallback.bind(a),error:a.uploadErrCallback.bind(a)})})},getCroppieResultSize:function(){return this.options.doCropClientSide?{width:744,height:744}:"original"},destroyCroppie:function(){this.croppieWidget&&(this.croppieWidget.destroy(),this.previewImageEl.removeClass("cr-original-image").insertBefore(this.previewImageEl.parent()),this.croppieWidget=void 0)},handleUploadLayoutChange:function(){this.uploadDialog.isOpen()&&this.previewImageEl&&(this.destroyCroppie(),this.initCroppieWidget())},
addPhotoDragHandlers:function(){var a=this,b=function(){setTimeout(function(){a.uploadDialog.options.forceOpen=!1},50);e(document).off("mouseup.uploaddraggr, mouseleave.uploaddraggr")};this.registerEvent("mousedown",a.getChildElement("uploadDialogContentEl"),function(){a.uploadDialog.options.forceOpen=!0;e(document).on("mouseup.uploaddraggr, mouseleave.uploaddraggr",b)});this.registerEvent("dragover",this.uploadTriggerEl,function(){a.uploadTriggerEl.addClass("dragged");return!1});this.registerEvent("dragleave",
this.uploadTriggerEl,function(){a.uploadTriggerEl.removeClass("dragged");return!1});this.registerEvent("drop",this.uploadTriggerEl,function(b){b.preventDefault();a.uploadTriggerEl.removeClass("dragged");a.handleFileAdd(b.originalEvent.dataTransfer.files[0])})},handleDialogOpen:function(){this.clearFile();this.handleLoadDefaultAvatars();this.getChildElement("petCarousel").slick("slickFilter",":not(.badImg)");this.previewSectionWrapperEl.hide().attr("aria-hidden",!0);this.uploadSectionWrapperEl.show().attr("aria-hidden",
!1);this.uploadErrEl.hide().attr("aria-hidden",!0).text("");this.uploadSpinnerEl.hide().attr("aria-busy",!1);this.previewImageEl=void 0;this.options.userSocialImgUrl&&this.options.userImgUrl?(this.uploadDialogSocialWrapperEl.find("img").attr("src",this.options.userSocialImgUrl),this.uploadDialogSocialWrapperEl.show().attr("aria-hidden",!1)):(this.uploadDialogSocialWrapperEl.find("img").attr("src",""),this.uploadDialogSocialWrapperEl.hide().attr("aria-hidden",!0));this.uploadDialog.open();b.Analytics.api.trackEvent({subPageId:"profile-photo",
category:"upload-dialog",action:"/open"})},handleLoadDefaultAvatars:function(){this.defaultPhotosLoaded||(this.uploadDialogEl.find(".js-pet \x3e img").each(function(){e(this).attr("src",e(this).data("src"))}),this.defaultPhotosLoaded=!0)},handlePhotoUploadClick:function(){this.clearFile();this.fileInputEl.focus().click();b.Analytics.api.trackEvent({subPageId:"profile-photo",category:"upload-dialog",action:"/open-file"})},handleFileInputChange:function(a){this.handleFileAdd(a.target.files[0])},handleFileAdd:function(a){var c=
this;this.fileInputEl.val("");this.uploadErrEl.text("").hide().attr("aria-hidden",!0);a&&(0>this.validTypes.indexOf(a.type)?this.uploadErrEl.text(this.msg.invalidTypeMsg).show().attr("aria-hidden",!1):this.loadFile(a).then(function(a){a.loaded/1E3/1E3>c.options.maxFileSizeInMb?(alert(b.Common.Utils.String.formatString(c.msg.errFileSize,c.options.maxFileSizeInMb)),c.clearFile()):(c.uploadSectionWrapperEl.hide().attr("aria-hidden",!0),c.getChildElement("imagePlaceholder").html('\x3cimg class\x3d"preview" draggable\x3d"false" src\x3d"'+
a.target.result+'"/\x3e'),c.previewImageEl=c.uploadDialogEl.find(".preview"),setTimeout(function(){c.previewSectionWrapperEl.show().attr("aria-hidden",!1);c.initCroppieWidget()},30),b.Analytics.api.trackEvent({subPageId:"profile-photo",category:"user-photo",action:"/selected"}))}).fail(function(a){alert(a)}))},initCroppieWidget:function(){var a;a=this.canaryEl.width()?this.options.croopieWidth:this.twoXDim/2-20;this.croppieWidget=new Croppie(this.previewImageEl[0],{viewport:{width:a,height:a,type:"circle"},
showZoomer:!0,enableOrientation:!0,customClass:"photoCroppieV2"})},clearFile:function(){this.fileInputEl.val(null)},loadFile:function(a){var c=new FileReader,d=e.Deferred();c.onload=function(a){a?d.resolve(a):d.reject(b.Common.Utils.String.formatString(this.msg.errReadingImg))};c.onabort=function(a){d.reject(b.Common.Utils.String.formatString(this.msg.errUploadAbort))};c.onerror=function(a){d.reject(b.Common.Utils.String.formatString(this.msg.errReadingImg))};c.readAsDataURL(a);return d}})})(R9,jQuery);(function(b){R9.extend("Widgets",{TextInput:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.TextInput",{isTextInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"text"==a.type.toLowerCase()},isWidgetControlled:function(a){return"undefined"==typeof document.createElement("input").placeholder}});R9.extend("Widgets.TextInput.prototype",{widgetName:"textinput",
widgetBaseClass:"r9-textinput",widgetPlaceholderClass:"r9-textinput-placeholder-active",elementNode:null,element:null,options:{click:null,change:null},init:function(){this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("smartyfocus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.bindFormSubmission();this.element.data(this.widgetName,this);this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode)},validateElement:function(){return R9.Widgets.TextInput.isTextInput(this.elementNode)&&
R9.Widgets.TextInput.isWidgetControlled(this.elementNode)&&void 0===this.element.data(this.widgetName)},bindInputEvent:function(a,b){var c=this;a+="."+this.widgetName;this.element.unbind(a).bind(a,function(a){b.call(c,this,a)})},bindFormSubmission:function(){var a=this,b="submit."+a.widgetName+a.element.attr("id"),d="form-pre-submit."+a.widgetName+a.element.attr("id");this.element.parents("form").off(b).on(b,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)});
this.element.parents("form").off(d).on(d,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)})},handleElementFocusEvent:function(a,c){a.disabled||(b(a).val()==b(a).attr("placeholder")&&this.clearPlaceholderText(b(a)),this.options.focus&&this.options.focus.apply(this,arguments))},handleElementBlurEvent:function(a,c){a.disabled||(0==b.trim(b(a).val()).length&&this.setPlaceholderText(a),this.options.blur&&this.options.blur.apply(this,arguments))},clearPlaceholderText:function(a){a.removeClass(this.widgetPlaceholderClass).val("")},
setPlaceholderText:function(a){b(a).addClass(this.widgetPlaceholderClass).val(b(a).attr("placeholder"))}})})(jq||jQuery);
(function(b){R9.createWidgetClass("text.TextInput",b.extend({},R9.Widgets.TextInput.prototype,{widgetPlaceholderClass:"vs-placeholder",inputElement:null,options:{needsPlaceholderSupport:!1,selectOnFocus:!1},init:function(){this.inputElement=this.inputElement||this.element;this.elementNode=this.inputElement.get(0)},addEventHandlers:function(){var a=this;this.options.needsPlaceholderSupport&&(this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode),this.bindInputEvent("focus",this.handleElementFocusEvent),
this.bindInputEvent("smartyfocus",this.handleElementFocusEvent),this.bindInputEvent("blur",this.handleElementBlurEvent));if(this.options.selectOnFocus)a.inputElement.on("focus",function(){a.inputElement.on("mouseup.a keyup.a",function(b){a.elementNode.setSelectionRange(0,9999);a.inputElement.off("mouseup.a keyup.a").select()})})},getValue:function(){return b(this.inputElement).val()}}))})(jq||jQuery);(function(e,f){e.publish("SmartyLogger",{loggingCategory:"Smarty",inputDefault:"destination",selectedIndex:"",subscribedLogSearchId:void 0,locationTypeIdLookupMap:{ap:"lmid",lm:"lmid",hotel:"hid",freereg:"frid",hood:"nhid",ctry:"cid"},_save:function(a){this.setStorage(a)},_log:function(a){a&&(this.logData(a,"origin"),this.logData(a,"destination"))},logData:function(a,c){var b=this;a=this.getLoggingObj(a,c);f.isEmptyObject(a)||e.Analytics.api.trackEvent(a,function(){b.cleanUpSmartyLogger(c)})},makeOptionsStr:function(a,
c){var b=this,d,f,k,g=[],l=!1;a.each(function(h){d=e.common.widgets.smarty.FlareSmarty.prototype.translateItem.call(this,a[h]);null==c||l||d.id!==c.id||d.type!==c.type||(b.selectedIndex=h+1,l=!0);f=d.id.split("/");1<f.length&&(d.idCode=f[1],d.apCode=f[0]);k="ap"===d.type?"airport":d.type;g.push("pos: "+(h+1));g.push("text: "+b.cleanString(d.short_str||d.str));g.push("locid: "+b.getBestItemId.call(b,d));g.push("loc_type: "+k)});return g.join("|")},getBestItemId:function(a){return a&&a.type?this.cleanString(a[this.locationTypeIdLookupMap[a.type]||
"id"]||a.id||""):""},getLoggingObj:function(a,c){var b=this.getStorage(c),d={};f.isEmptyObject(b)||(d={searchid:a,category:this.loggingCategory,params:{point:c}},b.hasOwnProperty("vertical")&&(d.params.vertical=b.vertical),b.hasOwnProperty("prefix")&&(d.params.prefix=b.prefix),b.hasOwnProperty("selected")&&(d.params.selected=b.selected),b.hasOwnProperty("options")&&(d.params.options=b.options));return d},setStorage:function(a){if(a&&e.storage.isAvailable()){var c=(a.inputType||this.inputDefault)+
"SmartyLogging",b=this.getStorageObj(a.inputType);a.hasOwnProperty("vertical")&&(b.vertical=a.vertical);a.hasOwnProperty("prefix")&&(b.prefix=this.cleanString(a.prefix));a.hasOwnProperty("options")&&(b.options=this.makeOptionsStr(a.options,a.selectedElem||null),b.selected=this.selectedIndex,this.selectedIndex="");e.storage.set(c,b)}},getStorageObj:function(a){a=(a||this.inputDefault)+"SmartyLogging";var c={};e.storage.isAvailable()&&(c=e.storage.get(a),f.isEmptyObject(c)&&(e.storage.set(a,{}),c=e.storage.get(a)));
return c},getStorage:function(a){var c={};e.storage.isAvailable()&&(c=e.storage.get(a+"SmartyLogging"));return c},cleanString:function(a){return"string"===typeof a?a.trim().replace(/&/g,"\\\x26"):""},cleanUpSmartyLogger:function(a){e.storage.remove(a+"SmartyLogging");this.selectedIndex=""},onLogSearchId:function(a){a&&this._log(a)}});e.SmartyLogger.subscribedLogSearchId||(e.SmartyLogger.subscribedLogSearchId=1,e.events.subscribe("smartylogger.log.searchId",f.proxy(e.SmartyLogger.onLogSearchId,e.SmartyLogger)))})(R9,
jQuery);(function(e,k){e.createWidgetClass("checkbox.StyleJamCheckbox",{widgetName:"checkbox",isToggle:!1,showLabel:!0,options:{click:k.noop,change:k.noop,keydown:k.noop,focus:k.noop,blur:k.noop},init:function(){this.elementNode=this.element.get(0);if(this.slider=this.getChildElement("slider"))this.isToggle=!0;this.label=this.getChildElement("label");this.showLabel=!!this.label.text().trim()},addEventHandlers:function(){this.bindInputEvent("click",this._handleElementClickEvent);this.bindInputEvent("change",
this._handleElementChangeEvent);this.bindInputEvent("keydown",this._handleKeydownEvent);this.bindInputEvent("focus",this._handleElementFocusEvent);this.bindInputEvent("blur",this._handleElementBlurEvent);if(!this.showLabel){var a=this;this.bindInputEvent("click",function(c){a.element.trigger("click."+this.widgetName,c)},this.getChildElement("icon"))}},bindInputEvent:function(a,c,d){var b=this;a+="."+this.widgetName;d=d||this.element;d.off(a).on(a,function(a){c.call(b,this,null,a)})},_handleElementClickEvent:function(){this.options.click.apply(this,
arguments)},_handleElementChangeEvent:function(a,c,d){e.common.widgets.checkbox.StyleJamCheckbox.refresh(a);this.options.change.apply(this,arguments);var b=k(a).prop("checked");a.setAttribute("aria-checked",b)},_handleKeydownEvent:function(a,c,d){this.options.keydown.apply(this,arguments)},_handleElementFocusEvent:function(a,c,d){a.disabled||(this.options.useFocusOutlines&&this.toggleFocusOutline(!0),this.isToggle&&e.common.widgets.checkbox.StyleJamCheckbox.refresh(this.elementNode),this.options.focus.apply(this,
arguments))},_handleElementBlurEvent:function(a,c,d){a.disabled||(this.options.useFocusOutlines&&this.toggleFocusOutline(!1),this.isToggle&&e.common.widgets.checkbox.StyleJamCheckbox.refresh(this.elementNode),this.options.blur.apply(this,arguments))},toggleFocusOutline:function(a){this.swapClassesToggle(this.element.closest(".js-checkbox-wrapper"),"","Checkbox--focused",!a)},setEnabled:function(a){a?this.element.removeAttr("disabled"):this.element.attr("disabled","disabled");this.element.attr("aria-disabled",
!a);e.common.widgets.checkbox.StyleJamCheckbox.refresh(this.element)},getValue:function(){return this.element.prop("checked")},setChecked:function(a){this.element.prop("checked",a)},setLabel:function(a){this.label.text(a)}});e.extend("common.widgets.checkbox.StyleJamCheckbox",{isCheckbox:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"checkbox"==a.type.toLowerCase()},refresh:function(a){var c=e.question.ask("checkbox.StyleJamCheckbox.states");this.reflectState(a,c)},reflectState:function(a,
c){var d=k(a),b=d.data("switchInfo"),h=d.attr("id"),g=k("#"+h+"-label"),d=k("#"+h+"-icon"),h=k("#"+h+"-slider");if(g.length){var f=c.label;f[b.presentation]||(new e.logger(this.prototype._logPath)).error("Label States not defined for "+b.presentation+". Set them in StyleJamCheckbox.java#getLabelStates");l=f[b.presentation].checked||f.VANILLA.checked;m=f[b.presentation].unchecked||f.VANILLA.unchecked;f=f[b.presentation].disabled||f.VANILLA.disabled;a.checked?e.dom.swapClasses(g,m,l):e.dom.swapClasses(g,
l,m);a.disabled||a.prop&&a.prop("disabled")?e.dom.swapClasses(g,"",f):e.dom.swapClasses(g,f,"")}if(d.length){var g=c.icon,n=g.VANILLA;g[b.presentation]||(new e.logger(this.prototype._logPath)).error("Icon states not defined for "+b.presentation+". Presentations with icons must have states defined, set them in StyleJamCheckbox.java#getIconStates");b.disableMouseOutAnimation?(l=g.disableMouseOutAnimation.checked||n.checked,m=g.disableMouseOutAnimation.unchecked||n.unchecked,f=g.disableMouseOutAnimation.disabled||
n.disabled):(l=g[b.presentation].checked||n.checked,m=g[b.presentation].unchecked||n.unchecked,f=g[b.presentation].disabled||n.disabled,p=g[b.presentation].checkedFocus||n.checkedFocus,q=g[b.presentation].uncheckedFocus||n.uncheckedFocus);d.removeClass(l+" "+p+" "+m+" "+q);a.checked?a===document.activeElement?d.addClass(p):d.addClass(l):a===document.activeElement?d.addClass(q):d.addClass(m);a.disabled||a.prop&&a.prop("disabled")?e.dom.swapClasses(d,"",f):e.dom.swapClasses(d,f,"")}if(h.length){c=c.slider;
var l=c[b.presentation].checked||"",m=c[b.presentation].unchecked||"",f=c[b.presentation].disabled||"",p=c[b.presentation].checkedFocus||"",q=c[b.presentation].uncheckedFocus||"";c[b.presentation]||(new e.logger(this.prototype._logPath)).error("Slider states not defined for "+b.presentation+". Presentations with sliders must have states defined, set them in StyleJamCheckbox.java#getSliderStates");h.removeClass(l+" "+p+" "+m+" "+q);a.checked?a===document.activeElement?h.addClass(p):h.addClass(l):a===
document.activeElement?h.addClass(q):h.addClass(m);a.disabled?e.dom.swapClasses(h,"",f):e.dom.swapClasses(h,f,"")}if("TOGGLE_WITH_CHECK_MARK"===b.presentation||"TOGGLE"===b.presentation)b=k(a).getWidget(),p=k(a).parent().find(".toggle"),a.checked?b.swapClasses(p,"Checkbox--unchecked--toggle__slider__toggle","Checkbox--checked--toggle-with-checkmark__slider__toggle"):b.swapClasses(p,"Checkbox--checked--toggle-with-checkmark__slider__toggle","Checkbox--unchecked--toggle__slider__toggle")}});(function(a){var c=
a.fn.prop;a.fn.prop=function(d,b){var h=c.apply(this,arguments);"undefined"==typeof b||"checked"!=d&&"disabled"!=d||this.each(function(){e.common.widgets.checkbox.StyleJamCheckbox.isCheckbox(this)&&a(this).parent().is(".StyleJamCheckbox")&&e.common.widgets.checkbox.StyleJamCheckbox.refresh(this)});return h}})(k)})(R9,jQuery);(function(b){R9.extend("Widgets.Smarty",{Smarty:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.Smarty.Smarty",{isInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()},isWidgetControlled:function(a){return b(a).hasClass(R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass+"-input")},getDropdownEl:function(a){return jq(a).find("#smartbox")},getDropdownId:function(a){return"smartbox"}});
R9.extend("Widgets.Smarty.Smarty.prototype",{widgetName:"smarty",widgetBaseClass:"r9-smarty",elementNode:null,element:null,dropdown:null,lastValue:null,aria:!1,trimInputElements:"span.nearbyHotels, span.nearbyRentals, span.showRank",lastClickOnScrollbar:!1,keyTimeout:null,isHighlightKeyPressed:!1,isItemSet:!1,backgroundAutocomplete:null,activeAnimation:!0,options:{minLength:0,appendTo:"body",dropdown:null,fixedDropdown:!1,initialData:null,initialDataLoadWithCallback:null,searchOnFocus:!1,showDropdownWhenEmpty:!1,
dataSource:null,dataType:"text",minWidth:10,maxWidth:1024,noAutoWidth:!1,position:"left",dropdownClass:null,setItem:null,beforeStart:null,afterDone:null,dropdownListSelector:"ul li[class!\x3d'separator']",keyDelay:200,forceSelection:!1,makeHTML:null,translateItem:null,display:"inline",showBackgroundAutocomplete:!1,backgroundAutocompleteMinLength:3,getBackgroundAutocompletePositionProps:null,delayShowDropdown:null,showDropdownDelay:200,enableRemoteHide:!1,zIndex:9999,continents:[],showContinents:!1,
onInputValueChange:function(a){},forceSelectionOfHighlightedItem:!0},init:function(){var a=this;this.aria=R9.config&&R9.config.getBoolean("ui.smarty.aria",!0);R9.config&&(this.options.zIndex=R9.config.getInt("ui.smarty.zIndex",9999));this.initDropdown();R9.globals.browserCapabilities.scrollbarRetainsInputFocus&&"false"!==R9.globals.browserCapabilities.scrollbarRetainsInputFocus||this.trackScrollbarClick();this.bindInputEvent("focus",this.handleInputFocusEvent);this.bindInputEvent("blur",this.handleInputBlurEvent);
this.bindInputEvent("keydown",this.handleInputKeydownEvent);this.bindInputEvent("textchange",this.handleInputChangeEvent);b(window).on("scroll.smarty",function(){a.position()});b(window).resize(this.handleWindowResize.bind(a));this.element.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off"});this.aria&&this.element.attr({role:"combobox","aria-autocomplete":this.options.showBackgroundAutocomplete?"both":"list"});this.element.data(this.widgetName,this);this.element.is(":focus")&&this.element.focus();
this.initBackgroundAutocomplete()},unInit:function(){this.unbindInputEvent("focus");this.unbindInputEvent("blur");this.unbindInputEvent("keydown");this.unbindInputEvent("textchange");b(window).off("scroll.smarty");this.dropdown.off("mousedown.trackScrollbarClick");jq("body").off("click.trackScrollbarClick")},initDropdown:function(){var a=R9.Widgets.Smarty.Smarty.getDropdownEl(this.element),c=R9.Widgets.Smarty.Smarty.getDropdownId(this.element),a=jq(a)[0];if(null==a){var b=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass;
this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);a=jq("\x3cdiv\x3e\x3c/div\x3e",{id:c,css:{display:"none",position:"absolute",width:"auto",zIndex:1E4},role:"dialog",tabindex:"0"}).appendTo(this.options.appendTo)[0];jq(a).addClass(b)}this.dropdown=jq(a)},validateElement:function(){return R9.Widgets.Smarty.Smarty.isInput(this.elementNode)&&R9.Widgets.Smarty.Smarty.isWidgetControlled(this.element)},trackScrollbarClick:function(){var a=this;a.dropdown.on("mousedown.trackScrollbarClick",
function(b){a.lastClickOnScrollbar=!0;b.stopPropagation();jq("body").trigger("event",[b])});jq("body").on("click.trackScrollbarClick",function(b){R9.Common.Utils.Browsers.isIE()&&a.lastClickOnScrollbar&&(a.lastClickOnScrollbar=!1,a.element.blur());a.lastClickOnScrollbar=!1})},bindInputEvent:function(a,b){var c=this;a+="."+this.widgetName;this.element.off(a).on(a,function(a){return b.call(c,this,a)})},unbindInputEvent:function(a){a+="."+this.widgetName;this.element.off(a)},bindDropdownEvent:function(a,
b){var c=this;this.dropdown.off(a,this.options.dropdownListSelector).on(a,this.options.dropdownListSelector,function(a){b.call(c,this,a)})},handleInputKeydownEvent:function(a,b){this.activeAnimation=this.focusEventHandled=!1;var c=b.keyCode?b.keyCode:b.which;switch(c){case 38:return this.highlitePrevItem(),!1;case 40:return this.highliteNextItem(),!1;case 27:return!this.hideDropdown();case 13:return this.selectHighlightedItemWhenSearchCompleted(c);case 9:if(this.canItemBeActivatedByTab()){if(R9.config.getBoolean("ui.common.smarty.anywhere-on-tab-check.enabled",
!1)&&this.isItAnywhereItem())return this.selectHighlightedItemWhenSearchCompleted(c);this.options.forceSelectionOfHighlightedItem&&this.selectHighlitedItem(c)}break;default:this.handleKeydownBeforeAutocomplete(a,b),this.abortSearchCompletedEventListeners()}},isItAnywhereItem:function(){var a=this.getItemList(),b=this.getHighlitedItemIndex();return(a=a[b])?"anywhere"==a.getAttribute("data-short-name")?!0:!1:!1},canItemBeActivatedByTab:function(){var a=this.getItemList(),c=this.getHighlitedItemIndex();
return(a=b(a[c]))?!(a.hasClass("signupnow")||a.hasClass("signup")||a.hasClass("showHistory")||a.hasClass("js-not-selectable")):!1},handleInputChangeEvent:function(a,b){if(this.focusEventHandled)this.focusEventHandled=!1;else{if(!R9.Common.Utils.Browsers.isIE(10)&&!R9.Common.Utils.Browsers.isIE(11)||this.element.is(":focus")){this.abortKeyTimeout();this.abortRequest();this.onInputChange();var c=this;this.keyTimeout=setTimeout(function(){c.keyTimeout=null;c.handleInputValue()},this.options.keyDelay)}this.activeAnimation=
!1}},onInputChange:function(){this.isItemSet=!1;var a=this.getHighlitedItem();a&&!this.itemMatches(a,this.element.val())&&this.removeItemHighlight();"function"===typeof this.options.clearItem&&this.options.clearItem(this);try{this.element&&(jq(this.element).removeClass("smarty-complete"),jq(this.element).removeClass("four-twenty"),jq(this.element).addClass("smarty-incomplete"),R9.events.publish("smarty.setitem.incomplete",{id:this.element.attr("id")}))}catch(c){}},handleInputValue:function(){var a=
this.element.val();this.options.onInputValueChange(a);this.element.length&&0<a.length?(this.abortRequest(),this.runSearch(!0)):this.options.showDropdownWhenEmpty?(this.abortRequest(),this.showInitialDropdown()):(this.dropdown[0].innerHTML="",this.hideDropdown())},handleInputFocusEvent:function(a,b){jq(a).trigger("smartyfocus");var c=this;if(!c.lastClickOnScrollbar){var e=function(){c.checkAlive()&&setTimeout(e,250)};setTimeout(e,250);this.onBeforeStart(b);this.runSearchOnFocus()&&(this.focusEventHandled=
!0,0!=this.element.val().length||this.runNoQuerySearch()?this.runSearch(!!b):null!==this.options.initialDataLoadWithCallback?this.options.initialDataLoadWithCallback(function(a){c.showInitialDropdownForData(a)}):this.showInitialDropdown())}},runSearchOnFocus:function(){return this.options.searchOnFocus},runNoQuerySearch:function(){return this.options.searchNoQuery},onBeforeStart:function(a){"function"===typeof this.options.beforeStart&&this.options.beforeStart(this,a)},handleInputBlurEvent:function(a,
b){this.focusEventHandled=!1;var c=this;setTimeout(function(){if(c.lastClickOnScrollbar)R9.Common.Utils.Browsers.isIE()||(c.element.focus(),c.lastClickOnScrollbar=!1);else{c.stopInputProcessing();if(c.hideDropdown()&&c.options.forceSelection)c.onForceSelection();c.onAfterDone()}},10)},stopInputProcessing:function(){this.isUpdateInProgress()&&(this.abortKeyTimeout(),this.abortRequest(),this.removeItemHighlight())},isUpdateInProgress:function(){return this.keyTimeout||this.request},onForceSelection:function(){if(!this.isItemSet&&
""!==this.element.val()){var a=this.getHighlitedItem();a&&this.selectItem(a,null)}},onAfterDone:function(){"function"===typeof this.options.afterDone&&this.options.afterDone(this)},handleItemMouseoverEvent:function(a,b){this.getItemList().removeClass("selected");jq(a).not(".js-not-selectable").addClass("selected")},handleItemMouseoutEvent:function(a,b){jq(a).removeClass("selected")},handleItemMousedownEvent:function(a,b){b.stopPropagation();jq("body").trigger("event",[b]);this.selectItem(a,null);
this.hideDropdown()},selectHighlitedItem:function(a){var b=this.getItemList();if(b){var d=this.getHighlitedItemIndex();0>d?13==a&&this.noItemToSelect():(b=b[d])&&this.selectItem(b,a)}else 13==a&&this.noItemToSelect()},selectHighlightedItemWhenSearchCompleted:function(a){var b=this;if(this.isItemSet&&!this.isHighlightKeyPressed){if(this.isDropdownHidden()&&13===a)return!0;this.hideDropdown();return!1}this.selectHighlitedItem(a);this.hideDropdown(!this.isItemSet);if(this.isItemSet)return!1;this.element.one("searchCompleted",
function(){b.selectHighlitedItem(a);b.hideDropdown()});return!1},noItemToSelect:function(){},selectItem:function(a,b){a=this.translateItem(a);this.setItem(a,b)},translateItem:function(a){return"function"===typeof this.options.translateItem?this.options.translateItem(a):a},setItem:function(a,b){if(this.element)try{if(a){jq(this.element).addClass("smarty-complete");jq(this.element).removeClass("smarty-incomplete");jq(this.element).removeClass("four-twenty");if(R9.config.getBoolean("ui.four-twenty.enabled",
!1)&&"string"===typeof a.str){var c=!1,e=R9.config.getString("ui.four-twenty.states","").split(";"),f=a.str.match(/^[^,]+,\s+([A-Z]{2})(\s|$)/);(f=f?f[1]:null)&&-1!==e.indexOf(f)&&(c=!0);for(var g=R9.config.getString("ui.four-twenty.cities","").split(";"),e=0;e<g.length;e++)""!==g[e]&&-1!==a.str.indexOf(g[e])&&(c=!0);c&&jq(this.element).addClass("four-twenty")}R9.events&&R9.events.publish("smarty.setitem.complete",{id:this.element.attr("id")})}else jq(this.element).addClass("smarty-incomplete"),jq(this.element).removeClass("smarty-complete"),
jq(this.element).removeClass("four-twenty"),R9.events&&R9.events.publish("smarty.setitem.incomplete",{id:this.element.attr("id")})}catch(h){}"function"===typeof this.options.setItem?(this.isItemSet=!0,this.options.setItem(this,a,b)):a?(this.isItemSet=!0,this.element.val(jq(a).text())):(this.isItemSet=!1,this.element.val(""))},showInitialDropdown:function(){this.showInitialDropdownForData(this.onInitialData())},showInitialDropdownForData:function(a){a&&this.searchCompleted(a,!1)},onInitialData:function(){return"function"===
typeof this.options.initialData?this.options.initialData(this):this.options.initialData},runSearch:function(a){var b=this.element.val();if(!(b.length<this.options.minLength||this.lastValue==b)){var d=this.getRequestData(),d=this.preprocessRequest(d),e=this,f=function(c){e.request=null;e.lastValue=b;c=e.postprocessResponse(c,a);e.searchCompleted(c,a)};if("function"===typeof this.options.dataSource)this.options.dataSource(d,f,this,a);else if(R9.config.getBoolean("ui.common.smarty.get.enabled",!1)){var g=
this.getDataSource();d.cv=R9.config.getString("ui.common.smarty.get.version","1");this.request=jq.ajax({type:"GET",url:g,data:d,dataType:this.options.dataType,cache:!0,success:f})}else this.request=jq.post(this.getDataSource(),d,f,this.options.dataType)}},getDataSource:function(){return this.options.dataSource},preprocessRequest:function(a){return a},getRequestData:function(){return{value:this.element.val(),formtoken:R9.globals.formtoken}},searchCompleted:function(a,b){(a=this.canShowDropdown(a))?
this.showDropdown(a,b):(this.dropdown[0].innerHTML="",this.hideDropdown());this.element.trigger("searchCompleted",!!a)},canShowDropdown:function(a){return a},abortSearchCompletedEventListeners:function(){this.element.off("searchCompleted")},postprocessResponse:function(a,b){return a},makeHTML:function(a){return"function"===typeof this.options.makeHTML?this.options.makeHTML(a):a},animateSmartyV2:function(a){var b=this;this.dropdown.addClass("smarty-animation-v2");a?this.activeAnimation?(this.dropdown.addClass("open-animation"),
this.dropdown.removeClass("close-animation"),setTimeout(function(){b.dropdown.show()},480)):b.dropdown.show():this.activeAnimation?(this.dropdown.addClass("close-animation"),this.dropdown.removeClass("open-animation"),setTimeout(function(){b.dropdown.hide()},480)):b.dropdown.hide()},showDropdown:function(a,b){if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=setTimeout(this.showDropdown.bind(this,a,b),this.options.showDropdownDelay);
else{null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);b=this.dropdown[0].style;var c=this.makeHTML(a);this.dropdown[0].innerHTML=c;c=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass;this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);this.dropdown.attr("class",c);a.length?this.dropdown.removeClass("empty"):this.dropdown.addClass("empty");this.position();this.aria&&(this.element.attr({"aria-expanded":!0}),this.dropdown.find("ul").attr("role",
"listbox"),this.dropdown.find("li").not(".js-not-option").attr("role","option"));R9.config.getBoolean("ui.smarty.animate",!1)&&this.dropdown.slideDown(R9.config.getInt("ui.smarty.animation.ms",250));b.visibility="visible";b.display=this.options.display;jq.fn.zIndex&&(b.zIndex=jq(this.element).zIndex()+this.options.zIndex);this.bindDropdownEvent("mousedown",this.handleItemMousedownEvent);this.bindDropdownEvent("mouseover",this.handleItemMouseoverEvent);this.bindDropdownEvent("mouseout",this.handleItemMouseoutEvent);
this.removeItemHighlight();""!==this.element.val()&&this.highlightFirstSelectableItem();R9.config.getBoolean("ui.smarty.animation.v2",!1)&&this.animateSmartyV2(!0)}},position:function(){var a=this.dropdown[0].style,b=0;this.dropdown.parent()[0]===jq(document.body)[0]&&(b=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);this.dropdown.css("width","auto");var d=this.dropdown.outerWidth(!0),e=!1;this.options.minWidth&&d<=this.options.minWidth&&(d=Math.max(this.options.minWidth,d),e=!0);
this.options.maxWidth&&d>=this.options.maxWidth&&(d=Math.min(this.options.maxWidth,d),e=!0);a.width=e||this.options.noAutoWidth?d+"px":"auto";var e=this.element.offset(),f=jq(this.options.appendTo).offset(),g=e.left-f.left;"right"===this.options.position&&(g+=this.element.width()-d-2);a.left=g+"px";a.top=b+e.top+this.element.outerHeight()-f.top+"px"},isDropdownHidden:function(){return"none"==this.dropdown.css("display")||"hidden"==this.dropdown.css("visibility")},hideDropdown:function(a){a||(this.abortKeyTimeout(),
this.abortRequest());this.isHighlightKeyPressed=!1;this.lastValue=null;if(this.isDropdownHidden())return!1;R9.config.getBoolean("ui.smarty.animation.v2",!1)?this.animateSmartyV2(!1):this.dropdown.hide();this.aria&&this.element.attr({"aria-expanded":!1});this.setBackgroundAutocomplete();return!0},abortRequest:function(){if(this.request){try{this.request.abort()}catch(a){}this.request=null}},abortKeyTimeout:function(){this.keyTimeout&&(clearTimeout(this.keyTimeout),this.keyTimeout=null)},highliteNextItem:function(){var a=
this.getItemList(),b=nsel=this.getHighlitedItemIndex();-1==b?nsel=0:b<a.length-1&&(nsel=b+1);b!=nsel&&(jq(a[b]).removeClass("selected"),jq(a[b]).trigger("mouseout"),jq(a[nsel]).addClass("selected"),jq(a[nsel]).trigger("mouseover"),this.isHighlightKeyPressed=!0,this.setBackgroundAutocomplete(a[nsel]))},highlitePrevItem:function(){var a=this.getItemList(),b=nsel=this.getHighlitedItemIndex();-1==b?nsel=0:0<b&&(nsel=b-1);b!=nsel&&(jq(a[b]).removeClass("selected"),jq(a[b]).trigger("mouseout"),jq(a[nsel]).addClass("selected"),
jq(a[nsel]).trigger("mouseover"),this.isHighlightKeyPressed=!0,this.setBackgroundAutocomplete(a[nsel]))},highlightFirstSelectableItem:function(){for(var a=this.getItemList(),b=0;b<a.length;b++){var d=jq(a[b]);if(!d.hasClass("hist")&&!d.hasClass("js-not-selectable")){d.addClass("selected");this.setBackgroundAutocomplete(a[b]);return}}jq(a[0]).addClass("selected");this.setBackgroundAutocomplete(a[0])},removeItemHighlight:function(){jq(this.getItemList()).removeClass("selected")},getHighlitedItemIndex:function(){for(var a=
this.getItemList(),b=a.length,d=0;d<b;d++)if(jq(a[d]).hasClass("selected"))return d;return R9.config.getBoolean("ui.smarty.auto.select.1st",!1)&&0<b?0:-1},getHighlitedItem:function(){for(var a=this.getItemList(),b=a.length,d=0;d<b;d++)if(jq(a[d]).hasClass("selected"))return a[d];return R9.config.getBoolean("ui.smarty.auto.select.1st",!1)&&0<b?a[0]:null},getItemList:function(){return this.dropdown.find(this.options.dropdownListSelector)},itemMatches:function(a,b){return a?0<=jq(a).text().toLowerCase().indexOf(b.toLowerCase()):
!1},checkAlive:function(){return this.element.closest("html").length?this.element.is(":visible")?!0:(this.hideDropdown(),!1):(this.hideDropdown(),this.unInit(),!1)},initBackgroundAutocomplete:function(){!this.backgroundAutocomplete&&this.options.showBackgroundAutocomplete&&(this.options.backgroundAutocompleteMinLength=R9.config.getInt("ui.common.smarty.background.autocomplete.min.length",3),this.backgroundAutocomplete=jq("\x3cinput/\x3e",{id:this.element.attr("id")+"-bg-autocomplete","class":this.element.attr("class"),
type:"text",tabindex:"-1"}).insertBefore(this.element),this.updateBackgroundAutocompletePosition(),this.backgroundAutocomplete.css("color",this.element.css("color").replace(")",", 0.27)").replace("rgb","rgba")),this.backgroundAutocomplete.addClass("smarty-bg-autocomplete"),this.element.addClass("smarty-with-bg-autocomplete"))},updateBackgroundAutocompletePosition:function(){if(this.options.showBackgroundAutocomplete)if("function"===typeof this.options.getBackgroundAutocompletePositionProps)this.backgroundAutocomplete.css(this.options.getBackgroundAutocompletePositionProps());
else{var a=this.element.is(":visible")?this.element.outerHeight():this.element.height();this.backgroundAutocomplete.css({"margin-bottom":"-"+a+"px"})}},handleKeydownBeforeAutocomplete:function(a,b){if(this.options.showBackgroundAutocomplete){var c=this;setTimeout(function(){var a=c.backgroundAutocomplete.val(),b=c.element.val();b.length>=c.options.backgroundAutocompleteMinLength&&b.length<a.length&&!c.isDropdownHidden()?c.backgroundAutocomplete.val(b+a.substr(b.length)):c.backgroundAutocomplete.val("")},
1)}},setBackgroundAutocomplete:function(a){if(this.options.showBackgroundAutocomplete){var b=this.element.val();if(a&&b.length>=this.options.backgroundAutocompleteMinLength){var d=this.getBackgroundAutocompleteText(a);if(0<d.length){a=d.toUpperCase().indexOf(b.toUpperCase());this.backgroundAutocomplete.val(-1===a?"":b+d.substr(a+b.length));return}}this.backgroundAutocomplete.val("")}this.aria&&a&&a.attributes.id&&(b=jq(a).find(this.trimInputElements).filter(function(){return jq(this).is(":visible")}),
0<b.length&&(d=jq(a).clone(),d.find(this.trimInputElements).remove(),jq(a).attr("aria-label",d.text()+" "+b.text())),this.element.attr({"aria-activedescendant":a.attributes.id.value}))},getBackgroundAutocompleteText:function(a){a=this.translateItem(a);return"string"===typeof a.str?a.str:""},handleWindowResize:function(){this.updateBackgroundAutocompletePosition()}})})(jq||jQuery);
R9.extend("Widgets.Smarty",{FlareSmarty:function(b,a){R9.Widgets.Smarty.Smarty.call(this,b,jq.extend({dataSource:"/mv/marvel"},a));var c=this;jq(".mapViewOuter .filterWrapper").scroll(function(){R9.Widgets.Smarty.Smarty.prototype.handleInputBlurEvent.call(c)})}});R9.extend("Widgets.Smarty.FlareSmarty",!0,{setRunSearchNextFocus:function(b){R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=b},runSearchNextFocus:!0});
R9.extend("Widgets.Smarty.FlareSmarty.prototype",!0,R9.Widgets.Smarty.Smarty.prototype,{translateItem:function(b){if(!b)return null;var a=jq(b).clone()[0];b=a.id.split("-");var c="";1<b.length&&0>b[1].indexOf(" ")&&(c=b[1]);jq(a).find("span.airportCode, span.region-label, span.nearbyHotels, span.nearbyRentals, span.smarty-emoji, span.smarty-label, span.smarty-popular, span.smarty-city-popular, span.smarty-air-popular, span.showRank").remove();var d=jq(a).attr("data-text-to-select"),d=d&&0<jq.trim(d).length?
d:jq(a).text(),a={type:b[0],id:c,str:d,name:d,short_str:jq(a).attr("data-short-name"),cc:jq(a).attr("data-cc")||"",apicode:a.getAttribute("data-apicode")};"isl"===a.type&&1<b.length&&(c=b[1].split("/"),a.str=c[0]);2<b.length&&(a.hc=b[2]);3<b.length&&("hotel"===a.type?a.hid=b[3]:"rest"===a.type?a.rtid=b[3]:"freereg"===a.type?a.frid=b[3]:"reg"===a.type?a.rid=b[3]:"ctry"===a.type?a.cid=b[3]:"ctgroup"===a.type?a.cgid=b[3]:"hood"===a.type?a.nhid=b[3]:a.lmid=b[3]);return a},preprocessRequest:function(b){var a=
{};this.options.extendRequest&&(a="function"===typeof this.options.extendRequest?this.options.extendRequest(this,b):this.options.extendRequest);var c={};this.options.v&&(c.v=this.options.v);c.f="h";this.options.f&&(c.f=this.options.f);c.where=b.value;c.s=this.getFlareSmartyType()||-1;c.lc_cc=R9.globals.locale.lc_cc;c.lc=R9.globals.locale.lc;return jq.extend(c,a)},runSearchOnFocus:function(){var b=R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus;R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=!0;
return R9.Widgets.Smarty.Smarty.prototype.runSearchOnFocus.call(this)&&b},onInitialData:function(){var b=this.generateTopDestinations()||R9.Widgets.Smarty.Smarty.prototype.onInitialData.call(this)||this.makeRecentList(null,!0),a=this.generateAnywhereMarkup(),c=this.generateLoginBar(b||a),d=this.generateContinentsMarkup();if(b)return this.placeAnywhereMarkup(b,(a?a:"")+c);b=[];this.appendToInitialData(b);a&&b.push(a);d&&b.push(d);this.options.smartyControlGroup&&R9.globals.canLogin&&"undefined"!==
typeof c&&b.push(c);return b.length?"\x3cul\x3e"+b.join("")+"\x3c/ul\x3e":""},appendToInitialData:function(b){},generateTopDestinations:function(){if(this.options.smartyControlGroup){var b=this.options.smartyControlGroup.getTopDestinations();if(b){var a=b.getItems(),c=b.getMaxItems();return(b=a&&a.filter(function(a,b){return b<c}).map(this.createTopDestinationItem.bind(this)).join(""))&&""!==b?"\x3cul\x3e"+b+"\x3c/ul\x3e":null}}},createTopDestinationItem:function(b){return""},generateAnywhereMarkup:function(b){},
generateContinentsMarkup:function(){},placeAnywhereMarkup:function(b,a){return b?R9.config.getBoolean("ui.smarty.anywhereFirst",!1)?b.replace("\x3cul\x3e","\x3cul\x3e"+a):b.replace("\x3c/ul\x3e",a+"\x3c/ul\x3e"):b},placeContinentsMarkup:function(b,a){return b?b.replace("\x3c/ul\x3e",a+"\x3c/ul\x3e"):b},postprocessResponse:function(b,a){var c=b&&/<li/i.test(b),d=this.makeRecentList(a?this.element.val().toUpperCase():null,!c),e=this.generateOtherMarkup(c);a=this.generateAnywhereMarkup(c);var f=this.generateContinentsMarkup();
if(!d&&!c&&!a)return null;if(!c)return b=d?d:"\x3cul\x3e\x3c/ul\x3e",b=e?b.replace("\x3c/ul\x3e",e+"\x3c/ul\x3e"):b,b=this.placeAnywhereMarkup(b,a?a:""),b=this.placeContinentsMarkup(b,f),b+this.generateLoginBar(!1);b=e?b.replace("\x3c/ul\x3e",e+"\x3c/ul\x3e"):b;b=this.placeAnywhereMarkup(b,a?a:"");d&&(b=b.replace("\x3c/ul\x3e",d+"\x3c/ul\x3e"));return b.replace("\x3c/ul\x3e",this.generateLoginBar(!0)+"\x3c/ul\x3e")},generateOtherMarkup:function(b){return null},selectItem:function(b,a){jq(b).hasClass("hist")&&
this.options.smartyControlGroup?(b=jq(b).data("history-idx"),a=this.options.smartyControlGroup.getHistory(),this.options.smartyControlGroup.setFieldsFromHistoryItem(a.history[b],!1),"undefined"!==typeof this.tempState&&delete this.tempState,R9.Analytics.api.trackEvent("smartyHistory/click/historyItem")):jq(b).hasClass("showHistory")?(window.location.assign("/history"),R9.Analytics.api.trackEvent("smartyHistory/click/seeAllHistory")):jq(b).hasClass("signup")?(AjaxReg.ui.register({promoType:"smarty"}),
R9.Analytics.api.trackEvent("smartyHistory/click/signUp")):jq(b).hasClass("signupnow")?(R9.config.getBoolean("ui.login.staticSignUp")?R9.authentication.showDefault({promoType:"smarty"}):R9.authentication.showSignup(),R9.Analytics.api.trackEvent("smartyHistory/click/signUp"),R9.events.publish("smarty.setitem.complete",{id:this.element.attr("id")})):(b=this.translateItem(b),this.setItem(b,a))},makeRecentList:function(b,a){var c=this.options.recentList,d=null;if(c&&0<c.length){for(var d="",e=0;e<c.length;e++)if(!b||
-1!=c[e].display.toUpperCase().indexOf(b)){var f=c[e].display;b&&(f=this.highliteText(f,b));d+="\x3cli id\x3d'"+c[e].code+"' class\x3d'"+c[e].className+"' data-short-name\x3d'"+c[e].shortName+"'\x3e"+f+"\x3c/li\x3e"}d=""!=d?(a?"\x3cul\x3e":"")+"\x3cli class\x3d'separator'\x3e\x3cb\x3eRecently searched:\x3c/b\x3e\x3c/li\x3e"+d+(a?"\x3c/ul\x3e":""):null}return d},highliteText:function(b,a){a&&(a=a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$\x26"),b=b.replace(new RegExp("("+a+")","ig"),"\x3cb\x3e$1\x3c/b\x3e"));
return b},getFlareSmartyType:function(){return this.options.flareSmartyType},setFlareSmartyType:function(b){this.options.flareSmartyType=b},matchAndBold:function(b,a,c,d){if(!b||!a)return a;c=c||"\x3cb\x3e";d=d||"\x3c/b\x3e";var e=0,f=0,g="",h=a,k=b.length;for(b=b.toUpperCase();;){if(0!==e||0!==(f=a.toUpperCase().indexOf(b,e)))if(-1<(f=a.toUpperCase().indexOf(" "+b,e)))f++;else break;e=a.substring(e,f);h=a.substring(f,f+k);g+=e+c+h+d;h=a.substring(f+k,a.length);e=f+k}return g+h},handleItemMouseoverEvent:function(b,
a){this.getItemList().removeClass("selected");jq(b).addClass("selected");!this.isDisabledHistoryPreview()&&jq(b).hasClass("hist")&&this.options.smartyControlGroup&&"undefined"===typeof this.tempState&&(this.tempState=this.options.smartyControlGroup.saveFieldsToHistoryItem(),b=jq(b).data("history-idx"),a=this.options.smartyControlGroup.getHistory(),this.options.smartyControlGroup.setFieldsFromHistoryItem(a.history[b],!0))},handleItemMouseoutEvent:function(b,a){jq(b).removeClass("selected");this.isDisabledHistoryPreview()||
"undefined"===typeof this.tempState||(this.options.smartyControlGroup.setFieldsFromHistoryItem(this.tempState,!0),delete this.tempState)},isDisabledHistoryPreview:function(){return!1},generateLoginBar:function(b){if(!this.options.smartyControlGroup||!R9.globals.canLogin)return"";var a="admin";b&&(a+=" addSeparation");return"undefined"!==typeof R9Anon&&R9Anon?"\x3cli class\x3d'signup "+a+"'\x3eSign up to access recent searches anywhere\x3c/li\x3e":"\x3cli class\x3d'showHistory "+a+"'\x3e See all search history\x3c/li\x3e"},
generateRecentHeader:function(){R9.Common.SmartyHistory.currentSmarty=this;R9.Common.SmartyHistory.currentSmartyHistory=this.options.smartyControlGroup.getHistory();this.hasClearRecentEvent||(this.hasClearRecentEvent=!0,this.dropdown.on("click","ul li.searchHistorySeparator",function(b){b.stopPropagation();b.stopImmediatePropagation()}),this.dropdown.on("mousedown","ul li .clearRecent",function(b){b.stopPropagation();jq("body").trigger("event",[b]);R9.Common.SmartyHistory.SmartyClearHistory()}));
return"\x3cli class\x3d'separator searchHistorySeparator'\x3e\x3cspan class\x3d'separatorLabel'\x3eRecent Searches\x3c/span\x3e\x3ca class\x3d'clearRecent'\x3eclear\x3c/a\x3e\x3c/li\x3e"}});
(function(b,a){b.createWidgetClass("smarty.SmartyBaseLoader",a.extend({},b.Widgets.Smarty.Smarty.prototype));b.createWidgetClass("smarty.FlareSmartyBaseLoader","common.widgets.smarty.Smarty",a.extend({},b.Widgets.Smarty.FlareSmarty.prototype,{constructor:function(c,d){this.base(c,a.extend({},b.Widgets.Smarty.FlareSmarty.prototype.options,d))}}))})(window.R9,window.jq||window.jQuery);(function(e,f){e.createWidgetClass("smarty.Smarty","common.widgets.smarty.SmartyBaseLoader",{loggingPrefix:"smarty",setItemTriggered:!1,activeAnimation:!0,focusEventHandled:!1,updateDropdownTop:!0,options:{flippable:!0,direction:"down",repositionDropdownOnResize:e.config.getBoolean("ui.smarty.repositionDropdownOnResize",!0),messages:{SMARTY_HOTELS_NEAR_CITY:"",SMARTY_RENTALS_NEAR_CITY:"",SMARTY_LOCATION_TYPE_HOTEL:"",SMARTY_LOCATION_TYPE_AIRPORT:"",SMARTY_LOCATION_TYPE_NEIGHBORHOOD:"",SMARTY_LOCATION_TYPE_CITY:"",
SMARTY_LOCATION_TYPE_LANDMARK:"",SMARTY_LOCATION_TYPE_COUNTRY:"",SMARTY_LOCATION_TYPE_COUNTRY_GROUP:"",SMARTY_LOCATION_TYPE_REGION:"",SMARTY_LOCATION_TYPE_FREE_REGION:"",SMARTY_LOCATION_TYPE_RAIL:"",SMARTY_LOCATION_TYPE_RESTAURANT:"",SMARTY_LOCATION_TYPE_AIRLINE:"",SMARTY_LOCATION_TYPE_BRAND:"",SMARTY_LOCATION_TYPE_BRAND_GROUP:"",SMARTY_LOCATION_TYPE_AIRPORT_NEAR_CITY:"",SMARTY_LOCATION_TYPE_PLACE:"",SMARTY_LOCATION_TYPE_POI:"",SMARTY_LOCATION_TYPE_WORLD:"",SMARTY_CONTINENTS_LABEL:""}},locationTypeMessages:{},
constructor:function(a,b){this.base(a,b);this.applyJsonOptions();this.locationTypeMessages={ap:this.options.messages.SMARTY_LOCATION_TYPE_AIRPORT,hood:this.options.messages.SMARTY_LOCATION_TYPE_NEIGHBORHOOD,lm:this.options.messages.SMARTY_LOCATION_TYPE_LANDMARK,ctry:this.options.messages.SMARTY_LOCATION_TYPE_COUNTRY,cg:this.options.messages.SMARTY_LOCATION_TYPE_REGION,ctgroup:this.options.messages.SMARTY_LOCATION_TYPE_REGION,reg:this.options.messages.SMARTY_LOCATION_TYPE_REGION,freereg:this.options.messages.SMARTY_LOCATION_TYPE_FREE_REGION,
city:this.options.messages.SMARTY_LOCATION_TYPE_CITY,hotel:this.options.messages.SMARTY_LOCATION_TYPE_HOTEL,rail:this.options.messages.SMARTY_LOCATION_TYPE_RAIL,rest:this.options.messages.SMARTY_LOCATION_TYPE_RESTAURANT,addr:this.options.messages.SMARTY_LOCATION_TYPE_PLACE}},init:function(){this.aria=e.config&&e.config.getBoolean("ui.smarty.aria",!0);e.config&&(this.options.zIndex=e.config.getInt("ui.smarty.zIndex",9999));this.dropdown=this.options.dropdown;this.initSmartyDropdown();this.element.attr("smarty",
!0);!0===this.options.enableRemoteHide&&this.id()&&e.events.subscribe("Smarty.hide",f.proxy(this.hideSmartyById,this));this.subscribe("Smarty.change.style",this.changeSmartyStyle.bind(this))},changeSmartyStyle:function(a){var b=this.dropdown[0].id;b.includes(a.id)&&(this.updateDropdownTop=a.updateDropdownTop,b.includes("origin")?this.dropdown.css(a.originCss):b.includes("destination")&&this.dropdown.css(a.destinationCss))},hideSmartyById:function(a){this.id()!==a&&this.hideDropdown(!1)},inlineComponentsReady:function(){var a=
this;setTimeout(function(){a.element.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off"});a.aria&&a.element.attr({role:"combobox","aria-autocomplete":a.options.showBackgroundAutocomplete?"both":"list"});a.element.is(":focus")?a.element.focus():a.element.attr("autofocus")&&a.element.focus();a.options.showBackgroundAutocomplete&&(a.options.getBackgroundAutocompletePositionProps=function(){return{"margin-bottom":"-"+a.element.outerHeight(!0)+"px"}});a.initBackgroundAutocomplete();e.config.getBoolean("ui.smarty.animation.v2",
!1)&&a.animateSmartyV2(!1);a.initialVal=a.element.val();a.initialCode=a.element.next(".aircode").val();""!==a.initialVal&&(a.isItemSet=!0)},1)},concatExtraDropdownClasses:function(a,b){if(f.isArray(a)&&b)for(var c=0;c<a.length;c++)a[c]&&a[c].dropdownClass&&(a[c].dropdownClass+=b)},extraIconClasses:function(a){return a?" "+e.config.getString("ui.smarty.iconClasses","greyIcons")+" ":""},extraLabelClasses:function(){return e.config.getBoolean("ui.smarty.labels",!1)&&this.options.extendRequest&&"v2"===
this.options.extendRequest.v?e.config.getString("ui.smarty.labelsClasses","greyLabels"):""},addEventHandlers:function(){this.bindInputEvent("keydown",this.handleInputKeydownEvent);this.addDelegateEventHandlers()},addDelegateEventHandlers:e.Common.Utils.limit(1,function(){var a=[e.globals.keyCodes.TAB,e.globals.keyCodes.RETURN,e.globals.keyCodes.ESC];this.bindDelegateInputEvent("focus",this.handleInputFocusEvent);this.bindDelegateInputEvent("mousedown touchstart",this.handleInputFocusEvent);this.bindDelegateInputEvent("blur",
this.handleSmartyInputBlurEvent);this.bindDelegateInputEvent("textchange",this.handleInputChangeEvent);this.bindDelegateInputEvent("keyup",function(b){0<=a.indexOf(b.keyCode?b.keyCode:b.which)||this.dropdown&&this.dropdown.is(":visible")&&this.handleInputFocusEvent(this.element,b)})}),bindDelegateInputEvent:function(a,b){f("body").off(a,'input[smarty\x3d"true"]').on(a,'input[smarty\x3d"true"]',function(a){var c=f(this).getWidget();return c?b.call(c,a):!1})},initDropdown:function(){this.initSmartyDropdown()},
initSmartyDropdown:function(){if(!this.dropdown){var a={id:this.id("smartbox-dropdown"),css:{display:"none",position:"absolute",width:"auto"},role:"dialog",tabindex:"0"},b=this.widgetBaseClass||"";this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);this.dropdown=f("\x3cdiv\x3e\x3c/div\x3e",a).addClass(b);this.dropdown.addClass("R9-Overlay");this.dropdown.addClass(this.extraIconClasses());this.dropdown.addClass(this.extraLabelClasses())}},setDropdownContent:function(a){this.dropdown[0].innerHTML=
a},setDropdownPosition:function(){var a=this.widgetBaseClass;this.options.dropdownClass&&(a=a+" "+this.options.dropdownClass);a=a+" "+this.extraIconClasses()+" "+this.extraLabelClasses();this.dropdown.attr("class",a);var a=this.dropdown[0].style,b=this.dropdown.outerWidth(!0),c=!1;this.options.minWidth&&b<this.options.minWidth&&(b=Math.max(this.options.minWidth,b),c=!0);this.options.maxWidth&&b>this.options.maxWidth&&(b=Math.min(this.options.maxWidth,b),c=!0);a.width=c?b+"px":"auto";if(this.options.fixedDropdown)a.position=
"relative";else{var c=this.options.positionTarget||this.element,d=c.offset(),e=f(this.options.appendTo).offset(),h=0,l=d.left-e.left,k=this.options.direction;this.dropdown.parent()[0]===f(document.body)[0]&&(h=parseInt((f(document.body).css("top")||"0").replace("-",""))||0);"right"===this.options.position&&(l+=c.width()-b-2);this.shouldFlipDirection(k)&&(k="down"===k?"up":"down");"up"===k?this.updateDropdownTop&&(this.element.addClass("up"),a.top=d.top-this.dropdown.outerHeight()-h+"px"):this.updateDropdownTop&&
(this.element.removeClass("up"),a.top=h+d.top+c.outerHeight()-e.top+"px");"rtl"===document.dir?(b=f(window).width()-(d.left+c.outerWidth()),a.right=b+"px"):a.left=l+"px"}this.isAnimated()||(a.display="inline");this.aria&&(this.element.attr({"aria-expanded":!0}),this.dropdown.find("ul").attr("role","listbox"),this.dropdown.find("li").attr("role","option"));a.zIndex=this.element.zIndex()+this.options.zIndex;this.options.boundToScreen&&(this.dropdown.css("height","auto"),b=f(window).height(),c=f(window).scrollTop(),
d=this.dropdown.outerHeight(),a=parseInt(a.top),d+a+10-c>b&&(this.dropdown.height(b+c-a-10),this.dropdown.css("overflow-y","auto")))},shouldFlipDirection:function(a){if(this.options.flippable){var b=f(window).scrollTop(),c=b+f(window).outerHeight(),d=this.dropdown.outerHeight(),e=this.element.offset().top,c=e+this.element.outerHeight()+d>c,b=e-d<b;if("down"===a)return c&&!b;if("up"===a)return b&&!c}return!1},showDropdown:function(a,b){this.options.enableRemoteHide&&e.events.publish("Smarty.hide",
this.id());this.deferredSmartyAppend||(this.deferredSmartyAppend=1,this.dropdown.appendTo(this.options.appendTo));var c=this;this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()){var d=this.showDropdownLast?Date.now()-this.showDropdownLast:null;if(!this.showDropdownLast||0===d||d&&0<d&&d<this.options.showDropdownDelay){this.showDropdownLast=this.showDropdownLast||Date.now();
this.showDropdownTimeout=setTimeout(this.showDropdown.bind(this,a,b),d||this.options.showDropdownDelay);return}}this.showDropdownLast=null;this.setDropdownContent(this.makeHTML(a));this.setDropdownPosition();this.bindDropdownEvent("click",this.handleItemClickEvent);this.bindDropdownEvent("mouseover",this.handleItemMouseoverEvent);this.bindDropdownEvent("mouseout",this.handleItemMouseoutEvent);if(this.options.repositionDropdownOnResize)f(window).off("resize.smarty").on("resize.smarty",this.handleWindowResizeSmarty.bind(this));
clearTimeout(this.clickDropdownSetID);this.clickDropdownSetID=setTimeout(function(){if(c.isSmartyActiveElement())f(document).off("click.Smarty"+c.id()).on("click.Smarty"+c.id(),function(){c.onDocumentClicked()})},400);this.removeItemHighlight();""!==this.element.val()&&this.highlightFirstSelectableItem();this.options.positionOnScroll&&(a=function(){c.position()},f(window).off("scroll.smarty",a).on("scroll.smarty",a),f(".col-left-rail").off("scroll.colSmarty").on("scroll.colSmarty",a),f(".filterList").off("scroll.colSmarty").on("scroll.colSmarty",
a),f(".Common-Widgets-Dialog-Dialog.visible\x3e.viewport").off("scroll.dialogSmarty").on("scroll.dialogSmarty",a));e.config.getBoolean("ui.smarty.animation.v2",!1)&&this.animateSmartyV2(!0)},hideDropdown:function(a){f(window).off("resize.smarty");this.base(a);if(e.config.getBoolean("ui.smarty.auto.select.1st",!1))return!0},toggleAnywhere:function(a){this.options.showAnywhere=a},stopInputProcessing:function(){this.setItemTriggered||this.smartyLoggerSave();this.setItemTriggered=!1;this.base()},handleItemClickEvent:function(a){this.selectItem(a,
null);this.hideDropdown()},handleInputBlurEvent:function(a,b){this.handleSmartyInputBlurEvent(a,b)},handleSmartyInputBlurEvent:function(){var a=this;this.focusEventHandled=!1;setTimeout(function(){if(!a.isSmartyActiveElement()){a.stopInputProcessing();if(a.hideDropdown()&&a.options.forceSelection)a.onForceSelection();a.onAfterDone()}},10)},onDocumentClicked:function(){if(!this.isSmartyActiveElement())if(f(document).off("click.Smarty"+this.id()),this.options.cleanUpInputFieldOnFocus){if(this.lastValue&&
!this.element.val()&&this.element.val(this.lastValue),!this.isSmartyActiveElement()){this.stopInputProcessing();if(this.hideDropdown()&&this.options.forceSelection)this.onForceSelection();this.onAfterDone()}}else this.hideDropdown()},isSmartyActiveElement:function(){return this.dropdown&&this.element?document.activeElement===this.dropdown.get(0)||document.activeElement===this.element.get(0)||0<this.dropdown.find(f(document.activeElement)).length:!1},setItem:function(a,b){this.smartyLoggerSave(a);
this.setItemTriggered=!0;this.base(a,b)},smartyLoggerSave:function(a){if(e.config.getBoolean("ui.smarty.r9LogOptions",!0)){var b={vertical:this._logPath,inputType:this.element.attr("name")||"destination",prefix:this.isItemSet||!this.setItemTriggered&&this.initialVal&&this.initialVal===this.element.val()?"":this.element.val()||"",options:this.getSmartyLoggerItems()||[]};a&&(b.selectedElem=a);e.SmartyLogger._save(b)}},getSmartyLoggerItems:function(){return this.dropdown&&this.dropdown.children&&this.dropdown.children("ul").children("li")},
handleWindowResize:function(){this.handleWindowResizeSmarty()},handleWindowResizeSmarty:function(){if(!this.isDropdownHidden()){var a=this.options.positionTarget||this.element,b=a.offset().left-f(this.options.appendTo).offset().left,c=a.offset().top+a.outerHeight()-f(this.options.appendTo).offset().top;"right"===this.options.position&&(b+=a.width()-2);this.dropdown.css("left",b+"px");this.dropdown.css("top",c+"px")}this.updateBackgroundAutocompletePosition()},destroy:function(){this.base();this.hideDropdown();
this.abortSearchCompletedEventListeners();this.unInit();this.unbindInputEvent("mousedown touchstart");this.unbindInputEvent("keyup");this.element.removeData("widget");this.element.attr("smarty",!1);f(document).off("click.Smarty"+this.id());f(window).off("resize.smarty");!0===this.options.enableRemoteHide&&this.id()&&e.events.unsubscribe("Smarty.hide",this.hideSmartyById)},animateSmarty:function(a,b){this.isAnimated()&&(a?this.dropdown.slideDown(250):this.dropdown.slideUp(250,b))},isAnimated:function(){return this.options.animateSmarty},
isJSON:function(){var a=this.options.extendRequest;return a&&"j"===a.f},isJsonResponse:function(a){return this.isJSON()&&"string"!==typeof a},applyJsonOptions:function(){this.isJSON()&&(this.options.dataType="json",this.options.extendRequest=f.extend({},this.options.extendRequest,{v:"v1"}),this.options.dropdownClass+=" smartbox-js")},postprocessResponse:function(a,b){return this.isJsonResponse(a)?a:this.base(a,b)},makeHTML:function(a){if(!this.isJsonResponse(a))return this.base(a);var b=this,c=this.getRequestData(),
d=c&&c.value||"",e=this.getMaxItemsToShow();return'\x3cul role\x3d"listbox"\x3e'+a.map(function(a,c){return 0<e&&c>=e?null:b.formatItem(a,d)}).filter(function(a){return!!a}).join("")+"\x3c/ul\x3e"},getMaxItemsToShow:function(){return-1},formatItem:function(a,b){var c=a.cc&&"ctry"===a.loctype&&e.config&&e.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1);if(!a||!a.loctype)return"";var d=this.getDisplayName(a),g=this.getNearbyHotels(a),h=this.getNearbyRentals(a),d=f.extend({},a,{id:this.getItemId(a),
name:d,label:[d,g,h].filter(function(a){return!!a}).join(" "),highlighting:this.highlight(d,b),parentPath:a.parentPath||a.rc||"",nearbyHotels:g,nearbyRentals:h}),g='\x3cdiv class\x3d"smarty-city"\x3e'+d.highlighting+"\x3c/div\x3e";"ap"===a.loctype?(d.shortName=a.shortdisplayname||"",g+='\x3cspan class\x3d"airportCode"\x3e'+this.highlight(a.ap,b)+"\x3c/span\x3e"):"city"===a.loctype?d.shortName=a.cityonly||"":"ctry"===a.loctype&&a.cc&&!c&&(d.icon="/images/flags/a-small-flag."+a.cc.toLowerCase()+".png");
(b=this.locationTypeMessages[a.loctype]||"")&&!c&&(g+='\x3cspan class\x3d"smarty-label '+a.loctype+'"\x3e'+b+"\x3c/span\x3e");"ap"!==a.loctype&&"hotel"!==a.loctype&&(g+=this.formatNearbyDetails(a,d));b=a.loctype||"city";"cg"===b&&(b="ctgroup");c&&(b+=" noBackgroundIcon");c=['id\x3d"'+this.formatListItemId(a,d)+'"','class\x3d"'+b+'"','role\x3d"option"','tabindex\x3d"0"'];a.cc&&c.push('data-cc\x3d"'+a.cc+'"');a.rc&&c.push('data-rc\x3d"'+a.rc+'"');d.shortName&&c.push('data-short-name\x3d"'+d.shortName+
'"');d.label&&c.push('aria-label\x3d"'+d.label+'"');d.icon&&c.push('style\x3d"background-image:url('+d.icon+')"');c.push('data-attr\x3d"'+this.htmlEscape(JSON.stringify(d))+'"');return"\x3cli "+c.join(" ")+"\x3e"+g+"\x3c/li\x3e"},getDisplayName:function(a){var b=a.displayname||"";if(a.ap){a="("+a.ap+")";var c=b.length,d=c-a.length;b&&b.substring(d,c)===a&&(b=b.substring(0,d).trim())}return b},getNearbyHotelsCount:function(a){return a.hotelCount||a.nearbyHotels||0},getNearbyHotels:function(a){return""},
getNearbyRentalsCount:function(a){return a.rentalCount||a.nearbyRentals||0},getNearbyRentals:function(a){return""},formatNearbyDetails:function(a,b){a="";b.nearbyHotels&&(a+='\x3cspan class\x3d"smarty-label hotels"\x3e'+b.nearbyHotels+"\x3c/span\x3e");b.nearbyRentals&&(a+='\x3cspan class\x3d"smarty-label rentals"\x3e'+b.nearbyRentals+"\x3c/span\x3e");return a},getItemId:function(a){return""+(("ap"===a.loctype?a.ap:"city"===a.loctype?a.ctid:"ctry"===a.loctype?a.cid:"hotel"===a.loctype?a.hid:"reg"===
a.loctype?a.rid:"freereg"===a.loctype?a.frid:"cg"===a.loctype?a.cgid:"hood"===a.loctype?a.sid:"lm"===a.loctype?a.lmid:a.id)||"")},formatListItemId:function(a,b){return a.loctype+"-"+b.id},htmlEscape:function(a){var b={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#39;"};return a.replace(/[&<>"']/g,function(a){return b[a]})},highlight:function(a,b){var c=a.toLowerCase().indexOf(b.toLowerCase());b=c+b.length;return 0>c?a:a.substring(0,c)+"\x3cb\x3e"+a.substring(c,b)+"\x3c/b\x3e"+
a.substring(b)}})})(window.R9,window.jq||window.jQuery);(function(d,e){d.createWidgetClass("smarty.PopularDestinationsSmarty","common.widgets.smarty.FlareSmarty",{currentOrigin:null,constructor:function(a,b){d.config.getBoolean("ui.smarty.auto.select.1st.item.on.close",!1)&&e.extend(b,{dropdownList1stItemSelector:"ul[role\x3dlistbox] li:first-child:visible",dropdownListItemsSelector:"ul[role\x3dlistbox] li"});this.base(a,b)},showDropdown:function(a,b){this.base(a,b);d.config.getBoolean("ui.smarty.animation.v2",!1)&&this.activeAnimation?(this.animateSmartyV2(!0),
this.base(a,b)):this.isAnimated()&&this.animateSmarty(!0)},searchCompleted:function(a,b){d.config.getBoolean("ui.smarty.auto.select.1st.item.on.close",!1)?((a=this.canShowDropdown(a))?this.showDropdown(a,b):this.hideDropdown(!0),this.element.trigger("searchCompleted",!!a)):this.base(a,b)},hideDropdown:function(a){var b="undefined"==typeof a;if(d.config.getBoolean("ui.smarty.auto.select.1st.item.on.close",!1)&&""!==this.element[0].value&&this.isSelectOnCloseSupported()){var c=this.dropdown.find(this.options.dropdownList1stItemSelector);
a=this.dropdown.find(this.options.dropdownListItemsSelector);if("undefined"!==typeof c&&0<c.length&&c.hasClass("selected"))(a=this.extractFirstListItemData(c))&&this.setItem(a);else if(b){b=!1;for(c=0;c<a.length;c++)e(a[c]).hasClass("selected")&&(b=a[c]);b||(1<c&&(e(a[0]).hasClass("anywhere")&&"undefined"!==typeof a[1]?e(a[1]).addClass("selected"):e(a[0]).addClass("selected")),a.each(this.checkAndSetItem.bind(this)))}}if(d.config.getBoolean("ui.smarty.animation.v2",!1)&&this.activeAnimation){if(!this.dropdown||
"none"===this.dropdown.css("display"))return!1;this.animateSmartyV2(!1);this.base()}else this.isAnimated()?this.animateSmarty(!1,this.base.bind(this)):this.base();if(d.config.getBoolean("ui.smarty.auto.select.1st",!1))return!0},checkAndSetItem:function(a,b){a=e(b);if(a.hasClass("anywhere")&&a.hasClass("selected")&&a.is(":visible"))return a={id:"",short_str:"anywhere",str:a[0].innerText,type:""},this.setItem(a),!1;if("undefined"!==a.attr("id")&&a.is(":visible")&&(a=this.extractFirstListItemData(a)))return this.setItem(a),
!1},extractFirstListItemData:function(a){if(a.hasClass("anywhere")&&a.hasClass("selected")&&a.is(":visible"))return{id:"",short_str:"anywhere",str:a[0].innerText,type:""};if(d.config.getBoolean("ui.smarty.populardestinations.1st.translate",!0))return(a=this.translateItem(a))?a:!1;var b=a[0].id.split("-"),c=a[0].id;return c.startsWith("ap")?{id:b[1],short_str:a.attr("data-short-name"),str:a.clone().find("span").remove().end().text(),type:"ap"}:c.startsWith("freereg")?{frid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,
type:"freereg"}:c.startsWith("ctry")?{cid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"ctry"}:c.startsWith("reg")?{rid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"reg"}:c.startsWith("city")?{hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"city"}:c.startsWith("lm")?{hc:b[2],lmid:b[3],id:b[1],str:a.children("div")[0].innerText,type:"lm"}:!1},isSelectOnCloseSupported:function(){return 51===this.options.flareSmartyType||50===this.options.flareSmartyType||58===
this.options.flareSmartyType},drawDestinationsContent:function(a){this.lastValue=null;this.currentOrigin&&this.currentOrigin===a||(this.currentOrigin=a,this.dropdown[0].innerHTML="");this.hideDropdown()}})})(window.R9,window.jq||window.jQuery);(function(e,l){var r=function(a){return 3===a.trim().length};e.createWidgetClass("smarty.FlightSmarty","common.widgets.smarty.PopularDestinationsSmarty",{isDirty:!1,constructor:function(a,b){var c={dropdownClass:" smartbox smartbox-air smartbox-air-regions smartbox-v2 R9-Overlay ",templatePresentationSuffix:"",flareSmartyType:1,forceSelection:!0,minWidth:250,searchOnFocus:!0,useNearby:!1,allowMultipleAirports:e.config.getBoolean("ui.smarty.flights.allowMultipleAirports",!0),airportMultiSelectEnabled:!1,
useApiAirportCode:e.config.getBoolean("ui.smarty.flights.useApiAirportCode",!1),nearbyChecked:!1,extendRequest:{v:"v2"},alwaysShowAnywhere:!1,disableAnywhereDirtyCheck:e.config.getBoolean("ui.smarty.disableAnywhereDirtyCheck",!1),disableHistoryPreview:e.config.getBoolean("ui.smarty.disableHistoryPreview",!1),repositionDropdownOnResize:e.config.getBoolean("ui.smarty.flights.repositionDropdownOnResize",!1),onInputChange:function(){},onAddAirportMultiSelection:function(a,b,c,e){},onRemoveAirportMultiSelection:function(a,
b){},getAirportMultiSelections:function(){return[]},hasAirportMultiSelectionCode:function(){},allowAddAirportMultiSelection:function(){}};c.isBusinessMode=e.question.ask("common.business.BusinessIsBusinessMode");c.isBusinessMode&&(c.businessOffices=e.question.ask("common.business.BusinessOffices"),c.businessOfficesHeader=e.question.ask("common.business.BusinessOfficesHeader"),c.businessSmartyMatchOffices=e.question.ask("common.business.BusinessSmartyMatchOffices"));this.concatExtraDropdownClasses([c,
b],this.extraIconClasses(e.config.getBoolean("ui.smarty.flights.greyIcons",!1)));b&&b.extraDropdownClasses&&(c.dropdownClass+=" "+b.extraDropdownClasses+" ");this.base(a,l.extend(c,b))},setOptions:function(a){l.extend(this.options,a)},showDropdown:function(a,b){this.base(a,b);!this.options.useNearby||!l.trim(this.element.val()).length&&this.options.smartyControlGroup&&this.options.smartyControlGroup.getTopDestinations()||this.addNearby()},addNearby:function(){if(this.dropdown){var a=this.id("nearby"),
b=this.id("nearbyCheck"),c,d=!!this.isNearbyChecked||void 0===this.isNearbyChecked&&this.options.nearbyChecked,h=this;if(!(0<this.dropdown.find("#"+a).length)){c=0<this.dropdown.find("li").map(function(){return this.id.split("-")[0]}).toArray().filter(function(a){return"ap"===a||"apnc"===a}).length;var g=this.airportMultiSelectActive&&!!this.dropdown.find("li.js-selection").length;if(c||g)c=e.template.render("nearbySmartyCheck"+this.options.templatePresentationSuffix,{id:b}),a=e.template.renderElement("nearbySmartyWrapper"+
this.options.templatePresentationSuffix,{id:a,nearbySmartyCheck:c}),this.dropdown.prepend(a),b=this.dropdown.find("#"+b),a=b.parent().is(".StyleJamCheckbox")?"styleJamCheckbox":"checkbox",b[a]({change:function(a){h.isNearbyChecked=a.checked;"function"===typeof h.options.nearbyCallback&&h.options.nearbyCallback.call(null,{enabled:h.isNearbyChecked})}}).prop("checked",d?"checked":""),this.isNearbyChecked=d}}},getIsNearbyChecked:function(){return this.isNearbyChecked},postprocessResponse:function(a,
b){var c=this,d=this.base(a,b);if(this.options.allowMultipleAirports&&1<this.element.val().split(",").filter(r).length){d="\x3cli id\x3d'custom' class\x3d'no-icon'\x3e\x3cb\x3e"+this.element.val()+"\x3c/b\x3e\x3c/li\x3e";if("string"===typeof a){var h=a.indexOf("\x3cli");if(0<h)return a.slice(0,h)+d+a.slice(h)}return"\x3cul\x3e"+d+"\x3c/ul\x3e"}!a&&e.config.getBoolean("ui.flight.smarty-addresses",!0)&&e.Maps&&e.Maps.Google&&e.Maps.Google.load&&e.Maps.Google.load(function(){if(c.lastValue){var d=c.getAddressSuggestions(c.lastValue),
h=c.searchCompleted,f=c.base,l=c.matchAndBold,m=c.lastValue;d.done(function(a){if(a&&0<a.length){for(var d="\x3cul\x3e",g=0;g<a.length;g++){var k=a[g],n=!1,q=!1;if(k.types)for(var p=0;p<k.types.length;p++)if("street_address"===k.types[p]||"route"===k.types[p]||"premise"===k.types[p]){q=!0;break}q&&(n=!0,d+=e.template.render("smartyAddressItem",{index:g,value:l.call(c,m,k.description)}))}d=d.replace(/&lt;/g,"\x3c").replace(/&gt;/g,"\x3e").replace(/&#x2F;/g,"/");d+="\x3c/ul\x3e";!n&&c.isProbablyAddress(m)&&
(d=c.getAddressPlaceholder(m));h.call(c,f.call(c,d,b),b)}else c.isProbablyAddress(m)&&h.call(c,f.call(c,c.getAddressPlaceholder(m),b),b)}).fail(function(){c.isProbablyAddress(m)&&h.call(c,f.call(c,c.getAddressPlaceholder(m),b),b)});return a}},c.widgetName);return d},getAddressSuggestions:function(a){var b=l.Deferred();e.config.getBoolean("ui.flight.smarty-addresses",!0)&&window.google&&google.maps&&google.maps.places&&google.maps.places.AutocompleteService&&(new google.maps.places.AutocompleteService).getPlacePredictions({input:a},
function(a,d){d===google.maps.places.PlacesServiceStatus.OK?b.resolve(a):b.reject(d)});return b.promise()},getAddressPlaceholder:function(a){},isProbablyAddress:function(a){return!1},setIsNearbyChecked:function(a){this.isNearbyChecked!==a&&(this.isNearbyChecked=!!a,this.dropdown&&this.dropdown.find("#"+this.id("nearbyCheck")).prop("checked",this.isNearbyChecked?"checked":""))},createTopDestinationItem:function(a){var b=[],c="%s (%s)".format(a.name,a.cityCode);b.push(a.name);a.stateCode&&""!==a.stateCode?
b.push(a.stateCode):a.state&&b.push(a.state);a.country&&b.push(a.country);return('\x3cli id\x3d"ap-%s" class\x3d"ap" data-short-name\x3d"%s" data-cc\x3d"%s" data-apicode\x3d"%s" role\x3d"option"\x3e\x3cspan class\x3d"airportCode"\x3e%s\x3c/span\x3e%s\x3cspan class\x3d"smarty-label ap"\x3e'+this.options.messages.SMARTY_LOCATION_TYPE_AIRPORT+"\x3c/span\x3e\x3c/li\x3e").format(a.cityCode+"/"+a.ctId,c,a.cid,a.cityCode,a.cityCode,b.join(", "))},translateItem:function(a){var b=this.base(a);if(this.options.useApiAirportCode&&
"ap"===b.type&&b.apicode){var c=b.id.split("/");b.id=1<c.length?b.apicode+"/"+c[1]:b.apicode}this.options.airportMultiSelectEnabled&&(b.isMetroCode=l(a).hasClass("aap"));b.lat=l(a).attr("data-lat");b.long=l(a).attr("data-long");return b},makeBusinessOfficeList:function(){if(this.options.isBusinessMode){var a;a=null===this.lastValue?this.options.businessOffices:this.options.businessSmartyMatchOffices(this.lastValue);return 0<a.length?e.template.render("flightBusinessOffices",{businessOfficesHeader:this.options.businessOfficesHeader,
offices:a}):""}},isDisabledHistoryPreview:function(){return this.options.disableHistoryPreview},makeRecentList:function(a,b){if(this.options.isBusinessMode)return"";if(this.options.smartyControlGroup){var c=this.options.smartyControlGroup.getHistory();if(c){var d=this.options.smartyControlGroup.getMaxHistory(),e="origin"===this.elementNode.name,g="destination"===this.elementNode.name,k=this.options.smartyControlGroup.isRoundTrip();a=l.trim(a);var d=""===a?d:3,f;g&&(f=l(this.options.smartyControlGroup.options.originCode).val());
c=c.filter(a,e,d,k,f);g="";for(k=0;k<c.length;k++){f=c[k];var d=this.isSmartyUIV1()?f.departAirportName:f.departShortName,n=this.isSmartyUIV1()?f.destAirportName:f.destShortName,m=!1;k===c.length-1&&(m=!0);g=e?g+this.generateSmartyItem(this.matchAndBold(a,d),n,f.startDate,f.endDate,f.idx,f.isRoundTrip,f.isPast,m):g+this.generateSmartyItem(d,this.matchAndBold(a,n),f.startDate,f.endDate,f.idx,f.isRoundTrip,f.isPast,m)}return g=""!==g?(b?"\x3cul\x3e":"")+this.generateRecentHeader()+g+(b?"\x3c/ul\x3e":
""):null}}},generateSmartyItem:function(a,b,c,d,h,g,k,f){c=new moment(c);d=new moment(d);k=k?"past":"";f=f?" last":"";var l=g?"doubleArrow":"singleArrow";g=g?" - "+d.format(this.options.smartyControlGroup.options.endFormat):"";d='\x3cli tabindex\x3d"0" class\x3d"hist '+f+'" data-history-idx\x3d"'+h+'"\x3e\x3cspan class\x3d"smartyRecentAirports"\x3e'+a+'\x3cspan class\x3d"arrow '+l+'"\x3e\x3c/span\x3e'+b+'\x3c/span\x3e\x3cspan class\x3d"smartyRecentDate '+k+'"\x3e'+c.format(this.options.smartyControlGroup.options.startFormat)+
g+"\x3c/span\x3e\x3c/li\x3e";this.isSmartyUIV1()&&(a="\x3cdiv class\x3d'airports'\x3e%s\x3c/div\x3e".format('\x3cspan class\x3d"smartyRecentAirports"\x3e'+a+'\x3cspan class\x3d"arrow '+l+'"\x3e\x3c/span\x3e'+b+"\x3c/span\x3e"),b="\x3cdiv class\x3d'dates'\x3e%s\x3c/div\x3e".format('\x3cspan class\x3d"smartyRecentDate '+k+'"\x3e'+c.format(this.options.smartyControlGroup.options.startFormat)+g+"\x3c/span\x3e"),d='\x3cli tabindex\x3d"0" class\x3d"hist '+f+'" data-history-idx\x3d"'+h+'"\x3e\x3cdiv class\x3d"icon-wrapper"\x3e'+
e.template.render("smartyFlightHistorySVG")+'\x3c/div\x3e\x3cdiv class\x3d"search-info"\x3e%s\x3c/div\x3e\x3c/li\x3e'.format(a+b));return d},generateLoginBar:function(a){if(this.options.isBusinessMode)return"";var b="";if(!this.options.smartyControlGroup||this.isSmartyUIV1()&&a)return"";var c="admin";a&&(c+=" addSeparation");"notloggedin"===e.globals.analytics.loginState?(b+="\x3cli tabindex\x3d'0' class\x3d'signupnow "+c+"'\x3e"+this.options.messages.loginForSearchHistory+"\x3c/li\x3e",this.isSmartyUIV1()&&
(b=e.template.render("smartySignUpIn",{extraClasses:c}))):b+="\x3cli tabindex\x3d'0' class\x3d'showHistory "+c+"'\x3e"+(this.isSmartyUIV1()?'\x3cdiv class\x3d"icon-wrapper"\x3e'+e.template.render("smartyHistorySVG")+"\x3c/div\x3e":"")+this.options.messages.seeAllSearchHistory+"\x3c/li\x3e";return b},selectItem:function(a,b){l(a).is(".sign-up-in")||this.base(a,b)},generateAnywhereMarkup:function(a){if(this.options.isBusinessMode)return"";var b="",c=this.element.val().trim().toLocaleLowerCase(),d=this.options.messages?
this.options.messages.anywhere:null,h="",c=this.options.showAnywhere&&(this.options.disableAnywhereDirtyCheck||!this.isDirty||""===c||d&&0===d.toLocaleLowerCase().indexOf(c)&&2<c.length),g=this.options.smartyControlGroup&&!this.options.smartyControlGroup.isRoundTrip(),k=e.config.getBoolean("ui.smarty.anywhere.oneWay",!1);if(c||this.options.alwaysShowAnywhere){if(g&&!k)return b;e.config.getBoolean("ui.smarty.anywhereFirst",!1)&&/ - /.test(d)&&[].map&&(d=d.split(" - ").map(function(a){return"\x3cdiv\x3e"+
a+"\x3c/div\x3e"}).join(""),h+=" split ");b+="\x3cli tabindex\x3d'0' data-short-name\x3d'anywhere' class\x3d'anywhere admin "+h+(a?"addSeparation":"")+"'\x3e"+d+"\x3c/li\x3e";this.isSmartyUIV1()&&(this.isDestinationImagesEnabled()&&(h+=" dimg"),b=e.template.render("anywhereMarkUp",{extraClasses:h+(a?" addSeparation":"")}))}return b},generateAirportMultiSelectHeader:function(a){return e.template.render("airportMultiSelectHeader",{id:this.id("airportMultiSelectHeader"),maxMessageVisible:!this.options.allowAddAirportMultiSelection(),
selectedTitle:a,suggestedTitle:!a})},generateAirportMultiSelections:function(){var a=this,b=this.options.getAirportMultiSelections();if(!b||!b.length)return"";var c=this.generateAirportMultiSelectHeader(!0),b=b.map(function(b){var c={loctype:"ap",locationname:b.description||b.display,ap:b.code,airportname:"",shortdisplayname:b.display,smartyDisplay:b.description};return e.template.render("airportMultiSelectItem",{ariaLabel:b.display,iconHtml:a.getSvgIcon({loctype:"ap"}),displayNameHtml:a.getDisplayNameHtml(c),
airportCodeCheckboxHtml:a.getAirportCodeHtml(c,!0)})}).join("");return[c,'\x3cul role\x3d"listbox"\x3e',b,"\x3c/ul\x3e"].join("")},handleInputValue:function(){this.isDirty=!0;this.options.onInputChange();this.base()},setItem:function(a,b){if("custom"===a.type)e.events.publish("smarty.setitem.complete",{id:this.element.attr("id")});else if(a&&"easter"===a.type)e.events.publish("smarty.easteregg.found",l.extend(a,{vertical:"flights"})),this.element.val(""),this.element.trigger("textchange");else{if(e.config.getBoolean("ui.smarty.flights.logCityVsAp",
!0)){var c=a.hasOwnProperty("type")&&"city"===a.type?"city":"airport";e.Analytics.api.trackEvent({category:this.loggingPrefix,action:"click",label:c,value:(a.short_str||a.str||"").replace(/\s+/g,"-")})}this.airportMultiSelectActive&&a.isMetroCode&&this.toggleSubAirportMultiCheckboxes(!0);a.lat&&a.long&&(this.element.attr("data-lat",a.lat),this.element.attr("data-long",a.long));this.base(a,b)}},stopInputProcessing:function(){e.common.widgets.smarty.Smarty.prototype.stopInputProcessing.apply(this,arguments)},
makeHTML:function(a){if(!this.isJsonResponse(a))return this.options.isBusinessMode&&(a='\x3cul role\x3d"listbox" class\x3d"flight-smarty"\x3e'+this.makeBusinessOfficeList()+"\x3c/ul\x3e"),this.base(a);var b=this,c=this.getRequestData(),d=c&&c.value||"",h=e.config.getInt("ui.smarty.json.itemLimit",-1),g=this.makeRecentList(d,!0),k="function"===typeof a.map&&a.length,c=this.airportMultiSelectActive?this.generateAirportMultiSelectHeader(!1):"",f="";if(k)var l=a.some(function(a){return a&&"ap"===a.loctype&&
b.isCheckedMetroCode(a.ap||a.airportcode,a.airportname)}),f=f+a.map(function(a,c){if(0<h&&c>=h)return null;l&&a&&"ap"===a.loctype&&a.sub&&(a.selectedMetroCodeMember=!0);return b.formatItem(a,d)}).filter(function(a){return!!a}).join("");this.options.isBusinessMode?(a=this.makeBusinessOfficeList(),f+=a||""):(f=f+(g||"")+(this.isSmartyUIV1()?this.generateAnywhereMarkup(k?a.length:0):""),f+=this.generateLoginBar(!0));return""!==f?c+'\x3cul role\x3d"listbox" class\x3d"flight-smarty"\x3e'+f+"\x3c/ul\x3e":
""},canShowDropdown:function(a){var b=a;this.options.showAnywhere&&this.isSmartyUIV1()&&(b=a||[]);return b},getDestinationImages:function(a){if(!this.isDestinationImagesEnabled())return null;switch(a.loctype){case "ap":case "apnc":return this.createDestinationImageNode(a);default:return this.base(a)}},originalUseNearby:null,toggleNearbyAllowed:function(a){null===this.originalUseNearby&&(this.originalUseNearby=!!this.options.useNearby);this.options.useNearby=a?this.originalUseNearby:!1},isNearbyEnabled:function(){return this.options.useNearby},
hideNearbyCheckbox:function(){this.getChildElement("nearby").remove()},toggleMultiCheckboxEnabled:function(a){this.dropdown.find(".js-multi-select-message").prop("hidden",a).removeClass("multiAirportSelectionsHeader__message--error");this.dropdown.find(".js-multi-select-checkbox-input").not(":checked").prop("disabled",!a)},highlightMultiCheckboxMessage:function(){this.dropdown.find(".js-multi-select-message").addClass("multiAirportSelectionsHeader__message--error")},toggleMultiCheckbox:function(a,
b){a=this.dropdown.find('.js-multi-select-checkbox-input[data-value\x3d"'+a+'"]');a.prop("checked",b);this.isMetroCodeCheckbox(a)&&this.toggleSubAirportMultiCheckboxes(!1)},showAirportMultiSelections:function(){this.showInitialDropdownForData(this.generateAirportMultiSelections());this.isNearbyEnabled()&&this.addNearby()},runSearchOnFocus:function(){return this.airportMultiSelectActive?!1:this.base()},handleItemClickEvent:function(a,b){var c=l(b.target);c.is(".js-multi-select-container, .js-not-selectable")?
b.stopPropagation():c.is(".js-multi-select-checkbox")?(b.preventDefault(),b.stopPropagation(),this.handleAirportMultiCheckboxToggle(c)):this.base(a,b)},getAirportCodeHtml:function(a,b){if(!this.options.airportMultiSelectEnabled)return this.base(a);if("ap"!==a.loctype&&"apnc"!==a.loctype)return"";var c=a.ap||a.airportCode,d=["multiAirportCheckbox",c,Math.floor(100*Math.random())].join("-");a.shortdisplayname&&a.smartyDisplay||this.log.errorInternal("AirportMultiSelect checkbox is missing destination metadata");
return e.template.render("airportMultiSelectCol",{value:c,uniqueId:this.id(d),checked:b||a.selectedMetroCodeMember||this.options.hasAirportMultiSelectionCode(a.ap||a.airportCode),disabled:a.selectedMetroCodeMember,display:a.shortdisplayname,description:a.smartyDisplay})},airportMultiSelectActive:!1,getAirportMultiSelectActive:function(){return this.airportMultiSelectActive},originalForceSelection:null,originalForceSelectionOfHighlightedItem:null,setAirportMultiSelectActive:function(a){this.airportMultiSelectActive=
a;null===this.originalForceSelection&&(this.originalForceSelection=this.options.forceSelection);null===this.originalForceSelectionOfHighlightedItem&&(this.originalForceSelectionOfHighlightedItem=this.options.forceSelectionOfHighlightedItem);a?(a=this.generateAirportMultiSelectHeader(!0),this.getChildElement("nearby").replaceWith(a),this.dropdown.find("li").not(".ap, .apnc").remove(),this.options.forceSelection=!1,this.options.forceSelectionOfHighlightedItem=!1):this.options.useNearby&&(this.getChildElement("airportMultiSelectHeader").remove(),
this.addNearby(),this.options.forceSelection=this.originalForceSelection,this.options.forceSelectionOfHighlightedItem=this.originalForceSelectionOfHighlightedItem)},isMetroCodeCheckbox:function(a){return a.parentsUntil("ul","li.aap").length},toggleSubAirportMultiCheckboxes:function(a){var b=this,c=this.dropdown.find("li.sub .js-multi-select-checkbox-input");c.each(function(){var a=l(this).data("value");b.options.onRemoveAirportMultiSelection(a)});c.prop("checked",a).prop("disabled",a)},handleAirportMultiCheckboxToggle:function(a){var b=
a.siblings("input");if(b.prop("disabled"))this.highlightMultiCheckboxMessage();else{var c=!b.prop("checked");b.prop("checked",c);b.off("click").on("click",function(){return!1});b=a.data("value");if(c)this.options.onAddAirportMultiSelection(b,a.data("display"),a.data("description"),"checkbox");else this.options.onRemoveAirportMultiSelection(b,"checkbox");this.isMetroCodeCheckbox(a)&&this.toggleSubAirportMultiCheckboxes(c);this.element.focus()}},isCheckedMetroCode:function(a,b){return this.options.airportMultiSelectEnabled&&
this.options.allAirportsLocalizedText===b&&this.options.hasAirportMultiSelectionCode(a)},onDocumentClicked:function(){if(!this.isSmartyActiveElement()){if(this.options.forceSelection)this.onForceSelection();this.base()}}})})(window.R9,window.jq||window.jQuery);(function(d,h){d.createWidgetClass("smarty.FlareSmarty","common.widgets.smarty.FlareSmartyBaseLoader",{constructor:function(a,b){this.base(a,h.extend({dataSource:"/f/smarty",appendTo:"body"},b))},init:function(){d.common.widgets.smarty.Smarty.prototype.init.apply(this,arguments)},showDropdown:function(){d.common.widgets.smarty.Smarty.prototype.showDropdown.apply(this,arguments)},translateItem:function(a){var b=d.Widgets.Smarty.FlareSmarty.prototype.translateItem.call(this,a);(a=h(a).data("attr"))&&
(b=h.extend(b,a));return b},setItem:function(){d.common.widgets.smarty.Smarty.prototype.setItem.apply(this,arguments)},handleItemClickEvent:function(a,b){this.isSmartyUIV1()?h(a).hasClass("sign-up-in")?(this.openSignUpInPopup(h(b.target).hasClass("sign-up")),this.hideDropdown()):this.base(a,b):this.base(a,b)},getDataSource:function(){return this.isSmartyUIV1()?d.config.getString("ui.common.smarty.get.url",this.options.dataSource):this.base()},postprocessResponse:function(a,b){return this.isJsonResponse(a)?
d.common.widgets.smarty.Smarty.prototype.postprocessResponse.call(this,a,b):this.base(a,b)},makeHTML:function(a){return this.isJsonResponse(a)?d.common.widgets.smarty.Smarty.prototype.makeHTML.call(this,a):this.base(a)},getMaxItemsToShow:function(){return d.config.getInt("ui.smarty.json.itemLimit",-1)},openSignUpInPopup:function(a){a?d.authentication.showSignup():d.authentication.showLogin()},isSmartyUIV1:function(){return this.isJSON()&&this.options.smartyUIUpdateEnabled},isDestinationImagesEnabled:function(){return this.isSmartyUIV1()&&
d.config.getBoolean("ui.smarty.destinationimages.enabled",!1)},formatItem:function(a,b){if(!this.isSmartyUIV1())return this.base(a,b);var c=a.cc&&"ctry"===a.loctype&&d.config&&d.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1);if(!a||!a.loctype)return"";b=this.getItemAttrs(a);var g=this.getDisplayNameHtml(a),e=this.getAirportCodeHtml(a),g=g+e,e=a.loctype||"city";"cg"===e&&(e="ctgroup");c&&(e+=" noBackgroundIcon");"ap"!==a.loctype&&"apnc"!==a.loctype||this.options.allAirportsLocalizedText!==
a.airportname||(e+=" aap");c=['role\x3d"option"','tabindex\x3d"0"','data-short-name\x3d"'+(b.shortName||"")+'"','data-text-to-select\x3d"'+(b.displayName||"")+'"'];b.hasOwnProperty("apicode")?c.push("data-apicode\x3d"+b.apicode):"rail"===a.loctype&&b.hasOwnProperty("ap")&&c.push("data-apicode\x3d"+b.ap);var l=this.getDestinationImages(a);"ctry"===a.loctype&&b.icon?(c.push('style\x3d"background-image:url('+b.icon+')"'),e+=" with-icon"):g=l&&!a.sub?l+g:b.svgIcon+g;c.push('class\x3d"'+e+(a.sub?" sub":
"")+'"');e=this.formatListItemId(a);this.addItemAttributes(a,c);e&&c.push('id\x3d"'+e+'"');a.cc&&c.push('data-cc\x3d"'+a.cc+'"');a.rc&&c.push('data-rc\x3d"'+a.rc+'"');b.shortName&&c.push('data-short-name\x3d"'+b.shortName+'"');"addr"===a.loctype&&c.push('data-ctid\x3d"'+a.ctid+'"');b.label&&(e=this.locationTypeMessages[a.loctype],c.push('aria-label\x3d"'+(e?b.label+" - "+e:b.label)+'"'));c.push('data-attr\x3d"'+this.htmlEscape(JSON.stringify({entityKey:a.entityKey,objectID:a.objectID}))+'"');return"\x3cli "+
c.join(" ")+"\x3e"+g+"\x3c/li\x3e"},addItemAttributes:function(a,b){},formatListItemId:function(a){var b=this.getItemId(a);switch(a.loctype){case "ap":case "apnc":return[a.loctype,[a.ap||a.airportcode,a.ctid].join("/")].join("-");case "freereg":case "reg":case "ctry":return[a.loctype,0,a.nearbyHotels,b].join("-");case "hood":case "lm":return[a.loctype,a.ctid,a.nearbyHotels,b].join("-");case "ctgroup":return[a.loctype,0,0,a.cg].join("-");default:return b?[a.loctype,b].join("-"):null}},getItemAttrs:function(a){var b=
a.cc&&"ctry"===a.loctype&&d.config&&d.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1),c=this.getDisplayName(a),g=this.getNearbyHotels(a),e=this.getNearbyRentals(a),c=h.extend({},a,{id:this.getItemId(a),displayName:c,label:[c,g,e].filter(function(a){return!!a}).join(" "),parentPath:a.parentPath||a.rc||"",nearbyHotels:g,nearbyRentals:e});"ap"===a.loctype||"apnc"===a.loctype?c.shortName=a.shortdisplayname||"":"city"===a.loctype?c.shortName=a.cityonly||"":"geocode"===a.loctype&&(c.shortName=
a.structured_formatting.main_text);"ctry"===a.loctype&&a.cc&&!b&&(c.icon="/images/flags/a-small-flag."+a.cc.toLowerCase()+".png");c.svgIcon=this.getSvgIcon(a);return c},getDisplayName:function(a){return"geocode"===a.loctype?a.description:this.base(a)},getItemId:function(a){if(this.isSmartyUIV1())switch(a.loctype){case "hotel":case "hood":case "lm":case "freereg":return a.id;case "addr":return a.displayname;case "rest":return a.rtid}return this.base(a)},getDisplayNameHtml:function(a){var b=a.locationname||
a.searchFormSecondary,c=a.airportname,g=a.cityname,e=a.smartyDisplay,h=a.displayname,m=a.nearbyInfo,k=this.getItemId(a),k=d.config.getBoolean("ui.smarty.hideTypeFeatures."+a.loctype+"."+k,!1),n=a.cc&&"ctry"===a.loctype&&d.config&&d.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1);if("ap"===a.loctype||"apnc"===a.loctype){var f=[];"apnc"!==a.loctype&&c===this.options.allAirportsLocalizedText?f.push("\x3cdiv\x3e%s\x3c/div\x3e".format([g,c].join(", "))):(f.push("\x3cdiv\x3e%s\x3c/div\x3e".format("apnc"===
a.loctype?e||c:a.sub?c:b)),f.push("\x3cdiv\x3e%s\x3c/div\x3e".format("apnc"===a.loctype?m||b:a.sub?b:c)));return"\x3cdiv class\x3d'item-info'\x3e%s\x3c/div\x3e".format(f.join(""))}if("ctgroup"===a.loctype)return"\x3cdiv class\x3d'item-info'\x3e\x3cdiv\x3e%s\x3c/div\x3e\x3c/div\x3e".format(h);"hotel"===a.loctype?(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.hotelname||a.name)),f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(g))):"geocode"===a.loctype?(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.structured_formatting.main_text)),
f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.structured_formatting.secondary_text))):"addr"===a.loctype?(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.searchFormPrimary)),f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.searchFormSecondary))):"rail"===a.loctype?f=["\x3cdiv\x3e%s\x3c/div\x3e".format(this.getDisplayName(a)),"\x3cdiv\x3e%s\x3c/div\x3e".format(this.locationTypeMessages[a.loctype])]:(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(h)),n||k||f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(this.locationTypeMessages[a.loctype])));
return"\x3cdiv class\x3d'item-info'\x3e%s\x3c/div\x3e".format(f.join(""))},getAirportCodeHtml:function(a,b){return"ap"===a.loctype||"apnc"===a.loctype?"\x3cdiv class\x3d'ap-code'\x3e\x3cspan\x3e"+(a.ap||a.airportcode)+"\x3c/span\x3e\x3c/div\x3e":""},getSvgIcon:function(a){var b;switch(a.loctype){case "ap":case "apnc":b="smartyFlightSVG";this.options.allAirportsLocalizedText&&a.airportname===this.options.allAirportsLocalizedText&&(b="smartyCitySVG");break;case "hotel":b="smartyHotelSVG";break;case "rail":b=
"smartyTrainSVG";break;case "city":b="smartyCitySVG";break;case "ctgroup":b=this.getCtGroupIcon(a);break;default:b="smartyMapSVG"}return"\x3cdiv class\x3d'smarty-icon-wrapper'\x3e"+d.template.render(b)+"\x3c/div\x3e"},getDestinationImages:function(a){if(!this.isDestinationImagesEnabled())return null;switch(a.loctype){case "city":case "ctry":case "reg":case "freereg":case "lm":case "hood":return this.createDestinationImageNode(a)}return null},createDestinationImageNode:function(a){a=a.destination_images;
return a.image_jpeg?a.image_webp?'\x3cdiv class\x3d"destination-images"\x3e\x3cdiv class\x3d"img-wrapper"\x3e\x3cpicture\x3e'+'\x3csource srcset\x3d"%s" type\x3d"image/webp"\x3e'.format(a.image_webp)+'\x3csource srcset\x3d"%s" type\x3d"image/jpeg"\x3e'.format(a.image_jpeg)+'\x3cimg src\x3d"%s" onerror\x3d"this.style.display\x3d\'none\'" onload\x3d"this.style.opacity\x3d1" alt\x3d""/\x3e'.format(a.image_jpeg)+"\x3c/picture\x3e\x3c/div\x3e\x3c/div\x3e":'\x3cdiv class\x3d"destination-images"\x3e\x3cdiv class\x3d"img-wrapper"\x3e'+
'\x3cimg src\x3d"%s" onerror\x3d"this.style.display\x3d\'none\'" onload\x3d"this.style.opacity\x3d1" alt\x3d""/\x3e'.format(a.image_jpeg)+"\x3c/div\x3e\x3c/div\x3e":null},getCtGroupIcon:function(a){switch(a.cg){case "AS":case "AF":case "EU":case "NA":case "SA":case "SP":case "CB":case "ME":return"smartyCtGroup"+a.cg;default:return"smartyCtGroup"}},generateContinentsMarkup:function(){var a="",b=this.options.continents;0<b.length&&this.options.showContinents&&(a+='\x3cdiv class\x3d"separator continents-separator"\x3e\x3cspan class\x3d"separatorLabel"\x3e'+
this.options.messages.SMARTY_CONTINENTS_LABEL+"\x3c/span\x3e\x3c/div\x3e",b.forEach(function(b){a+='\x3cli  id\x3d"continent-'+b.id+'" class\x3d"continent '+b.id+'" tabindex\x3d"0" \x3e'+b.message+"\x3c/li\x3e"}));return a}})})(window.R9,window.jq||window.jQuery);(function(c,d){c.createComponentClass("account.v2.AccountSummary",{homeAirportSmarty:void 0,homeAirportWrapperElement:void 0,smartyWrapperElement:void 0,homeAirportElement:void 0,spinnerElement:void 0,options:{smartyUrl:"/mv/marvel"},msg:{bannerTitleNoName:void 0,bannerTitleWithName:void 0},init:function(){this.msg=this.options.msg;this.homeAirportWrapperElement=this.element.find(".js-homeAirport");this.homeAirportNameElement=this.element.find(".js-homeAirportName");this.smartyWrapperElement=this.element.find(".js-smarty");
this.spinnerElement=this.element.find(".js-spinner")},inlineComponentsReady:function(){this.options.showAirport&&(this.homeAirportSmarty=this.bindFlightSmarty(this.getChildElement("homeAirport"),!0,d.proxy(this,"setHomeAirport")))},addEventHandlers:function(){this.bindSelectTextOnFocus();this.registerEvent("click",".editAirport",this.toggleEditHomeAirport.bind(this));this.registerEvent("keydown",".editAirport",this.handleEditHomeApKeydown.bind(this));this.registerEvent("click",".js-close",this.toggleEditHomeAirport.bind(this));
this.registerEvent("keydown",".js-close",this.handleEditHomeApKeydown.bind(this));this.subscribe("account.action.change-nickname",this.handleChangeNickname.bind(this));this.subscribe("account.preferences.change-primary-airport",this.setHomeAirport.bind(this))},handleChangeNickname:function(a){this.getChildElement("bannerTitle").text(c.Common.Utils.String.formatString(a.firstName?this.msg.bannerTitleWithName:this.msg.bannerTitleNoName,a.firstName))},handleEditHomeApKeydown:function(a){a.keyCode===
c.globals.keyCodes.RETURN&&this.toggleEditHomeAirport()},toggleEditHomeAirport:function(){this.homeAirportWrapperElement.toggle();this.smartyWrapperElement.toggle();c.Analytics.api.trackEvent({subPageId:"header",category:"edit-home-airport",action:"toggle"})},setHomeAirport:function(a){var b=this;this.homeAirportNameElement.text(a.str).data("code",a.id.split("/")[0]);this.element.find(".editAirport").hide();this.spinnerElement.show();a.isFromPref||(this.toggleEditHomeAirport(),c.events.publish("account.action.change-homeairport",
a));d.ajax({type:"POST",headers:{"X-CSRF":c.globals.formtoken},url:"/k/myprefs/update/prefs",data:{formtoken:c.globals.formtoken,key:"airportcode",value:a.id,displayValue:a.str},dataType:"json",success:function(){b.element.find(".editAirport").show();b.spinnerElement.hide();a.successCallback&&(a.successCallback(a),b.getChildElement("homeAirport").val(a.str))},error:function(a,b){}})},bindSelectTextOnFocus:function(){var a=this;this.element.find(".selectTextOnFocus").on("focus.selectAll",function(){a.selectInput(this)})},
selectInput:function(a){clearTimeout(this.selectAllTimer);this.selectAllTimer=window.setTimeout(function(){a.select()},50)},bindFlightSmarty:function(a,b,d){b={flareSmartyType:13,dataSource:this.options.smartyUrl,smartyControlGroup:null,setItem:function(a){return function(b,e){e&&setTimeout(function(){c.Analytics.api.trackEvent("homeairport/set/"+e.str);a.val(e.str);d(e)},10)}}(a),showAnywhere:!b,alwaysShowAnywhere:!b,showDropdownWhenEmpty:!b,showBackgroundAutocomplete:!1,animateSmarty:!1,useNearby:!1,
dropdownClass:"smartbox smartbox-air smartbox-v2 smartbox-air-regions greyIcons"};this.options.smartyUIUpdateEnabled&&(b.extendRequest={f:"j"},b.dropdownClass+=" ui-update-v1",b.smartyUIUpdateEnabled=!0);return a.flightSmarty(b).getWidget()}})})(R9,jQuery);(function(b,d){b.createComponentClass("account.v2.Navigation",{goRightEl:void 0,goLeftEl:void 0,scrollableEl:void 0,options:{activeTab:"dashboard"},init:function(){this.goRightEl=this.getChildElement("goRight");this.goLeftEl=this.getChildElement("goLeft");this.scrollableEl=this.getChildElement("scrollable")},addEventHandlers:function(){this.registerEvent("click",".js-navTab",this.handleTabClick.bind(this));this.registerEvent("resize",d(window),this.hideShowArrows.bind(this));this.registerEvent("scroll",
this.scrollableEl,this.hideShowArrows.bind(this));this.registerEvent("click",this.goRightEl,this.handleScrollRight.bind(this));this.registerEvent("click",this.goLeftEl,this.handleScrollLeft.bind(this));this.subscribe("account.nav.changetabs",this.handleChangeTab.bind(this))},inlineComponentsReady:function(){this.hideShowArrows();this.handleScrollToActiveTab(this.options.activeTab)},hideShowArrows:function(){b.Common.Utils.throttle(100,function(){var a=Math.round(this.scrollableEl[0].scrollWidth),
c=Math.round(this.scrollableEl.outerWidth()),b=Math.round(this.scrollableEl.scrollLeft());a===c&&(this.goLeftEl.hide(),this.goRightEl.hide());0<b&&this.goLeftEl.show();0===b&&this.goLeftEl.hide();0===a-c-b&&this.goRightEl.hide();0<a-c-b&&this.goRightEl.show()},this)()},handleScrollLeft:function(){this.scrollableEl.animate({scrollLeft:"-\x3d200"},200)},handleScrollRight:function(){this.scrollableEl.animate({scrollLeft:"+\x3d200"},200)},handleScrollToActiveTab:function(a){a=this.element.find(".js-navTab[data-tab\x3d'"+
a+"']");this.scrollableEl.animate({scrollLeft:a.position().left+70},200)},handleChangeTab:function(a){var c=this.element.find(".js-navTab[data-tab\x3d'"+a.activeTab+"']");this.element.find("[aria-current\x3d'page']").removeAttr("aria-current");c.attr("aria-current","page");this.swapClasses(this.element.find(".js-navTab"),"Tab--active","Tab--default");this.swapClasses(c,"Tab--default","Tab--active");this.handleScrollToActiveTab(a.activeTab);b.Analytics.api.trackEvent({subPageId:"navigation",category:"change-tab",
action:a.activeTab})},handleTabClick:function(a){b.events.publish("account.nav.changetabs",{activeTab:d(a.currentTarget).data("tab")})}})})(R9,jQuery);function ConsentHandler(c){this.consentExpires=c&&0<=c.consentExpires?c.consentExpires:15552E6;this.declinedExpires=6048E5;this.CONSENT_NAME="DATA_CONSENT"}ConsentHandler.prototype.setConsentToCookie=function(c,d){d="undefined"===typeof d?!0:d;var a=new Date;a.setTime(a.getTime()+this.consentExpires);document.cookie=this.CONSENT_NAME+"\x3d"+d+";path\x3d/;expires\x3d"+a;c&&c({dataConsent:d})};
ConsentHandler.prototype.setDeclinedConsentCookie=function(c){var d=new Date;d.setTime(d.getTime()+this.declinedExpires);document.cookie=this.CONSENT_NAME+"\x3dfalse;path\x3d/;expires\x3d"+d;c&&c({dataConsent:!1})};ConsentHandler.prototype.getConsentFromCookie=function(){if(document.cookie){var c=this.CONSENT_NAME+"\x3dtrue";return document.cookie.split(";").some(function(d){return d&&d.trim&&d.trim()===c})}return!1};
ConsentHandler.prototype.getConsentCookieValue=function(){var c=this;if(document.cookie){var d=document.cookie.split(";").filter(function(a){return a&&a.trim&&0===a.trim().indexOf(c.CONSENT_NAME)});if(d.length)return"true"===d[0].trim().split("\x3d")[1]?!0:!1}return null};
(function(c,d){c.createComponentClass("common.tags.DataLayer",{ENDUSER_CONSENT_NAME:"DATA_ENDUSER_CONSENT",consented:!1,ready:!1,consentHandler:null,consentEvents:null,gtmSourceSetup:!1,gtm:null,queue:null,options:{useConsentSetup:!1,consentExpires:0,noConsentDefersLoad:!1},affiliateDataLayerSchema:{common:"presentation placement locale vertical screenId eventName event dataConsent".split(" "),clickOut:["eventName","startDate","endDate","price"],expandDetails:["eventName","screenId","price"],flight:{results:"startDate endDate originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode cabinClass roundTrip tripType totalTravelers adultTravelers youthTravelers childTravelers seatInfantTravelers lapInfantTravelers legs".split(" "),
clickOut:"originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode roundTrip tripType totalTravelers seniorTravelers adultTravelers youthTravelers childTravelers seatInfantTravelers lapInfantTravelers airlineName cabinClass legs".split(" ")},hotel:{results:"rooms guests cityName countryCode hotelName adultTravelers childTravelers".split(" "),details:"hotelName starRating rooms guests cityName countryCode".split(" "),clickOut:"hotelName starRating rooms guests cityName countryCode".split(" ")},
car:{results:"pickupTime dropoffTime sameLocation pickupAirportCode pickupCityName pickupCountryCode dropoffAirportCode dropoffCityName dropoffCountryCode".split(" "),clickOut:["carClass"]},packagetour:{results:"originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode totalTravelers seniorTravelers adultTravelers youthTravelers childTravelers infantTravelers".split(" "),clickOut:"originCityId originRegionName originRegionCode destinationCityId destinationRegionName destinationRegionCode hotelId brandName brandId parentBrandId".split(" ")},
unknown:{}},init:function(a){this.queue=[];this.options.useConsentSetup?(this.consentHandler=new ConsentHandler({consentExpires:this.options.consentExpires}),this.consented=this.consentHandler.getConsentFromCookie()):this.consented=!0;this.consentEvents=c.config.getString("ui.horizon.cookie.consent.events","").split(",");this.gtm=d(a)[0];d(this.gtm).on("load",d.proxy(this.onLoadIFrame,this))},inlineComponentsReady:function(){!this.consented&&this.options.noConsentDefersLoad||this.loadGtm();c.question.ask("tags.dataLayer.hasCustomHandler")||
this.updateDataLayer(this.getMainLayerParams())},addEventHandlers:function(){var a=this;this.options.useConsentSetup&&(this.subscribe(this.consentEvents,this.consentSuccess.bind(this)),this.subscribe("gdpr.cookie.declined",this.declinedConsent.bind(this)));c.events.subscribe("frontdoor.view.changed",function(){if(a.ready)try{var b=that.gtm.contentWindow;b.history&&b.history.replaceState&&b.history.replaceState("",document.title,location.href);b.document.title=document.title}catch(l){}});this.subscribe("tags.dataLayer.push",
function(b){b=b||{};b.attachMainParams&&(b=d.extend(a.getMainLayerParams(),b));b.hasOwnProperty("dataConsent")||(b.dataConsent=a.consented);delete b.attachMainParams;b.affiliateGoogleTagManagerId&&""!==b.affiliateGoogleTagManagerId&&(b.dataConsent=a.getEndUserConsentFromCookie(),b=a.getAffilaiteDataLayer(b));c.config.getBoolean("ui.gtm.force.datalyer.presentation",!0)&&(b.presentation=a.options.apPresentation);a.updateDataLayer(b)});this.subscribe("gtm.enduser.consent",function(b){b&&(a.setEndUserConsentCookie(),
a.loadGtm())});c.question.answer("horizon.cookie.consent.value",function(){return a.consentHandler.getConsentCookieValue()})},onLoadIFrame:function(){setTimeout(this.processQueue.bind(this),1)},processQueue:function(){this.ready=!0;for(var a=0,b;b=this.queue[a];a++)this.updateDataLayer(b)},cleanUndefinedVars:function(a){d.each(a,function(b,c){""!==c&&null!==c||delete a[b]})},updateDataLayer:function(a){a&&!a.hasOwnProperty("dataConsent")&&(a.dataConsent=this.consented);if(this.ready)try{this.log.console("updating data layer",
a);var b=this.gtm.contentWindow;b.unifiedDataLayer||(b.unifiedDataLayer=[]);this.cleanUndefinedVars(a);b.unifiedDataLayer.push(a)}catch(l){}else this.queue.push(a)},consentSuccess:function(){var a=this;!this.consented&&this.consentHandler&&this.consentHandler.setConsentToCookie(function(b){a.consented=!0;a.updateDataLayer(b);a.loadGtm()})},declinedConsent:function(){var a=this;this.consentHandler&&this.consentHandler.setDeclinedConsentCookie(function(b){a.consented=!1;a.updateDataLayer(b);a.loadGtm()},
!1)},isIframe:function(){try{return window.self!==window.top}catch(a){return!0}},getEndUserConsentFromCookie:function(){if(document.cookie){var a=this.ENDUSER_CONSENT_NAME+"\x3dtrue";return document.cookie.split(";").some(function(b){return b&&b.trim&&b.trim()===a})}return!1},setEndUserConsentCookie:function(){var a=new Date,b=0<=this.options.consentExpires?this.options.consentExpires:15552E6;a.setTime(a.getTime()+b);document.cookie=this.ENDUSER_CONSENT_NAME+"\x3dtrue;path\x3d/;expires\x3d"+a},isEndUserConsent:function(){var a=
this.getEndUserConsentFromCookie(),b=window;if(!a){var c=b.setInterval(function(){"parentIFrame"in b&&(b.clearInterval(c),c=null,b.parentIFrame.sendMessage({action:"getGTMEndUserConsent"}))},500);b.setTimeout(function(){c&&b.clearInterval(c)},15E3)}return a},loadGtm:function(){if(!this.gtmSourceSetup){this.gtmSourceSetup=!0;var a=window.location,b="",c="",d=this.options.affiliateGTMEndUserConsentFeature,e=this.options.affiliateGoogleTagManagerId;if(e&&(b=-1<a.search.indexOf("?")?"\x26":"?",c="gtmid\x3d"+
e,d&&this.isIframe()&&!this.isEndUserConsent())){this.gtmSourceSetup=!1;return}a="/ugtm{pathname}{search}{hash}{sign}{gtmid}".replace("{pathname}",a.pathname).replace("{search}",a.search).replace("{hash}",a.hash).replace("{sign}",b).replace("{gtmid}",c);this.gtm.src=a}},cloneDataLayer:function(a,b){var c={};a.forEach(function(a){b.hasOwnProperty(a)&&(c[a]=b[a])});return c},getAffilaiteDataLayer:function(a){var b=c.globals.analytics||{},d=b.screenId||b.pageId||"unknown",f=b.vertical||"unknown",b=a.eventName||
"screenView",e=this.affiliateDataLayerSchema,h=e.common||[],k="undefined"!==typeof e[f],d=k?e[f][d]:[],g={};k&&(h=h.concat(d),g=this.cloneDataLayer(h,a),a.hasOwnProperty("presentation")&&(g.presentation=this.options.apPresentation),"clickOut"==b&&(f=e[b].concat(e[f][b]),g=this.cloneDataLayer(f,a)),"expandDetails"==b&&(g=this.cloneDataLayer(e[b],a)));return g},getMainLayerParams:function(){var a=c.globals.analytics||{},b=d.extend({},this.options,{vertical:a.vertical||"unknown",screenId:a.screenId||
a.pageId||"unknown",subScreenId:a.subScreenId||a.subPageId,eventName:this.options.eventName||"screenView",dataConsent:this.consented,placement:c.globals.placement||"",presentation:this.options.apPresentation});["apPresentation","useConsentSetup","consentExpires","noConsentDefersLoad"].forEach(function(a){delete b[a]});return b}})})(R9,jQuery);(function(b,d){b.createComponentClass("common.tracking.IFrameGoogleTagManager",{options:{clickTripz:!1,updateDelay:100,useConsentSetup:!1,consentExpires:0,noConsentDefersLoad:!1},searchId:null,queue:null,ready:!1,consented:!1,CONSENT_NAME:"DATA_CONSENT",gtmSourceSetup:!1,init:function(a){this.gdprEvents=b.config.getString("ui.horizon.cookie.consent.iframegtm.events","").split(",");this.queue=[];this.consented=!this.options.useConsentSetup||this.getConsentFromCookie();this.setUpInitialData();this.gtm=
d(a)[0];d(this.gtm).on("load",d.proxy(this.onLoadIFrame,this));!this.consented&&this.options.noConsentDefersLoad||this.setupGtmSource()},setupGtmSource:function(){this.gtmSourceSetup||(this.gtmSourceSetup=!0,this.gtm.src="/gtm"+location.pathname+location.search+location.hash)},getConsentFromCookie:function(){if(document.cookie){var a=this.CONSENT_NAME+"\x3dtrue";return document.cookie.split(";").some(function(c){return c&&c.trim&&c.trim()===a})}return!1},consentSuccess:function(){if(!this.consented){this.consented=
!0;if(this.options.useConsentSetup){var a=new Date,c=0<=this.options.consentExpires?this.options.consentExpires:15552E6;a.setTime(a.getTime()+c);document.cookie=this.CONSENT_NAME+"\x3dtrue;path\x3d/;expires\x3d"+a}this.updateDataLayer({dataConsent:!0});this.setupGtmSource()}},onLoadIFrame:function(){setTimeout(this.processQueue.bind(this),1)},setUpInitialData:function(){var a=b.globals.analytics||[],c=a.pixelContext||{};this.updateDataLayer({vertical:a.vertical||b.globals.vertical,locale:b.globals.locale.loc,
affiliate:b.globals.affiliate,affiliateskin:b.globals.brand,placement:b.globals.placement||"",geoIpCc:b.globals.geoIpCc,experiment:b.globals.experiment,pageId:a.pageId,subPageId:a.subPageId,presentation:a.presentation||b.globals.presentation,clickTripz:this.options.clickTripz,pixelContext:c,dataConsent:this.consented,event:"pageView"});this.searchId=c.searchId},processQueue:function(){this.ready=!0;for(var a=0,c;c=this.queue[a];a++)this.updateDataLayer(c)},updateDataLayer:function(a){a&&!a.hasOwnProperty("dataConsent")&&
(a.dataConsent=this.consented);if(this.ready)try{this.log.console("updating data layer",a);var c=this.gtm.contentWindow;c.dataLayer||(c.dataLayer=[]);c.dataLayer.push(a)}catch(e){}else this.queue.push(a)},addEventHandlers:function(){var a=this;b.events.subscribe("frontdoor.view.changed",function(){if(a.ready)try{var c=a.gtm.contentWindow;c.history&&c.history.replaceState&&c.history.replaceState("",document.title,location.href);c.document.title=document.title}catch(f){}});var c=this.options.updateDelay;
b.events.subscribe("search.poll.response",function(b){b.pixelContext&&a.searchId!==b.pixelContext.searchId&&(setTimeout(a.updateDataLayer.bind(a,{event:"pageView",vertical:b.vertical,pageId:"results",pixelContext:b.pixelContext}),c),a.searchId=b.pixelContext.searchId);b.completed&&setTimeout(a.updateDataLayer.bind(a,{event:"resultsLoaded"}),c)});this.options.useConsentSetup&&b.events.subscribe(this.gdprEvents,this.consentSuccess.bind(this));b.events.subscribe(["login.success","fbauth.login.success",
"googleauth.login.success"],function(){a.updateDataLayer({event:"login"})});b.events.subscribe("signup.success",function(){a.updateDataLayer({event:"signup"})});b.events.subscribe("gtm.update",function(b){a.updateDataLayer(b)})}})})(R9,jq||jQuery);(function(a,e){a.createComponentClass("common.privacy.StyleJamHeaderCookiesMessage",{options:{gdprEnabled:!1,ajaxComponent:"common/privacy/AjaxStyleJamHeaderCookiesMessage"},init:function(){var b=this.options.ajaxComponent||"common/privacy/AjaxStyleJamHeaderCookiesMessage",c={type:"GET",replace:!0,combinable:a.config.getBoolean("ui.horizon.common.header.cookieMessage.combinable",!1),cacheable:a.config.getBoolean("ui.horizon.common.header.cookieMessage.cacheable",!1)};if(this.options.gdprEnabled){var d=
window["@r9/gdpr"];d&&d.canShowConsentDialog()&&(b=a.config.getString("ui.horizon.common.gdpr.cookie.consent.dialog.url","common/gdpr/CookieConsent"),c={type:"GET",appendTo:e("body")})}a.ajax.execute(b,c)}})})(window.R9,window.jQuery);(function(b,a){b.createComponentClass("common.currency.StyleJamCurrencyMessage",{options:{displayLater:!1,displayImmediately:!1,cookieName:"hideCurrencyMessage"},isVisible:!1,closeBtn:void 0,init:function(b){this.closeBtn=a("#"+this.id("close"));this.options.displayImmediately?this.showMessage():this.options.displayLater&&(this.subscribe("resultspage.view.setvisible",a.proxy(this.showMessage,this)),this.subscribe("header.view.set",{view:"results"},a.proxy(this.showMessage,this)),this.subscribe("pageContainers.changed",
{state:"results"},a.proxy(this.showMessage,this)),this.subscribe("resultspage.routed",a.proxy(this.showMessage,this)))},addEventHandlers:function(){this.closeBtn.bind("click",a.proxy(this.close,this))},showMessage:function(){this.isVisible||(this.element.slideDown("slow"),window.setMetaCookie(this.options.cookieName,!0),this.isVisible=!0)},close:function(){this.element.slideUp("slow")}})})(window.R9,window.jQuery);(function(a){a.createComponentClass("common.layout.SiteWideMessage",$.extend({},a.Common.RedirectMessage.prototype,{redirectMessage:void 0,options:{redirectFromTo:void 0,redirectFromToAlt:void 0,upgradeBrowserEnabled:!1},upgradeId:void 0,init:function(){this.upgradeId=this.id("upgrade");this.containerId=this.id();this.redirectFromTo=this.options.redirectFromTo;this.redirectFromToAlt=this.options.redirectFromToAlt;this.updateRedirectUrl();this.bindRedirectAdt()},addEventHandlers:function(){this.subscribe("frontdoor.view.changed",
this.updateRedirectUrl.bind(this));null!==document.getElementById(this.upgradeId)&&a.ajax.execute("common/upgrade/UpgradeBrowser",{appendTo:this.upgradeId});this.registerEvent("click",this.element.find(".js-close"),function(){$(this).closest(".js-msgContainer").slideUp("slow");var a=$(this).attr("data-mc");setMetaCookie(a,!0)})}}))})(R9);(function(b,f){b.createComponentClass("common.layout.StyleJamNavLink",{loggingPrefix:"StyleJamNavLink",openedSwindleTab:!1,infoMarker:null,options:{url:null,active:!1,verticalName:null,preventNavigation:!1,pageStates:{default:{base:null,defaultState:null,activeState:null,infoMarker:null,viewTransition:null},results:{base:null,defaultState:null,activeState:null,infoMarker:null,viewTransition:null}},showFocusIndication:!1,focusedElement:""},view:null,init:function(){this.infoMarker=this.getChildElement("info-marker")},
addEventHandlers:function(){var a=this;a.element.on("click",function(d){var c=a.getStates();a.options.preventNavigation?(a.options.active||(b.events.publish("NavLink.clicked",{vertical:a.options.verticalName,url:a.options.url,active:a.options.active}),b.dom.swapClasses(a.element,c.defaultState,c.activeState),a.options.active=!0),d.preventDefault()):b.Analytics.api.trackEvent({category:a.loggingPrefix,action:"click",label:a.options.verticalName})});a.options.preventNavigation&&this.subscribe("NavLink.clicked",
this.onActiveNavChanged.bind(this));if(!b.config.getBoolean("ui.no.popup.enabled",!1)||"notloggedin"===b.globals.analytics.loginState){if(b.config.getBoolean("ui.search.swindle.enabled",!0)&&b.config.getBoolean("ui.search.swindle."+a.options.verticalName+".enabled",!0)&&(!b.config.getBoolean("ui.suppress.swindle",!1)||b.config.getBoolean("ui.suppress.swindle",!1)&&!b.storage.get("suppress_swindle")))a.element.on("click",function(d){var c=b.storage.get("lastSwindleClick"),e=b.config.getInt("ui.search.swindle.expiration",
864E5);if(("/"===document.location.pathname||"/hotels"===document.location.pathname)&&!a.options.active&&(!c||c+e<Date.now()))return b.storage.set("lastSwindleClick",Date.now()),b.events.publish("swindleTab.activated"),window.open(a.options.url,"_blank"),d.preventDefault(),!1});this.subscribe(["header.view.set","pageContainers.changed","sem.explore.form.change-state"],function(d){if(d.view||d.newstate){d=d.view||d.newstate;a.view="rp"===d?"results":d;var c=a.getStates();c&&(a.element.removeClass(),
a.infoMarker.removeClass(),a.element.addClass(c.viewTransition),window.setTimeout(function(){a.options.active?a.element.addClass(c.activeState):a.element.addClass(c.defaultState);a.infoMarker.length&&a.infoMarker.addClass(c.infoMarker);b.dom.schedule(function(){a.element.addClass(c.base);a.element.removeClass(c.viewTransition)})},0))}});this.subscribe("omni.vertical.changed",function(d){var c=a.getStates();a.options.verticalName!==d?(b.dom.swapClasses(a.element,c.activeState,c.defaultState),a.options.active=
!1):(b.dom.swapClasses(a.element,c.defaultState,c.activeState),a.options.active=!0)});this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",function(d){d?b.dom.swapClasses(a.element,"",a.options.focusedElement):b.dom.swapClasses(a.element,a.options.focusedElement,"")})}},onActiveNavChanged:function(a){a.vertical!==this.options.verticalName&&this.options.active&&(a=this.getStates(),b.dom.swapClasses(this.element,a.activeState,a.defaultState),this.options.active=!1)},getStates:function(){return"results"===
this.view?this.options.pageStates.results:this.options.pageStates.default}})})(R9,jQuery);(function(b,d){b.createComponentClass("common.layout.StyleJamNavigation",{options:{isAjaxableMoreNavLinkEnabled:!1,activeVertical:"",overflowVertical:"",showFocusIndication:!1},init:function(){this.options.isAjaxableMoreNavLinkEnabled&&this.loadValues()},loadValues:function(){var a=this.getData(this.options);b.ajax.execute("common/layout/StyleJamMoreNavLink",{data:d.extend({},a,{active:"more"===a.activeVertical,isTab:!0,currentVertical:a.activeVertical,underline:a.underlineLinks,hideBreakpoint:a.hideMoreBreakpoint,
styleJamPresentation:a.moreNavLinkPresentation,styleJamPresentationRP:a.moreNavLinkPresentationRP,activeStyleJamPresentation:a.activeMoreNavLinkPresentation,showFocusIndication:a.showFocusIndication,moreNavMenuOptions:JSON.stringify(a.moreNavMenuOptions),overrideLinks:JSON.stringify(a.overrideLinks),seo:b.globals.isSeo}),appendTo:this.element.find(".col.js-vertical-more"),replace:!0})},getData:function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&null!==a[c]&&(b[c]=a[c]);return b}})})(R9,$);(function(g,d){g.createWidgetClass("dropdown.DropdownDialog",{element:null,elementNode:null,content:null,placeholder:null,label:null,value:null,icon:null,isOpen:!1,leftOffset:0,ajaxLoadFailed:!1,eventSuffix:null,openDisabled:!1,subValue:null,animationDuration:200,changePosition:!1,positionCss:{},options:{autoOpen:!1,alignment:null,direction:"down",isPopover:!1,showIcon:!0,matchWidth:!1,isFixedWidth:!1,repositionWithStyle:!1,scrollOffset:157,fixedPositionOffset:45,loadWithAjaxOnInit:!1,ajaxUrl:"",
ajaxData:{},iconClass:"",contentClass:"",triggerClass:"",content:null,onInit:null,onOpen:null,onClose:null,text:"",placeholder:"",topOffset:0,leftOffset:0,removeZIndex:!1,flippable:!0,delayShowDropdown:d.noop,showDropdownDelay:200,hasSubValue:!1,animateClose:null,expandTo:null,forceTriggerWidth:!1,useCover:!1,closeEvent:null,stopClickPropagation:!1,checkIsOutsideScreen:!1,tooltipIcon:"",tooltipText:"",showModalBp:-1},init:function(){!this.options.alignment&&this.element&&this.element.data("alignment")&&
(this.options.alignment=this.element.data("alignment"));!this.options.expandTo&&this.element&&this.element.data("expandto")&&(this.options.expandTo=this.element.data("expandto"));this.options.alignment||(this.options.alignment="left");this.eventSuffix=".DropdownDialog."+this.id();this.options.autoOpen&&this.open();if(this.options.onInit)this.options.onInit(this);this.createContent();this.elementNode=this.element[0];this.createTrigger();this.popoverArrow=this.getChildElement("popover-arrow");this.options.loadWithAjaxOnInit&&
this.options.ajaxUrl&&this.loadAjax();this.options.alignment||(this.options.alignment="left");this.options.useCover&&(this.cover=this.getChildElement("cover"),this.coverInner=this.getChildElement("cover-inner"));if(this.options.tooltipIcon){var a=this.getChildElement("tooltip");a.toolTip({content:a.data("message"),extraClass:"halfWidth"})}},closeOnBodyClick:function(a){this.isOpen&&(!this.content||!this.content[0]||this.content[0]!==a.target&&1>this.content.find(a.target).length)&&this.close()},changeDropdownPosition:function(a){this.id()===
a.id&&(this.changePosition=a.changePosition,this.positionCss=a.positionCss)},addEventHandlers:function(){var a=this,b;b=this.options.triggerClass?d("."+a.options.triggerClass):d(a.element);g.globals.testMode&&b.attr("data-test-popover-trigger","");var c=this.closeOnBodyClick.bind(this),e=["authentication.showLogin","trips.menu.open","afterclick.dialog.opened","common.dropdown.closeAll"];this.options.closeEvent&&e.push(this.options.closeEvent);this.subscribe(e,this.close.bind(this,null,!0));this.subscribe("travelers.dropdown.change.position",
this.changeDropdownPosition.bind(this));var f="click.dialog"+this.eventSuffix,h=d("body");this.registerEvent("click"+this.eventSuffix,b,function(b){a.options.stopClickPropagation&&b.stopPropagation();h.off(f,c);a.toggleContent();a.isOpen&&setTimeout(function(){h.on(f,c)},10)});if(this.isOpen)h.on(f,c);this.registerEvent("keydown",function(b){if(13===b.which||32===b.which)a.element.trigger("click"),b.preventDefault(),b.stopImmediatePropagation(),b.stopPropagation()})},bindOpenDialogEvents:function(){var a=
this;d(document).on("keydown"+this.eventSuffix,function(b){27===b.which&&a.close(b,null,!0)});d(window).on("resize"+this.eventSuffix,function(){a.isOpen&&a.reposition(!0)});d(document).on("scroll"+this.eventSuffix,function(){a.isOpen&&a.reposition(!0)});d(".viewport").on("scroll"+this.eventSuffix,function(){a.isOpen&&a.reposition(!0)});var b=function(){a.element.is(":visible")&&(g.Common.Utils.Browsers.isIE(11)||setTimeout(function(){a.reposition(!0)},25))};this.registerEvent("click",this.content.find(".close"),
this.close.bind(this));this.registerEvent("mouseup touchend",this.content,b);this.subscribe("horizon.dropdownDialog.reposition",b)},destroy:function(){this.base();this.removeOpenDialogEvents()},removeOpenDialogEvents:function(){d(".viewport").off("scroll"+this.eventSuffix);d(window).off("resize"+this.eventSuffix);d(document).off("scroll"+this.eventSuffix).off("keydown"+this.eventSuffix);d(document.body).off("click"+this.eventSuffix).off("click.dialog"+this.eventSuffix)},createContent:function(){this.content=
this.options.content?d(this.options.content):d("#"+this.element.attr("id")+"_content");this.options.isFixedWidth&&this.content.css("width",this.getTriggerWidth()+"px");this.content.hasClass("open")&&(this.isOpen=!0)},createTrigger:function(){this.element.hasClass("open")&&(this.isOpen=!0);this.label=this.element.find(".label");this.label.length||(this.label=d("\x3cdiv\x3e",{"class":"label"}),this.element.prepend(this.label));this.placeholder=this.element.find(".placeholder");this.placeholder.length||
(this.placeholder=d("\x3cdiv\x3e",{"class":"placeholder",text:this.options.placeholder}),this.element.append(this.placeholder));this.options.showIcon&&(this.icon=this.element.find(".icon"),this.icon.length||(this.icon=d("\x3cdiv\x3e",{"class":"icon "+this.options.iconClass}),this.element.append(this.icon)));this.options.hasSubValue&&(this.value=this.label.find(".value"),this.value.length||(this.value=d("\x3cdiv\x3e",{"class":"value"}),this.label.prepend(this.value)),this.subValue=this.label.find(".subValue"),
this.subValue.length||(this.subValue=d("\x3cdiv\x3e",{"class":"subValue"}),this.label.prepend(this.subValue)));if(this.options.text)this[this.options.hasSubValue?"updateValue":"updateLabel"](this.options.text);else if(!this.options.hasSubValue){var a=this.label.html();a&&a.trim()&&this.updateLabel(a.trim())}},open:function(){if(!this.openDisabled){this.isOpen=!0;var a=this,b="body";if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=
setTimeout(this.open.bind(this),this.options.showDropdownDelay);else{null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);this.bindOpenDialogEvents();this.options.container&&""!==this.options.container&&(b=this.options.container,d(a.options.container).off("scroll."+a.id()).on("scroll."+a.id(),function(){a.isOpen&&a.repositionWithJS()}));this.options.isPopover&&this.popoverArrow.show();this.content.appendTo(b);if(this.options.onOpen)this.options.onOpen(this);
this.repositionWithJS();this.element.attr("aria-pressed")&&this.element.attr("aria-pressed",!0);a.element.addClass("open");a.content.addClass("open");this.content.attr("aria-expanded",!0);this.element.attr("aria-expanded",!0);this.content.data("owner",this.element.attr("id"));g.globals.testMode&&this.element.add(this.content).attr("data-test-popover-open",!0);g.events.publish("DropdownDialog.open",{id:a.id()});this.toggleCover(!0);this.setupTabKeyHandling();this.styleForModal(!0);this.changePosition&&
this.id()&&this.content.css({top:d(document).scrollTop()+this.positionCss.top+"px",left:this.positionCss.left+"px"})}}},setupTabKeyHandling:function(){var a=this,b=this.getFocusableElements();b.length&&(a.content.off("keydown","**"),setTimeout(function(){d(b[0]).focus();a.content.on("mouseover","a, [tabindex]",function(){a.content.find(":focus").trigger("blur")});a.content.on("keydown",function(c){b=a.getFocusableElements();var e=c.target,d=b.get(0)===e,e=b.get(b.length-1)===e;9===c.which&&(1===b.length||
d&&c.shiftKey||e&&!c.shiftKey)&&(a.toggleContent(),a.element.focus())})},25))},getFocusableElements:function(){return this.content.find(":input:visible,[tabindex]:visible, a[href]:visible").not("[tabindex\x3d-1],[disabled]")},_close:function(a,b,c){var e=this.isOpen,d=this;this.isOpen=!1;this.options.isPopover&&this.popoverArrow.hide();this.element.removeClass("open");this.content.removeClass("open");this.toggleCover(!1);d.element.after(d.content);c&&setTimeout(function(){d.element.focus()},1);if(this.options.onClose)this.options.onClose(e,
this,a);g.events.publish("DropdownDialog.close",{id:d.id(),silent:!!b});this.element.attr("aria-pressed")&&this.element.attr("aria-pressed",!1);this.content.attr("aria-expanded",!1);this.element.attr("aria-expanded",!1);g.globals.testMode&&this.element.add(this.content).attr("data-test-popover-open",!1);this.styleForModal(!1)},close:function(a,b,c){if(!c||"object"!==typeof c||c.avoidElementId!==this.id()){this.options.repositionWithStyle&&this.resetPosition();this.removeOpenDialogEvents();if(this.options.animateClose){var d=
this;this.animateClose(function(){d._close(a,b,c)})}else this.isOpen&&this._close(a,b,c);null!=a&&a.stopPropagation()}},toggleContent:function(){this.isOpen?this.close(null,null,!0):this.open()},updateLabel:function(a,b,c){b&&(a+=(c||"")+b);this.label.html(a);"0"==a+""||a?this.element.addClass("hasValue"):this.element.removeClass("hasValue")},updateValue:function(a){a=a||"";this.value.html(a);"0"==a+""||a?this.element.addClass("hasValue"):this.element.removeClass("hasValue")},hasValue:function(){return this.element.hasClass("hasValue")},
resetPosition:function(){this.content.css({position:"absolute"})},reposition:function(a){if(this.options.repositionWithStyle){var b;window.scrollY>this.options.scrollOffset?(b={position:"fixed",top:this.options.fixedPositionOffset+"px"},this.content.css(b),this.changePosition&&this.content.css({top:d(document).scrollTop()+this.positionCss.top+"px",left:this.positionCss.left+"px"})):(b={position:"absolute"},this.content.css(b),this.repositionWithJS(a))}else this.repositionWithJS(a)},repositionForNonModal:function(){var a=
this.showInModal();if(this.modalActive()&&a)return!1;this.styleForModal(a);return!a&&!this.modalActive()},repositionWithJS:function(a){if(this.repositionForNonModal()){var b=this.options.direction,c=this.options.alignment,e=this.element.offset(),f=d(this.options.container),h=d("#"+this.options.expandTo),g=h.length&&h.is(":visible"),l=g?h.offset():null;a=a||!1;if(f.length)var k=f.offset(),e={top:e.top-k.top+f.scrollTop(),left:e.left-k.left};else f=d(window);k=e.top+this.element.outerHeight();0===this.element.width()&&
0!==this.element.position().top&&(k+=window.scrollY);this.shouldFlipDirection(b)&&(b=this.getReversedDirection(b));this.shouldFlipAlignment(c)&&(c=this.getReversedDirection(c));this.updateAnimationClass(b,c);this.content.toggleClass("noAnimation",a);"up"===b?(this.content.addClass("up"),k=e.top-this.content.outerHeight()):this.content.removeClass("up");if("left"===b||"right"===b)k="up"===this.options.alignment?e.top-this.element.outerHeight()/2:"down"===this.options.alignment?e.top-this.content.outerHeight()+
this.element.outerHeight():e.top+this.element.outerHeight()/2-this.content.outerHeight()/2;a={top:Math.floor(k)+"px"};g?"right"===c?a.right=Math.floor(f.width()-h.width()-l.left)+"px":a.left=Math.floor(l.left)+"px":"left"===b?a.right=Math.floor(f.width()-e.left)+"px":"right"===b?a.left=Math.floor(e.left+this.element.width())+"px":"right"===c||"window-center-desktop"===c?"window-center-desktop"==c&&768<=window.innerWidth?(a.right="",a.left=Math.floor(window.innerWidth/2-this.content.outerWidth()/2)+
"px"):(a.left="",b=this.getTriggerWidth(),38>b&&!this.options.forceTriggerWidth&&(b=38),a.right=Math.floor(f.width()-(e.left+b))+"px"):a.left="center"===c?Math.floor(e.left-this.content.outerWidth()/2)+this.getTriggerWidth()/2+"px":"window-center"===c?Math.floor(window.innerWidth/2-this.content.outerWidth()/2)+"px":Math.floor(e.left)+"px";this.options.topOffset&&0!==this.options.topOffset&&(a.marginTop=this.options.topOffset+"px");this.options.leftOffset&&0!==this.options.leftOffset&&(a.right?a.right=
parseInt(a.right.replace("px",""))-this.options.leftOffset+"px":a.left&&(a.left=parseInt(a.left.replace("px",""))+this.options.leftOffset+"px"));this.leftOffset&&(a.marginLeft=this.leftOffset+"px");this.options.isPopover&&"right"===c&&(a.left=Math.floor(e.left+this.getTriggerWidth()+22)+"px",a.top=Math.floor(k-45)+"px");c=this.options.isFixedWidth?"width":"minWidth";this.options.matchWidth?a[c]=this.getTriggerWidth()+"px":g?a[c]=h.outerWidth()+"px":a.minWidth="";this.options.removeZIndex||(a.zIndex=
this.element.zIndex()+9999);this.options.checkIsOutsideScreen&&(h=this.content.outerWidth(),f=f.outerWidth(),g=!1,h>=f?g=!0:(c=parseInt(a.left,10),e=parseInt(a.right,10),c&&c+h>=f?g=!0:e&&e+h>=f&&(g=!0)),g&&(a.left="0px",a.right="auto",a.maxWidth=f+"px"));this.content.css(a);this.changePosition&&this.content.css({top:d(document).scrollTop()+this.positionCss.top+"px",left:this.positionCss.left+"px"})}},styleForModal:function(a){a&&this.showInModal()?(this.content.css({top:0,left:0,right:0,maxWidth:"100%",
minHeight:"100vh"}),this.content.addClass("modal"),this.content.toggleClass("noAnimation",!0),d("body").addClass("modal-open"),this.addedModalOpen=!0):this.addedModalOpen&&(this.addedModalOpen=!1,this.content.removeClass("modal"),d("body").removeClass("modal-open"))},modalActive:function(){return this.content.hasClass("modal")},shouldFlipDirection:function(a){if(this.options.flippable){var b=d(window).scrollTop(),c=b+d(window).outerHeight(),e=this.content.outerHeight(),f=this.element.offset().top,
c=f+this.element.outerHeight()+e>c,b=f-e<b;if("down"===a)return c&&!b;if("up"===a)return b&&!c}return!1},shouldFlipAlignment:function(a){if(this.options.flippable){var b=d(window).width(),c=this.content.width(),e=this.element.offset().left,f=this.element.width(),f=0>=e+("left"===a?0:f)-c,b=e+("left"===a?c:0)>=b;if("left"===a)return!f&&b;if("right"===a)return f&&!b}return!1},getReversedDirection:function(a){switch(a){case "down":return"up";case "up":return"down";case "left":return"right";case "right":return"left";
case "bottom":return"top";case "top":return"bottom";case "center":return"center"}return a},updateAnimationClass:function(a,b){a=this.getDirectionClass(a,b);this.content.hasClass(a)||this.content.removeClass(function(a,b){return(b.match(/\banimate-\S+/g)||[]).join(" ")}).addClass(a).removeAttr("style")},getDirectionClass:function(a,b){var c;"left"===a||"right"===a?(c="down"===b?"top":"bottom",a="center"===a?"right":this.getReversedDirection(a)):(c="down"===a?"top":"bottom",a="center"===b?"right":b);
return"animate-"+c+"-"+a},loadAjax:function(){var a=this;return g.ajax.execute(this.options.ajaxUrl,{data:this.options.ajaxData,customUpdate:function(b){b.innerHTML&&""!==b.innerHTML?a.content.html(b.innerHTML):(a.element.remove(),a.content.remove(),a.ajaxLoadFailed=!0);return!0}})},getTriggerWidth:function(){var a=this.elementNode.getBoundingClientRect();return a?a.right-a.left:this.element.outerWidth()},animateClose:function(a){var b=this,c=this.content.attr("class");(c=c&&c.match(/\banimate-\S+/))&&
c.length&&(this.content.removeClass(c[0]),window.setTimeout(function(){b.content.addClass(c[0]+" close-animation")},1),window.setTimeout(function(){a();b.content.removeClass("close-animation")},this.animationDuration))},toggleCover:function(a){this.options.useCover&&(a?this.coverInner.css("transform","scale("+(this.cover.outerWidth()+2)/this.element.outerWidth()+", 1.333)"):this.coverInner.css("transform","scale(1)"))},showInModal:function(){return 0<this.options.showModalBp&&d(window).outerWidth()<
this.options.showModalBp&&this.content.hasClass("open")}})})(window.R9,window.jQuery);(function(b,c){b.createComponentClass("common.layout.NavMenu",{dropdown:null,messageTimeoutId:null,options:{isLoggedInUser:!1,signInOutLink:"",includeContent:!1,showEmailLogin:!1,isLogoutFullUrl:!1,messageDuration:3E3,activeVertical:null,accountDropdownLogin:!1},init:function(){var a=this;window.showAlertRegRedirect=function(d){a.options.isLoggedInUser?window.location="/alerts":b.authentication.showSignup({onclose:c.noop,success:function(){a.options.isLoggedInUser=!0;window.location="/alerts"}})};
this.options.includeContent||this.loadNavContent()},addEventHandlers:function(){var a=this;this.getChildElement("login").click(function(d){c("body").click();b.Social.WebCredentials.trySignIn(function(){a.options.accountDropdownLogin?b.events.publish("header.navMenu.dropdown.toggle"):b.authentication.showLogin()});d.preventDefault()});this.getChildElement("dropdown").click(function(d){a.options.isLoggedInUser||(d.preventDefault(),b.Social.WebCredentials.trySignIn(function(){b.authentication.showLogin()}))});
this.getChildElement("profileIcon").click(function(d){a.options.isLoggedInUser||(d.preventDefault(),b.Social.WebCredentials.trySignIn(function(){b.authentication.showLogin()}))});this.getChildElement("signup").click(function(a){c("body").click();b.authentication.showSignup({promoType:"all"});a.preventDefault()});this.getChildElement("login-icon").click(function(){b.Social.WebCredentials.trySignIn(function(){b.authentication.showLogin()})});this.getChildElement("more-logout").click(function(){b.Social.WebCredentials.requireUserMediation();
document.location="/k/ident/signout?redir\x3d"+encodeURIComponent(a.options.isLogoutFullUrl?window.location.href:window.location.pathname)});this.options.contentIncluded&&a.getChildElement("menuContent").find(".navmenu-more-login").click(function(){b.authentication.showLogin()});b.events.subscribe("DropdownDialog.open",a.handleDropdownEvent.bind(a,!0));b.events.subscribe("DropdownDialog.close",a.handleDropdownEvent.bind(a,!1));b.events.subscribe("NavMenu.showMessage",a.showMessage.bind(a))},handleDropdownEvent:function(a,
b){var d=this._id+"-dropdown";b.id&&b.id===d&&(a?c(this.element).addClass("active"):c(this.element).removeClass("active"))},loadNavContent:function(){b.ajax.execute("common/layout/NavMenuContent",{data:{signInOutLink:this.options.signInOutLink,loggedIn:this.options.isLoggedInUser,parentId:this.id(),activeVertical:this.options.activeVertical,isSEO:this.options.isSEO},appendTo:this.getChildElement("menuContent"),replace:!0})},showMessage:function(a){var b=this;if(a&&a.id&&a.text){var c=this.getChildElement(a.id);
if(c.length){this.removeMessage(c);clearTimeout(this.messageTimeoutId);var e={subNameSpace:"navMenu",content:a.text,position:"bottom",activation:"click",extraClass:"NavMenuTipAdjustTop",showImmediately:!0,closeOnBodyClick:!1,appendTo:"body"};a.color&&(e.color=a.color);c.toolTip(e);this.messageTimeoutId=setTimeout(function(){b.removeMessage(c)},this.options.messageDuration)}}},removeMessage:function(a){a.data("toolTip")&&a.data("toolTip").removeWidget()}})})(R9,jQuery);(function(c,d){c.createComponentClass("common.layout.StyleJamHeader",{options:{focusHeaderMenuOnLoad:!1,navigationVisible:!0,fixedHeaderOnAlertSaved:!1,fixedHeaderOnAlertSavedToTrip:!1,statesClasses:{"default":{main:"",headerWrapper:"",headerContainer:"",caretBorder:""},hidden:{main:"",headerWrapper:"",headerContainer:"",caretBorder:""},results:{main:"",headerWrapper:"",headerContainer:"",caretBorder:""},navWrapper:{hidden:"",visible:""},activeState:""},swapInvertedLogoOnRp:!1,useCaret:!1,isHeaderSticky:!1,
fullWidthMap:!1},headerContainer:null,inlineComponentsReady:function(){var a=this;if(this.options.focusHeaderMenuOnLoad&&!this.isHashNavigation()&&!c.globals.isSeo){var b=this.element.find(".StyleJamNavLink")[0];b&&b.focus()}this.answer("header.height",function(){return a.element.outerHeight()});this.options.isHeaderSticky&&c.events.publish("pinnableBar.pinnedChange");this.headerContainer=this.getChildElement("headerContainer")},isHashNavigation:function(){return!!window.location.hash},addEventHandlers:function(){var a=
this;a.element.find("#myAccount").click(function(a){a.stopPropagation();c.events.publish("header.account.clicked",{})});c.events.subscribe(["header.view.set","pageContainers.changed","sem.explore.form.change-state"],function(b){if(b.view||b.newstate)b=b.view||b.newstate,a.changeView("rp"===b?"results":b)});this.options.useCaret&&c.events.subscribe("header.hideCaretBorder",function(){a.getChildElement("caretBorder").hide()});this.subscribe("hotels.results.dualViewMap.open",this.setDualViewMapOpen.bind(this,
!0));this.subscribe("hotels.results.dualViewMap.closed",this.setDualViewMapOpen.bind(this,!1));this.options.fixedHeaderOnAlertSaved&&(this.subscribe("alertsaved.success",this.slideDownHeaderForPriceAlert.bind(this)),this.subscribe("alertsaved.success.dismiss",this.resetHeaderStyleForPriceAlert.bind(this)),this.subscribe("resultItem.alert.tooltip.reset",this.resetTooltipSeen.bind(this)));this.options.fixedHeaderOnAlertSavedToTrip&&(this.subscribe("resultItem.alert.saved",this.slideDownHeaderForTrip.bind(this)),
this.subscribe("resultItem.alert.saved.dismiss",this.resetHeaderStyleForTrip.bind(this)),this.subscribe("resultItem.alert.tooltip.reset",this.resetTooltipSeen.bind(this)))},setDualViewMapOpen:function(a){this.element.toggleClass("map-open",a);this.element.toggleClass("map-closed",!a);this.options.fullWidthMap&&this.swapClassesToggle(this.headerContainer,"Header--fullWidth","Header--autoWidth",a)},changeView:function(a){var b=this.options.statesClasses[a],d=this.options.statesClasses.activeState,e=
this.options.statesClasses[d]||this.options.statesClasses.default;b||(b=this.options.statesClasses.default);b&&a!==d&&(c.dom.swapClasses(this.element,e.main,b.main),c.dom.swapClasses(this.getChildElement("headerWrapper"),e.headerWrapper,b.headerWrapper),c.dom.swapClasses(this.getChildElement("headerContainer"),e.headerContainer,b.headerContainer),e.caretBorder&&b.caretBorder&&c.dom.swapClasses(this.getChildElement("caretBorder"),e.caretBorder,b.caretBorder),this.options.statesClasses.activeState=
a,"results"!==a||this.options.navigationVisible||(this.options.navigationVisible=!0,this.getChildElement("verticals").attr("aria-hidden","false")));this.options.swapInvertedLogoOnRp&&"results"===a&&(this.toggleLogoVisibility(this.element.find(".js-logo")),this.toggleLogoVisibility(this.element.find(".js-logo-inverted")))},toggleLogoVisibility:function(a){var b=!a.hasClass(this.getStlBlock("Header__phoenixLogo--hidden"));this.swapClassesToggle(a,"Header__phoenixLogo--hidden","Header__phoenixLogo--visible",
b)},slideDownHeaderForTrip:function(a){if(sessionStorage.getItem("alertSavedToTripTooltipSeen"))c.events.publish("resultItem.alert.saved.dismiss",a);else{var b=function(){c.events.publish("resultItem.alert.saved.show-tooltip",a);this.element.off(c.Common.Utils.Browsers.ANIMATION_END)}.bind(this);d(window).scrollTop()>this.element.height()?this.slideDownHeader(b):c.events.publish("resultItem.alert.saved.show-tooltip",a)}},slideDownHeaderForPriceAlert:function(){if(sessionStorage.getItem("priceAlertTooltipSeen"))c.events.publish("alertsaved.success.show-tooltip");
else{var a=function(){c.events.publish("alertsaved.success.show-tooltip");this.element.off(c.Common.Utils.Browsers.ANIMATION_END)}.bind(this);d(window).scrollTop()>this.element.height()?this.slideDownHeader(a):c.events.publish("alertsaved.success.show-tooltip")}},resetHeaderStyleForTrip:function(){sessionStorage.getItem("alertSavedToTripTooltipSeen")||(this.resetHeaderStyle(),sessionStorage.setItem("alertSavedToTripTooltipSeen",!0))},resetHeaderStyleForPriceAlert:function(){sessionStorage.getItem("priceAlertTooltipSeen")||
(this.resetHeaderStyle(),sessionStorage.setItem("priceAlertTooltipSeen",!0))},slideDownHeader:function(a){d("body").css({"padding-top":this.element.height()});this.swapClasses(this.element,"","Header--fixed");this.element.removeClass("slideUp").addClass("slideDown");a&&this.element.on(c.Common.Utils.Browsers.ANIMATION_END,a)},resetHeaderStyle:function(){this.element.hasClass("slideDown")&&(this.element.on(c.Common.Utils.Browsers.ANIMATION_END,function(){d("body").css({"padding-top":0});this.swapClasses(this.element,
"Header--fixed","");this.element.off(c.Common.Utils.Browsers.ANIMATION_END)}.bind(this)),this.element.removeClass("slideDown").addClass("slideUp"))},resetTooltipSeen:function(){sessionStorage.removeItem("alertSavedToTripTooltipSeen");sessionStorage.removeItem("priceAlertTooltipSeen")}})})(R9,jQuery);(function(k,c){k.createComponentClass("common.layout.MomondoLocalePicker",{dialog:null,countryDialog:null,langugeDialog:null,currencyDialog:null,options:{currentCountryCode:"",currentLanguageCode:"",currentCurrencyCode:""},init:function(){this.dialog=this.getChildElement("momondoLocalePicker").dialog({}).getWidget();this.countryDialog=this.getChildElement("country-dropdown").dropdownDialog({}).getWidget();this.langugeDialog=this.getChildElement("language-dropdown").dropdownDialog({}).getWidget();
this.currencyDialog=this.getChildElement("currency-dropdown").dropdownDialog({}).getWidget()},addEventHandlers:function(){var a=this;c("a",a.element).on("click",function(){a.dialog.open()});c("li",a.countryDialog.content).on("click",function(b){var d=c(b.delegateTarget);a.options.currentCountryCode=d.data("countrycode");b=d.data("countryname");for(var d=d.data("languages").split("|"),g="",f=0;f<d.length;f++){var e=d[f].split(";"),h=e[0],e=e[1];0==f&&(a.langugeDialog.updateLabel(e),a.options.currentLanguageCode=
h);g=g+"\x3cli data-langcode\x3d"+h+" data-langname\x3d"+e+"\x3e"+e+"\x3c/li\x3e"}c("ul",a.langugeDialog.content).html(g);a.addLanguagesEventHandlers();a.countryDialog.updateLabel(a.formatCountryLabel(a.options.currentCountryCode,b));a.countryDialog.close()});a.addLanguagesEventHandlers();c("li",a.currencyDialog.content).on("click",function(b){b=c(b.delegateTarget);a.options.currentCurrencyCode=b.data("currencycode");a.currencyDialog.updateLabel(a.formatCurrencyLabel(b.data("currencycode"),b.data("currencyname")));
a.currencyDialog.close()});c(".cancel",a.dialog.content).on("click",function(){a.dialog.close()});c(".ok",a.dialog.content).on("click",function(){window.location="/in?cc\x3d"+a.options.currentCountryCode+"\x26lc\x3d"+a.options.currentLanguageCode+"\x26mc\x3d"+a.options.currentCurrencyCode})},addLanguagesEventHandlers:function(){var a=this;c("li",a.langugeDialog.content).on("click",function(b){b=c(b.delegateTarget);a.options.currentLanguageCode=b.data("langcode");a.langugeDialog.updateLabel(b.data("langname"));
a.langugeDialog.close()})},formatCurrencyLabel:function(a,b){return b+"\x3cspan class\x3d'currencyCode'\x3e"+a+"\x3c/span\x3e"},formatCountryLabel:function(a,b){return"\x3cspan class\x3d'flag "+a+"'\x3e\x26nbsp;\x3c/span\x3e "+b}})})(window.R9,window.jq||window.jQuery);(function(l,c){l.createComponentClass("common.layout.MomondoLocaleDropdownContent",{dialog:void 0,countryList:void 0,languageList:void 0,currencyList:void 0,countryLabel:void 0,languageLabel:void 0,currencyLabel:void 0,selectionContent:void 0,options:{currentCountryCode:"",currentCountryUrl:"",currentLanguageCode:"",currentCurrencyCode:"",placeholderText:""},previousCC:"",previousLC:"",previousCurr:"",init:function(){this.dialog=this.getChildElement("momondoLocaleDropdown").dropdownDialog({onClose:c.proxy(this.onDropdownClose,
this),onOpen:c.proxy(this.onDropdownOpen,this)}).getWidget();this.countryList=this.getChildElement("countries");this.languageList=this.getChildElement("languages");this.currencyList=this.getChildElement("currency");this.previousCC=this.options.currentCountryCode;this.previousLC=this.options.currentLanguageCode;this.previousCurr=this.options.currentCurrencyCode;this.countryLabel=this.getChildElement("localeCountry");this.languageLabel=this.getChildElement("localeLanguage");this.currencyLabel=this.getChildElement("localeCurrency");
this.selectionContent=this.getChildElement("selectionContent");this.dialog.updateLabel(this.options.placeholderText)},hasAnyChanges:function(){return this.options.currentCountryCode!==this.previousCC||this.options.currentLanguageCode!==this.previousLC||this.options.currentCurrencyCode!==this.previousCurr},onlyCurrencyChanged:function(){return this.options.currentCountryCode===this.previousCC&&this.options.currentLanguageCode===this.previousLC},onDropdownOpen:function(){var a=this;setTimeout(function(){a.dialog.content.addClass("rendered")},
100)},onDropdownClose:function(){this.dialog.content.removeClass("rendered");this.selectionContent.addClass("show");c(".js-locale-list-container",this.dialog.content).removeClass("show")},openList:function(a){a.addClass("show");this.selectionContent.removeClass("show")},closeList:function(a){a.removeClass("show");this.selectionContent.addClass("show")},addEventHandlers:function(){var a=this;c("a",a.element).on("click",function(){a.dialog.open()});c(".js-selection",a.dialog.content).click(function(b){a.openList(c("#"+
c(b.currentTarget).data("list")))});c(".js-locale-list-container \x3e .js-back",a.dialog.content).click(function(b){a.closeList(c(b.currentTarget).parent())});c("li",a.countryList).on("click",function(b){var d=c(b.delegateTarget);a.options.currentCountryCode=d.data("countrycode");a.options.currentCountryUrl=d.data("url");b=d.data("countryname");for(var d=d.data("languages").split("|"),h="",f=0;f<d.length;f++){var e=d[f].split(";"),k=e[0],g=e[1],e=e[2];0==f&&(a.languageLabel.html(g),a.options.currentLanguageCode=
k);h+="\x3cli data-langcode\x3d'"+k+"' data-langname\x3d'"+g+"' data-url\x3d'"+e+"'\x3e"+g+"\x3c/li\x3e"}c("ul",a.languageList).html(h);a.addLanguagesEventHandlers();a.countryLabel.html(a.formatCountryLabel(a.options.currentCountryCode,b));a.closeList(a.countryList)});a.addLanguagesEventHandlers();c("li",a.currencyList).on("click",function(b){b=c(b.delegateTarget);a.options.currentCurrencyCode=b.data("currencycode");a.currencyLabel.html(a.formatCurrencyLabel(b.data("currencycode"),b.data("currencyname")));
a.closeList(a.currencyList)});c(".cancel",a.dialog.content).on("click",function(){a.dialog.close()});c(".ok",a.dialog.content).on("click",function(){if(a.hasAnyChanges())if(a.onlyCurrencyChanged())a.saveCurrency();else{var b=a.options.currentCountryCode;"US"===a.options.currentCountryCode.toUpperCase()&&"es"===a.options.currentLanguageCode&&(b="uy");b="/in?cc\x3d"+b+"\x26lc\x3d"+a.options.currentLanguageCode+"\x26mc\x3d"+a.options.currentCurrencyCode;a.options.currentCountryUrl&&(b=a.options.currentCountryUrl,
-1<b.indexOf("/in?")&&(b+="\x26mc\x3d"+a.options.currentCurrencyCode));window.location=b}else a.dialog.close()})},saveCurrency:function(){c.ajax({type:"POST",url:"/k/ident/currency",data:{currency:this.options.currentCurrencyCode,posted:!0,save:!1},dataType:"text",success:function(){location.reload()},cache:!1})},addLanguagesEventHandlers:function(){var a=this;c("li",a.languageList).on("click",function(b){b=c(b.delegateTarget);a.options.currentLanguageCode=b.data("langcode");a.languageLabel.html(b.data("langname"));
if(b=b.data("url"))a.options.currentCountryUrl=b;a.closeList(a.languageList)})},formatCurrencyLabel:function(a,b){return b+"\x3cspan class\x3d'currencyCode'\x3e"+a+"\x3c/span\x3e"},formatCountryLabel:function(a,b){return"\x3cspan class\x3d'flag "+a+"'\x3e\x26nbsp;\x3c/span\x3e "+b}})})(window.R9,window.jq||window.jQuery);(function(a){a.createComponentClass("common.layout.Footer",{options:{isSeo:!1,loadContent:!1,needSeoFooter:!1},fdFooter:null,rpFooter:null,init:function(){this.fdFooter=jq("#footer-fd",this.element);this.rpFooter=jq("#footer-rp",this.element);this.options.loadContent&&a.ajax.execute("common/layout/AjaxFooterLinks",{type:"GET",data:{id:this.id(),isSeo:this.options.isSeo},replace:!0})},addEventHandlers:function(){var b=this;a.question.answer("footer.offset",function(){return b.element.position()});
a.events.subscribe("footer.show",function(){b.element.show()});a.events.subscribe("footer.hide",function(){b.element.hide()});a.events.publish("footer.init");a.events.subscribe("resultspage.view.setvisible",this.updateVisibility.bind(this));a.events.subscribe("footer.update.rp.disclaimer",this.updateText.bind(this))},updateVisibility:function(){this.options.needSeoFooter&&this.fdFooter&&this.rpFooter&&(this.fdFooter.addClass("hidden"),this.rpFooter.removeClass("hidden"))},updateText:function(a){this.options.needSeoFooter&&
this.rpFooter&&this.rpFooter.html(a.message)}})})(R9);(function(b,c){b.createComponentClass("common.errors.ErrorDialog",{dialog:null,dialogEl:null,title:null,messages:null,init:function(){this.dialogEl=this.getChildElement("dialog");this.dialog=this.dialogEl.dialog({}).getWidget();this.title=this.getChildElement("title");this.messages=this.getChildElement("messages")},addEventHandlers:function(){var a=this;this.subscribe("error.alert",this.show.bind(this));b.events.when("error.alert",this.show.bind(this));this.subscribe("error.dismiss",this.hide.bind(this));
this.getChildElement("close").on("click keydown",function(c){c.keyCode!==b.globals.keyCodes.TAB&&a.dialog.close()})},show:function(a){var b=this;a.title?(this.title.html(a.title),this.dialogEl.addClass("hasTitle")):(this.title.html(""),this.dialogEl.removeClass("hasTitle"));this.messages.html("");a.messages&&(c.isArray(a.messages)||(a.messages=[a.messages]),c.each(a.messages,function(a,d){a=c("\x3cli\x3e").html(d);b.messages.append(a)}));this.dialog.open()},hide:function(){this.dialog.close()}})})(R9,
jQuery);(function(a,b){a.createComponentClass("common.utils.admin.Tools",{options:{showExperimentSwitchTool:!1,showFeaturesSwitchTool:!1,showCookieControlTool:!1,showFindTemplateTool:!1,seoIndexDisabled:!1,currentExperiments:null,icon:null},legacyAdminToolsInstance:null,constructor:function(a,d,e){this._id=a;this.options=b.extend({},this.options,b.extend(d||{},e||{}));this.init()},init:function(){this.legacyAdminToolsInstance=a.Admin.AdminTools.getInstance({classNameMainContainer:"Common-Utils-Admin-Tools layer-sticky r9-admin-main"},
!0);this.options.showExperimentSwitchTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.ExperimentTool({currentExperiments:this.options.currentExperiments}));this.options.showFeaturesSwitchTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.FeatureTool);this.options.showCookieControlTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.CookieTool);this.options.showFindTemplateTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.FindTemplateTool);var c=this.getChildElement("chev").detach();
if(c){var d=this;c.click(function(a){a.stopPropagation();a.stopImmediatePropagation();d.legacyAdminToolsInstance.getMenuContainer().toggleClass("collapsed")});this.legacyAdminToolsInstance.getMenuContainer().children().eq(0).prepend(c)}this.options.seoIndexDisabled&&(0<b("link[rel\x3d'canonical'][href$\x3d'/seonox']").length&&b("body").addClass("seonox"),b("a[href$\x3d'/seonox']").addClass("seonox"))}})})(window.R9,window.jQuery);(function(a,b){a.createComponentClass("common.layout.StandardBody",{stateClasses:{results:"ResultsPageBody"},init:function(){},addEventHandlers:function(){}})})(R9,jQuery);(function(a,d){a.createComponentClass("common.layout.momondo.StandardBody",{stateClasses:{results:"ResultsPageBody"},modalOverlay:null,init:function(){this.modalOverlay=this.getChildElement("modalOverlay")},addEventHandlers:function(){var b=this;a.events.subscribe("modalOverlay.visible",function(c){b.modalOverlay.toggleClass("OverlayVisible",c.open);c.event&&b.modalOverlay.click(function(){a.events.publish(c.event)})});b.modalOverlay.click(function(){d(this).removeClass("OverlayVisible")})}})})(R9,
jQuery);(function(e,g){g.openTooltipInstances={};var b=!1;R9.extend("Widgets",{Tooltip:function(a,d){this.element=e(a);this.element.data(this.widgetName,this);this.setOptions(d,!0)}});R9.extend("Widgets.Tooltip",{validateElement:function(a){return void 0===e(a).data(this.prototype.widgetName)},getInstance:function(a,d){return this.validateElement(a)?new R9.Widgets.Tooltip(a,d):(a=e(a).data(this.prototype.widgetName),d?a.setOptions(d):a)},removeWidget:function(a){this.validateElement(a)||this.getInstance(a).removeWidget()},
setDebug:function(a){b=a},isDebug:function(){return b}});R9.extend("Widgets.Tooltip.prototype",{element:null,widgetNamespace:"r9-tooltip",widgetBaseClass:"r9-tooltip",widgetName:"tooltip",positionTarget:"data-tooltip-position-target",isOpen:!1,options:{delay:200,fadeIn:200,fadeOut:200,edgeOffset:3,baseClass:null,content:null,positionTarget:null,position:"top",activation:"hover",showImmediately:!1,subNameSpace:"",onOpen:null,fixedPositioning:null,onClose:null,positionUpdate:!1,appendTo:"body",offsetLeft:0,
offsetAgainstEdge:!0,keepOpenOnContentHover:!1,keepOpenOnPositionTargetHover:!1,readContentOnOpen:!1,keepOpenOnRelatedTargetHover:!0,closeDelay:0,fallbackPosition:null,forceDesiredPosition:!1},_timer:null,_closeTimer:null,_originalTitle:null,_positionUpdater:null,init:function(){this._removeAllWidgetBindings();openTooltipInstances.hasOwnProperty(this.options.subNameSpace)||(openTooltipInstances[this.options.subNameSpace]=null);var a=this,d=a._getContainerElement(),c=a._getArrowElement();switch(this.options.activation){case "click":this.element.on("click."+
this.widgetName,function(c){null===openTooltipInstances[a.options.subNameSpace]&&(a.isOpen=!1);a.isOpen?a.close(c):setTimeout(a.open.bind(a,c),0)});this.options.keepOpenOnContentHover||this.bindContainerHoverEvents();this.options.showImmediately&&this.element.trigger("click."+this.widgetName);break;case "focus":this.element.on("focus."+this.widgetName,function(c){a.open(c)});this.element.on("blur."+this.widgetName,function(c){a.close(c)});this.options.showImmediately&&this.element.trigger("focus."+
this.widgetName);break;default:this.element.on("mouseenter."+this.widgetName,function(c){clearTimeout(a._closeTimer);a.open(c)}),(this.options.keepOpenOnPositionTargetHover?this._getPositionTarget():this.element).on("mouseleave."+this.widgetName,function(b){a.options.keepOpenOnRelatedTargetHover&&(e(b.relatedTarget).closest(d).length||e(b.relatedTarget).closest(c).length)||(a.options.closeDelay?a._closeTimer=setTimeout(function(){a.close(b)},a.options.closeDelay):a.close(b))}),this.options.showImmediately&&
this.element.trigger("mouseenter."+this.widgetName),this.options.keepOpenOnContentHover&&this.bindContainerHoverEvents()}return this},bindContainerHoverEvents:function(){var a=this;this._getContainerElement().on("mouseenter."+this.widgetName,function(){a.isOpen&&clearTimeout(a._closeTimer)}).on("mouseleave."+this.widgetName,function(d){a.isOpen&&!e(d.relatedTarget).closest(a._getArrowElement()).length&&(a._closeTimer=setTimeout(function(){a.close(d)},a.options.closeDelay))})},setOptions:function(a,
d){a&&(this.options=e.extend({},this.options,a));(a||d)&&this.init();return this},open:function(a){var d=this.getContent(a);if(!d||this.isOpen)return this;var c=!1;openTooltipInstances[this.options.subNameSpace]&&openTooltipInstances[this.options.subNameSpace]!==this&&(c=!0,openTooltipInstances[this.options.subNameSpace].close(a,c));var b=this._getWrapperElement(),f=this._getContainerElement(),h=this._getArrowElement();this.renderContent(d,f);this._resetElements(b,f,h);d=this._getPositionMap(b,h);
this._updateArrowElement(d,h);this._updateWrapperElement(d,b);this._updateContainerElement(d,f);if(this.options.fixedPositioning){var k=this;Object.keys(this.options.fixedPositioning).forEach(function(a){b.css(a,k.options.fixedPositioning[a])});b.css("position","fixed")}this._timer&&clearTimeout(this._timer);this._closeTimer&&clearTimeout(this._closeTimer);this.isOpen=!0;openTooltipInstances[this.options.subNameSpace]=this;if(this.options.delay){var m=this;this._timer=setTimeout(function(){m._open(b,
a,c)},this.options.delay)}else this._open(b,a,c);this._positionUpdater&&clearInterval(this._positionUpdater);e(g).on("resize",e.proxy(this._updatePosition,this));return this},renderContent:function(a,d){d.html(a)},close:function(a,d){if(!R9.Widgets.Tooltip.isDebug()){this._timer&&clearTimeout(this._timer);this._closeTimer&&clearTimeout(this._closeTimer);this._positionUpdater&&clearInterval(this._positionUpdater);e(g).off("resize",this._updatePosition);a=this._getWrapperElement();a.stop(!0,!0);this.isOpen=
!1;openTooltipInstances[this.options.subNameSpace]=null;var c=this;this.options.fadeOut&&!d?a.fadeOut(this.options.fadeOut,function(){c._close()}):(a.hide(),this._close());return this}},getContent:function(a){var d=this.element.attr("title");d&&(this._originalTitle=d,this.element.attr("title",""));return this.options.content?"function"==typeof this.options.content?this.options.content.call(this,a):this.options.content:this._originalTitle?this._originalTitle:null!=this.element.data("title")?this.element.data("title"):
this.element.text()},removeWidget:function(){this._removeAllWidgetBindings();this.element.removeData(this.widgetName);this.close();return this},_updatePosition:function(){var a=this._getWrapperElement(),d=this._getContainerElement(),c=this._getArrowElement(),b=this._getPositioning(a,c);this._updateArrowElement(b,c);"rtl"!==document.dir&&a.css({top:b.newWrapperTop+"px",left:b.newWrapperLeft+"px"});this._updateContainerElement(b,d)},_getWrapperElement:function(){var a=e("#"+this._getIdValue("-wrapper"));
a.length||(a=this._createDOMElement("-wrapper"),this.options.readContentOnOpen?a.attr("role","alert"):a.attr("role","tooltip"),e(this.options.appendTo).append(a));return a},_getContainerElement:function(){var a=e("#"+this._getIdValue("-container"));a.length||(a=this._createDOMElement("-container"),this._getWrapperElement().append(a));return a},_getArrowElement:function(){var a=e("#"+this._getIdValue("-arrow"));a.length||(a=this._createDOMElement("-arrow"),this._getWrapperElement().append(a));return a},
_createDOMElement:function(a){var d=e("\x3cdiv\x3e\x3c/div\x3e").attr("id",this._getIdValue(a));this._setStyleClasses(d,a);return d},_removeAllWidgetBindings:function(){this.element.off("click."+this.widgetName).off("focus."+this.widgetName).off("blur."+this.widgetName).off("mouseenter."+this.widgetName).off("mouseleave."+this.widgetName);return this},_getPositionTarget:function(){var a=this.options.positionTarget||this.element.attr(this.positionTarget);return a&&(a=this.options.positionTarget?e("#"+
this.options.positionTarget):e(a,this.element),0<a.length)?a:this.element},_getOffsetInformation:function(a,d,c){var b=this._getPositionTarget();this.options.fixedPositioning&&this._getContainerElement();var f=b.outerWidth(),h=b.outerHeight();a="width"===a?c.outerWidth():c.outerHeight();return{arrowSize:Math.round(a/2),elementWidth:f,elementHeight:h,wrapperWidth:d.outerWidth(),wrapperHeight:d.outerHeight(),offset:{top:Math.floor(b.offset().top-e(this.options.appendTo).offset().top),left:Math.floor(b.offset().left-
e(this.options.appendTo).offset().left)}}},_getPositionMap:function(a,d){a.attr("style","").css({top:"-1000px",left:"-5000px",display:"block"});return this._getPositioning(a,d)},_getPositioning:function(a,d,c){switch(c||this.options.position){case "bottom":return this._getBottomPositioning(a,d);case "left":return this._getLeftPositioning(a,d);case "right":return this._getRightPositioning(a,d);default:return this._getTopPositioning(a,d)}},_getCommonPositioningMap:function(){return{newArrowTop:0,newArrowLeft:0,
newWrapperTop:0,newWrapperLeft:0,wrapperClass:""}},getLeftRightOffsetAgainstEdge:function(a,d,c){if(this.options.offsetAgainstEdge){var b=e(this.options.appendTo).offset(),f=b?b.left+e(this.options.appendTo).width():e(this.options.appendTo).width(),h,k=null!=b&&a<b.left,g=!isNaN(f)&&a+c.wrapperWidth>f;k?h=Math.floor(b.left+this.options.edgeOffset):g&&(h="rtl"===document.dir?Math.floor(c.wrapperWidth-(c.offset.left+c.elementWidth)-c.elementWidth/2):Math.floor(f-c.wrapperWidth-this.options.edgeOffset));
if(k||g)d="rtl"===document.dir?c.elementWidth/2+c.arrowSize:d+a-h,a=h}return{wrapperLeft:a,arrowLeft:d}},_getTopPositioning:function(a,d){var c=this._getOffsetInformation("height",a,d),b=c.elementWidth/2,f="-top",h=c.wrapperHeight,k=c.offset.top-this.options.edgeOffset-c.arrowSize-c.wrapperHeight;if(!this.options.forceDesiredPosition&&0>=k){if(this.options.fallbackPosition&&"top"!==this.options.fallbackPosition)return this._getPositioning(a,d,this.options.fallbackPosition);f="-bottom";k=c.offset.top+
c.elementHeight+this.options.edgeOffset+c.arrowSize;h=-1*c.arrowSize}a=this.getLeftRightOffsetAgainstEdge(c.offset.left+b-c.wrapperWidth/2+this.options.offsetLeft,c.wrapperWidth/2-c.arrowSize,c);return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(h),newArrowLeft:Math.round(a.arrowLeft),newWrapperTop:Math.round(k),newWrapperLeft:Math.round(a.wrapperLeft),wrapperClass:f})},_getBottomPositioning:function(a,b){var c=this._getOffsetInformation("height",a,b),d=c.elementWidth/2,f="-bottom",
h=-1*c.arrowSize,k=c.offset.top+c.elementHeight+this.options.edgeOffset+c.arrowSize;if(!this.options.forceDesiredPosition&&k+c.wrapperHeight>=jq(g).scrollTop()+e(g).height()){if(this.options.fallbackPosition&&"bottom"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);f="-top";k=c.offset.top-this.options.edgeOffset-c.arrowSize-c.wrapperHeight;h=c.wrapperHeight}a=this.getLeftRightOffsetAgainstEdge(c.offset.left+d-c.wrapperWidth/2+this.options.offsetLeft,
c.wrapperWidth/2-c.arrowSize,c);return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(h),newArrowLeft:Math.round(a.arrowLeft),newWrapperTop:Math.round(k),newWrapperLeft:Math.round(a.wrapperLeft),wrapperClass:f})},_getLeftPositioning:function(a,b){var c=this._getOffsetInformation("width",a,b),d=c.elementHeight/2,f=c.wrapperHeight/2,h="-left",k=c.wrapperWidth,g=c.offset.left-this.options.edgeOffset-c.arrowSize-c.wrapperWidth;if(!this.options.forceDesiredPosition&&0>=g){if(this.options.fallbackPosition&&
"left"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);h="-right";g=c.offset.left+c.elementWidth+this.options.edgeOffset+c.arrowSize;k=-1*c.arrowSize}return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(f-c.arrowSize),newArrowLeft:Math.round(k),newWrapperTop:Math.round(c.offset.top+d-f),newWrapperLeft:Math.round(g),wrapperClass:h})},_getRightPositioning:function(a,b){var c=this._getOffsetInformation("border-right-width",a,b),d=c.elementHeight/
2,f=c.wrapperHeight/2,h="-right",k=-1*c.arrowSize,m="rtl"===document.dir?c.wrapperWidth-c.offset.left+c.arrowSize:c.offset.left+c.elementWidth+this.options.edgeOffset+c.arrowSize;if(!this.options.forceDesiredPosition&&m+c.wrapperWidth>=e(g).width()){if(this.options.fallbackPosition&&"right"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);a=c.offset.left-this.options.edgeOffset-c.arrowSize-c.wrapperWidth;0<=a&&(h="-left",m=a,k=c.wrapperWidth)}return e.extend(this._getCommonPositioningMap(),
{newArrowTop:Math.round(f-c.arrowSize),newArrowLeft:Math.round(k),newWrapperTop:Math.round(c.offset.top+d-f),newWrapperLeft:Math.round(m),wrapperClass:h})},_setStyleClasses:function(a,b,c){a.attr("class","");this._addStyleClasses(a,b,c);return this},_addStyleClasses:function(a,b,c){b&&(a.addClass(this.widgetBaseClass+b),c&&a.addClass(this.widgetBaseClass+b+c),this.options.baseClass&&(a.addClass(this.options.baseClass+b),c&&a.addClass(this.options.baseClass+b+c)));return this},_updateWrapperElement:function(a,
b){this._addStyleClasses(b,"-wrapper",a.wrapperClass);b.attr("style","");"number"===typeof a.newWrapperTop&&b.css("top",a.newWrapperTop+"px");"number"===typeof a.newWrapperLeft&&("rtl"===document.dir?b.css({right:a.newWrapperLeft+"px",left:""}):b.css({left:a.newWrapperLeft+"px",right:""}));return this},_updateArrowElement:function(a,b){this._addStyleClasses(b,"-arrow",a.wrapperClass);b.css({top:a.newArrowTop+"px"});"rtl"===document.dir?b.css({right:a.newArrowLeft+"px",left:""}):b.css({left:a.newArrowLeft+
"px",right:""});return this},_updateContainerElement:function(a,b){this._addStyleClasses(b,"-container",a.wrapperClass);this.options.updateContainerOnResize&&b.css({top:a.newArrowTop+5+"px",left:a.newArrowLeft-b.width()+"px"});return this},_getIdValue:function(a){return this.widgetNamespace+this.options.subNameSpace+a},_open:function(a,b,c){var d=this;a.stop(!0,!0);var f=function(a){this.options.onOpen&&this.options.onOpen.call(this,a);this.options.positionUpdate&&(this._positionUpdater=setInterval(e.proxy(this._updatePosition,
this),1E3/60))};this.options.fadeIn&&!c?a.fadeIn(this.options.fadeIn,function(){f.call(d,b)}):(a.show(),f.call(d,b));return this},_close:function(){this._originalTitle&&(this.element.attr("title",this._originalTitle),this._originalTitle=null);this.options.onClose&&this.options.onClose.call(this,null);return this},_resetElements:function(a,b,c){this._setStyleClasses(a,"-wrapper");this._setStyleClasses(b,"-container");this._setStyleClasses(c,"-arrow");return this}})})(jq||jQuery,window);
(function(e,g){e.createWidgetClass("tip.ToolTip",g.extend({},e.Widgets.Tooltip.prototype,{contentContainer:null,boundEvents:null,orientationOffset:null,trackEventId:null,options:g.extend({},e.Widgets.Tooltip.prototype.options,{showImmediately:!1,baseClass:"coolTip",extraClass:null,delay:200,position:"top",fallbackPosition:null,forceDesiredPosition:null,orientation:"middle",orientationOffset:null,onDestroy:null,activation:"hover",subNameSpace:"",alwaysRendered:!1,color:"black",size:"l",closeOnBodyClick:!0,
destroyAfterClose:!1,content:"",isComponent:!1,target:null,positionTarget:null,updateContainerOnResize:!1,track:null,testAttributes:null}),init:function(){this.base();if(this.options.alwaysRendered){this.contentContainer=this.getChildElement("rendered-content");var b=this.contentContainer.children().eq(0);b.attr({"data-test-popover-content":"","data-test-popover-open":this.options.showImmediately});this.setContent(b)}e.Widgets.Tooltip.prototype.init.call(this);this.boundEvents={};this.orientationOffset=
this._getOrientationOffset()},addEventHandlers:function(){this.subscribe("common.widgets.tooltip.clearCloseTimers",this._clearCloseTimers.bind(this));var b=this;this.subscribe("common.widgets.tooltip.closeAll",function(){b.isOpen&&b.close()})},destroy:function(){if("function"===typeof this.options.onDestroy)this.options.onDestroy();this.options.fadeOut=!1;var b=this._getContainerElement();Object.keys(this.boundEvents).forEach(function(a){b.off(a,this.boundEvents[a])}.bind(this));this.isOpen&&this.close();
this._removeAllWidgetBindings();this.element.removeData(this.widgetName);this.base()},bindComponent:function(){this.element.data("toolTip",this);this.element.data("widget")||this.element.data("widget",this);this._addTestAttributes(this.element,"trigger");e.globals.testMode&&this.element.attr({"data-test-popover-widget":"","data-test-popover-triggerevent":this.options.activation})},bindEventHandler:function(b,a,d){b=b.replace(/\s|$/g,"."+this.id()+" ");this._getContainerElement().on(b,a,d);this.boundEvents[b]=
a},setContent:function(b){this.options.content=b},renderContent:function(b,a){"string"===typeof b?e.Widgets.Tooltip.prototype.renderContent.call(this,b,a):"object"===typeof b?g.contains(a,b)||(a.html(""),a.append(b)):this.log.errorInternal('Bad parameter passed to renderContent(): "content" param must be a String or a jQuery object');this._addTestAttributes(a,"content")},getOptionalTarget:function(b,a){return"string"===typeof b&&b.length?"#"===b[0]?g(b):g("#"+b):null!==b&&"object"===typeof b?g(b):
a},_addTestAttributes:function(b,a){var d=this,c={};e.globals.testMode&&(c["data-test-popover-"+a]="");this.options.testAttributes&&Object.keys(this.options.testAttributes).forEach(function(a){var b=/^data-/.test(a)?a:"data-"+a;c[b]=d.options.testAttributes[a]});b.attr(c)},_getOrientationOffset:function(){return null!==this.options.orientationOffset?this.options.orientationOffset:this.options.extraClass&&-1!==this.options.extraClass.indexOf("no-arrow")?0:{start:-15,middle:0,end:15}[this.options.orientation]},
_getPositioning:function(b,a,d,c){d=d||this.options.position;var l=e.Widgets.Tooltip.prototype._getPositioning.call(this,b,a,d),f={top:0,left:0},h=this.orientationOffset*(c?-1:1);if("middle"!==this.options.orientation){var k=this.options.orientation,m,n;c&&(k="start"===k?"end":"start");"left"===d||"right"===d?(n="top",m="outerHeight"):(n="left",m="outerWidth");var p=this.getOptionalTarget(this.options.positionTarget,this.element),r=p[m](),q=this._getWrapperElement()[m]();if(!c&&!this.options.forceDesiredPosition)if(c=
p.offset()[n],p="scroll"+n.charAt(0).toUpperCase()+n.slice(1),"start"===k){if(c+q>g(window)[p]()+g(window)[m]())return this._getPositioning(b,a,d,!0)}else if("end"===k&&c+r-q<g(window)[p]())return this._getPositioning(b,a,d,!0);b=r/2;q/=2;"start"===k?f[n]=Math.ceil(q-b+h):"end"===k&&(f[n]=Math.ceil(b-q+h))}l.newArrowTop-=f.top;l.newArrowLeft-=f.left;l.newWrapperTop+=f.top;l.newWrapperLeft+=f.left;return l},clearTrackEvent:function(){this.trackEventId&&(clearTimeout(this.trackEventId),this.trackEventId=
null)},startTrackEvent:function(b){this.clearTrackEvent();if(b&&b.wait&&b.label){var a=parseInt(b.wait);isNaN(a)||1>a||(this.trackEventId=setTimeout(this.triggerTrackEvent.bind(this,b),a))}},triggerTrackEvent:function(b){if(this.element&&this.element.hasClass("tooltip-open")&&b&&b.label){var a={category:b.category||"ToolTip",action:b.action||"open",label:b.label};b.hasOwnProperty("value")&&(a.value=b.value);e.Analytics.api.trackEvent(a)}},_open:function(b,a,d){var c=this,l="click."+this.id(),f=this._getContainerElement();
e.Widgets.Tooltip.prototype._open.call(this,b,a,d);e.events.publish("common.widgets.tooltip.clearCloseTimers",this.options.subNameSpace);this.element.addClass("tooltip-open");f.attr("aria-expanded",!0);e.globals.testMode&&this.element.add(f).attr("data-test-popover-open",!0);var h=function(a){b[0].contains(a.target)||"click"===c.options.activation&&c.element[0].contains(a.target)||(g(document).off(l),c.close())};this.options.closeOnBodyClick&&setTimeout(function(){g(document).off(l).on(l,h)},1);this.options.track&&
this.startTrackEvent(g.extend({wait:2E3},this.options.track))},_close:function(b){var a=this.getContent(),d=this._getContainerElement();this.options.alwaysRendered&&"object"===typeof a&&this.contentContainer.append(a);e.Widgets.Tooltip.prototype._close.call(this,b);this.element.removeClass("tooltip-open");d.attr("aria-expanded",!1);e.globals.testMode&&this.element.add(d).attr("data-test-popover-open",!1);this.options.closeOnBodyClick&&e.dom.schedule(function(){g(document).off("click."+this.id())}.bind(this));
this.options.track&&this.clearTrackEvent();this.options.destroyAfterClose&&this.destroy()},closeAfter:function(b){this._forceCloseTimer&&clearTimeout(this._forceCloseTimer);this._forceCloseTimer=window.setTimeout(this.close.bind(this),b)},_clearCloseTimers:function(b){b===this.options.subNameSpace&&clearTimeout(this._closeTimer)},_addStyleClasses:function(b,a,d){a&&(b.addClass(this.widgetBaseClass+a),d&&b.addClass(this.widgetBaseClass+a+d),this.options.baseClass&&(b.addClass(this.options.baseClass+
a),d&&b.addClass(this.options.baseClass+a+d)),this.options.color&&b.addClass("Color-"+this.options.color));this.options.extraClass&&b.addClass(this.options.extraClass);this.options.size&&b.addClass("size-"+this.options.size);e.Common.Utils.Browsers.isIE()?b.addClass("ie"):e.Common.Utils.Browsers.isChrome()&&(b.addClass("chrome"),a=e.Common.Utils.Browsers.getChromeVersion(),65!==a&&66!==a||b.addClass("chrome65"));return this},_getOffsetInformation:function(b,a,d){var c=this.getOptionalTarget(this.options.positionTarget,
this.element),e=c.outerWidth(),f=c.outerHeight(),c={top:Math.floor(c.offset().top-g(this.options.appendTo).offset().top),left:Math.floor(c.offset().left-g(this.options.appendTo).offset().left)};b="width"===b?d.outerWidth():d.outerHeight();return{arrowSize:Math.round(b/2),elementWidth:e,elementHeight:f,wrapperWidth:a.outerWidth(),wrapperHeight:a.outerHeight(),offset:c}}}))})(R9,jQuery);(function(g,d){g.createWidgetClass("tip.StyleJamTooltip",{presentations:{wrapper:"Tooltip__Wrapper Tooltip__Wrapper--fixed Tooltip__Wrapper--hidden",visible:"Tooltip__Wrapper--visible",hidden:"Tooltip__Wrapper--hidden",content:"Tooltip__Content",pointer:"Tooltip__Pointer",above:"Tooltip__Pointer Tooltip__Pointer--down",right:"Tooltip__Pointer Tooltip__Pointer--left",below:"Tooltip__Pointer Tooltip__Pointer--up",left:"Tooltip__Pointer Tooltip__Pointer--right"},$targetElem:null,$triggerElem:null,$tooltipElem:null,
$tooltipPointerElem:null,state:null,options:{targetElem:null,triggerElem:null,triggerEvent:"hover",position:"above",positionOffsetX:50,positionOffsetY:50,showDelay:0,hideDelay:1E3,content:null,preRendered:!1},init:function(){this.base();this.state={afID:null,scrolling:!1,scrollTicker:null,visible:!1,showTimeout:0,hideTimeout:0,widthSet:!1};this.$targetElem=d("#"+this.options.targetElem);this.$triggerElem=null!==this.options.triggerElem?d("#"+this.options.triggerElem):this.$targetElem;this.$targetElem.length&&
this.$triggerElem.length?(this.options.preRendered?(this.$tooltipElem=d("#"+this.id()),this.$tooltipPointerElem=this.getChildElement("pointer")):(this.$tooltipElem=d(this.createTooltipElement()),this.$tooltipPointerElem=this.$tooltipElem.children("#"+this.id("pointer"))),this.options.preRendered&&this.$tooltipElem.appendTo(d("body"))):console.warn("StyleJamTooltip: Couldn't locate target element with id: %s",this.options.targetElem)},addEventHandlers:function(){var a=this;switch(this.options.triggerEvent){case "hover":this.$triggerElem.on("mouseenter",
function(){a.show()}).on("mouseleave",function(){a.hide()});this.$tooltipElem.on("mouseenter",function(){a.show()}).on("mouseleave",function(){a.hide()});break;case "click":this.options.hideDelay=0;this.$triggerElem.on("click",function(){a.show()});d(document).on("click",function(b){if(a.state.visible){var c=a.$targetElem[0],e=a.$tooltipElem[0],c=b.target===c||a.isDescendant(c,b.target);b=b.target===e||a.isDescendant(e,b.target);c||b||a.hide()}});break;case "focus":this.$triggerElem.on("focus",function(){a.show()}).on("blur",
function(){a.hide()})}this.setupOnScroll();this.subscribe("common.widgets.tooltip.closeAll",this.hide.bind(this))},createTooltipElement:function(){var a=document.createElement("div");a.setAttribute("id",this.id());a.setAttribute("class",this.getStlBlocks(this.presentations.wrapper));var b=document.createElement("div");b.setAttribute("class",this.getStlBlock(this.presentations.content));b.innerHTML=this.options.content;var c=document.createElement("div");c.setAttribute("id",this.id("pointer"));c.setAttribute("class",
this.getStlBlock(this.presentations.pointer));a.appendChild(b);a.appendChild(c);return a},setupOnScroll:function(){var a=this;this.registerEvent("scroll resize",d(window),function(){clearTimeout(a.state.scrollTicker);!a.state.scrolling&&a.state.visible&&(a.state.scrolling=!0,a.position());a.state.scrollTicker=setTimeout(function(){a.state.scrolling=!1;cancelAnimationFrame(a.state.afID)},150)})},show:function(){var a=this;this.state.visible=!0;this.options.preRendered||this.$tooltipElem.appendTo(d("body"));
this.state.widthSet||(this.$tooltipElem.width(this.$tooltipElem.width()),this.state.widthSet=!0);this.position();this.resetTimers();this.state.showTimeout=setTimeout(function(){a.swapClasses(a.$tooltipElem,a.presentations.hidden,a.presentations.visible)},this.options.showDelay)},hide:function(){var a=this;this.resetTimers();this.state.hideTimeout=setTimeout(function(){a.state.visible=!1;a.swapClasses(a.$tooltipElem,a.presentations.visible,a.presentations.hidden);a.options.preRendered||a.$tooltipElem.remove()},
this.options.hideDelay)},resetTimers:function(){clearTimeout(this.state.showTimeout);clearTimeout(this.state.hideTimeout)},position:function(){var a=this;this.state.scrolling&&(this.state.afID=requestAnimationFrame(function(){a.position()}));var b=this.$targetElem[0].getBoundingClientRect(),c=this.$tooltipElem[0].getBoundingClientRect(),e=this.$tooltipElem[0].currentStyle||window.getComputedStyle(this.$tooltipElem[0]);c.x-=parseFloat(e.marginLeft);c.width=c.width+parseFloat(e.marginLeft)+parseFloat(e.marginRight);
c.height=c.height+parseFloat(e.marginTop)+parseFloat(e.marginBottom);b=this.getRenderPosition(this.options.position,b,c);this.$tooltipElem.css({top:b.y+"px",left:b.x+"px"})},getRenderPosition:function(a,b,c){var e=b.x+this.options.positionOffsetX/100*b.width-c.width/2,d=b.y+this.options.positionOffsetY/100*b.height-c.height/2,f={left:[d,b.x-c.width,this.getInnerHeight()-(d+c.height)],below:[e,this.getInnerHeight()-(b.y+b.height+c.height),this.getInnerWidth()-(e+c.width)],right:[d,this.getInnerWidth()-
(b.x+b.width+c.width),this.getInnerHeight()-(d+c.height)],above:[e,b.y-c.height,this.getInnerWidth()-(e+c.width)]};a=f[a].every(function(a){return 0<=a})?a:Object.keys(f).reduce(function(a,b){return f[a].map(function(a){return 0<a?0:a}).reduce(function(a,b){return a+b})>f[b].map(function(a){return 0<a?0:a}).reduce(function(a,b){return a+b})?a:b});this.$tooltipPointerElem.attr("class","").addClass(this.getStlBlocks(this.presentations[a]));switch(a){case "above":return{x:e,y:b.y-c.height};case "right":return{x:b.x+
b.width,y:d};case "below":return{x:e,y:b.y+b.height};case "left":return{x:b.x-c.width,y:d}}},isDescendant:function(a,b){for(b=b.parentNode;null!=b;){if(b==a)return!0;b=b.parentNode}return!1},getInnerWidth:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},getInnerHeight:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}})})(R9,jQuery);(function(a,f){a.createComponentClass("account.v2.ProfilePage",{activeTab:void 0,viewSpinner:void 0,xhr:void 0,lastActivity:void 0,options:{activeTab:"dashboard",checkActivityInterval:3E4,timeoutPeriod:18E5,initial:void 0,loginUrlPath:"/login",msg:{dashboard:void 0,account:void 0,preferences:void 0,notifications:void 0,tripsettings:void 0,travelers:void 0,payment:void 0,history:void 0,alerts:void 0,watchlist:void 0,myguides:void 0}},views:{dashboard:"dashboard/DashboardView",account:"account/AccountView",
preferences:"preferences/PreferencesView",notifications:"notifications/NotificationsView",tripsettings:"tripsettings/TripSettingsView",travelers:"travelers/TravelersView",payment:"payments/PaymentsView",history:"history/HistoryView",watchlist:"watchlist/WatchlistView",myguides:"guidebooks/GuidebooksView"},init:function(){this.lastActivity=(new Date).getTime();this.viewSpinner=this.element.find(".js-viewSpinner");this.handleChangeTabs({activeTab:this.options.activeTab},!0)},addEventHandlers:function(){this.subscribe("account.nav.changetabs",
this.handleChangeTabs.bind(this));this.handleValidatedActionRequest();this.initExecuteWithRetryHandler()},handleValidatedActionRequest:function(){var e=this,d=function(b){a.authentication.showLogin({success:function(){a.action.execute("account/v2/action/validateinitial",{initial:e.options.initial}).then(function(){a.events.publish("social.response.loaded");b()}).fail(function(){window.location.reload()})},preventClose:!1})};this.subscribe("account.v2.validated-action",function(b){a.action.execute("account/v2/action/validateuser").then(b.successCallback).fail(function(){d(b.successCallback)})})},
initExecuteWithRetryHandler:function(){var e=this;this.subscribe("account.v2.execute-account-action",function(d){d.data=d.data||{};var b=function(c){f.ajax({type:"POST",url:c.path,data:f.extend(c.data,{formtoken:a.globals.formtoken}),headers:{"X-CSRF":a.globals.formtoken}}).then(function(b){c.success&&c.success(b)}).fail(function(a){401===a.status?e.promptLoginAndRetry(b,c):403===a.status?a.getResponseHeader("redirect")?window.location=a.getResponseHeader("redirect")+encodeURI(window.location.pathname):
window.location.reload():c.fail&&c.fail(a)}).always(function(){c.always&&c.always()})};b(d)})},promptLoginAndRetry:function(e,d){var b=this;a.authentication.showLogin({success:function(){a.events.publish("social.response.loaded");d.data.initial=b.options.initial;e(d)},preventClose:!1})},inlineComponentsReady:function(){a.Analytics.api.trackEvent({subPageId:"profile",category:this.activeTab,action:"loaded"})},handleChangeTabs:function(e,d){var b=this,c=this.activeTab===e.activeTab;if(!c||c&&this.xhr&&
"resolved"===this.xhr.state()){this.activeTab=e.activeTab;document.title=this.options.msg[this.activeTab];var c=this.views[this.activeTab],f=this.element.find(".js-activeView");f.empty();this.viewSpinner.show();this.xhr&&this.xhr.abort&&this.xhr.abort();this.xhr=a.ajax.execute("account/v2/views/"+c,{data:{},appendTo:f,replace:!1,customUpdate:function(){b.viewSpinner.hide()}});this.xhr.then(function(){e.jumpToWatchlist&&a.events.publish("account.dashboard.jumpToSection",{section:"watchlist"})});this.xhr.fail(function(a){401===
a.status&&(window.location=b.options.loginUrlPath+"?redir\x3d"+encodeURI(window.location.pathname))});d?window.history.replaceState(null,null,"/profile/"+b.activeTab+window.location.search):window.history.pushState(null,null,"/profile/"+b.activeTab)}}})})(R9,jQuery);function validateEmail(a){if(!a||!a.match)return!1;a=a.match(/^[A-Z0-9._%+-]{1,63}@(?:[A-Z0-9-]+\.){1,125}[A-Z]{2,63}$/i);return!!(a&&a[0]&&a[0].length)}function replaceArgs(){for(var a=arguments[0],b=1;b<=arguments.length;b++)a=a.replace("{"+(b-1)+"}",arguments[b]);return a}R9.metacookie=R9.metacookie||{};R9.metacookie.saveQueue=R9.metacookie.saveQueue||[];
function saveQueuedMetaCookie(){if(0!=R9.metacookie.saveQueue.length){var a=R9.metacookie.saveQueue[0];jq.ajax({type:"POST",url:"/k/cookie",data:{action:"setmeta",metacookie:a.name,metavalue:a.value,formtoken:R9.globals.formtoken},complete:function(){R9.metacookie.saveQueue.shift();saveQueuedMetaCookie()},success:function(){a.callback()}})}}function setMetaCookie(a,b,c){R9.metacookie.saveQueue.push({name:a,value:b,callback:c||jq.noop});1==R9.metacookie.saveQueue.length&&saveQueuedMetaCookie()}
function deleteMetaCookie(a,b){"function"!==typeof b&&(b=$.noop);jq.ajax({type:"POST",url:"/k/cookie",data:{action:"deletemeta",metacookie:a,formtoken:R9.globals.formtoken},success:b})}jq.ajaxPrefilter("script",function(a){a.cache=!0});(function(c){c.createComponentClass("common.core.RealUserMeasurementsComponent",{options:{fullstoryEnabled:!1},trackedSubmit:!1,addEventHandlers:function(){this.base();this.subscribe("searchform.submit",this.onSearchSubmit.bind(this))},onSearchSubmit:function(a){if(!this.trackedSubmit&&this.options.fullstoryEnabled&&window&&"FS"in window&&a&&a.vertical){this.trackedSubmit=!0;a="did"+this.fixCase(a.vertical)+"Search_bool";var b={};b[a]=!0;FS.setUserVars(b)}},fixCase:function(a){return a.toLowerCase().replace(/(^| )(\w)/g,
function(a){return a.toUpperCase()})}})})(R9);(function(d,f,e,c){d.createComponentClass("common.core.FullyInvisibleCaptcha",{options:{enabled:!1},init:function(){var a=this;this.options.enabled&&(this.setupCaptchaCallback(),this.initAPI().then(function(){a.fireCaptcha()}))},setupCaptchaCallback:function(){var a=this;c.onReCaptchaSubmit=function(b){a.captchaResult(b)};c.onReCaptchaError=function(a){console.log(a)}},initAPI:function(){var a=f.Deferred();c.recaptchaReady=function(){a.resolve()};var b=e.createElement("script");b.type="text/javascript";
b.async=!0;b.src="https://www.google.com/recaptcha/api.js?onload\x3drecaptchaReady\x26render\x3dexplicit";e.getElementById("recaptcha-root").appendChild(b);return a},fireCaptcha:function(){"undefined"!==typeof grecaptcha&&(grecaptcha.render("captcha",{},!0),grecaptcha.execute())},captchaResult:function(a){d.action.execute("common.core.FullyInvisibleCaptchaAction",{data:a})}})})(R9,jQuery,document,window);(function(e,d){e.createComponentClass("common.core.FastlyTiming",{options:{runTest:!1,measurementUrl:"/fastly-timer",logUrl:"/s/run/fastlytimerlog"},init:function(){this.options.runTest&&this.runTimingRequest()},runTimingRequest:function(){d.ajax({type:"POST",url:this.options.measurementUrl,success:this.logResult.bind(this)})},logResult:function(c,a,b){b&&c&&c.cluster&&(a=b.getResponseHeader("x-served-by"),b=b.getResponseHeader("x-timer"),a&&b&&(a=a.split(" "),a=a[a.length-1].split("-"),d.ajax({type:"POST",
url:this.options.logUrl,data:{cluster:c.cluster,timer:b,fastlyNode:a[a.length-1]}})))}})})(R9,jQuery);(new R9.logger).timeEnd("combined");