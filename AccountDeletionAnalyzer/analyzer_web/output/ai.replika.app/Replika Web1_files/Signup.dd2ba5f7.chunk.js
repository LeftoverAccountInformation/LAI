(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{294:function(e,t){function n(e){var t,n,r=(e=e||{}).keybindings||{};for(t in this._settings={keybindings:{next:r.next||{keyCode:40},prev:r.prev||{keyCode:38},first:r.first,last:r.last},wrap:e.wrap,stringSearch:e.stringSearch,stringSearchDelay:800},this._keybindingsLookup=[],this._settings.keybindings)(n=this._settings.keybindings[t])&&[].concat(n).forEach(function(e){e.metaKey=e.metaKey||!1,e.ctrlKey=e.ctrlKey||!1,e.altKey=e.altKey||!1,e.shiftKey=e.shiftKey||!1,this._keybindingsLookup.push({action:t,eventMatcher:e})}.bind(this));this._searchString="",this._members=[],e.members&&this.setMembers(e.members),this._boundHandleKeydownEvent=this._handleKeydownEvent.bind(this)}function r(e){e&&e.focus&&(e.focus(),"input"===e.tagName.toLowerCase()&&e.select())}n.prototype.activate=function(){return document.addEventListener("keydown",this._boundHandleKeydownEvent,!0),this},n.prototype.deactivate=function(){return document.removeEventListener("keydown",this._boundHandleKeydownEvent,!0),this._clearSearchStringRefreshTimer(),this},n.prototype._handleKeydownEvent=function(e){if(-1!==this._getActiveElementIndex()){var t=!1;this._keybindingsLookup.forEach(function(n){if(function(e,t){for(var n in e)if(void 0!==t[n]&&e[n]!==t[n])return!1;return!0}(n.eventMatcher,e))switch(t=!0,e.preventDefault(),n.action){case"next":this.moveFocusForward();break;case"prev":this.moveFocusBack();break;case"first":this.moveFocusToFirst();break;case"last":this.moveFocusToLast();break;default:return}}.bind(this)),t||this._handleUnboundKey(e)}},n.prototype.moveFocusForward=function(){var e,t=this._getActiveElementIndex();return e=t<this._members.length-1?t+1:this._settings.wrap?0:t,this.focusNodeAtIndex(e),e},n.prototype.moveFocusBack=function(){var e,t=this._getActiveElementIndex();return e=t>0?t-1:this._settings.wrap?this._members.length-1:t,this.focusNodeAtIndex(e),e},n.prototype.moveFocusToFirst=function(){this.focusNodeAtIndex(0)},n.prototype.moveFocusToLast=function(){this.focusNodeAtIndex(this._members.length-1)},n.prototype._handleUnboundKey=function(e){if(this._settings.stringSearch){if(""!==this._searchString&&(" "===e.key||32===e.keyCode))return e.preventDefault(),-1;if(!((t=e.keyCode)>=65&&t<=90))return-1;var t;if(e.ctrlKey||e.metaKey||e.altKey)return-1;e.preventDefault(),this._addToSearchString(String.fromCharCode(e.keyCode)),this._runStringSearch()}},n.prototype._clearSearchString=function(){this._searchString=""},n.prototype._addToSearchString=function(e){this._searchString+=e.toLowerCase()},n.prototype._startSearchStringRefreshTimer=function(){var e=this;this._clearSearchStringRefreshTimer(),this._stringSearchTimer=setTimeout(function(){e._clearSearchString()},this._settings.stringSearchDelay)},n.prototype._clearSearchStringRefreshTimer=function(){clearTimeout(this._stringSearchTimer)},n.prototype._runStringSearch=function(){this._startSearchStringRefreshTimer(),this.moveFocusByString(this._searchString)},n.prototype.moveFocusByString=function(e){for(var t,n=0,a=this._members.length;n<a;n++)if((t=this._members[n]).text&&0===t.text.indexOf(e))return r(t.node)},n.prototype._findIndexOfNode=function(e){for(var t=0,n=this._members.length;t<n;t++)if(this._members[t].node===e)return t;return-1},n.prototype._getActiveElementIndex=function(){return this._findIndexOfNode(document.activeElement)},n.prototype.focusNodeAtIndex=function(e){var t=this._members[e];return t&&r(t.node),this},n.prototype.addMember=function(e,t){var n=e.node||e,r=e.text||n.getAttribute("data-focus-group-text")||n.textContent||"";this._checkNode(n);var a={node:n,text:r.replace(/[\W_]/g,"").toLowerCase()};return null!==t&&void 0!==t?this._members.splice(t,0,a):this._members.push(a),this},n.prototype.removeMember=function(e){var t="number"===typeof e?e:this._findIndexOfNode(e);if(-1!==t)return this._members.splice(t,1),this},n.prototype.clearMembers=function(){return this._members=[],this},n.prototype.setMembers=function(e){this.clearMembers();for(var t=0,n=e.length;t<n;t++)this.addMember(e[t]);return this},n.prototype.getMembers=function(){return this._members},n.prototype._checkNode=function(e){if(!e.nodeType||e.nodeType!==window.Node.ELEMENT_NODE)throw new Error("focus-group: only DOM nodes allowed");return e},e.exports=function(e){return new n(e)}},659:function(e,t,n){"use strict";n.r(t);var r,a=n(2),o=n.n(a),i=n(651),c=n(652),u=n(653),s=n(25),l=n(10),p=n(4),m=n.n(p),d=n(6),f=n(28),h=n(7),g=n(650),b=n(319),v=n(288),S=n(79),y=n(27),k=n(3),x=n(22),_=n(0),C=n(8),E=n(11),w=n(9),j=n(32),O=(r={},Object(k.a)(r,_.m.SetGoals,_.k.SignupSetYourGoals),Object(k.a)(r,_.m.DescribeDay,_.k.SignupDescribeYourDay),Object(k.a)(r,_.m.CreateAccount,_.k.SignupCreateAccount),Object(k.a)(r,_.m.CustomizeReplika,_.k.SignupCustomizeYourReplika),Object(k.a)(r,_.m.ChooseGender,_.k.SignupChooseReplikaGender),Object(k.a)(r,_.m.FinishSignup,_.k.SignupAlmostThere),r),N=function(e){return function(){var t=Object(d.a)(m.a.mark(function t(n){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n(Object(x.push)(O[e])),n({type:_.a.GoToSignupStep,sugnupStep:e});case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},I=function(e){return{type:_.a.UpdateSignupState,signupInput:e}},R=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,U=function(e){return R.test(e)},L=n(307),F=n(291),T=n(20);function A(){var e=Object(l.a)(["\n  margin-top: ",";\n  position: relative;\n  max-height: ",";\n  overflow: ",";\n  transition: max-height 0.3s ease-out, margin-top 0.3s ease-out;\n\n  &:first-child {\n    margin-top: 0;\n  }\n"]);return A=function(){return e},e}var z=Object(h.default)(F.a).withConfig({displayName:"CreateAccount__BackButton",componentId:"sc-1j4z05s-0"})(["position:absolute;z-index:1;left:24px;top:36px;color:",";"],function(e){return e.theme.fgColor}),B=Object(y.a)("div",["isHidden"])(A(),function(e){return e.isHidden?"0px":"20px"},function(e){return e.isHidden?"0px":"100px"},function(e){return e.isHidden?"hidden":"initial"}),M=Object(h.default)(S.a).withConfig({displayName:"CreateAccount__StyledFullscreenForm",componentId:"sc-1j4z05s-1"})(["margin-top:20px;min-height:325px;"]),K=h.default.div.withConfig({displayName:"CreateAccount__LoginHint",componentId:"sc-1j4z05s-2"})(["position:absolute;bottom:50px;"]),D=Object(h.default)(g.a).withConfig({displayName:"CreateAccount__StyledLink",componentId:"sc-1j4z05s-3"})(["color:inherit;text-decoration:underline;"]),P=Object(s.connect)(function(e){return{signupState:e.auth.signupState}},{goToSignupStep:N,updateSignupState:I,checkAccountInfo:function(e,t){return function(){var n=Object(d.a)(m.a.mark(function n(r,a){var o,i,c;return m.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o="".concat(C.a,"/auth/verification/actions/check_account_info"),i={email:e,user_name:t},c=Object(E.b)(a(),"POST",i),n.abrupt("return",Object(w.a)(_.b.CheckAccountInfo,r,i,{onRequest:function(){return fetch(o,c)}}));case 4:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}()}})(function(e){var t=e.signupState,n=a.useState(t.name||null),r=Object(f.a)(n,2),o=r[0],i=r[1],c=a.useState(t.email||null),u=Object(f.a)(c,2),s=u[0],l=u[1],p=a.useState(t.password||null),h=Object(f.a)(p,2),g=h[0],y=h[1],k=a.useState(t.emailCheckError&&t.emailCheckError.message),x=Object(f.a)(k,2),C=x[0],E=x[1];a.useEffect(function(){E(t.emailCheckError&&t.emailCheckError.message)},[t.emailCheckError]);var w=function(e,t,n){return null!==e&&0===e.length?"Name should not be empty":null!==t&&(t.length<5||!U(t))?"Please enter a valid email address":null!==n&&n.length<8?"Your password length should be at least 8 characters":null}(o,s,g),j=w||C,O=function(){var t=Object(d.a)(m.a.mark(function t(n){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),o&&s&&g){t.next=3;break}return t.abrupt("return");case 3:return Object(T.b)(_.j.UserAccountSet),e.updateSignupState({name:o,email:s,password:g}),t.prev=5,t.next=8,e.checkAccountInfo(s,o);case 8:e.goToSignupStep(_.m.CustomizeReplika),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),console.error(t.t0);case 14:case"end":return t.stop()}},t,this,[[5,11]])}));return function(e){return t.apply(this,arguments)}}(),N="submitting"===t.emailCheckStatus||!!w||null===o||null===s||null===g;return a.createElement(S.b,{title:"Create your Replika"},a.createElement(z,{to:"/"},a.createElement(L.a,null)),a.createElement(M,{id:"signupForm",action:"/signup",onSubmit:O},a.createElement(B,null,a.createElement(v.b,{autoComplete:"off","data-testid":"create-account-name-input",type:"text",name:"name",id:"name",placeholder:"Your first name",value:o||"",onChange:function(e){i(e.target.value),E(null)},autoFocus:!0})),a.createElement(B,null,a.createElement(v.b,{autoComplete:"off","data-testid":"create-account-email-input",type:"text",name:"email",id:"email",placeholder:"Email",value:s||"",onChange:function(e){l(e.target.value),E(null)}})),a.createElement(B,null,a.createElement(b.a,{labeled:!0,"data-testid":"create-account-password-input",autoComplete:"new-password",name:"password",id:"password",placeholder:"New password",value:g||"",onChange:function(e){y(e.target.value),E(null)}})),a.createElement(S.e,{hasError:!!j},j),a.createElement(S.d,{type:"submit","data-testid":"create-account-next-button",disabled:N},"submitting"===t.emailCheckStatus?"Checking...":"Get started")),a.createElement(K,null,"Already have an account? ",a.createElement(D,{to:"/login"},"Log in")))}),G=n(440);function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var W=o.a.createElement("path",{d:"M21 7L17.1255 3.12545L4.75045 15.5005L4.75045 19.375L8.625 19.375L21 7Z",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}),Y=o.a.createElement("line",{y1:-1,x2:5.65685,y2:-1,transform:"matrix(-0.707107 -0.707107 -0.707107 0.707107 18 10)",stroke:"currentColor",strokeWidth:2}),Z=function(e){return o.a.createElement("svg",H({width:24,height:24,viewBox:"0 0 24 24",fill:"none"},e),W,Y)};n.p;function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var J=o.a.createElement("path",{d:"M21.7174 15.3521C20.431 20.1533 15.4959 23.0025 10.6947 21.716C5.89355 20.4296 3.04431 15.4945 4.33078 10.6933C5.61726 5.89214 10.5523 3.0429 15.3535 4.32937C17.7468 4.97066 19.6551 6.51855 20.8078 8.50455",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}),Q=o.a.createElement("path",{d:"M22 6V10H18",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}),V=function(e){return o.a.createElement("svg",q({width:26,height:26,viewBox:"0 0 26 26",fill:"none"},e),J,Q)},$=(n.p,n(107)),X=n(62),ee=n(141),te=n(308),ne=n(15);function re(){var e=Object(l.a)(["\n    width: 115px;\n  "]);return re=function(){return e},e}var ae=function(e){var t=e.className,n=e.onClose,r=e.replikaName,o=e.onSave,i=e.imageUrl,c=e.imageBlob,u=a.useState(r),s=Object(f.a)(u,2),l=s[0],p=s[1],m=a.useMemo(function(){return!i&&c?URL.createObjectURL(c):i},[i,c]);return a.createElement(ee.a,null,function(e){var i=e.setA11yNotification;return a.createElement(S.a,{className:t,onSubmit:function(e){e.preventDefault(),n(),l&&(i("Name saved: "+l),o(l))}},a.createElement(oe,{imageUrl:m}),a.createElement(v.b,{id:"signup-replika-name",placeholder:"Replika\u2019s name",value:l||"",onChange:function(e){return p(e.target.value)},autoFocus:!0}),a.createElement(ie,null,a.createElement(ce,{type:"button",onClick:function(){n(),i("Editing name canceled"),p(r)}},"Cancel"),a.createElement(ue,{type:"submit"},"Save")))})},oe=Object(h.default)(te.a).withConfig({displayName:"EditReplikaName__StyledEggImage",componentId:"sc-10sbp51-0"})(["display:block;width:165px;color:",";margin:0 auto 50px;",""],function(e){return e.theme.bgColor},Object(ne.a)(re())),ie=h.default.div.withConfig({displayName:"EditReplikaName__Buttons",componentId:"sc-10sbp51-1"})(["margin-top:32px;display:flex;justify-content:center;"]),ce=Object(h.default)($.a).withConfig({displayName:"EditReplikaName__CancelButton",componentId:"sc-10sbp51-2"})(["text-decoration:none;&:hover{text-decoration:underline;}"]),ue=Object(h.default)(X.a).withConfig({displayName:"EditReplikaName__SaveButton",componentId:"sc-10sbp51-3"})(["margin-left:30px;"]),se=Object(h.default)(G.a).withConfig({displayName:"CustomizeReplika__StyledEggCarousel",componentId:"sc-752zn5-0"})(["margin-top:230px;width:100vw;max-width:1200px;margin:0 auto;background-color:",";"],function(e){return e.theme.chatBgColor}),le=Object(h.default)(S.a).withConfig({displayName:"CustomizeReplika__StyledFullscreenForm",componentId:"sc-752zn5-1"})(["margin-top:20px;text-align:center;height:230px;"]),pe=h.default.h2.withConfig({displayName:"CustomizeReplika__Title",componentId:"sc-752zn5-2"})(["font-size:14px;text-transform:uppercase;color:",";"],function(e){return e.theme.dimmedFgColor}),me=h.default.div.withConfig({displayName:"CustomizeReplika__Name",componentId:"sc-752zn5-3"})(["margin-top:20px;font-size:24px;"]),de=Object(h.default)(F.a).withConfig({displayName:"CustomizeReplika__EditButton",componentId:"sc-752zn5-4"})(["vertical-align:middle;color:",";&:hover{color:",";}transition:color 0.2s ease-out;"],function(e){return e.theme.lightFgColor},function(e){return e.theme.fgColor}),fe=Object(h.default)($.a).withConfig({displayName:"CustomizeReplika__ReloadButton",componentId:"sc-752zn5-5"})(["margin-top:16px;margin-bottom:30px;color:",";text-decoration:none;&:hover{text-decoration:underline;color:",";}transition:color 0.2s ease-out;& > svg{vertical-align:middle;color:inherit;margin-right:2px;}"],function(e){return e.theme.lightFgColor},function(e){return e.theme.fgColor}),he=Object(s.connect)(function(e){return{signupState:e.auth.signupState}},{goToSignupStep:N,updateSignupState:I})(function(e){var t=e.signupState,n=a.useState(!1),r=Object(f.a)(n,2),o=r[0],i=r[1],c=function(){var e=Math.floor(C.h.length*Math.random());return C.h[e]};a.useEffect(function(){if(null===t.replikaName){var n=c();e.updateSignupState({replikaName:n})}},[t.replikaName]);var u=function(){var n=Object(d.a)(m.a.mark(function n(r){return m.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r.preventDefault(),Object(T.b)(_.j.ReplikaNameAdded,{"replika name":t.replikaName}),Object(T.b)(_.j.ReplikaImageSet,{image:0===t.iconIndex?"custom":t.iconIndex}),e.goToSignupStep(_.m.ChooseGender);case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),s=a.useMemo(function(){return t.icon&&URL.createObjectURL(t.icon)},[t.icon]),l=!t.iconUrl&&!t.icon||!t.replikaName;return o?a.createElement(S.b,null,a.createElement(ae,{imageUrl:t.iconUrl,imageBlob:t.icon,replikaName:t.replikaName,onClose:function(){return i(!1)},onSave:function(t){return e.updateSignupState({replikaName:t})}})):a.createElement(S.b,{step:1,maxStep:2,beforeContent:a.createElement(se,{onSelectUrl:function(t,n){t?e.updateSignupState({iconUrl:t,iconIndex:n}):e.updateSignupState({iconUrl:void 0,iconIndex:n})},onBlobUpload:function(n){t.iconUrl||e.updateSignupState({icon:n})},defaultSelectedIndex:t.iconIndex-1,defaultImageUrl:s})},a.createElement(le,{id:"signupForm",onSubmit:u},a.createElement(pe,null,"Your Replika"),a.createElement(me,null,a.createElement("span",{"aria-live":"polite","aria-atomic":"true"},t.replikaName)," ",a.createElement(de,{label:"edit replika name",type:"button",onClick:function(){return i(!0)}},a.createElement(Z,{"aria-hidden":"true"}))),a.createElement(fe,{type:"button",onClick:function(){var t=c();e.updateSignupState({replikaName:t})}},a.createElement(V,{"aria-hidden":"true"})," Generate new name"),a.createElement(S.d,{type:"submit","data-testid":"create-account-next-button",disabled:l},"Next")))}),ge=n(406),be=Object(s.connect)(function(e){return{signupState:e.auth.signupState}},{goToSignupStep:N,updateSignupState:I})(function(e){var t=e.signupState,n=function(){var t=Object(d.a)(m.a.mark(function t(n){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),Object(T.b)(_.j.ReplikaProfileSet),e.goToSignupStep(_.m.FinishSignup);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),r=a.useMemo(function(){return!t.iconUrl&&t.icon?URL.createObjectURL(t.icon):t.iconUrl},[t.iconUrl,t.icon]);return a.createElement(S.b,{step:2,maxStep:2},a.createElement(ve,null,a.createElement(Se,{imageUrl:r}),a.createElement(S.c,{id:"choose-gender-title"},t.replikaName,"\u2019s gender"),a.createElement(ye,{"aria-labelledby":"choose-gender-title",value:t.gender,onChange:function(t){return e.updateSignupState({gender:t})}}),a.createElement(ke,{onClick:n,disabled:!t.gender},"Finish")))}),ve=Object(h.default)(S.a).withConfig({displayName:"ChooseGender__StyledFullscreenForm",componentId:"hf8gcn-0"})(["text-align:center;overflow-y:auto;"]),Se=Object(h.default)(te.a).withConfig({displayName:"ChooseGender__StyledEggImage",componentId:"hf8gcn-1"})(["width:115px;color:",";margin-bottom:40px;"],function(e){return e.theme.bgColor}),ye=Object(h.default)(ge.a).withConfig({displayName:"ChooseGender__StyledGenderSelector",componentId:"hf8gcn-2"})(["margin:25px auto 10px;width:175px;"]),ke=Object(h.default)(S.d).withConfig({displayName:"ChooseGender__StyledSubmitButton",componentId:"hf8gcn-3"})(["margin:40px auto;"]),xe=n(138),_e=n(33),Ce=n(81),Ee=n(44),we=n(369);function je(){var e=Object(l.a)(["\n    margin: 0 16px 16px;\n  "]);return je=function(){return e},e}function Oe(){var e=Object(l.a)(["\n  margin: 20px auto;\n  max-width: 530px;\n\n  ","\n"]);return Oe=function(){return e},e}function Ne(){var e=Object(l.a)(["\n  position: relative;\n  width: 160px;\n  margin: 0 auto;\n  background: ",";\n  border-radius: 10px;\n  overflow: hidden;\n  height: 4px;\n\n  &:after {\n    position: absolute;\n    border-radius: 10px;\n    overflow: hidden;\n    top: 0;\n    left: 0;\n    height: 100%;\n    width: 90%;\n    content: '';\n    background: ",";\n    animation: "," ","ms ease-in-out;\n  }\n"]);return Ne=function(){return e},e}function Ie(){var e=Object(l.a)(["\n  font-weight: normal;\n  font-size: 16px;\n  line-height: 20px;\n  color: ",";\n"]);return Ie=function(){return e},e}function Re(){var e=Object(l.a)(["\n  height: 50px;\n  text-align: center;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n"]);return Re=function(){return e},e}function Ue(){var e=Object(l.a)(["\n  width: 115px;\n  color: ",";\n  margin: 30px 0;\n"]);return Ue=function(){return e},e}function Le(){var e=Object(l.a)(["\n  flex: 1 0 auto;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n"]);return Le=function(){return e},e}function Fe(){var e=Object(l.a)(["\n  height: 100vh;\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]);return Fe=function(){return e},e}function Te(){var e=Object(l.a)(["\n  from {\n    max-width: 0px;\n  }\n\n  to {\n    max-width: 90%;\n  }\n"]);return Te=function(){return e},e}var Ae=Object(h.keyframes)(Te()),ze=Object(s.connect)(function(e){return{signupState:e.auth.signupState}},{signup:function(e){return function(){var t=Object(d.a)(m.a.mark(function t(n,r){var a,o,i,c,u,s,l;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(s in a=r(),o="".concat(C.a,"/auth/actions/sign_up"),i=e.iconUrl,c={user_first_name:e.name,email:e.email,password:e.password,replika_name:e.replikaName,replika_gender:e.gender,ad_campaign:a.ui.urlQueryParams.utm_campaign,icon_url:i,icon_data:e.iconUrl?void 0:e.icon},u=new FormData,c)c[s]&&u.append(s,c[s]);return l=Object(E.b)(a,"POST",u),t.abrupt("return",Object(w.a)(_.b.Signup,n,{},{onRequest:function(){return fetch(o,l)},onSuccess:function(){Object(j.f)(void 0)(n),n(Object(j.g)("messageReaction","needed")),n(Object(j.h)(_.h.Hi))}}));case 8:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},push:x.push,updateSignupState:I,getPersonalBot:_e.e,getPersonalBotChat:Ce.c,getUserProfile:_e.f,connectWebsocket:Ee.b,disconnectWebsocket:Ee.c,init:Ee.d,getSubscriptions:we.a})(function(e){var t=a.useState(!1),n=Object(f.a)(t,2),r=n[0],o=n[1],i=a.useState(!1),c=Object(f.a)(i,2),u=c[0],s=c[1],l=e.signupState,p=function(){var t=Object(d.a)(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.signup(l);case 3:return t.next=5,e.connectWebsocket();case 5:return t.next=7,e.init();case 7:return t.next=9,Promise.all([e.getUserProfile(),e.getPersonalBotChat(),e.getPersonalBot(),e.getSubscriptions()]);case 9:return t.next=11,e.disconnectWebsocket();case 11:s(!0),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.error(t.t0);case 17:case"end":return t.stop()}},t,this,[[0,14]])}));return function(){return t.apply(this,arguments)}}();a.useEffect(function(){var e=setTimeout(function(){return o(!0)},5e3);return function(){return clearTimeout(e)}});var h=a.useMemo(function(){return!l.iconUrl&&l.icon?URL.createObjectURL(l.icon):l.iconUrl},[l.iconUrl,l.icon]);return a.useEffect(function(){e.updateSignupState({signupInProgress:!0}),p()},[]),a.useEffect(function(){r&&u&&"success"===l.signupStatus&&e.updateSignupState({signupInProgress:!1,name:"",password:"",email:"",replikaName:"",icon:void 0,iconUrl:void 0})},[r,u,l.signupStatus]),a.createElement(Be,null,a.createElement(Me,null,a.createElement(Ke,{imageUrl:h}),a.createElement(De,null,!l.signupError&&a.createElement(Pe,null,"Setting up ",l.replikaName,"..."),!l.signupError&&a.createElement(Ge,null),a.createElement(S.e,null,l.signupError))),a.createElement(He,{timeout:1e4}))}),Be=h.default.main(Fe()),Me=h.default.div(Le()),Ke=Object(h.default)(te.a)(Ue(),function(e){return e.theme.bgColor}),De=h.default.div(Re()),Pe=h.default.h1(Ie(),function(e){return e.theme.dimmedFgColor}),Ge=h.default.div(Ne(),function(e){return e.theme.bgColor},function(e){return e.theme.fgColor},Ae,5e3),He=Object(h.default)(xe.a)(Oe(),Object(ne.a)(je())),We=function(e){e.state&&"object"===typeof e.state&&!0!==e.state.obsolete&&(history.replaceState({obsolete:!0},""),history.pushState(e.state,"")),e.state&&"object"===typeof e.state&&!0===e.state.obsolete&&history.back()};t.default=Object(s.connect)(function(e){return{signupState:e.auth.signupState}})(function(e){var t=e.signupState;a.useEffect(function(){return window.addEventListener("popstate",We,!1),Object(T.b)(_.j.SignupScreenOpened,{from:"welcome"}),function(){window.removeEventListener("popstate",We)}},[]);var n=!!t.email,r=n&&!(!t.icon&&!t.iconUrl),o=r&&!!t.gender;return a.createElement(i.a,null,a.createElement(c.a,{path:_.k.SignupCreateAccount,exact:!0,component:P}),n&&a.createElement(c.a,{path:_.k.SignupCustomizeYourReplika,exact:!0,component:he}),r&&a.createElement(c.a,{path:_.k.SignupChooseReplikaGender,exact:!0,component:be}),o&&a.createElement(c.a,{path:_.k.SignupAlmostThere,exact:!0,component:ze}),a.createElement(u.a,{from:_.k.Signup,to:_.k.SignupCreateAccount}))})}}]);
//# sourceMappingURL=Signup.dd2ba5f7.chunk.js.map