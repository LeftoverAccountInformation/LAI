function checkFirstLaunch(){$("#splash").remove()}function formattedDate(e,t){try{var n=Date.fromISO(e);if("short"===t)return SHORT_MONTHS[n.getMonth()]+" "+n.getDate();if("relative"===t){var i=new Date,s=new Date(new Date-864e5),a=new Date-5184e5;return n.getFullYear()==i.getFullYear()&&n.getMonth()==i.getMonth()&&n.getDate()==i.getDate()?App.t("today").toLowerCase():n.getFullYear()==s.getFullYear()&&n.getMonth()==s.getMonth()&&n.getDate()==s.getDate()?App.t("yesterday").toLowerCase():n>a?DAYS[n.getDay()]:SHORT_MONTHS[n.getMonth()]+" "+n.getDate()}return MONTHS[n.getMonth()]+" "+n.getDate()+", "+n.getFullYear()}catch(r){return e}}function guess_category(e){return null==e?18:(e=e.toLowerCase(),null!=e.match(/\brent\b|\broom\b|\broomrent\b|\bmiete\b/)?3:null!=e.match(/\bmortgage\b/)?4:null!=e.match(/\belec|\bpg&e\b|\bpower\b|\benergy\b|\bcomed\b|\bnstar\b|\bpge\b|\bpg\b|\bxcel\b|\bpeco\b|\belectricity\b|\btabak\b|\bstrom\b|\bstromrechnung\b|\benergie\b/)?5:null!=e.match(/\bheat|\bcylinder\b|cooking gas/)?6:null!=e.match(/\binternet\b|\bcomcast\b|\batt\b|\bat&t\b|\bat\b&\bt\b|\bcable\b|\bphone\b|\bnet\b|\btime\b|\bverizon\b|\bwarner\b|\btwc\b|\bcox\b|\bbroadband\b|\bwifi\b|\brcn\b|\bvonage\b|\btmobile\b|\bsprint\b|\bt-mobile\b|\bmodem\b|\bmobile\b|\brecharge\b|\bairtel\b|\breliance\b|\btata docomo\b|\btata sky\b|\btatasky\b|\bvoda|\bgez\b|\bo2\b/)?8:null!=e.match(/\bparking\b|\bparken\b/)?9:null!=e.match(/\binsurance\b|\brenters\b|\bversicherung\b/)?10:null!=e.match(/\bnetflix\b|\butility\b|\bhulu\b|\bac\b/)?11:null!=e.match(/\bgroceries\b|\bmilk\b|\bgrocery\b|\bchicken\b|\bsafeway\b|\bbread\b|\beggs\b|\bstore\b|\bmarket\b|\bpatel\b|\bbaza|\bcurd\b|\bveg\b|\bvegetables\b|\bkroger\b|\bbazz\b|\bbaaz|\bchips\b|\boil\b|\bshop\b|\bjuice\b|\btesco\b|\bfoods\b|\bapna\b|\bveggies\b|\bwhole\b|\bbanana\b|\bfruits\b|\bmart\b|\byogurt\b|\baldi\b|\bonion\b|\bstores\b|\bonions\b|\bpasta\b|\bshoprite\b|\bbasket\b|\bmilk\b|\bhoney\b|\bbananas\b|\bhalal\b|\bsalt\b|\bbutter\b|\bjoes\b|\begg\b|\bapple\b|\bmeijer\b|\bgarlic\b|\bmeyer\b|\bsupermarket\b|\bjoe's\b|\bpotato\b|\bicc\b|\bginger\b|\bolive\b|\bcheese\b|\bstrawberry\b|\bcereal\b|\bapples\b|\bwegmans\b|\bmutton\b|\bpopcorn\b|\bturkey\b|\bfarmers\b|\bwinco\b|\bbuttermilk\b|\bthanksgiving\b|\bfruit\b|\bbeans\b|\bcola\b|\bwholefoods\b|\bwhole\bfoods\b|\bcream\b|\bcurd\b|\bdahi\b|\btomato\b|\bmaggi\b|\batta\b|\bgrofers\b|\bsabzi\b|\bcoconut\b|\blemon\b|\bvim\b|\bsurf\b|\bpoha\b|\bbigbasket\b|\bbig basket\b|\bdudh\b|\bsoda\b|\bghee\b|\bwatermelon\b|\btamatar\b|\bcold drink|\bnimbu pani\b|\btata fresh\b|\bstar bazar\b|\bstar bazaar\b|\bstar bazzar\b|\bsainsbury|\brewe\b|\baldi\b|\blidl\b|\bnetto\b|\bedeka\b|\bkaufland\b|\bflotte\b|\balnatura\b|\bspar\b|\bspesa\b|\blebensmittel\b|\bmarktkauf\b|\bmirchi\b|\bcoles\b|\bspesa\b|\bcarrefour\b|\beinkauf\b|\beink\xe4ufe\b|\bb\xe4cker\b|\bbaecker\b|\bmilch\b|\beinkaufen\b|\bbr\xf6tchen\b|\bsupermarkt\b|\bbrot\b|\bwasser\b|\bkarotte\b|\bmarkt\b|\bcurd\b|\bk\xe4se\b|\bobst\b|\bfleisch\b|\boliven\xf6l\b|\bmetzger\b|\bgem\xfcse\b|\beier\b|\bzwiebeln\b|\bpilze\b|\berdbeeren\b|\bessig\b/)?12:null!=e.match(/\bdinner\b|\blunch\b|\bpizza\b|\bindian\b|\bbreakfast\b|\bcoffee\b|\bsubway\b|\btea\b|\bcafe\b|\bgarden\b|\btaco\b|\bthai\b|\bstarbucks\b|\bchinese\b|\bchipotle\b|\bcurry\b|\bbombay\b|\bchat\b|\bbuffet\b|\bihop\b|\bsandwich\b|\bdiner\b|\btiffin\b|\bbfast\b|\btacos\b|\btavern\b|\bbagel\b|donalds\b|\bdunkin\b|\bbrunch\b|\bgelato\b|\brestaurant\b|\bdonuts\b|\bwendys\b|\bkfc\b|\bburger\b|\bpanera\b|\bdominoes\b|\bdomino|\bpapa\b|\bsushi\b|\bsabji\b|\bbiryani\b|\bdosa\b|\bcurries\b|\broti\b|\bshake\b|\bchai\b|\blassi\b|\blasi\b|\bcurry\b|\btiffin\b|\bmcd|\bsamosa\b|\bparatha\b|\bbiriyani\b|\bcanteen\b|\bmomo\b|\bcold coffee\b|\bchayoos\b|\bpani puri\b|\bvapiano\b|\bessen\b|\bfr\xfchst\xfcck\b|\bkaffe\b|\bkaffee\b|\babendessen\b|\bd\xf6ner\b|\bdoner\b|\bmittagessen\b|\bmittag\b|\bmensa\b|\bsalat\b|\bkuchen\b|\bcaf\xe9\b|\bpommes\b|\btee\b|\babend\b|\bnudeln\b|\bitaliener\b/)?13:null!=e.match(/\bwalmart\b|\bcostco\b|\btarget\b|\bpaper\b|\btoilet\b|\bdish\b|\bdollar\b|\bkitchen\b|\bcvs\b|\btide\b|\btowels\b|\bdetergent\b|\bwalgreens\b|\bliquid\b|\btp\b|\bsam's\b|\btoothpaste\b|\bbathroom\b|\bbath\b|\bvacuum\b|\bshampoo\b|\bhousehold\b|\bwal-mart\b|\bshower\b|\btissue\b|\bfilter\b|\bfoil\b|\bgloves\b|\bdmart\b|\bhandwash\b|\brossmann\b|\bklopapier\b|\btoilettenpapier\b|\bm\xfcllbeutel\b/)?14:null!=e.match(/\bcar\b|\bauto\b|\bzipcar\b|\bzip\b|\benterprise\b|\bmaut\b|\bmietwagen\b/)?15:null!=e.match(/\bikea\b|\bmattress\b|\bbed\b|\btable\b|\bbj's\b|\bcouch\b|\bfridge\b|\bpillow\b/)?16:null!=e.match(/\brepair\b|\bmaintenance\b|\bhornbach\b/)?17:null!=e.match(/\bpoker\b/)?20:null!=e.match(/\bmovies?\b|\bamc\b|\bcinema\b|\bkino\b/)?21:null!=e.match(/\bmusic\b|\bconcert|\bspotify\b|\bdeezer\b/)?22:null!=e.match(/\bentry\b|\bhookah\b|\bcig|\bcasino\b|\bcamping\b/)?23:null!=e.match(/\bgolf\b|\bgym\b|\bbowling\b/)?24:null!=e.match(/\bsnack/)?26:null!=e.match(/\bwashing\b|\bbooks\b|\bkeys\b|\bprime\b/)?28:null!=e.match(/\bdogs?\b|\bcats?\b|\bpets?\b/)?29:null!=e.match(/\blaundry\b|\bcook\b|\bhaushaltsengel\b/)?30:null!=e.match(/\bbus\b|\bbuses\b|\bbusses\b|\btrains?\b|\brail\b|\bmegabus\b|\bgreyhound\b|\bbahn\b|\bzug\b/)?32:null!=e.match(/\bfuel\b|\bpetrol\b|\bchevron\b|\bgasoline\b|\bshell\b|\btanken\b|\btanke\b|\bbenzin\b|\bdiesel\b/)?33:null!=e.match(/\btravel\b|\brides?\b|\btoll\b/)?34:null!=e.match(/\bplane\b|\bjetblue\b|\bairline\b|\bairlines\b|\bflight/)?35:null!=e.match(/\btaxis?\b|\bcabs?\b|\btaxicabs?\b|\bubers?\b|\blyfts?\b|\bolas?\b|\bflughafen\b|\btuk\b/)?36:null!=e.match(/\btrash\b|\bgarbage\b/)?37:null!=e.match(/\bbeer|\bdrink|\bparty\b|\bbar\b|\bwine\b|\bliquor\b|\bbooze\b|\balcohol\b|\bshots\b|\bpub\b|\bwhiskey\b|\bbier\b|\bwein\b|\bgetr\xe4nke\b|\bwg\b|\balkohol\b|\btrinken\b/)?38:null!=e.match(/\blaptop\b|\bprinter\b|\bhdmi\b|\bfrys\b|\bkabel\b/)?39:null!=e.match(/\bclothing\b|\bshirt\b|\bclothes\b|\bshoes\b|\bmacys\b|\bkohls\b|\bgap\b|\bsocken\b/)?41:null!=e.match(/\bcake\b|\bgift\b|\bbday\b|\bgeschenk\b|\bhochzeit\b|\bgeburtstag\b|\bgeschenke\b/)?42:null!=e.match(/\bmedicines\b|\bmedicine\b|\bmedical\b|\bapotheke\b/)?43:null!=e.match(/\bfedex\b|\bmassage\b/)?44:null!=e.match(/\bbikes?\b|\bbicycles?\b/)?46:null!=e.match(/\bhotel|\bairbnb|\binns?\b|\bhostel\b|\bunterkunft\b|\b\xfcbernachtung\b/)?47:null!=e.match(/\bcleaning\b|\bmaid\b|\bcleaner|\bbai\b|\bsafai\b|\bputzfrau\b/)?48:null!=e.match(/\bgas\b/)?null!=e.match(/bill|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|\bco\b|\bnatural\b/)?6:(null!=e.match(/\bto\b|\bfrom\b|\boff\b|\btrip\b|\bbefore\b|\bgallon\b|\bliter\b/),33):null!=e.match(/\bwater\b/)?null!=e.match(/\bbottle\b|\bcan|mineral|sparkling|seltzer/)?12:(null!=e.match(/bill|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/),7):null!=e.match(/\bconservice/)?11:18)}function initTranslations(e,t){var n=/(?:%@)|(?:%(\d+)\$@)/g;App.t=function(){var i,s,a,r;return i=arguments[0],s=arguments.length>=2?Array.prototype.slice.call(arguments,1):[],void 0===(a=e[i])&&void 0===(a=t[i])?i:(0!==s.length&&(a=a.replace(n,function(e,t){return r=t?s[t-1]:s.shift(),r instanceof TranslationString?r.toString():_.escape(r)})),a)}}function TranslationString(e){this._content=e,this._leftTags="",this._rightTags=""}function S(e){return new TranslationString(e)}!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t=!!e&&"length"in e&&e.length,n=he.type(e);return"function"===n||he.isWindow(e)?!1:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function i(e,t,n){if(he.isFunction(t))return he.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return he.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(Ae.test(t))return he.filter(t,e,n);t=he.filter(t,e)}return he.grep(e,function(e){return he.inArray(e,t)>-1!==n})}function s(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function a(e){var t={};return he.each(e.match(Ee)||[],function(e,n){t[n]=!0}),t}function r(){ie.addEventListener?(ie.removeEventListener("DOMContentLoaded",o),e.removeEventListener("load",o)):(ie.detachEvent("onreadystatechange",o),e.detachEvent("onload",o))}function o(){(ie.addEventListener||"load"===e.event.type||"complete"===ie.readyState)&&(r(),he.ready())}function l(e,t,n){if(void 0===n&&1===e.nodeType){var i="data-"+t.replace(Re,"-$1").toLowerCase();if(n=e.getAttribute(i),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Fe.test(n)?he.parseJSON(n):n}catch(s){}he.data(e,t,n)}else n=void 0}return n}function p(e){var t;for(t in e)if(("data"!==t||!he.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function c(e,t,n,i){if(De(e)){var s,a,r=he.expando,o=e.nodeType,l=o?he.cache:e,p=o?e[r]:e[r]&&r;if(p&&l[p]&&(i||l[p].data)||void 0!==n||"string"!=typeof t)return p||(p=o?e[r]=ne.pop()||he.guid++:r),l[p]||(l[p]=o?{}:{toJSON:he.noop}),("object"==typeof t||"function"==typeof t)&&(i?l[p]=he.extend(l[p],t):l[p].data=he.extend(l[p].data,t)),a=l[p],i||(a.data||(a.data={}),a=a.data),void 0!==n&&(a[he.camelCase(t)]=n),"string"==typeof t?(s=a[t],null==s&&(s=a[he.camelCase(t)])):s=a,s}}function u(e,t,n){if(De(e)){var i,s,a=e.nodeType,r=a?he.cache:e,o=a?e[he.expando]:he.expando;if(r[o]){if(t&&(i=n?r[o]:r[o].data)){he.isArray(t)?t=t.concat(he.map(t,he.camelCase)):t in i?t=[t]:(t=he.camelCase(t),t=t in i?[t]:t.split(" ")),s=t.length;for(;s--;)delete i[t[s]];if(n?!p(i):!he.isEmptyObject(i))return}(n||(delete r[o].data,p(r[o])))&&(a?he.cleanData([e],!0):ue.deleteExpando||r!=r.window?delete r[o]:r[o]=void 0)}}}function d(e,t,n,i){var s,a=1,r=20,o=i?function(){return i.cur()}:function(){return he.css(e,t,"")},l=o(),p=n&&n[3]||(he.cssNumber[t]?"":"px"),c=(he.cssNumber[t]||"px"!==p&&+l)&&Oe.exec(he.css(e,t));if(c&&c[3]!==p){p=p||c[3],n=n||[],c=+l||1;do a=a||".5",c/=a,he.style(e,t,c+p);while(a!==(a=o()/l)&&1!==a&&--r)}return n&&(c=+c||+l||0,s=n[1]?c+(n[1]+1)*n[2]:+n[2],i&&(i.unit=p,i.start=c,i.end=s)),s}function h(e){var t=Ue.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function f(e,t){var n,i,s=0,a="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):void 0;if(!a)for(a=[],n=e.childNodes||e;null!=(i=n[s]);s++)!t||he.nodeName(i,t)?a.push(i):he.merge(a,f(i,t));return void 0===t||t&&he.nodeName(e,t)?he.merge([e],a):a}function m(e,t){for(var n,i=0;null!=(n=e[i]);i++)he._data(n,"globalEval",!t||he._data(t[i],"globalEval"))}function g(e){qe.test(e.type)&&(e.defaultChecked=e.checked)}function _(e,t,n,i,s){for(var a,r,o,l,p,c,u,d=e.length,_=h(t),b=[],v=0;d>v;v++)if(r=e[v],r||0===r)if("object"===he.type(r))he.merge(b,r.nodeType?[r]:r);else if(Je.test(r)){for(l=l||_.appendChild(t.createElement("div")),p=(ze.exec(r)||["",""])[1].toLowerCase(),u=He[p]||He._default,l.innerHTML=u[1]+he.htmlPrefilter(r)+u[2],a=u[0];a--;)l=l.lastChild;if(!ue.leadingWhitespace&&We.test(r)&&b.push(t.createTextNode(We.exec(r)[0])),!ue.tbody)for(r="table"!==p||Ve.test(r)?"<table>"!==u[1]||Ve.test(r)?0:l:l.firstChild,a=r&&r.childNodes.length;a--;)he.nodeName(c=r.childNodes[a],"tbody")&&!c.childNodes.length&&r.removeChild(c);for(he.merge(b,l.childNodes),l.textContent="";l.firstChild;)l.removeChild(l.firstChild);l=_.lastChild}else b.push(t.createTextNode(r));for(l&&_.removeChild(l),ue.appendChecked||he.grep(f(b,"input"),g),v=0;r=b[v++];)if(i&&he.inArray(r,i)>-1)s&&s.push(r);else if(o=he.contains(r.ownerDocument,r),l=f(_.appendChild(r),"script"),o&&m(l),n)for(a=0;r=l[a++];)Be.test(r.type||"")&&n.push(r);return l=null,_}function b(){return!0}function v(){return!1}function y(){try{return ie.activeElement}catch(e){}}function w(e,t,n,i,s,a){var r,o;if("object"==typeof t){"string"!=typeof n&&(i=i||n,n=void 0);for(o in t)w(e,o,n,i,t[o],a);return e}if(null==i&&null==s?(s=n,i=n=void 0):null==s&&("string"==typeof n?(s=i,i=void 0):(s=i,i=n,n=void 0)),s===!1)s=v;else if(!s)return e;return 1===a&&(r=s,s=function(e){return he().off(e),r.apply(this,arguments)},s.guid=r.guid||(r.guid=he.guid++)),e.each(function(){he.event.add(this,t,s,i,n)})}function x(e,t){return he.nodeName(e,"table")&&he.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function A(e){return e.type=(null!==he.find.attr(e,"type"))+"/"+e.type,e}function k(e){var t=st.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function S(e,t){if(1===t.nodeType&&he.hasData(e)){var n,i,s,a=he._data(e),r=he._data(t,a),o=a.events;if(o){delete r.handle,r.events={};for(n in o)for(i=0,s=o[n].length;s>i;i++)he.event.add(t,n,o[n][i])}r.data&&(r.data=he.extend({},r.data))}}function T(e,t){var n,i,s;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!ue.noCloneEvent&&t[he.expando]){s=he._data(t);for(i in s.events)he.removeEvent(t,i,s.handle);t.removeAttribute(he.expando)}"script"===n&&t.text!==e.text?(A(t).text=e.text,k(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),ue.html5Clone&&e.innerHTML&&!he.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&qe.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function C(e,t,n,i){t=ae.apply([],t);var s,a,r,o,l,p,c=0,u=e.length,d=u-1,h=t[0],m=he.isFunction(h);if(m||u>1&&"string"==typeof h&&!ue.checkClone&&it.test(h))return e.each(function(s){var a=e.eq(s);m&&(t[0]=h.call(this,s,a.html())),C(a,t,n,i)});if(u&&(p=_(t,e[0].ownerDocument,!1,e,i),s=p.firstChild,1===p.childNodes.length&&(p=s),s||i)){for(o=he.map(f(p,"script"),A),r=o.length;u>c;c++)a=p,c!==d&&(a=he.clone(a,!0,!0),r&&he.merge(o,f(a,"script"))),n.call(e[c],a,c);if(r)for(l=o[o.length-1].ownerDocument,he.map(o,k),c=0;r>c;c++)a=o[c],Be.test(a.type||"")&&!he._data(a,"globalEval")&&he.contains(l,a)&&(a.src?he._evalUrl&&he._evalUrl(a.src):he.globalEval((a.text||a.textContent||a.innerHTML||"").replace(at,"")));p=s=null}return e}function $(e,t,n){for(var i,s=t?he.filter(t,e):e,a=0;null!=(i=s[a]);a++)n||1!==i.nodeType||he.cleanData(f(i)),i.parentNode&&(n&&he.contains(i.ownerDocument,i)&&m(f(i,"script")),i.parentNode.removeChild(i));return e}function E(e,t){var n=he(t.createElement(e)).appendTo(t.body),i=he.css(n[0],"display");return n.detach(),i}function N(e){var t=ie,n=pt[e];return n||(n=E(e,t),"none"!==n&&n||(lt=(lt||he("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(lt[0].contentWindow||lt[0].contentDocument).document,t.write(),t.close(),n=E(e,t),lt.detach()),pt[e]=n),n}function j(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function D(e){if(e in kt)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=At.length;n--;)if(e=At[n]+t,e in kt)return e}function F(e,t){for(var n,i,s,a=[],r=0,o=e.length;o>r;r++)i=e[r],i.style&&(a[r]=he._data(i,"olddisplay"),n=i.style.display,t?(a[r]||"none"!==n||(i.style.display=""),""===i.style.display&&Ie(i)&&(a[r]=he._data(i,"olddisplay",N(i.nodeName)))):(s=Ie(i),(n&&"none"!==n||!s)&&he._data(i,"olddisplay",s?n:he.css(i,"display"))));for(r=0;o>r;r++)i=e[r],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?a[r]||"":"none"));return e}function R(e,t,n){var i=yt.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function M(e,t,n,i,s){for(var a=n===(i?"border":"content")?4:"width"===t?1:0,r=0;4>a;a+=2)"margin"===n&&(r+=he.css(e,n+Pe[a],!0,s)),i?("content"===n&&(r-=he.css(e,"padding"+Pe[a],!0,s)),"margin"!==n&&(r-=he.css(e,"border"+Pe[a]+"Width",!0,s))):(r+=he.css(e,"padding"+Pe[a],!0,s),"padding"!==n&&(r+=he.css(e,"border"+Pe[a]+"Width",!0,s)));return r}function O(e,t,n){var i=!0,s="width"===t?e.offsetWidth:e.offsetHeight,a=ft(e),r=ue.boxSizing&&"border-box"===he.css(e,"boxSizing",!1,a);if(0>=s||null==s){if(s=mt(e,t,a),(0>s||null==s)&&(s=e.style[t]),ut.test(s))return s;i=r&&(ue.boxSizingReliable()||s===e.style[t]),s=parseFloat(s)||0}return s+M(e,t,n||(r?"border":"content"),i,a)+"px"}function P(e,t,n,i,s){return new P.prototype.init(e,t,n,i,s)}function I(){return e.setTimeout(function(){St=void 0}),St=he.now()}function L(e,t){var n,i={height:e},s=0;for(t=t?1:0;4>s;s+=2-t)n=Pe[s],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function q(e,t,n){for(var i,s=(W.tweeners[t]||[]).concat(W.tweeners["*"]),a=0,r=s.length;r>a;a++)if(i=s[a].call(n,t,e))return i}function z(e,t,n){var i,s,a,r,o,l,p,c,u=this,d={},h=e.style,f=e.nodeType&&Ie(e),m=he._data(e,"fxshow");n.queue||(o=he._queueHooks(e,"fx"),null==o.unqueued&&(o.unqueued=0,l=o.empty.fire,o.empty.fire=function(){o.unqueued||l()}),o.unqueued++,u.always(function(){u.always(function(){o.unqueued--,he.queue(e,"fx").length||o.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],p=he.css(e,"display"),c="none"===p?he._data(e,"olddisplay")||N(e.nodeName):p,"inline"===c&&"none"===he.css(e,"float")&&(ue.inlineBlockNeedsLayout&&"inline"!==N(e.nodeName)?h.zoom=1:h.display="inline-block")),n.overflow&&(h.overflow="hidden",ue.shrinkWrapBlocks()||u.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}));for(i in t)if(s=t[i],Ct.exec(s)){if(delete t[i],a=a||"toggle"===s,s===(f?"hide":"show")){if("show"!==s||!m||void 0===m[i])continue;f=!0}d[i]=m&&m[i]||he.style(e,i)}else p=void 0;if(he.isEmptyObject(d))"inline"===("none"===p?N(e.nodeName):p)&&(h.display=p);else{m?"hidden"in m&&(f=m.hidden):m=he._data(e,"fxshow",{}),a&&(m.hidden=!f),f?he(e).show():u.done(function(){he(e).hide()}),u.done(function(){var t;he._removeData(e,"fxshow");for(t in d)he.style(e,t,d[t])});for(i in d)r=q(f?m[i]:0,i,u),i in m||(m[i]=r.start,f&&(r.end=r.start,r.start="width"===i||"height"===i?1:0))}}function B(e,t){var n,i,s,a,r;for(n in e)if(i=he.camelCase(n),s=t[i],a=e[n],he.isArray(a)&&(s=a[1],a=e[n]=a[0]),n!==i&&(e[i]=a,delete e[n]),r=he.cssHooks[i],r&&"expand"in r){a=r.expand(a),delete e[i];for(n in a)n in e||(e[n]=a[n],t[n]=s)}else t[i]=s}function W(e,t,n){var i,s,a=0,r=W.prefilters.length,o=he.Deferred().always(function(){delete l.elem}),l=function(){if(s)return!1;for(var t=St||I(),n=Math.max(0,p.startTime+p.duration-t),i=n/p.duration||0,a=1-i,r=0,l=p.tweens.length;l>r;r++)p.tweens[r].run(a);return o.notifyWith(e,[p,a,n]),1>a&&l?n:(o.resolveWith(e,[p]),!1)},p=o.promise({elem:e,props:he.extend({},t),opts:he.extend(!0,{specialEasing:{},easing:he.easing._default},n),originalProperties:t,originalOptions:n,startTime:St||I(),duration:n.duration,tweens:[],createTween:function(t,n){var i=he.Tween(e,p.opts,t,n,p.opts.specialEasing[t]||p.opts.easing);return p.tweens.push(i),i},stop:function(t){var n=0,i=t?p.tweens.length:0;if(s)return this;for(s=!0;i>n;n++)p.tweens[n].run(1);return t?(o.notifyWith(e,[p,1,0]),o.resolveWith(e,[p,t])):o.rejectWith(e,[p,t]),this}}),c=p.props;for(B(c,p.opts.specialEasing);r>a;a++)if(i=W.prefilters[a].call(p,e,c,p.opts))return he.isFunction(i.stop)&&(he._queueHooks(p.elem,p.opts.queue).stop=he.proxy(i.stop,i)),i;return he.map(c,q,p),he.isFunction(p.opts.start)&&p.opts.start.call(e,p),he.fx.timer(he.extend(l,{elem:e,anim:p,queue:p.opts.queue})),p.progress(p.opts.progress).done(p.opts.done,p.opts.complete).fail(p.opts.fail).always(p.opts.always)}function U(e){return he.attr(e,"class")||""}function H(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,s=0,a=t.toLowerCase().match(Ee)||[];if(he.isFunction(n))for(;i=a[s++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function J(e,t,n,i){function s(o){var l;return a[o]=!0,he.each(e[o]||[],function(e,o){var p=o(t,n,i);return"string"!=typeof p||r||a[p]?r?!(l=p):void 0:(t.dataTypes.unshift(p),s(p),!1)}),l}var a={},r=e===Kt;return s(t.dataTypes[0])||!a["*"]&&s("*")}function V(e,t){var n,i,s=he.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((s[i]?e:n||(n={}))[i]=t[i]);return n&&he.extend(!0,e,n),e}function G(e,t,n){for(var i,s,a,r,o=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===s&&(s=e.mimeType||t.getResponseHeader("Content-Type"));if(s)for(r in o)if(o[r]&&o[r].test(s)){l.unshift(r);break}if(l[0]in n)a=l[0];else{for(r in n){if(!l[0]||e.converters[r+" "+l[0]]){a=r;break}i||(i=r)}a=a||i}return a?(a!==l[0]&&l.unshift(a),n[a]):void 0}function Y(e,t,n,i){var s,a,r,o,l,p={},c=e.dataTypes.slice();if(c[1])for(r in e.converters)p[r.toLowerCase()]=e.converters[r];for(a=c.shift();a;)if(e.responseFields[a]&&(n[e.responseFields[a]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=a,a=c.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(r=p[l+" "+a]||p["* "+a],!r)for(s in p)if(o=s.split(" "),o[1]===a&&(r=p[l+" "+o[0]]||p["* "+o[0]])){r===!0?r=p[s]:p[s]!==!0&&(a=o[0],c.unshift(o[1]));break}if(r!==!0)if(r&&e["throws"])t=r(t);else try{t=r(t)}catch(u){return{state:"parsererror",error:r?u:"No conversion from "+l+" to "+a}}}return{state:"success",data:t}}function X(e){return e.style&&e.style.display||he.css(e,"display")}function Q(e){if(!he.contains(e.ownerDocument||ie,e))return!0;for(;e&&1===e.nodeType;){if("none"===X(e)||"hidden"===e.type)return!0;e=e.parentNode}return!1}function K(e,t,n,i){var s;if(he.isArray(t))he.each(t,function(t,s){n||sn.test(e)?i(e,s):K(e+"["+("object"==typeof s&&null!=s?t:"")+"]",s,n,i)});else if(n||"object"!==he.type(t))i(e,t);else for(s in t)K(e+"["+s+"]",t[s],n,i)}function Z(){try{return new e.XMLHttpRequest}catch(t){}}function ee(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function te(e){return he.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var ne=[],ie=e.document,se=ne.slice,ae=ne.concat,re=ne.push,oe=ne.indexOf,le={},pe=le.toString,ce=le.hasOwnProperty,ue={},de="1.12.4",he=function(e,t){return new he.fn.init(e,t)},fe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,me=/^-ms-/,ge=/-([\da-z])/gi,_e=function(e,t){return t.toUpperCase()};he.fn=he.prototype={jquery:de,constructor:he,selector:"",length:0,toArray:function(){return se.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:se.call(this)},pushStack:function(e){var t=he.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e){return he.each(this,e)},map:function(e){return this.pushStack(he.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(se.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:re,sort:ne.sort,splice:ne.splice},he.extend=he.fn.extend=function(){var e,t,n,i,s,a,r=arguments[0]||{},o=1,l=arguments.length,p=!1;for("boolean"==typeof r&&(p=r,r=arguments[o]||{},o++),"object"==typeof r||he.isFunction(r)||(r={}),o===l&&(r=this,o--);l>o;o++)if(null!=(s=arguments[o]))for(i in s)e=r[i],n=s[i],r!==n&&(p&&n&&(he.isPlainObject(n)||(t=he.isArray(n)))?(t?(t=!1,a=e&&he.isArray(e)?e:[]):a=e&&he.isPlainObject(e)?e:{},r[i]=he.extend(p,a,n)):void 0!==n&&(r[i]=n));return r},he.extend({expando:"jQuery"+(de+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===he.type(e)},isArray:Array.isArray||function(e){return"array"===he.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){var t=e&&e.toString();return!he.isArray(e)&&t-parseFloat(t)+1>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==he.type(e)||e.nodeType||he.isWindow(e))return!1;try{if(e.constructor&&!ce.call(e,"constructor")&&!ce.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(!ue.ownFirst)for(t in e)return ce.call(e,t);for(t in e);return void 0===t||ce.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?le[pe.call(e)]||"object":typeof e},globalEval:function(t){t&&he.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(me,"ms-").replace(ge,_e)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t){var i,s=0;if(n(e))for(i=e.length;i>s&&t.call(e[s],s,e[s])!==!1;s++);else for(s in e)if(t.call(e[s],s,e[s])===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(fe,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?he.merge(i,"string"==typeof e?[e]:e):re.call(i,e)),i},inArray:function(e,t,n){var i;if(t){if(oe)return oe.call(t,e,n);for(i=t.length,n=n?0>n?Math.max(0,i+n):n:0;i>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){for(var n=+t.length,i=0,s=e.length;n>i;)e[s++]=t[i++];if(n!==n)for(;void 0!==t[i];)e[s++]=t[i++];return e.length=s,e},grep:function(e,t,n){for(var i,s=[],a=0,r=e.length,o=!n;r>a;a++)i=!t(e[a],a),i!==o&&s.push(e[a]);return s},map:function(e,t,i){var s,a,r=0,o=[];if(n(e))for(s=e.length;s>r;r++)a=t(e[r],r,i),null!=a&&o.push(a);else for(r in e)a=t(e[r],r,i),null!=a&&o.push(a);return ae.apply([],o)},guid:1,proxy:function(e,t){var n,i,s;return"string"==typeof t&&(s=e[t],t=e,e=s),he.isFunction(e)?(n=se.call(arguments,2),i=function(){return e.apply(t||this,n.concat(se.call(arguments)))},i.guid=e.guid=e.guid||he.guid++,i):void 0},now:function(){return+new Date},support:ue}),"function"==typeof Symbol&&(he.fn[Symbol.iterator]=ne[Symbol.iterator]),he.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){le["[object "+t+"]"]=t.toLowerCase()});var be=function(e){function t(e,t,n,i){var s,a,r,o,l,p,u,h,f=t&&t.ownerDocument,m=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==m&&9!==m&&11!==m)return n;if(!i&&((t?t.ownerDocument||t:q)!==D&&j(t),t=t||D,R)){if(11!==m&&(p=_e.exec(e)))if(s=p[1]){if(9===m){if(!(r=t.getElementById(s)))return n;if(r.id===s)return n.push(r),n}else if(f&&(r=f.getElementById(s))&&I(t,r)&&r.id===s)return n.push(r),n}else{if(p[2])return K.apply(n,t.getElementsByTagName(e)),n;if((s=p[3])&&w.getElementsByClassName&&t.getElementsByClassName)return K.apply(n,t.getElementsByClassName(s)),n}if(w.qsa&&!H[e+" "]&&(!M||!M.test(e))){if(1!==m)f=t,h=e;else if("object"!==t.nodeName.toLowerCase()){for((o=t.getAttribute("id"))?o=o.replace(ve,"\\$&"):t.setAttribute("id",o=L),u=S(e),a=u.length,l=de.test(o)?"#"+o:"[id='"+o+"']";a--;)u[a]=l+" "+d(u[a]);h=u.join(","),f=be.test(e)&&c(t.parentNode)||t}if(h)try{return K.apply(n,f.querySelectorAll(h)),n}catch(g){}finally{o===L&&t.removeAttribute("id")}}}return C(e.replace(oe,"$1"),t,n,i)}function n(){function e(n,i){return t.push(n+" ")>x.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function i(e){return e[L]=!0,e}function s(e){var t=D.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){for(var n=e.split("|"),i=n.length;i--;)x.attrHandle[n[i]]=t}function r(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||V)-(~e.sourceIndex||V);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function o(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function l(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function p(e){return i(function(t){return t=+t,i(function(n,i){for(var s,a=e([],n.length,t),r=a.length;r--;)n[s=a[r]]&&(n[s]=!(i[s]=n[s]))})})}function c(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function u(){}function d(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function h(e,t,n){var i=t.dir,s=n&&"parentNode"===i,a=B++;return t.first?function(t,n,a){for(;t=t[i];)if(1===t.nodeType||s)return e(t,n,a)}:function(t,n,r){var o,l,p,c=[z,a];if(r){for(;t=t[i];)if((1===t.nodeType||s)&&e(t,n,r))return!0}else for(;t=t[i];)if(1===t.nodeType||s){if(p=t[L]||(t[L]={}),l=p[t.uniqueID]||(p[t.uniqueID]={}),(o=l[i])&&o[0]===z&&o[1]===a)return c[2]=o[2];if(l[i]=c,c[2]=e(t,n,r))return!0}}}function f(e){return e.length>1?function(t,n,i){for(var s=e.length;s--;)if(!e[s](t,n,i))return!1;return!0}:e[0]}function m(e,n,i){for(var s=0,a=n.length;a>s;s++)t(e,n[s],i);return i}function g(e,t,n,i,s){for(var a,r=[],o=0,l=e.length,p=null!=t;l>o;o++)(a=e[o])&&(!n||n(a,i,s))&&(r.push(a),p&&t.push(o));return r}function _(e,t,n,s,a,r){return s&&!s[L]&&(s=_(s)),a&&!a[L]&&(a=_(a,r)),i(function(i,r,o,l){var p,c,u,d=[],h=[],f=r.length,_=i||m(t||"*",o.nodeType?[o]:o,[]),b=!e||!i&&t?_:g(_,d,e,o,l),v=n?a||(i?e:f||s)?[]:r:b;if(n&&n(b,v,o,l),s)for(p=g(v,h),s(p,[],o,l),c=p.length;c--;)(u=p[c])&&(v[h[c]]=!(b[h[c]]=u));if(i){if(a||e){if(a){for(p=[],c=v.length;c--;)(u=v[c])&&p.push(b[c]=u);a(null,v=[],p,l)}for(c=v.length;c--;)(u=v[c])&&(p=a?ee(i,u):d[c])>-1&&(i[p]=!(r[p]=u))}}else v=g(v===r?v.splice(f,v.length):v),a?a(null,r,v,l):K.apply(r,v)})}function b(e){for(var t,n,i,s=e.length,a=x.relative[e[0].type],r=a||x.relative[" "],o=a?1:0,l=h(function(e){return e===t},r,!0),p=h(function(e){return ee(t,e)>-1},r,!0),c=[function(e,n,i){var s=!a&&(i||n!==$)||((t=n).nodeType?l(e,n,i):p(e,n,i));return t=null,s}];s>o;o++)if(n=x.relative[e[o].type])c=[h(f(c),n)];else{if(n=x.filter[e[o].type].apply(null,e[o].matches),n[L]){for(i=++o;s>i&&!x.relative[e[i].type];i++);return _(o>1&&f(c),o>1&&d(e.slice(0,o-1).concat({value:" "===e[o-2].type?"*":""})).replace(oe,"$1"),n,i>o&&b(e.slice(o,i)),s>i&&b(e=e.slice(i)),s>i&&d(e))}c.push(n)}return f(c)}function v(e,n){var s=n.length>0,a=e.length>0,r=function(i,r,o,l,p){var c,u,d,h=0,f="0",m=i&&[],_=[],b=$,v=i||a&&x.find.TAG("*",p),y=z+=null==b?1:Math.random()||.1,w=v.length;for(p&&($=r===D||r||p);f!==w&&null!=(c=v[f]);f++){if(a&&c){for(u=0,r||c.ownerDocument===D||(j(c),o=!R);d=e[u++];)if(d(c,r||D,o)){l.push(c);break}p&&(z=y)}s&&((c=!d&&c)&&h--,i&&m.push(c))}if(h+=f,s&&f!==h){for(u=0;d=n[u++];)d(m,_,r,o);if(i){if(h>0)for(;f--;)m[f]||_[f]||(_[f]=X.call(l));_=g(_)}K.apply(l,_),p&&!i&&_.length>0&&h+n.length>1&&t.uniqueSort(l)}return p&&(z=y,$=b),m};return s?i(r):r}var y,w,x,A,k,S,T,C,$,E,N,j,D,F,R,M,O,P,I,L="sizzle"+1*new Date,q=e.document,z=0,B=0,W=n(),U=n(),H=n(),J=function(e,t){return e===t&&(N=!0),0},V=1<<31,G={}.hasOwnProperty,Y=[],X=Y.pop,Q=Y.push,K=Y.push,Z=Y.slice,ee=function(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",ie="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",se="\\["+ne+"*("+ie+")(?:"+ne+"*([*^$|!~]?=)"+ne+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ie+"))|)"+ne+"*\\]",ae=":("+ie+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+se+")*)|.*)\\)|)",re=new RegExp(ne+"+","g"),oe=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),le=new RegExp("^"+ne+"*,"+ne+"*"),pe=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),ce=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),ue=new RegExp(ae),de=new RegExp("^"+ie+"$"),he={ID:new RegExp("^#("+ie+")"),CLASS:new RegExp("^\\.("+ie+")"),TAG:new RegExp("^("+ie+"|[*])"),ATTR:new RegExp("^"+se),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},fe=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ge=/^[^{]+\{\s*\[native \w/,_e=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,be=/[+~]/,ve=/'|\\/g,ye=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),we=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},xe=function(){j()};try{K.apply(Y=Z.call(q.childNodes),q.childNodes),Y[q.childNodes.length].nodeType}catch(Ae){K={apply:Y.length?function(e,t){Q.apply(e,Z.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}w=t.support={},k=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},j=t.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:q;return i!==D&&9===i.nodeType&&i.documentElement?(D=i,F=D.documentElement,R=!k(D),(n=D.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",xe,!1):n.attachEvent&&n.attachEvent("onunload",xe)),
w.attributes=s(function(e){return e.className="i",!e.getAttribute("className")}),w.getElementsByTagName=s(function(e){return e.appendChild(D.createComment("")),!e.getElementsByTagName("*").length}),w.getElementsByClassName=ge.test(D.getElementsByClassName),w.getById=s(function(e){return F.appendChild(e).id=L,!D.getElementsByName||!D.getElementsByName(L).length}),w.getById?(x.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&R){var n=t.getElementById(e);return n?[n]:[]}},x.filter.ID=function(e){var t=e.replace(ye,we);return function(e){return e.getAttribute("id")===t}}):(delete x.find.ID,x.filter.ID=function(e){var t=e.replace(ye,we);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),x.find.TAG=w.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):w.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],s=0,a=t.getElementsByTagName(e);if("*"===e){for(;n=a[s++];)1===n.nodeType&&i.push(n);return i}return a},x.find.CLASS=w.getElementsByClassName&&function(e,t){return"undefined"!=typeof t.getElementsByClassName&&R?t.getElementsByClassName(e):void 0},O=[],M=[],(w.qsa=ge.test(D.querySelectorAll))&&(s(function(e){F.appendChild(e).innerHTML="<a id='"+L+"'></a><select id='"+L+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&M.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||M.push("\\["+ne+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+L+"-]").length||M.push("~="),e.querySelectorAll(":checked").length||M.push(":checked"),e.querySelectorAll("a#"+L+"+*").length||M.push(".#.+[+~]")}),s(function(e){var t=D.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&M.push("name"+ne+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||M.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),M.push(",.*:")})),(w.matchesSelector=ge.test(P=F.matches||F.webkitMatchesSelector||F.mozMatchesSelector||F.oMatchesSelector||F.msMatchesSelector))&&s(function(e){w.disconnectedMatch=P.call(e,"div"),P.call(e,"[s!='']:x"),O.push("!=",ae)}),M=M.length&&new RegExp(M.join("|")),O=O.length&&new RegExp(O.join("|")),t=ge.test(F.compareDocumentPosition),I=t||ge.test(F.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},J=t?function(e,t){if(e===t)return N=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!w.sortDetached&&t.compareDocumentPosition(e)===n?e===D||e.ownerDocument===q&&I(q,e)?-1:t===D||t.ownerDocument===q&&I(q,t)?1:E?ee(E,e)-ee(E,t):0:4&n?-1:1)}:function(e,t){if(e===t)return N=!0,0;var n,i=0,s=e.parentNode,a=t.parentNode,o=[e],l=[t];if(!s||!a)return e===D?-1:t===D?1:s?-1:a?1:E?ee(E,e)-ee(E,t):0;if(s===a)return r(e,t);for(n=e;n=n.parentNode;)o.unshift(n);for(n=t;n=n.parentNode;)l.unshift(n);for(;o[i]===l[i];)i++;return i?r(o[i],l[i]):o[i]===q?-1:l[i]===q?1:0},D):D},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==D&&j(e),n=n.replace(ce,"='$1']"),w.matchesSelector&&R&&!H[n+" "]&&(!O||!O.test(n))&&(!M||!M.test(n)))try{var i=P.call(e,n);if(i||w.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(s){}return t(n,D,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==D&&j(e),I(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==D&&j(e);var n=x.attrHandle[t.toLowerCase()],i=n&&G.call(x.attrHandle,t.toLowerCase())?n(e,t,!R):void 0;return void 0!==i?i:w.attributes||!R?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,s=0;if(N=!w.detectDuplicates,E=!w.sortStable&&e.slice(0),e.sort(J),N){for(;t=e[s++];)t===e[s]&&(i=n.push(s));for(;i--;)e.splice(n[i],1)}return E=null,e},A=t.getText=function(e){var t,n="",i=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=A(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[i++];)n+=A(t);return n},x=t.selectors={cacheLength:50,createPseudo:i,match:he,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ye,we),e[3]=(e[3]||e[4]||e[5]||"").replace(ye,we),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return he.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&ue.test(n)&&(t=S(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ye,we).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=W[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&W(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(s){var a=t.attr(s,e);return null==a?"!="===n:n?(a+="","="===n?a===i:"!="===n?a!==i:"^="===n?i&&0===a.indexOf(i):"*="===n?i&&a.indexOf(i)>-1:"$="===n?i&&a.slice(-i.length)===i:"~="===n?(" "+a.replace(re," ")+" ").indexOf(i)>-1:"|="===n?a===i||a.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i,s){var a="nth"!==e.slice(0,3),r="last"!==e.slice(-4),o="of-type"===t;return 1===i&&0===s?function(e){return!!e.parentNode}:function(t,n,l){var p,c,u,d,h,f,m=a!==r?"nextSibling":"previousSibling",g=t.parentNode,_=o&&t.nodeName.toLowerCase(),b=!l&&!o,v=!1;if(g){if(a){for(;m;){for(d=t;d=d[m];)if(o?d.nodeName.toLowerCase()===_:1===d.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[r?g.firstChild:g.lastChild],r&&b){for(d=g,u=d[L]||(d[L]={}),c=u[d.uniqueID]||(u[d.uniqueID]={}),p=c[e]||[],h=p[0]===z&&p[1],v=h&&p[2],d=h&&g.childNodes[h];d=++h&&d&&d[m]||(v=h=0)||f.pop();)if(1===d.nodeType&&++v&&d===t){c[e]=[z,h,v];break}}else if(b&&(d=t,u=d[L]||(d[L]={}),c=u[d.uniqueID]||(u[d.uniqueID]={}),p=c[e]||[],h=p[0]===z&&p[1],v=h),v===!1)for(;(d=++h&&d&&d[m]||(v=h=0)||f.pop())&&((o?d.nodeName.toLowerCase()!==_:1!==d.nodeType)||!++v||(b&&(u=d[L]||(d[L]={}),c=u[d.uniqueID]||(u[d.uniqueID]={}),c[e]=[z,v]),d!==t)););return v-=s,v===i||v%i===0&&v/i>=0}}},PSEUDO:function(e,n){var s,a=x.pseudos[e]||x.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return a[L]?a(n):a.length>1?(s=[e,e,"",n],x.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,s=a(e,n),r=s.length;r--;)i=ee(e,s[r]),e[i]=!(t[i]=s[r])}):function(e){return a(e,0,s)}):a}},pseudos:{not:i(function(e){var t=[],n=[],s=T(e.replace(oe,"$1"));return s[L]?i(function(e,t,n,i){for(var a,r=s(e,null,i,[]),o=e.length;o--;)(a=r[o])&&(e[o]=!(t[o]=a))}):function(e,i,a){return t[0]=e,s(t,null,a,n),t[0]=null,!n.pop()}}),has:i(function(e){return function(n){return t(e,n).length>0}}),contains:i(function(e){return e=e.replace(ye,we),function(t){return(t.textContent||t.innerText||A(t)).indexOf(e)>-1}}),lang:i(function(e){return de.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(ye,we).toLowerCase(),function(t){var n;do if(n=R?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===F},focus:function(e){return e===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!x.pseudos.empty(e)},header:function(e){return me.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:p(function(){return[0]}),last:p(function(e,t){return[t-1]}),eq:p(function(e,t,n){return[0>n?n+t:n]}),even:p(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:p(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:p(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:p(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}},x.pseudos.nth=x.pseudos.eq;for(y in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[y]=o(y);for(y in{submit:!0,reset:!0})x.pseudos[y]=l(y);return u.prototype=x.filters=x.pseudos,x.setFilters=new u,S=t.tokenize=function(e,n){var i,s,a,r,o,l,p,c=U[e+" "];if(c)return n?0:c.slice(0);for(o=e,l=[],p=x.preFilter;o;){(!i||(s=le.exec(o)))&&(s&&(o=o.slice(s[0].length)||o),l.push(a=[])),i=!1,(s=pe.exec(o))&&(i=s.shift(),a.push({value:i,type:s[0].replace(oe," ")}),o=o.slice(i.length));for(r in x.filter)!(s=he[r].exec(o))||p[r]&&!(s=p[r](s))||(i=s.shift(),a.push({value:i,type:r,matches:s}),o=o.slice(i.length));if(!i)break}return n?o.length:o?t.error(e):U(e,l).slice(0)},T=t.compile=function(e,t){var n,i=[],s=[],a=H[e+" "];if(!a){for(t||(t=S(e)),n=t.length;n--;)a=b(t[n]),a[L]?i.push(a):s.push(a);a=H(e,v(s,i)),a.selector=e}return a},C=t.select=function(e,t,n,i){var s,a,r,o,l,p="function"==typeof e&&e,u=!i&&S(e=p.selector||e);if(n=n||[],1===u.length){if(a=u[0]=u[0].slice(0),a.length>2&&"ID"===(r=a[0]).type&&w.getById&&9===t.nodeType&&R&&x.relative[a[1].type]){if(t=(x.find.ID(r.matches[0].replace(ye,we),t)||[])[0],!t)return n;p&&(t=t.parentNode),e=e.slice(a.shift().value.length)}for(s=he.needsContext.test(e)?0:a.length;s--&&(r=a[s],!x.relative[o=r.type]);)if((l=x.find[o])&&(i=l(r.matches[0].replace(ye,we),be.test(a[0].type)&&c(t.parentNode)||t))){if(a.splice(s,1),e=i.length&&d(a),!e)return K.apply(n,i),n;break}}return(p||T(e,u))(i,t,!R,n,!t||be.test(e)&&c(t.parentNode)||t),n},w.sortStable=L.split("").sort(J).join("")===L,w.detectDuplicates=!!N,j(),w.sortDetached=s(function(e){return 1&e.compareDocumentPosition(D.createElement("div"))}),s(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),w.attributes&&s(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),s(function(e){return null==e.getAttribute("disabled")})||a(te,function(e,t,n){var i;return n?void 0:e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(e);he.find=be,he.expr=be.selectors,he.expr[":"]=he.expr.pseudos,he.uniqueSort=he.unique=be.uniqueSort,he.text=be.getText,he.isXMLDoc=be.isXML,he.contains=be.contains;var ve=function(e,t,n){for(var i=[],s=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(s&&he(e).is(n))break;i.push(e)}return i},ye=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},we=he.expr.match.needsContext,xe=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,Ae=/^.[^:#\[\.,]*$/;he.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?he.find.matchesSelector(i,e)?[i]:[]:he.find.matches(e,he.grep(t,function(e){return 1===e.nodeType}))},he.fn.extend({find:function(e){var t,n=[],i=this,s=i.length;if("string"!=typeof e)return this.pushStack(he(e).filter(function(){for(t=0;s>t;t++)if(he.contains(i[t],this))return!0}));for(t=0;s>t;t++)he.find(e,i[t],n);return n=this.pushStack(s>1?he.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(i(this,e||[],!1))},not:function(e){return this.pushStack(i(this,e||[],!0))},is:function(e){return!!i(this,"string"==typeof e&&we.test(e)?he(e):e||[],!1).length}});var ke,Se=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,Te=he.fn.init=function(e,t,n){var i,s;if(!e)return this;if(n=n||ke,"string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:Se.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof he?t[0]:t,he.merge(this,he.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:ie,!0)),xe.test(i[1])&&he.isPlainObject(t))for(i in t)he.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}if(s=ie.getElementById(i[2]),s&&s.parentNode){if(s.id!==i[2])return ke.find(e);this.length=1,this[0]=s}return this.context=ie,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):he.isFunction(e)?"undefined"!=typeof n.ready?n.ready(e):e(he):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),he.makeArray(e,this))};Te.prototype=he.fn,ke=he(ie);var Ce=/^(?:parents|prev(?:Until|All))/,$e={children:!0,contents:!0,next:!0,prev:!0};he.fn.extend({has:function(e){var t,n=he(e,this),i=n.length;return this.filter(function(){for(t=0;i>t;t++)if(he.contains(this,n[t]))return!0})},closest:function(e,t){for(var n,i=0,s=this.length,a=[],r=we.test(e)||"string"!=typeof e?he(e,t||this.context):0;s>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(r?r.index(n)>-1:1===n.nodeType&&he.find.matchesSelector(n,e))){a.push(n);break}return this.pushStack(a.length>1?he.uniqueSort(a):a)},index:function(e){return e?"string"==typeof e?he.inArray(this[0],he(e)):he.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(he.uniqueSort(he.merge(this.get(),he(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),he.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ve(e,"parentNode")},parentsUntil:function(e,t,n){return ve(e,"parentNode",n)},next:function(e){return s(e,"nextSibling")},prev:function(e){return s(e,"previousSibling")},nextAll:function(e){return ve(e,"nextSibling")},prevAll:function(e){return ve(e,"previousSibling")},nextUntil:function(e,t,n){return ve(e,"nextSibling",n)},prevUntil:function(e,t,n){return ve(e,"previousSibling",n)},siblings:function(e){return ye((e.parentNode||{}).firstChild,e)},children:function(e){return ye(e.firstChild)},contents:function(e){return he.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:he.merge([],e.childNodes)}},function(e,t){he.fn[e]=function(n,i){var s=he.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(s=he.filter(i,s)),this.length>1&&($e[e]||(s=he.uniqueSort(s)),Ce.test(e)&&(s=s.reverse())),this.pushStack(s)}});var Ee=/\S+/g;he.Callbacks=function(e){e="string"==typeof e?a(e):he.extend({},e);var t,n,i,s,r=[],o=[],l=-1,p=function(){for(s=e.once,i=t=!0;o.length;l=-1)for(n=o.shift();++l<r.length;)r[l].apply(n[0],n[1])===!1&&e.stopOnFalse&&(l=r.length,n=!1);e.memory||(n=!1),t=!1,s&&(r=n?[]:"")},c={add:function(){return r&&(n&&!t&&(l=r.length-1,o.push(n)),function i(t){he.each(t,function(t,n){he.isFunction(n)?e.unique&&c.has(n)||r.push(n):n&&n.length&&"string"!==he.type(n)&&i(n)})}(arguments),n&&!t&&p()),this},remove:function(){return he.each(arguments,function(e,t){for(var n;(n=he.inArray(t,r,n))>-1;)r.splice(n,1),l>=n&&l--}),this},has:function(e){return e?he.inArray(e,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return s=o=[],r=n="",this},disabled:function(){return!r},lock:function(){return s=!0,n||c.disable(),this},locked:function(){return!!s},fireWith:function(e,n){return s||(n=n||[],n=[e,n.slice?n.slice():n],o.push(n),t||p()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},he.extend({Deferred:function(e){var t=[["resolve","done",he.Callbacks("once memory"),"resolved"],["reject","fail",he.Callbacks("once memory"),"rejected"],["notify","progress",he.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var e=arguments;return he.Deferred(function(n){he.each(t,function(t,a){var r=he.isFunction(e[t])&&e[t];s[a[1]](function(){var e=r&&r.apply(this,arguments);e&&he.isFunction(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[a[0]+"With"](this===i?n.promise():this,r?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?he.extend(e,i):i}},s={};return i.pipe=i.then,he.each(t,function(e,a){var r=a[2],o=a[3];i[a[1]]=r.add,o&&r.add(function(){n=o},t[1^e][2].disable,t[2][2].lock),s[a[0]]=function(){return s[a[0]+"With"](this===s?i:this,arguments),this},s[a[0]+"With"]=r.fireWith}),i.promise(s),e&&e.call(s,s),s},when:function(e){var t,n,i,s=0,a=se.call(arguments),r=a.length,o=1!==r||e&&he.isFunction(e.promise)?r:0,l=1===o?e:he.Deferred(),p=function(e,n,i){return function(s){n[e]=this,i[e]=arguments.length>1?se.call(arguments):s,i===t?l.notifyWith(n,i):--o||l.resolveWith(n,i)}};if(r>1)for(t=new Array(r),n=new Array(r),i=new Array(r);r>s;s++)a[s]&&he.isFunction(a[s].promise)?a[s].promise().progress(p(s,n,t)).done(p(s,i,a)).fail(l.reject):--o;return o||l.resolveWith(i,a),l.promise()}});var Ne;he.fn.ready=function(e){return he.ready.promise().done(e),this},he.extend({isReady:!1,readyWait:1,holdReady:function(e){e?he.readyWait++:he.ready(!0)},ready:function(e){(e===!0?--he.readyWait:he.isReady)||(he.isReady=!0,e!==!0&&--he.readyWait>0||(Ne.resolveWith(ie,[he]),he.fn.triggerHandler&&(he(ie).triggerHandler("ready"),he(ie).off("ready"))))}}),he.ready.promise=function(t){if(!Ne)if(Ne=he.Deferred(),"complete"===ie.readyState||"loading"!==ie.readyState&&!ie.documentElement.doScroll)e.setTimeout(he.ready);else if(ie.addEventListener)ie.addEventListener("DOMContentLoaded",o),e.addEventListener("load",o);else{ie.attachEvent("onreadystatechange",o),e.attachEvent("onload",o);var n=!1;try{n=null==e.frameElement&&ie.documentElement}catch(i){}n&&n.doScroll&&!function s(){if(!he.isReady){try{n.doScroll("left")}catch(t){return e.setTimeout(s,50)}r(),he.ready()}}()}return Ne.promise(t)},he.ready.promise();var je;for(je in he(ue))break;ue.ownFirst="0"===je,ue.inlineBlockNeedsLayout=!1,he(function(){var e,t,n,i;n=ie.getElementsByTagName("body")[0],n&&n.style&&(t=ie.createElement("div"),i=ie.createElement("div"),i.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(i).appendChild(t),"undefined"!=typeof t.style.zoom&&(t.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",ue.inlineBlockNeedsLayout=e=3===t.offsetWidth,e&&(n.style.zoom=1)),n.removeChild(i))}),function(){var e=ie.createElement("div");ue.deleteExpando=!0;try{delete e.test}catch(t){ue.deleteExpando=!1}e=null}();var De=function(e){var t=he.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return 1!==n&&9!==n?!1:!t||t!==!0&&e.getAttribute("classid")===t},Fe=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Re=/([A-Z])/g;he.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?he.cache[e[he.expando]]:e[he.expando],!!e&&!p(e)},data:function(e,t,n){return c(e,t,n)},removeData:function(e,t){return u(e,t)},_data:function(e,t,n){return c(e,t,n,!0)},_removeData:function(e,t){return u(e,t,!0)}}),he.fn.extend({data:function(e,t){var n,i,s,a=this[0],r=a&&a.attributes;if(void 0===e){if(this.length&&(s=he.data(a),1===a.nodeType&&!he._data(a,"parsedAttrs"))){for(n=r.length;n--;)r[n]&&(i=r[n].name,0===i.indexOf("data-")&&(i=he.camelCase(i.slice(5)),l(a,i,s[i])));he._data(a,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){he.data(this,e)}):arguments.length>1?this.each(function(){he.data(this,e,t)}):a?l(a,e,he.data(a,e)):void 0},removeData:function(e){return this.each(function(){he.removeData(this,e)})}}),he.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=he._data(e,t),n&&(!i||he.isArray(n)?i=he._data(e,t,he.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=he.queue(e,t),i=n.length,s=n.shift(),a=he._queueHooks(e,t),r=function(){he.dequeue(e,t)};"inprogress"===s&&(s=n.shift(),i--),s&&("fx"===t&&n.unshift("inprogress"),delete a.stop,s.call(e,r,a)),!i&&a&&a.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return he._data(e,n)||he._data(e,n,{empty:he.Callbacks("once memory").add(function(){he._removeData(e,t+"queue"),he._removeData(e,n)})})}}),he.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?he.queue(this[0],e):void 0===t?this:this.each(function(){var n=he.queue(this,e,t);he._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&he.dequeue(this,e)})},dequeue:function(e){return this.each(function(){he.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,s=he.Deferred(),a=this,r=this.length,o=function(){--i||s.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";r--;)n=he._data(a[r],e+"queueHooks"),n&&n.empty&&(i++,n.empty.add(o));return o(),s.promise(t)}}),function(){var e;ue.shrinkWrapBlocks=function(){if(null!=e)return e;e=!1;var t,n,i;return n=ie.getElementsByTagName("body")[0],n&&n.style?(t=ie.createElement("div"),i=ie.createElement("div"),i.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(i).appendChild(t),"undefined"!=typeof t.style.zoom&&(t.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",t.appendChild(ie.createElement("div")).style.width="5px",e=3!==t.offsetWidth),n.removeChild(i),e):void 0}}();var Me=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Oe=new RegExp("^(?:([+-])=|)("+Me+")([a-z%]*)$","i"),Pe=["Top","Right","Bottom","Left"],Ie=function(e,t){return e=t||e,"none"===he.css(e,"display")||!he.contains(e.ownerDocument,e)},Le=function(e,t,n,i,s,a,r){var o=0,l=e.length,p=null==n;if("object"===he.type(n)){s=!0;for(o in n)Le(e,t,o,n[o],!0,a,r)}else if(void 0!==i&&(s=!0,he.isFunction(i)||(r=!0),p&&(r?(t.call(e,i),t=null):(p=t,t=function(e,t,n){return p.call(he(e),n)})),t))for(;l>o;o++)t(e[o],n,r?i:i.call(e[o],o,t(e[o],n)));return s?e:p?t.call(e):l?t(e[0],n):a},qe=/^(?:checkbox|radio)$/i,ze=/<([\w:-]+)/,Be=/^$|\/(?:java|ecma)script/i,We=/^\s+/,Ue="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";!function(){var e=ie.createElement("div"),t=ie.createDocumentFragment(),n=ie.createElement("input");e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",ue.leadingWhitespace=3===e.firstChild.nodeType,ue.tbody=!e.getElementsByTagName("tbody").length,ue.htmlSerialize=!!e.getElementsByTagName("link").length,ue.html5Clone="<:nav></:nav>"!==ie.createElement("nav").cloneNode(!0).outerHTML,n.type="checkbox",n.checked=!0,t.appendChild(n),ue.appendChecked=n.checked,e.innerHTML="<textarea>x</textarea>",ue.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,t.appendChild(e),n=ie.createElement("input"),n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),e.appendChild(n),ue.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,ue.noCloneEvent=!!e.addEventListener,e[he.expando]=1,ue.attributes=!e.getAttribute(he.expando)}();var He={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ue.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};He.optgroup=He.option,He.tbody=He.tfoot=He.colgroup=He.caption=He.thead,He.th=He.td;var Je=/<|&#?\w+;/,Ve=/<tbody/i;!function(){var t,n,i=ie.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})n="on"+t,(ue[t]=n in e)||(i.setAttribute(n,"t"),ue[t]=i.attributes[n].expando===!1);i=null}();var Ge=/^(?:input|select|textarea)$/i,Ye=/^key/,Xe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Qe=/^(?:focusinfocus|focusoutblur)$/,Ke=/^([^.]*)(?:\.(.+)|)/;he.event={global:{},add:function(e,t,n,i,s){var a,r,o,l,p,c,u,d,h,f,m,g=he._data(e);if(g){for(n.handler&&(l=n,n=l.handler,s=l.selector),n.guid||(n.guid=he.guid++),(r=g.events)||(r=g.events={}),(c=g.handle)||(c=g.handle=function(e){return"undefined"==typeof he||e&&he.event.triggered===e.type?void 0:he.event.dispatch.apply(c.elem,arguments)},c.elem=e),t=(t||"").match(Ee)||[""],o=t.length;o--;)a=Ke.exec(t[o])||[],h=m=a[1],f=(a[2]||"").split(".").sort(),h&&(p=he.event.special[h]||{},h=(s?p.delegateType:p.bindType)||h,p=he.event.special[h]||{},u=he.extend({type:h,origType:m,data:i,handler:n,guid:n.guid,selector:s,needsContext:s&&he.expr.match.needsContext.test(s),namespace:f.join(".")},l),(d=r[h])||(d=r[h]=[],d.delegateCount=0,p.setup&&p.setup.call(e,i,f,c)!==!1||(e.addEventListener?e.addEventListener(h,c,!1):e.attachEvent&&e.attachEvent("on"+h,c))),p.add&&(p.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),s?d.splice(d.delegateCount++,0,u):d.push(u),he.event.global[h]=!0);e=null}},remove:function(e,t,n,i,s){var a,r,o,l,p,c,u,d,h,f,m,g=he.hasData(e)&&he._data(e);if(g&&(c=g.events)){for(t=(t||"").match(Ee)||[""],p=t.length;p--;)if(o=Ke.exec(t[p])||[],h=m=o[1],f=(o[2]||"").split(".").sort(),h){for(u=he.event.special[h]||{},h=(i?u.delegateType:u.bindType)||h,d=c[h]||[],o=o[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=a=d.length;a--;)r=d[a],!s&&m!==r.origType||n&&n.guid!==r.guid||o&&!o.test(r.namespace)||i&&i!==r.selector&&("**"!==i||!r.selector)||(d.splice(a,1),r.selector&&d.delegateCount--,u.remove&&u.remove.call(e,r));l&&!d.length&&(u.teardown&&u.teardown.call(e,f,g.handle)!==!1||he.removeEvent(e,h,g.handle),delete c[h])}else for(h in c)he.event.remove(e,h+t[p],n,i,!0);he.isEmptyObject(c)&&(delete g.handle,he._removeData(e,"events"))}},trigger:function(t,n,i,s){var a,r,o,l,p,c,u,d=[i||ie],h=ce.call(t,"type")?t.type:t,f=ce.call(t,"namespace")?t.namespace.split("."):[];if(o=c=i=i||ie,3!==i.nodeType&&8!==i.nodeType&&!Qe.test(h+he.event.triggered)&&(h.indexOf(".")>-1&&(f=h.split("."),h=f.shift(),f.sort()),r=h.indexOf(":")<0&&"on"+h,t=t[he.expando]?t:new he.Event(h,"object"==typeof t&&t),t.isTrigger=s?2:3,t.namespace=f.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:he.makeArray(n,[t]),p=he.event.special[h]||{},s||!p.trigger||p.trigger.apply(i,n)!==!1)){if(!s&&!p.noBubble&&!he.isWindow(i)){for(l=p.delegateType||h,Qe.test(l+h)||(o=o.parentNode);o;o=o.parentNode)d.push(o),c=o;c===(i.ownerDocument||ie)&&d.push(c.defaultView||c.parentWindow||e)}for(u=0;(o=d[u++])&&!t.isPropagationStopped();)t.type=u>1?l:p.bindType||h,a=(he._data(o,"events")||{})[t.type]&&he._data(o,"handle"),a&&a.apply(o,n),a=r&&o[r],a&&a.apply&&De(o)&&(t.result=a.apply(o,n),t.result===!1&&t.preventDefault());if(t.type=h,!s&&!t.isDefaultPrevented()&&(!p._default||p._default.apply(d.pop(),n)===!1)&&De(i)&&r&&i[h]&&!he.isWindow(i)){c=i[r],c&&(i[r]=null),he.event.triggered=h;try{i[h]()}catch(m){}he.event.triggered=void 0,c&&(i[r]=c)}return t.result}},dispatch:function(e){e=he.event.fix(e);var t,n,i,s,a,r=[],o=se.call(arguments),l=(he._data(this,"events")||{})[e.type]||[],p=he.event.special[e.type]||{};if(o[0]=e,e.delegateTarget=this,!p.preDispatch||p.preDispatch.call(this,e)!==!1){for(r=he.event.handlers.call(this,e,l),t=0;(s=r[t++])&&!e.isPropagationStopped();)for(e.currentTarget=s.elem,n=0;(a=s.handlers[n++])&&!e.isImmediatePropagationStopped();)(!e.rnamespace||e.rnamespace.test(a.namespace))&&(e.handleObj=a,e.data=a.data,i=((he.event.special[a.origType]||{}).handle||a.handler).apply(s.elem,o),void 0!==i&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return p.postDispatch&&p.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,s,a,r=[],o=t.delegateCount,l=e.target;if(o&&l.nodeType&&("click"!==e.type||isNaN(e.button)||e.button<1))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==e.type)){for(i=[],n=0;o>n;n++)a=t[n],s=a.selector+" ",void 0===i[s]&&(i[s]=a.needsContext?he(s,this).index(l)>-1:he.find(s,this,null,[l]).length),i[s]&&i.push(a);i.length&&r.push({elem:l,handlers:i})}return o<t.length&&r.push({elem:this,handlers:t.slice(o)}),r},fix:function(e){if(e[he.expando])return e;var t,n,i,s=e.type,a=e,r=this.fixHooks[s];for(r||(this.fixHooks[s]=r=Xe.test(s)?this.mouseHooks:Ye.test(s)?this.keyHooks:{}),i=r.props?this.props.concat(r.props):this.props,e=new he.Event(a),t=i.length;t--;)n=i[t],e[n]=a[n];return e.target||(e.target=a.srcElement||ie),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,r.filter?r.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,s,a=t.button,r=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||ie,s=i.documentElement,n=i.body,e.pageX=t.clientX+(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s&&s.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(s&&s.scrollTop||n&&n.scrollTop||0)-(s&&s.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&r&&(e.relatedTarget=r===e.target?t.toElement:r),e.which||void 0===a||(e.which=1&a?1:2&a?3:4&a?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==y()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===y()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return he.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return he.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n){var i=he.extend(new he.Event,n,{type:e,isSimulated:!0});he.event.trigger(i,null,t),i.isDefaultPrevented()&&n.preventDefault()}},he.removeEvent=ie.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)}:function(e,t,n){var i="on"+t;e.detachEvent&&("undefined"==typeof e[i]&&(e[i]=null),e.detachEvent(i,n))},he.Event=function(e,t){return this instanceof he.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?b:v):this.type=e,t&&he.extend(this,t),this.timeStamp=e&&e.timeStamp||he.now(),void(this[he.expando]=!0)):new he.Event(e,t)},he.Event.prototype={constructor:he.Event,isDefaultPrevented:v,isPropagationStopped:v,isImmediatePropagationStopped:v,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=b,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=b,e&&!this.isSimulated&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=b,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},he.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){
he.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,s=e.relatedTarget,a=e.handleObj;return(!s||s!==i&&!he.contains(i,s))&&(e.type=a.origType,n=a.handler.apply(this,arguments),e.type=t),n}}}),ue.submit||(he.event.special.submit={setup:function(){return he.nodeName(this,"form")?!1:void he.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=he.nodeName(t,"input")||he.nodeName(t,"button")?he.prop(t,"form"):void 0;n&&!he._data(n,"submit")&&(he.event.add(n,"submit._submit",function(e){e._submitBubble=!0}),he._data(n,"submit",!0))})},postDispatch:function(e){e._submitBubble&&(delete e._submitBubble,this.parentNode&&!e.isTrigger&&he.event.simulate("submit",this.parentNode,e))},teardown:function(){return he.nodeName(this,"form")?!1:void he.event.remove(this,"._submit")}}),ue.change||(he.event.special.change={setup:function(){return Ge.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(he.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._justChanged=!0)}),he.event.add(this,"click._change",function(e){this._justChanged&&!e.isTrigger&&(this._justChanged=!1),he.event.simulate("change",this,e)})),!1):void he.event.add(this,"beforeactivate._change",function(e){var t=e.target;Ge.test(t.nodeName)&&!he._data(t,"change")&&(he.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||he.event.simulate("change",this.parentNode,e)}),he._data(t,"change",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return he.event.remove(this,"._change"),!Ge.test(this.nodeName)}}),ue.focusin||he.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){he.event.simulate(t,e.target,he.event.fix(e))};he.event.special[t]={setup:function(){var i=this.ownerDocument||this,s=he._data(i,t);s||i.addEventListener(e,n,!0),he._data(i,t,(s||0)+1)},teardown:function(){var i=this.ownerDocument||this,s=he._data(i,t)-1;s?he._data(i,t,s):(i.removeEventListener(e,n,!0),he._removeData(i,t))}}}),he.fn.extend({on:function(e,t,n,i){return w(this,e,t,n,i)},one:function(e,t,n,i){return w(this,e,t,n,i,1)},off:function(e,t,n){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,he(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(s in e)this.off(s,t,e[s]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=v),this.each(function(){he.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){he.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?he.event.trigger(e,t,n,!0):void 0}});var Ze=/ jQuery\d+="(?:null|\d+)"/g,et=new RegExp("<(?:"+Ue+")[\\s/>]","i"),tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,nt=/<script|<style|<link/i,it=/checked\s*(?:[^=]|=\s*.checked.)/i,st=/^true\/(.*)/,at=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,rt=h(ie),ot=rt.appendChild(ie.createElement("div"));he.extend({htmlPrefilter:function(e){return e.replace(tt,"<$1></$2>")},clone:function(e,t,n){var i,s,a,r,o,l=he.contains(e.ownerDocument,e);if(ue.html5Clone||he.isXMLDoc(e)||!et.test("<"+e.nodeName+">")?a=e.cloneNode(!0):(ot.innerHTML=e.outerHTML,ot.removeChild(a=ot.firstChild)),!(ue.noCloneEvent&&ue.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||he.isXMLDoc(e)))for(i=f(a),o=f(e),r=0;null!=(s=o[r]);++r)i[r]&&T(s,i[r]);if(t)if(n)for(o=o||f(e),i=i||f(a),r=0;null!=(s=o[r]);r++)S(s,i[r]);else S(e,a);return i=f(a,"script"),i.length>0&&m(i,!l&&f(e,"script")),i=o=s=null,a},cleanData:function(e,t){for(var n,i,s,a,r=0,o=he.expando,l=he.cache,p=ue.attributes,c=he.event.special;null!=(n=e[r]);r++)if((t||De(n))&&(s=n[o],a=s&&l[s])){if(a.events)for(i in a.events)c[i]?he.event.remove(n,i):he.removeEvent(n,i,a.handle);l[s]&&(delete l[s],p||"undefined"==typeof n.removeAttribute?n[o]=void 0:n.removeAttribute(o),ne.push(s))}}}),he.fn.extend({domManip:C,detach:function(e){return $(this,e,!0)},remove:function(e){return $(this,e)},text:function(e){return Le(this,function(e){return void 0===e?he.text(this):this.empty().append((this[0]&&this[0].ownerDocument||ie).createTextNode(e))},null,e,arguments.length)},append:function(){return C(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=x(this,e);t.appendChild(e)}})},prepend:function(){return C(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=x(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return C(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return C(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&he.cleanData(f(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&he.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return he.clone(this,e,t)})},html:function(e){return Le(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(Ze,""):void 0;if("string"==typeof e&&!nt.test(e)&&(ue.htmlSerialize||!et.test(e))&&(ue.leadingWhitespace||!We.test(e))&&!He[(ze.exec(e)||["",""])[1].toLowerCase()]){e=he.htmlPrefilter(e);try{for(;i>n;n++)t=this[n]||{},1===t.nodeType&&(he.cleanData(f(t,!1)),t.innerHTML=e);t=0}catch(s){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return C(this,arguments,function(t){var n=this.parentNode;he.inArray(this,e)<0&&(he.cleanData(f(this)),n&&n.replaceChild(t,this))},e)}}),he.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){he.fn[e]=function(e){for(var n,i=0,s=[],a=he(e),r=a.length-1;r>=i;i++)n=i===r?this:this.clone(!0),he(a[i])[t](n),re.apply(s,n.get());return this.pushStack(s)}});var lt,pt={HTML:"block",BODY:"block"},ct=/^margin/,ut=new RegExp("^("+Me+")(?!px)[a-z%]+$","i"),dt=function(e,t,n,i){var s,a,r={};for(a in t)r[a]=e.style[a],e.style[a]=t[a];s=n.apply(e,i||[]);for(a in t)e.style[a]=r[a];return s},ht=ie.documentElement;!function(){function t(){var t,c,u=ie.documentElement;u.appendChild(l),p.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",n=s=o=!1,i=r=!0,e.getComputedStyle&&(c=e.getComputedStyle(p),n="1%"!==(c||{}).top,o="2px"===(c||{}).marginLeft,s="4px"===(c||{width:"4px"}).width,p.style.marginRight="50%",i="4px"===(c||{marginRight:"4px"}).marginRight,t=p.appendChild(ie.createElement("div")),t.style.cssText=p.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",p.style.width="1px",r=!parseFloat((e.getComputedStyle(t)||{}).marginRight),p.removeChild(t)),p.style.display="none",a=0===p.getClientRects().length,a&&(p.style.display="",p.innerHTML="<table><tr><td></td><td>t</td></tr></table>",p.childNodes[0].style.borderCollapse="separate",t=p.getElementsByTagName("td"),t[0].style.cssText="margin:0;border:0;padding:0;display:none",a=0===t[0].offsetHeight,a&&(t[0].style.display="",t[1].style.display="none",a=0===t[0].offsetHeight)),u.removeChild(l)}var n,i,s,a,r,o,l=ie.createElement("div"),p=ie.createElement("div");p.style&&(p.style.cssText="float:left;opacity:.5",ue.opacity="0.5"===p.style.opacity,ue.cssFloat=!!p.style.cssFloat,p.style.backgroundClip="content-box",p.cloneNode(!0).style.backgroundClip="",ue.clearCloneStyle="content-box"===p.style.backgroundClip,l=ie.createElement("div"),l.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",p.innerHTML="",l.appendChild(p),ue.boxSizing=""===p.style.boxSizing||""===p.style.MozBoxSizing||""===p.style.WebkitBoxSizing,he.extend(ue,{reliableHiddenOffsets:function(){return null==n&&t(),a},boxSizingReliable:function(){return null==n&&t(),s},pixelMarginRight:function(){return null==n&&t(),i},pixelPosition:function(){return null==n&&t(),n},reliableMarginRight:function(){return null==n&&t(),r},reliableMarginLeft:function(){return null==n&&t(),o}}))}();var ft,mt,gt=/^(top|right|bottom|left)$/;e.getComputedStyle?(ft=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},mt=function(e,t,n){var i,s,a,r,o=e.style;return n=n||ft(e),r=n?n.getPropertyValue(t)||n[t]:void 0,""!==r&&void 0!==r||he.contains(e.ownerDocument,e)||(r=he.style(e,t)),n&&!ue.pixelMarginRight()&&ut.test(r)&&ct.test(t)&&(i=o.width,s=o.minWidth,a=o.maxWidth,o.minWidth=o.maxWidth=o.width=r,r=n.width,o.width=i,o.minWidth=s,o.maxWidth=a),void 0===r?r:r+""}):ht.currentStyle&&(ft=function(e){return e.currentStyle},mt=function(e,t,n){var i,s,a,r,o=e.style;return n=n||ft(e),r=n?n[t]:void 0,null==r&&o&&o[t]&&(r=o[t]),ut.test(r)&&!gt.test(t)&&(i=o.left,s=e.runtimeStyle,a=s&&s.left,a&&(s.left=e.currentStyle.left),o.left="fontSize"===t?"1em":r,r=o.pixelLeft+"px",o.left=i,a&&(s.left=a)),void 0===r?r:r+""||"auto"});var _t=/alpha\([^)]*\)/i,bt=/opacity\s*=\s*([^)]*)/i,vt=/^(none|table(?!-c[ea]).+)/,yt=new RegExp("^("+Me+")(.*)$","i"),wt={position:"absolute",visibility:"hidden",display:"block"},xt={letterSpacing:"0",fontWeight:"400"},At=["Webkit","O","Moz","ms"],kt=ie.createElement("div").style;he.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=mt(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ue.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,a,r,o=he.camelCase(t),l=e.style;if(t=he.cssProps[o]||(he.cssProps[o]=D(o)||o),r=he.cssHooks[t]||he.cssHooks[o],void 0===n)return r&&"get"in r&&void 0!==(s=r.get(e,!1,i))?s:l[t];if(a=typeof n,"string"===a&&(s=Oe.exec(n))&&s[1]&&(n=d(e,t,s),a="number"),null!=n&&n===n&&("number"===a&&(n+=s&&s[3]||(he.cssNumber[o]?"":"px")),ue.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),!(r&&"set"in r&&void 0===(n=r.set(e,n,i)))))try{l[t]=n}catch(p){}}},css:function(e,t,n,i){var s,a,r,o=he.camelCase(t);return t=he.cssProps[o]||(he.cssProps[o]=D(o)||o),r=he.cssHooks[t]||he.cssHooks[o],r&&"get"in r&&(a=r.get(e,!0,n)),void 0===a&&(a=mt(e,t,i)),"normal"===a&&t in xt&&(a=xt[t]),""===n||n?(s=parseFloat(a),n===!0||isFinite(s)?s||0:a):a}}),he.each(["height","width"],function(e,t){he.cssHooks[t]={get:function(e,n,i){return n?vt.test(he.css(e,"display"))&&0===e.offsetWidth?dt(e,wt,function(){return O(e,t,i)}):O(e,t,i):void 0},set:function(e,n,i){var s=i&&ft(e);return R(e,n,i?M(e,t,i,ue.boxSizing&&"border-box"===he.css(e,"boxSizing",!1,s),s):0)}}}),ue.opacity||(he.cssHooks.opacity={get:function(e,t){return bt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,s=he.isNumeric(t)?"alpha(opacity="+100*t+")":"",a=i&&i.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===he.trim(a.replace(_t,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||i&&!i.filter)||(n.filter=_t.test(a)?a.replace(_t,s):a+" "+s)}}),he.cssHooks.marginRight=j(ue.reliableMarginRight,function(e,t){return t?dt(e,{display:"inline-block"},mt,[e,"marginRight"]):void 0}),he.cssHooks.marginLeft=j(ue.reliableMarginLeft,function(e,t){return t?(parseFloat(mt(e,"marginLeft"))||(he.contains(e.ownerDocument,e)?e.getBoundingClientRect().left-dt(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}):0))+"px":void 0}),he.each({margin:"",padding:"",border:"Width"},function(e,t){he.cssHooks[e+t]={expand:function(n){for(var i=0,s={},a="string"==typeof n?n.split(" "):[n];4>i;i++)s[e+Pe[i]+t]=a[i]||a[i-2]||a[0];return s}},ct.test(e)||(he.cssHooks[e+t].set=R)}),he.fn.extend({css:function(e,t){return Le(this,function(e,t,n){var i,s,a={},r=0;if(he.isArray(t)){for(i=ft(e),s=t.length;s>r;r++)a[t[r]]=he.css(e,t[r],!1,i);return a}return void 0!==n?he.style(e,t,n):he.css(e,t)},e,t,arguments.length>1)},show:function(){return F(this,!0)},hide:function(){return F(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ie(this)?he(this).show():he(this).hide()})}}),he.Tween=P,P.prototype={constructor:P,init:function(e,t,n,i,s,a){this.elem=e,this.prop=n,this.easing=s||he.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=a||(he.cssNumber[n]?"":"px")},cur:function(){var e=P.propHooks[this.prop];return e&&e.get?e.get(this):P.propHooks._default.get(this)},run:function(e){var t,n=P.propHooks[this.prop];return this.options.duration?this.pos=t=he.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):P.propHooks._default.set(this),this}},P.prototype.init.prototype=P.prototype,P.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=he.css(e.elem,e.prop,""),t&&"auto"!==t?t:0)},set:function(e){he.fx.step[e.prop]?he.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[he.cssProps[e.prop]]&&!he.cssHooks[e.prop]?e.elem[e.prop]=e.now:he.style(e.elem,e.prop,e.now+e.unit)}}},P.propHooks.scrollTop=P.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},he.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},he.fx=P.prototype.init,he.fx.step={};var St,Tt,Ct=/^(?:toggle|show|hide)$/,$t=/queueHooks$/;he.Animation=he.extend(W,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return d(n.elem,e,Oe.exec(t),n),n}]},tweener:function(e,t){he.isFunction(e)?(t=e,e=["*"]):e=e.match(Ee);for(var n,i=0,s=e.length;s>i;i++)n=e[i],W.tweeners[n]=W.tweeners[n]||[],W.tweeners[n].unshift(t)},prefilters:[z],prefilter:function(e,t){t?W.prefilters.unshift(e):W.prefilters.push(e)}}),he.speed=function(e,t,n){var i=e&&"object"==typeof e?he.extend({},e):{complete:n||!n&&t||he.isFunction(e)&&e,duration:e,easing:n&&t||t&&!he.isFunction(t)&&t};return i.duration=he.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in he.fx.speeds?he.fx.speeds[i.duration]:he.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){he.isFunction(i.old)&&i.old.call(this),i.queue&&he.dequeue(this,i.queue)},i},he.fn.extend({fadeTo:function(e,t,n,i){return this.filter(Ie).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var s=he.isEmptyObject(e),a=he.speed(t,n,i),r=function(){var t=W(this,he.extend({},e),a);(s||he._data(this,"finish"))&&t.stop(!0)};return r.finish=r,s||a.queue===!1?this.each(r):this.queue(a.queue,r)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,s=null!=e&&e+"queueHooks",a=he.timers,r=he._data(this);if(s)r[s]&&r[s].stop&&i(r[s]);else for(s in r)r[s]&&r[s].stop&&$t.test(s)&&i(r[s]);for(s=a.length;s--;)a[s].elem!==this||null!=e&&a[s].queue!==e||(a[s].anim.stop(n),t=!1,a.splice(s,1));(t||!n)&&he.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=he._data(this),i=n[e+"queue"],s=n[e+"queueHooks"],a=he.timers,r=i?i.length:0;for(n.finish=!0,he.queue(this,e,[]),s&&s.stop&&s.stop.call(this,!0),t=a.length;t--;)a[t].elem===this&&a[t].queue===e&&(a[t].anim.stop(!0),a.splice(t,1));for(t=0;r>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),he.each(["toggle","show","hide"],function(e,t){var n=he.fn[t];he.fn[t]=function(e,i,s){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(L(t,!0),e,i,s)}}),he.each({slideDown:L("show"),slideUp:L("hide"),slideToggle:L("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){he.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),he.timers=[],he.fx.tick=function(){var e,t=he.timers,n=0;for(St=he.now();n<t.length;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||he.fx.stop(),St=void 0},he.fx.timer=function(e){he.timers.push(e),e()?he.fx.start():he.timers.pop()},he.fx.interval=13,he.fx.start=function(){Tt||(Tt=e.setInterval(he.fx.tick,he.fx.interval))},he.fx.stop=function(){e.clearInterval(Tt),Tt=null},he.fx.speeds={slow:600,fast:200,_default:400},he.fn.delay=function(t,n){return t=he.fx?he.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,i){var s=e.setTimeout(n,t);i.stop=function(){e.clearTimeout(s)}})},function(){var e,t=ie.createElement("input"),n=ie.createElement("div"),i=ie.createElement("select"),s=i.appendChild(ie.createElement("option"));n=ie.createElement("div"),n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=n.getElementsByTagName("a")[0],t.setAttribute("type","checkbox"),n.appendChild(t),e=n.getElementsByTagName("a")[0],e.style.cssText="top:1px",ue.getSetAttribute="t"!==n.className,ue.style=/top/.test(e.getAttribute("style")),ue.hrefNormalized="/a"===e.getAttribute("href"),ue.checkOn=!!t.value,ue.optSelected=s.selected,ue.enctype=!!ie.createElement("form").enctype,i.disabled=!0,ue.optDisabled=!s.disabled,t=ie.createElement("input"),t.setAttribute("value",""),ue.input=""===t.getAttribute("value"),t.value="t",t.setAttribute("type","radio"),ue.radioValue="t"===t.value}();var Et=/\r/g,Nt=/[\x20\t\r\n\f]+/g;he.fn.extend({val:function(e){var t,n,i,s=this[0];{if(arguments.length)return i=he.isFunction(e),this.each(function(n){var s;1===this.nodeType&&(s=i?e.call(this,n,he(this).val()):e,null==s?s="":"number"==typeof s?s+="":he.isArray(s)&&(s=he.map(s,function(e){return null==e?"":e+""})),t=he.valHooks[this.type]||he.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,s,"value")||(this.value=s))});if(s)return t=he.valHooks[s.type]||he.valHooks[s.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(s,"value"))?n:(n=s.value,"string"==typeof n?n.replace(Et,""):null==n?"":n)}}}),he.extend({valHooks:{option:{get:function(e){var t=he.find.attr(e,"value");return null!=t?t:he.trim(he.text(e)).replace(Nt," ")}},select:{get:function(e){for(var t,n,i=e.options,s=e.selectedIndex,a="select-one"===e.type||0>s,r=a?null:[],o=a?s+1:i.length,l=0>s?o:a?s:0;o>l;l++)if(n=i[l],(n.selected||l===s)&&(ue.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!he.nodeName(n.parentNode,"optgroup"))){if(t=he(n).val(),a)return t;r.push(t)}return r},set:function(e,t){for(var n,i,s=e.options,a=he.makeArray(t),r=s.length;r--;)if(i=s[r],he.inArray(he.valHooks.option.get(i),a)>-1)try{i.selected=n=!0}catch(o){i.scrollHeight}else i.selected=!1;return n||(e.selectedIndex=-1),s}}}}),he.each(["radio","checkbox"],function(){he.valHooks[this]={set:function(e,t){return he.isArray(t)?e.checked=he.inArray(he(e).val(),t)>-1:void 0}},ue.checkOn||(he.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var jt,Dt,Ft=he.expr.attrHandle,Rt=/^(?:checked|selected)$/i,Mt=ue.getSetAttribute,Ot=ue.input;he.fn.extend({attr:function(e,t){return Le(this,he.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){he.removeAttr(this,e)})}}),he.extend({attr:function(e,t,n){var i,s,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return"undefined"==typeof e.getAttribute?he.prop(e,t,n):(1===a&&he.isXMLDoc(e)||(t=t.toLowerCase(),s=he.attrHooks[t]||(he.expr.match.bool.test(t)?Dt:jt)),void 0!==n?null===n?void he.removeAttr(e,t):s&&"set"in s&&void 0!==(i=s.set(e,n,t))?i:(e.setAttribute(t,n+""),n):s&&"get"in s&&null!==(i=s.get(e,t))?i:(i=he.find.attr(e,t),null==i?void 0:i))},attrHooks:{type:{set:function(e,t){if(!ue.radioValue&&"radio"===t&&he.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i,s=0,a=t&&t.match(Ee);if(a&&1===e.nodeType)for(;n=a[s++];)i=he.propFix[n]||n,he.expr.match.bool.test(n)?Ot&&Mt||!Rt.test(n)?e[i]=!1:e[he.camelCase("default-"+n)]=e[i]=!1:he.attr(e,n,""),e.removeAttribute(Mt?n:i)}}),Dt={set:function(e,t,n){return t===!1?he.removeAttr(e,n):Ot&&Mt||!Rt.test(n)?e.setAttribute(!Mt&&he.propFix[n]||n,n):e[he.camelCase("default-"+n)]=e[n]=!0,n}},he.each(he.expr.match.bool.source.match(/\w+/g),function(e,t){var n=Ft[t]||he.find.attr;Ot&&Mt||!Rt.test(t)?Ft[t]=function(e,t,i){var s,a;return i||(a=Ft[t],Ft[t]=s,s=null!=n(e,t,i)?t.toLowerCase():null,Ft[t]=a),s}:Ft[t]=function(e,t,n){return n?void 0:e[he.camelCase("default-"+t)]?t.toLowerCase():null}}),Ot&&Mt||(he.attrHooks.value={set:function(e,t,n){return he.nodeName(e,"input")?void(e.defaultValue=t):jt&&jt.set(e,t,n)}}),Mt||(jt={set:function(e,t,n){var i=e.getAttributeNode(n);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(n)),i.value=t+="","value"===n||t===e.getAttribute(n)?t:void 0}},Ft.id=Ft.name=Ft.coords=function(e,t,n){var i;return n?void 0:(i=e.getAttributeNode(t))&&""!==i.value?i.value:null},he.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);return n&&n.specified?n.value:void 0},set:jt.set},he.attrHooks.contenteditable={set:function(e,t,n){jt.set(e,""===t?!1:t,n)}},he.each(["width","height"],function(e,t){he.attrHooks[t]={set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}}})),ue.style||(he.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var Pt=/^(?:input|select|textarea|button|object)$/i,It=/^(?:a|area)$/i;he.fn.extend({prop:function(e,t){return Le(this,he.prop,e,t,arguments.length>1)},removeProp:function(e){return e=he.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(t){}})}}),he.extend({prop:function(e,t,n){var i,s,a=e.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&he.isXMLDoc(e)||(t=he.propFix[t]||t,s=he.propHooks[t]),void 0!==n?s&&"set"in s&&void 0!==(i=s.set(e,n,t))?i:e[t]=n:s&&"get"in s&&null!==(i=s.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=he.find.attr(e,"tabindex");return t?parseInt(t,10):Pt.test(e.nodeName)||It.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),ue.hrefNormalized||he.each(["href","src"],function(e,t){he.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),ue.optSelected||(he.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),he.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){he.propFix[this.toLowerCase()]=this}),ue.enctype||(he.propFix.enctype="encoding");var Lt=/[\t\r\n\f]/g;he.fn.extend({addClass:function(e){var t,n,i,s,a,r,o,l=0;if(he.isFunction(e))return this.each(function(t){he(this).addClass(e.call(this,t,U(this)))});if("string"==typeof e&&e)for(t=e.match(Ee)||[];n=this[l++];)if(s=U(n),i=1===n.nodeType&&(" "+s+" ").replace(Lt," ")){for(r=0;a=t[r++];)i.indexOf(" "+a+" ")<0&&(i+=a+" ");o=he.trim(i),s!==o&&he.attr(n,"class",o)}return this},removeClass:function(e){var t,n,i,s,a,r,o,l=0;if(he.isFunction(e))return this.each(function(t){he(this).removeClass(e.call(this,t,U(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(Ee)||[];n=this[l++];)if(s=U(n),i=1===n.nodeType&&(" "+s+" ").replace(Lt," ")){for(r=0;a=t[r++];)for(;i.indexOf(" "+a+" ")>-1;)i=i.replace(" "+a+" "," ");o=he.trim(i),s!==o&&he.attr(n,"class",o)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):he.isFunction(e)?this.each(function(n){he(this).toggleClass(e.call(this,n,U(this),t),t)}):this.each(function(){var t,i,s,a;if("string"===n)for(i=0,s=he(this),a=e.match(Ee)||[];t=a[i++];)s.hasClass(t)?s.removeClass(t):s.addClass(t);else(void 0===e||"boolean"===n)&&(t=U(this),t&&he._data(this,"__className__",t),he.attr(this,"class",t||e===!1?"":he._data(this,"__className__")||""))})},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&(" "+U(n)+" ").replace(Lt," ").indexOf(t)>-1)return!0;return!1}}),he.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){he.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),he.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}});var qt=e.location,zt=he.now(),Bt=/\?/,Wt=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;he.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var n,i=null,s=he.trim(t+"");return s&&!he.trim(s.replace(Wt,function(e,t,s,a){return n&&t&&(i=0),0===i?e:(n=s||t,i+=!a-!s,"")}))?Function("return "+s)():he.error("Invalid JSON: "+t)},he.parseXML=function(t){var n,i;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(i=new e.DOMParser,n=i.parseFromString(t,"text/xml")):(n=new e.ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(t))}catch(s){n=void 0}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||he.error("Invalid XML: "+t),n};var Ut=/#.*$/,Ht=/([?&])_=[^&]*/,Jt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Vt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Gt=/^(?:GET|HEAD)$/,Yt=/^\/\//,Xt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Qt={},Kt={},Zt="*/".concat("*"),en=qt.href,tn=Xt.exec(en.toLowerCase())||[];he.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:en,type:"GET",isLocal:Vt.test(tn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":he.parseJSON,"text xml":he.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?V(V(e,he.ajaxSettings),t):V(he.ajaxSettings,e)},ajaxPrefilter:H(Qt),ajaxTransport:H(Kt),ajax:function(t,n){function i(t,n,i,s){var a,u,b,v,w,A=n;2!==y&&(y=2,l&&e.clearTimeout(l),c=void 0,o=s||"",x.readyState=t>0?4:0,a=t>=200&&300>t||304===t,i&&(v=G(d,x,i)),v=Y(d,v,x,a),a?(d.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(he.lastModified[r]=w),w=x.getResponseHeader("etag"),w&&(he.etag[r]=w)),204===t||"HEAD"===d.type?A="nocontent":304===t?A="notmodified":(A=v.state,u=v.data,b=v.error,a=!b)):(b=A,(t||!A)&&(A="error",0>t&&(t=0))),x.status=t,x.statusText=(n||A)+"",a?m.resolveWith(h,[u,A,x]):m.rejectWith(h,[x,A,b]),x.statusCode(_),_=void 0,p&&f.trigger(a?"ajaxSuccess":"ajaxError",[x,d,a?u:b]),g.fireWith(h,[x,A]),p&&(f.trigger("ajaxComplete",[x,d]),--he.active||he.event.trigger("ajaxStop")))}"object"==typeof t&&(n=t,t=void 0),n=n||{};var s,a,r,o,l,p,c,u,d=he.ajaxSetup({},n),h=d.context||d,f=d.context&&(h.nodeType||h.jquery)?he(h):he.event,m=he.Deferred(),g=he.Callbacks("once memory"),_=d.statusCode||{},b={},v={},y=0,w="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!u)for(u={};t=Jt.exec(o);)u[t[1].toLowerCase()]=t[2];t=u[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=v[n]=v[n]||e,b[e]=t),this},overrideMimeType:function(e){return y||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)_[t]=[_[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||w;return c&&c.abort(t),i(0,t),this}};if(m.promise(x).complete=g.add,x.success=x.done,x.error=x.fail,d.url=((t||d.url||en)+"").replace(Ut,"").replace(Yt,tn[1]+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=he.trim(d.dataType||"*").toLowerCase().match(Ee)||[""],null==d.crossDomain&&(s=Xt.exec(d.url.toLowerCase()),d.crossDomain=!(!s||s[1]===tn[1]&&s[2]===tn[2]&&(s[3]||("http:"===s[1]?"80":"443"))===(tn[3]||("http:"===tn[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=he.param(d.data,d.traditional)),J(Qt,d,n,x),2===y)return x;p=he.event&&d.global,p&&0===he.active++&&he.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Gt.test(d.type),r=d.url,d.hasContent||(d.data&&(r=d.url+=(Bt.test(r)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=Ht.test(r)?r.replace(Ht,"$1_="+zt++):r+(Bt.test(r)?"&":"?")+"_="+zt++)),d.ifModified&&(he.lastModified[r]&&x.setRequestHeader("If-Modified-Since",he.lastModified[r]),he.etag[r]&&x.setRequestHeader("If-None-Match",he.etag[r])),(d.data&&d.hasContent&&d.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",d.contentType),x.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Zt+"; q=0.01":""):d.accepts["*"]);for(a in d.headers)x.setRequestHeader(a,d.headers[a]);if(d.beforeSend&&(d.beforeSend.call(h,x,d)===!1||2===y))return x.abort();w="abort";for(a in{success:1,error:1,complete:1})x[a](d[a]);if(c=J(Kt,d,n,x)){if(x.readyState=1,p&&f.trigger("ajaxSend",[x,d]),2===y)return x;d.async&&d.timeout>0&&(l=e.setTimeout(function(){x.abort("timeout")},d.timeout));try{y=1,c.send(b,i)}catch(A){if(!(2>y))throw A;i(-1,A)}}else i(-1,"No Transport");return x},getJSON:function(e,t,n){return he.get(e,t,n,"json")},getScript:function(e,t){return he.get(e,void 0,t,"script")}}),he.each(["get","post"],function(e,t){he[t]=function(e,n,i,s){return he.isFunction(n)&&(s=s||i,i=n,n=void 0),he.ajax(he.extend({url:e,type:t,dataType:s,data:n,success:i},he.isPlainObject(e)&&e))}}),he._evalUrl=function(e){return he.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},he.fn.extend({wrapAll:function(e){if(he.isFunction(e))return this.each(function(t){he(this).wrapAll(e.call(this,t))});if(this[0]){var t=he(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return he.isFunction(e)?this.each(function(t){he(this).wrapInner(e.call(this,t))}):this.each(function(){var t=he(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=he.isFunction(e);return this.each(function(n){he(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){he.nodeName(this,"body")||he(this).replaceWith(this.childNodes)}).end()}}),he.expr.filters.hidden=function(e){return ue.reliableHiddenOffsets()?e.offsetWidth<=0&&e.offsetHeight<=0&&!e.getClientRects().length:Q(e)},he.expr.filters.visible=function(e){return!he.expr.filters.hidden(e)};var nn=/%20/g,sn=/\[\]$/,an=/\r?\n/g,rn=/^(?:submit|button|image|reset|file)$/i,on=/^(?:input|select|textarea|keygen)/i;he.param=function(e,t){var n,i=[],s=function(e,t){t=he.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=he.ajaxSettings&&he.ajaxSettings.traditional),he.isArray(e)||e.jquery&&!he.isPlainObject(e))he.each(e,function(){s(this.name,this.value)});else for(n in e)K(n,e[n],t,s);return i.join("&").replace(nn,"+")},he.fn.extend({serialize:function(){return he.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=he.prop(this,"elements");return e?he.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!he(this).is(":disabled")&&on.test(this.nodeName)&&!rn.test(e)&&(this.checked||!qe.test(e))}).map(function(e,t){var n=he(this).val();return null==n?null:he.isArray(n)?he.map(n,function(e){return{name:t.name,value:e.replace(an,"\r\n")}}):{name:t.name,value:n.replace(an,"\r\n")}}).get()}}),he.ajaxSettings.xhr=void 0!==e.ActiveXObject?function(){return this.isLocal?ee():ie.documentMode>8?Z():/^(get|post|head|put|delete|options)$/i.test(this.type)&&Z()||ee()}:Z;var ln=0,pn={},cn=he.ajaxSettings.xhr();
e.attachEvent&&e.attachEvent("onunload",function(){for(var e in pn)pn[e](void 0,!0)}),ue.cors=!!cn&&"withCredentials"in cn,cn=ue.ajax=!!cn,cn&&he.ajaxTransport(function(t){if(!t.crossDomain||ue.cors){var n;return{send:function(i,s){var a,r=t.xhr(),o=++ln;if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)r[a]=t.xhrFields[a];t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(a in i)void 0!==i[a]&&r.setRequestHeader(a,i[a]+"");r.send(t.hasContent&&t.data||null),n=function(e,i){var a,l,p;if(n&&(i||4===r.readyState))if(delete pn[o],n=void 0,r.onreadystatechange=he.noop,i)4!==r.readyState&&r.abort();else{p={},a=r.status,"string"==typeof r.responseText&&(p.text=r.responseText);try{l=r.statusText}catch(c){l=""}a||!t.isLocal||t.crossDomain?1223===a&&(a=204):a=p.text?200:404}p&&s(a,l,p,r.getAllResponseHeaders())},t.async?4===r.readyState?e.setTimeout(n):r.onreadystatechange=pn[o]=n:n()},abort:function(){n&&n(void 0,!0)}}}}),he.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return he.globalEval(e),e}}}),he.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),he.ajaxTransport("script",function(e){if(e.crossDomain){var t,n=ie.head||he("head")[0]||ie.documentElement;return{send:function(i,s){t=ie.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){(n||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||s(200,"success"))},n.insertBefore(t,n.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var un=[],dn=/(=)\?(?=&|$)|\?\?/;he.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=un.pop()||he.expando+"_"+zt++;return this[e]=!0,e}}),he.ajaxPrefilter("json jsonp",function(t,n,i){var s,a,r,o=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return o||"jsonp"===t.dataTypes[0]?(s=t.jsonpCallback=he.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,o?t[o]=t[o].replace(dn,"$1"+s):t.jsonp!==!1&&(t.url+=(Bt.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return r||he.error(s+" was not called"),r[0]},t.dataTypes[0]="json",a=e[s],e[s]=function(){r=arguments},i.always(function(){void 0===a?he(e).removeProp(s):e[s]=a,t[s]&&(t.jsonpCallback=n.jsonpCallback,un.push(s)),r&&he.isFunction(a)&&a(r[0]),r=a=void 0}),"script"):void 0}),he.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||ie;var i=xe.exec(e),s=!n&&[];return i?[t.createElement(i[1])]:(i=_([e],t,s),s&&s.length&&he(s).remove(),he.merge([],i.childNodes))};var hn=he.fn.load;he.fn.load=function(e,t,n){if("string"!=typeof e&&hn)return hn.apply(this,arguments);var i,s,a,r=this,o=e.indexOf(" ");return o>-1&&(i=he.trim(e.slice(o,e.length)),e=e.slice(0,o)),he.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(s="POST"),r.length>0&&he.ajax({url:e,type:s||"GET",dataType:"html",data:t}).done(function(e){a=arguments,r.html(i?he("<div>").append(he.parseHTML(e)).find(i):e)}).always(n&&function(e,t){r.each(function(){n.apply(this,a||[e.responseText,t,e])})}),this},he.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){he.fn[t]=function(e){return this.on(t,e)}}),he.expr.filters.animated=function(e){return he.grep(he.timers,function(t){return e===t.elem}).length},he.offset={setOffset:function(e,t,n){var i,s,a,r,o,l,p,c=he.css(e,"position"),u=he(e),d={};"static"===c&&(e.style.position="relative"),o=u.offset(),a=he.css(e,"top"),l=he.css(e,"left"),p=("absolute"===c||"fixed"===c)&&he.inArray("auto",[a,l])>-1,p?(i=u.position(),r=i.top,s=i.left):(r=parseFloat(a)||0,s=parseFloat(l)||0),he.isFunction(t)&&(t=t.call(e,n,he.extend({},o))),null!=t.top&&(d.top=t.top-o.top+r),null!=t.left&&(d.left=t.left-o.left+s),"using"in t?t.using.call(e,d):u.css(d)}},he.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){he.offset.setOffset(this,e,t)});var t,n,i={top:0,left:0},s=this[0],a=s&&s.ownerDocument;if(a)return t=a.documentElement,he.contains(t,s)?("undefined"!=typeof s.getBoundingClientRect&&(i=s.getBoundingClientRect()),n=te(a),{top:i.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:i.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):i},position:function(){if(this[0]){var e,t,n={top:0,left:0},i=this[0];return"fixed"===he.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),he.nodeName(e[0],"html")||(n=e.offset()),n.top+=he.css(e[0],"borderTopWidth",!0),n.left+=he.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-he.css(i,"marginTop",!0),left:t.left-n.left-he.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&!he.nodeName(e,"html")&&"static"===he.css(e,"position");)e=e.offsetParent;return e||ht})}}),he.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n=/Y/.test(t);he.fn[e]=function(i){return Le(this,function(e,i,s){var a=te(e);return void 0===s?a?t in a?a[t]:a.document.documentElement[i]:e[i]:void(a?a.scrollTo(n?he(a).scrollLeft():s,n?s:he(a).scrollTop()):e[i]=s)},e,i,arguments.length,null)}}),he.each(["top","left"],function(e,t){he.cssHooks[t]=j(ue.pixelPosition,function(e,n){return n?(n=mt(e,t),ut.test(n)?he(e).position()[t]+"px":n):void 0})}),he.each({Height:"height",Width:"width"},function(e,t){he.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){he.fn[i]=function(i,s){var a=arguments.length&&(n||"boolean"!=typeof i),r=n||(i===!0||s===!0?"margin":"border");return Le(this,function(t,n,i){var s;return he.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(s=t.documentElement,Math.max(t.body["scroll"+e],s["scroll"+e],t.body["offset"+e],s["offset"+e],s["client"+e])):void 0===i?he.css(t,n,r):he.style(t,n,i,r)},t,a?i:void 0,a,null)}})}),he.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),he.fn.size=function(){return this.length},he.fn.andSelf=he.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return he});var fn=e.jQuery,mn=e.$;return he.noConflict=function(t){return e.$===he&&(e.$=mn),t&&e.jQuery===he&&(e.jQuery=fn),he},t||(e.jQuery=e.$=he),he}),function(e,t){"use strict";e.rails!==t&&e.error("jquery-ujs has already been loaded!");var n,i=e(document);e.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]",buttonClickSelector:"button[data-remote]:not([form]):not(form button), button[data-confirm]:not([form]):not(form button)",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",disableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",requiredInputSelector:"input[name][required]:not([disabled]), textarea[name][required]:not([disabled])",fileInputSelector:"input[name][type=file]:not([disabled])",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]",csrfToken:function(){return e("meta[name=csrf-token]").attr("content")},csrfParam:function(){return e("meta[name=csrf-param]").attr("content")},CSRFProtection:function(e){var t=n.csrfToken();t&&e.setRequestHeader("X-CSRF-Token",t)},refreshCSRFTokens:function(){e('form input[name="'+n.csrfParam()+'"]').val(n.csrfToken())},fire:function(t,n,i){var s=e.Event(n);return t.trigger(s,i),s.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e[0].href},isRemote:function(e){return e.data("remote")!==t&&e.data("remote")!==!1},handleRemote:function(i){var s,a,r,o,l,p;if(n.fire(i,"ajax:before")){if(o=i.data("with-credentials")||null,l=i.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,i.is("form")){s=i.data("ujs:submit-button-formmethod")||i.attr("method"),a=i.data("ujs:submit-button-formaction")||i.attr("action"),r=e(i[0]).serializeArray();var c=i.data("ujs:submit-button");c&&(r.push(c),i.data("ujs:submit-button",null)),i.data("ujs:submit-button-formmethod",null),i.data("ujs:submit-button-formaction",null)}else i.is(n.inputChangeSelector)?(s=i.data("method"),a=i.data("url"),r=i.serialize(),i.data("params")&&(r=r+"&"+i.data("params"))):i.is(n.buttonClickSelector)?(s=i.data("method")||"get",a=i.data("url"),r=i.serialize(),i.data("params")&&(r=r+"&"+i.data("params"))):(s=i.data("method"),a=n.href(i),r=i.data("params")||null);return p={type:s||"GET",data:r,dataType:l,beforeSend:function(e,s){return s.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+s.accepts.script),n.fire(i,"ajax:beforeSend",[e,s])?void i.trigger("ajax:send",e):!1},success:function(e,t,n){i.trigger("ajax:success",[e,t,n])},complete:function(e,t){i.trigger("ajax:complete",[e,t])},error:function(e,t,n){i.trigger("ajax:error",[e,t,n])},crossDomain:n.isCrossDomain(a)},o&&(p.xhrFields={withCredentials:o}),a&&(p.url=a),n.ajax(p)}return!1},isCrossDomain:function(e){var t=document.createElement("a");t.href=location.href;var n=document.createElement("a");try{return n.href=e,n.href=n.href,!((!n.protocol||":"===n.protocol)&&!n.host||t.protocol+"//"+t.host==n.protocol+"//"+n.host)}catch(i){return!0}},handleMethod:function(i){var s=n.href(i),a=i.data("method"),r=i.attr("target"),o=n.csrfToken(),l=n.csrfParam(),p=e('<form method="post" action="'+s+'"></form>'),c='<input name="_method" value="'+a+'" type="hidden" />';l===t||o===t||n.isCrossDomain(s)||(c+='<input name="'+l+'" value="'+o+'" type="hidden" />'),r&&p.attr("target",r),p.hide().append(c).appendTo("body"),p.submit()},formElements:function(t,n){return t.is("form")?e(t[0].elements).filter(n):t.find(n)},disableFormElements:function(t){n.formElements(t,n.disableSelector).each(function(){n.disableFormElement(e(this))})},disableFormElement:function(e){var n,i;n=e.is("button")?"html":"val",i=e.data("disable-with"),i!==t&&(e.data("ujs:enable-with",e[n]()),e[n](i)),e.prop("disabled",!0),e.data("ujs:disabled",!0)},enableFormElements:function(t){n.formElements(t,n.enableSelector).each(function(){n.enableFormElement(e(this))})},enableFormElement:function(e){var n=e.is("button")?"html":"val";e.data("ujs:enable-with")!==t&&(e[n](e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.prop("disabled",!1),e.removeData("ujs:disabled")},allowAction:function(e){var t,i=e.data("confirm"),s=!1;if(!i)return!0;if(n.fire(e,"confirm")){try{s=n.confirm(i)}catch(a){(console.error||console.log).call(console,a.stack||a)}t=n.fire(e,"confirm:complete",[s])}return s&&t},blankInputs:function(t,n,i){var s,a,r,o,l=e(),p=n||"input,textarea",c=t.find(p),u={};return c.each(function(){s=e(this),s.is("input[type=radio]")?(o=s.attr("name"),u[o]||(0===t.find('input[type=radio]:checked[name="'+o+'"]').length&&(r=t.find('input[type=radio][name="'+o+'"]'),l=l.add(r)),u[o]=o)):(a=s.is("input[type=checkbox],input[type=radio]")?s.is(":checked"):!!s.val(),a===i&&(l=l.add(s)))}),l.length?l:!1},nonBlankInputs:function(e,t){return n.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){var i=e.data("disable-with");i!==t&&(e.data("ujs:enable-with",e.html()),e.html(i)),e.bind("click.railsDisable",function(e){return n.stopEverything(e)}),e.data("ujs:disabled",!0)},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable"),e.removeData("ujs:disabled")}},n.fire(i,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,i){e.crossDomain||n.CSRFProtection(i)}),e(window).on("pageshow.rails",function(){e(e.rails.enableSelector).each(function(){var t=e(this);t.data("ujs:disabled")&&e.rails.enableFormElement(t)}),e(e.rails.linkDisableSelector).each(function(){var t=e(this);t.data("ujs:disabled")&&e.rails.enableElement(t)})}),i.on("ajax:complete",n.linkDisableSelector,function(){n.enableElement(e(this))}),i.on("ajax:complete",n.buttonDisableSelector,function(){n.enableFormElement(e(this))}),i.on("click.rails",n.linkClickSelector,function(t){var i=e(this),s=i.data("method"),a=i.data("params"),r=t.metaKey||t.ctrlKey;if(!n.allowAction(i))return n.stopEverything(t);if(!r&&i.is(n.linkDisableSelector)&&n.disableElement(i),n.isRemote(i)){if(r&&(!s||"GET"===s)&&!a)return!0;var o=n.handleRemote(i);return o===!1?n.enableElement(i):o.fail(function(){n.enableElement(i)}),!1}return s?(n.handleMethod(i),!1):void 0}),i.on("click.rails",n.buttonClickSelector,function(t){var i=e(this);if(!n.allowAction(i)||!n.isRemote(i))return n.stopEverything(t);i.is(n.buttonDisableSelector)&&n.disableFormElement(i);var s=n.handleRemote(i);return s===!1?n.enableFormElement(i):s.fail(function(){n.enableFormElement(i)}),!1}),i.on("change.rails",n.inputChangeSelector,function(t){var i=e(this);return n.allowAction(i)&&n.isRemote(i)?(n.handleRemote(i),!1):n.stopEverything(t)}),i.on("submit.rails",n.formSubmitSelector,function(i){var s,a,r=e(this),o=n.isRemote(r);if(!n.allowAction(r))return n.stopEverything(i);if(r.attr("novalidate")===t)if(r.data("ujs:formnovalidate-button")===t){if(s=n.blankInputs(r,n.requiredInputSelector,!1),s&&n.fire(r,"ajax:aborted:required",[s]))return n.stopEverything(i)}else r.data("ujs:formnovalidate-button",t);if(o){if(a=n.nonBlankInputs(r,n.fileInputSelector)){setTimeout(function(){n.disableFormElements(r)},13);var l=n.fire(r,"ajax:aborted:file",[a]);return l||setTimeout(function(){n.enableFormElements(r)},13),l}return n.handleRemote(r),!1}setTimeout(function(){n.disableFormElements(r)},13)}),i.on("click.rails",n.formInputClickSelector,function(t){var i=e(this);if(!n.allowAction(i))return n.stopEverything(t);var s=i.attr("name"),a=s?{name:s,value:i.val()}:null,r=i.closest("form");0===r.length&&(r=e("#"+i.attr("form"))),r.data("ujs:submit-button",a),r.data("ujs:formnovalidate-button",i.attr("formnovalidate")),r.data("ujs:submit-button-formaction",i.attr("formaction")),r.data("ujs:submit-button-formmethod",i.attr("formmethod"))}),i.on("ajax:send.rails",n.formSubmitSelector,function(t){this===t.target&&n.disableFormElements(e(this))}),i.on("ajax:complete.rails",n.formSubmitSelector,function(t){this===t.target&&n.enableFormElements(e(this))}),e(function(){n.refreshCSRFTokens()}))}(jQuery);var CryptoJS=CryptoJS||function(e,t){var n={},i=n.lib={},s=function(){},a=i.Base={extend:function(e){s.prototype=this;var t=new s;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},r=i.WordArray=a.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var s=0;e>s;s++)t[i+s>>>2]|=(n[s>>>2]>>>24-8*(s%4)&255)<<24-8*((i+s)%4);else if(65535<n.length)for(s=0;e>s;s+=4)t[i+s>>>2]=n[s>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],i=0;t>i;i+=4)n.push(4294967296*e.random()|0);return new r.init(n,t)}}),o=n.enc={},l=o.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],i=0;e>i;i++){var s=t[i>>>2]>>>24-8*(i%4)&255;n.push((s>>>4).toString(16)),n.push((15&s).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],i=0;t>i;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-4*(i%8);return new r.init(n,t/2)}},p=o.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],i=0;e>i;i++)n.push(String.fromCharCode(t[i>>>2]>>>24-8*(i%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],i=0;t>i;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-8*(i%4);return new r.init(n,t)}},c=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},u=i.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,s=n.sigBytes,a=this.blockSize,o=s/(4*a),o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0);if(t=o*a,s=e.min(4*t,s),t){for(var l=0;t>l;l+=a)this._doProcessBlock(i,l);l=i.splice(0,t),n.sigBytes-=s}return new r.init(l,s)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=u.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}});var d=n.algo={};return n}(Math);if(function(){var e=CryptoJS,t=e.lib,n=t.WordArray,i=t.Hasher,s=[],t=e.algo.SHA1=i.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],a=n[1],r=n[2],o=n[3],l=n[4],p=0;80>p;p++){if(16>p)s[p]=0|e[t+p];else{var c=s[p-3]^s[p-8]^s[p-14]^s[p-16];s[p]=c<<1|c>>>31}c=(i<<5|i>>>27)+l+s[p],c=20>p?c+((a&r|~a&o)+1518500249):40>p?c+((a^r^o)+1859775393):60>p?c+((a&r|a&o|r&o)-1894007588):c+((a^r^o)-899497514),l=o,o=r,r=a<<30|a>>>2,a=i,i=c}n[0]=n[0]+i|0,n[1]=n[1]+a|0,n[2]=n[2]+r|0,n[3]=n[3]+o|0,n[4]=n[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[(i+64>>>9<<4)+14]=Math.floor(n/4294967296),t[(i+64>>>9<<4)+15]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=i._createHelper(t),e.HmacSHA1=i._createHmacHelper(t)}(),void 0==typeof $||void 0==typeof _){var jquery_undefined=void 0==typeof $,underscore_undefined=void 0==typeof _,is_chrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1,is_firefox=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,error_message="An error occurred and Splitwise failed to load. Please email us at support@splitwise.com, so that we can ";error_message+="look into your problem further (and make sure it doesn't happen in the future).",(is_chrome||is_firefox)&&(error_message+="\n\n",error_message+="P.S. If you want to be super helpful, please send us a copy of your browser's error logs! ",error_message+="You can view your logs by clicking 'OK', then typing ",error_message+=is_chrome?"Control-Shift-J (Windows) or Command-Option-J (Mac)":"Control-Shift-J (Windows) or Command-Shift-J (Mac)",error_message+=". Thanks so much!"),alert(error_message)}this.JSON||(this.JSON={}),function(){function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,s,a,r,o=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,r=[],"[object Array]"===Object.prototype.toString.apply(l)){for(a=l.length,n=0;a>n;n+=1)r[n]=str(n,l)||"null";return s=0===r.length?"[]":gap?"[\n"+gap+r.join(",\n"+gap)+"\n"+o+"]":"["+r.join(",")+"]",gap=o,s}if(rep&&"object"==typeof rep)for(a=rep.length,n=0;a>n;n+=1)i=rep[n],"string"==typeof i&&(s=str(i,l),s&&r.push(quote(i)+(gap?": ":":")+s));else for(i in l)Object.hasOwnProperty.call(l,i)&&(s=str(i,l),s&&r.push(quote(i)+(gap?": ":":")+s));return s=0===r.length?"{}":gap?"{\n"+gap+r.join(",\n"+gap)+"\n"+o+"}":"{"+r.join(",")+"}",gap=o,s}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,i,s=e[t];if(s&&"object"==typeof s)for(n in s)Object.hasOwnProperty.call(s,n)&&(i=walk(s,n),void 0!==i?s[n]=i:delete s[n]);return reviver.call(e,t,s)}var j;if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){function e(e){function t(t,n,i,s,a,r){for(;a>=0&&r>a;a+=e){var o=s?s[a]:a;i=n(i,t[o],o,t)}return i}return function(n,i,s,a){i=v(i,a,4);var r=!T(n)&&b.keys(n),o=(r||n).length,l=e>0?0:o-1;return arguments.length<3&&(s=n[r?r[l]:l],l+=e),t(n,i,s,r,l,o)}}function t(e){return function(t,n,i){n=y(n,i);for(var s=S(t),a=e>0?0:s-1;a>=0&&s>a;a+=e)if(n(t[a],a,t))return a;return-1}}function n(e,t,n){return function(i,s,a){var r=0,o=S(i);if("number"==typeof a)e>0?r=a>=0?a:Math.max(a+o,r):o=a>=0?Math.min(a+1,o):a+o+1;else if(n&&a&&o)return a=n(i,s),i[a]===s?a:-1;if(s!==s)return a=t(c.call(i,r,o),b.isNaN),a>=0?a+r:-1;for(a=e>0?r:o-1;a>=0&&o>a;a+=e)if(i[a]===s)return a;return-1}}function i(e,t){var n=j.length,i=e.constructor,s=b.isFunction(i)&&i.prototype||o,a="constructor";for(b.has(e,a)&&!b.contains(t,a)&&t.push(a);n--;)a=j[n],a in e&&e[a]!==s[a]&&!b.contains(t,a)&&t.push(a)}var s=this,a=s._,r=Array.prototype,o=Object.prototype,l=Function.prototype,p=r.push,c=r.slice,u=o.toString,d=o.hasOwnProperty,h=Array.isArray,f=Object.keys,m=l.bind,g=Object.create,_=function(){},b=function(e){return e instanceof b?e:this instanceof b?void(this._wrapped=e):new b(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports._=b):s._=b,b.VERSION="1.8.3";var v=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,s){return e.call(t,n,i,s)};case 4:return function(n,i,s,a){return e.call(t,n,i,s,a)}}return function(){return e.apply(t,arguments)}},y=function(e,t,n){return null==e?b.identity:b.isFunction(e)?v(e,t,n):b.isObject(e)?b.matcher(e):b.property(e)};b.iteratee=function(e,t){return y(e,t,1/0)};var w=function(e,t){return function(n){var i=arguments.length;if(2>i||null==n)return n;for(var s=1;i>s;s++)for(var a=arguments[s],r=e(a),o=r.length,l=0;o>l;l++){var p=r[l];t&&void 0!==n[p]||(n[p]=a[p])}return n}},x=function(e){if(!b.isObject(e))return{};if(g)return g(e);_.prototype=e;var t=new _;return _.prototype=null,t},A=function(e){return function(t){return null==t?void 0:t[e]}},k=Math.pow(2,53)-1,S=A("length"),T=function(e){var t=S(e);return"number"==typeof t&&t>=0&&k>=t};b.each=b.forEach=function(e,t,n){t=v(t,n);var i,s;if(T(e))for(i=0,s=e.length;s>i;i++)t(e[i],i,e);else{var a=b.keys(e);for(i=0,s=a.length;s>i;i++)t(e[a[i]],a[i],e)}return e},b.map=b.collect=function(e,t,n){t=y(t,n);for(var i=!T(e)&&b.keys(e),s=(i||e).length,a=Array(s),r=0;s>r;r++){var o=i?i[r]:r;a[r]=t(e[o],o,e)}return a},b.reduce=b.foldl=b.inject=e(1),b.reduceRight=b.foldr=e(-1),b.find=b.detect=function(e,t,n){var i;return i=T(e)?b.findIndex(e,t,n):b.findKey(e,t,n),void 0!==i&&-1!==i?e[i]:void 0},b.filter=b.select=function(e,t,n){var i=[];return t=y(t,n),b.each(e,function(e,n,s){t(e,n,s)&&i.push(e)}),i},b.reject=function(e,t,n){return b.filter(e,b.negate(y(t)),n)},b.every=b.all=function(e,t,n){t=y(t,n);for(var i=!T(e)&&b.keys(e),s=(i||e).length,a=0;s>a;a++){var r=i?i[a]:a;if(!t(e[r],r,e))return!1}return!0},b.some=b.any=function(e,t,n){t=y(t,n);for(var i=!T(e)&&b.keys(e),s=(i||e).length,a=0;s>a;a++){var r=i?i[a]:a;if(t(e[r],r,e))return!0}return!1},b.contains=b.includes=b.include=function(e,t,n,i){return T(e)||(e=b.values(e)),("number"!=typeof n||i)&&(n=0),b.indexOf(e,t,n)>=0},b.invoke=function(e,t){var n=c.call(arguments,2),i=b.isFunction(t);return b.map(e,function(e){var s=i?t:e[t];return null==s?s:s.apply(e,n)})},b.pluck=function(e,t){return b.map(e,b.property(t))},b.where=function(e,t){return b.filter(e,b.matcher(t))},b.findWhere=function(e,t){return b.find(e,b.matcher(t))},b.max=function(e,t,n){var i,s,a=-(1/0),r=-(1/0);if(null==t&&null!=e){e=T(e)?e:b.values(e);for(var o=0,l=e.length;l>o;o++)i=e[o],i>a&&(a=i)}else t=y(t,n),b.each(e,function(e,n,i){s=t(e,n,i),(s>r||s===-(1/0)&&a===-(1/0))&&(a=e,r=s)});return a},b.min=function(e,t,n){var i,s,a=1/0,r=1/0;if(null==t&&null!=e){e=T(e)?e:b.values(e);for(var o=0,l=e.length;l>o;o++)i=e[o],a>i&&(a=i)}else t=y(t,n),b.each(e,function(e,n,i){s=t(e,n,i),(r>s||s===1/0&&a===1/0)&&(a=e,r=s)});return a},b.shuffle=function(e){for(var t,n=T(e)?e:b.values(e),i=n.length,s=Array(i),a=0;i>a;a++)t=b.random(0,a),t!==a&&(s[a]=s[t]),s[t]=n[a];return s},b.sample=function(e,t,n){return null==t||n?(T(e)||(e=b.values(e)),e[b.random(e.length-1)]):b.shuffle(e).slice(0,Math.max(0,t))},b.sortBy=function(e,t,n){return t=y(t,n),b.pluck(b.map(e,function(e,n,i){return{value:e,index:n,criteria:t(e,n,i)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return e.index-t.index}),"value")};var C=function(e){return function(t,n,i){var s={};return n=y(n,i),b.each(t,function(i,a){var r=n(i,a,t);e(s,i,r)}),s}};b.groupBy=C(function(e,t,n){b.has(e,n)?e[n].push(t):e[n]=[t]}),b.indexBy=C(function(e,t,n){e[n]=t}),b.countBy=C(function(e,t,n){b.has(e,n)?e[n]++:e[n]=1}),b.toArray=function(e){return e?b.isArray(e)?c.call(e):T(e)?b.map(e,b.identity):b.values(e):[]},b.size=function(e){return null==e?0:T(e)?e.length:b.keys(e).length},b.partition=function(e,t,n){t=y(t,n);var i=[],s=[];return b.each(e,function(e,n,a){(t(e,n,a)?i:s).push(e)}),[i,s]},b.first=b.head=b.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:b.initial(e,e.length-t)},b.initial=function(e,t,n){return c.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},b.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:b.rest(e,Math.max(0,e.length-t))},b.rest=b.tail=b.drop=function(e,t,n){return c.call(e,null==t||n?1:t)},b.compact=function(e){return b.filter(e,b.identity)};var $=function(e,t,n,i){for(var s=[],a=0,r=i||0,o=S(e);o>r;r++){var l=e[r];if(T(l)&&(b.isArray(l)||b.isArguments(l))){t||(l=$(l,t,n));var p=0,c=l.length;for(s.length+=c;c>p;)s[a++]=l[p++]}else n||(s[a++]=l)}return s};b.flatten=function(e,t){return $(e,t,!1)},b.without=function(e){return b.difference(e,c.call(arguments,1))},b.uniq=b.unique=function(e,t,n,i){b.isBoolean(t)||(i=n,n=t,t=!1),null!=n&&(n=y(n,i));for(var s=[],a=[],r=0,o=S(e);o>r;r++){var l=e[r],p=n?n(l,r,e):l;t?(r&&a===p||s.push(l),a=p):n?b.contains(a,p)||(a.push(p),s.push(l)):b.contains(s,l)||s.push(l)}return s},b.union=function(){return b.uniq($(arguments,!0,!0))},b.intersection=function(e){for(var t=[],n=arguments.length,i=0,s=S(e);s>i;i++){var a=e[i];if(!b.contains(t,a)){for(var r=1;n>r&&b.contains(arguments[r],a);r++);r===n&&t.push(a)}}return t},b.difference=function(e){var t=$(arguments,!0,!0,1);return b.filter(e,function(e){return!b.contains(t,e)})},b.zip=function(){return b.unzip(arguments)},b.unzip=function(e){for(var t=e&&b.max(e,S).length||0,n=Array(t),i=0;t>i;i++)n[i]=b.pluck(e,i);return n},b.object=function(e,t){for(var n={},i=0,s=S(e);s>i;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},b.findIndex=t(1),b.findLastIndex=t(-1),b.sortedIndex=function(e,t,n,i){n=y(n,i,1);for(var s=n(t),a=0,r=S(e);r>a;){var o=Math.floor((a+r)/2);n(e[o])<s?a=o+1:r=o}return a},b.indexOf=n(1,b.findIndex,b.sortedIndex),b.lastIndexOf=n(-1,b.findLastIndex),b.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var i=Math.max(Math.ceil((t-e)/n),0),s=Array(i),a=0;i>a;a++,e+=n)s[a]=e;return s};var E=function(e,t,n,i,s){if(!(i instanceof t))return e.apply(n,s);var a=x(e.prototype),r=e.apply(a,s);return b.isObject(r)?r:a};b.bind=function(e,t){if(m&&e.bind===m)return m.apply(e,c.call(arguments,1));if(!b.isFunction(e))throw new TypeError("Bind must be called on a function");var n=c.call(arguments,2),i=function(){return E(e,i,t,this,n.concat(c.call(arguments)))};return i},b.partial=function(e){var t=c.call(arguments,1),n=function(){for(var i=0,s=t.length,a=Array(s),r=0;s>r;r++)a[r]=t[r]===b?arguments[i++]:t[r];for(;i<arguments.length;)a.push(arguments[i++]);return E(e,n,this,this,a)};return n},b.bindAll=function(e){var t,n,i=arguments.length;if(1>=i)throw new Error("bindAll must be passed function names");for(t=1;i>t;t++)n=arguments[t],e[n]=b.bind(e[n],e);return e},b.memoize=function(e,t){var n=function(i){var s=n.cache,a=""+(t?t.apply(this,arguments):i);return b.has(s,a)||(s[a]=e.apply(this,arguments)),s[a]};return n.cache={},n},b.delay=function(e,t){var n=c.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},b.defer=b.partial(b.delay,b,1),b.throttle=function(e,t,n){var i,s,a,r=null,o=0;n||(n={});var l=function(){o=n.leading===!1?0:b.now(),r=null,a=e.apply(i,s),r||(i=s=null)};return function(){var p=b.now();o||n.leading!==!1||(o=p);var c=t-(p-o);return i=this,s=arguments,0>=c||c>t?(r&&(clearTimeout(r),r=null),o=p,a=e.apply(i,s),r||(i=s=null)):r||n.trailing===!1||(r=setTimeout(l,c)),a}},b.debounce=function(e,t,n){var i,s,a,r,o,l=function(){var p=b.now()-r;t>p&&p>=0?i=setTimeout(l,t-p):(i=null,n||(o=e.apply(a,s),i||(a=s=null)))};return function(){a=this,s=arguments,r=b.now();var p=n&&!i;return i||(i=setTimeout(l,t)),p&&(o=e.apply(a,s),a=s=null),o}},b.wrap=function(e,t){return b.partial(t,e)},b.negate=function(e){return function(){return!e.apply(this,arguments)}},b.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,i=e[t].apply(this,arguments);n--;)i=e[n].call(this,i);return i}},b.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},b.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),
1>=e&&(t=null),n}},b.once=b.partial(b.before,2);var N=!{toString:null}.propertyIsEnumerable("toString"),j=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];b.keys=function(e){if(!b.isObject(e))return[];if(f)return f(e);var t=[];for(var n in e)b.has(e,n)&&t.push(n);return N&&i(e,t),t},b.allKeys=function(e){if(!b.isObject(e))return[];var t=[];for(var n in e)t.push(n);return N&&i(e,t),t},b.values=function(e){for(var t=b.keys(e),n=t.length,i=Array(n),s=0;n>s;s++)i[s]=e[t[s]];return i},b.mapObject=function(e,t,n){t=y(t,n);for(var i,s=b.keys(e),a=s.length,r={},o=0;a>o;o++)i=s[o],r[i]=t(e[i],i,e);return r},b.pairs=function(e){for(var t=b.keys(e),n=t.length,i=Array(n),s=0;n>s;s++)i[s]=[t[s],e[t[s]]];return i},b.invert=function(e){for(var t={},n=b.keys(e),i=0,s=n.length;s>i;i++)t[e[n[i]]]=n[i];return t},b.functions=b.methods=function(e){var t=[];for(var n in e)b.isFunction(e[n])&&t.push(n);return t.sort()},b.extend=w(b.allKeys),b.extendOwn=b.assign=w(b.keys),b.findKey=function(e,t,n){t=y(t,n);for(var i,s=b.keys(e),a=0,r=s.length;r>a;a++)if(i=s[a],t(e[i],i,e))return i},b.pick=function(e,t,n){var i,s,a={},r=e;if(null==r)return a;b.isFunction(t)?(s=b.allKeys(r),i=v(t,n)):(s=$(arguments,!1,!1,1),i=function(e,t,n){return t in n},r=Object(r));for(var o=0,l=s.length;l>o;o++){var p=s[o],c=r[p];i(c,p,r)&&(a[p]=c)}return a},b.omit=function(e,t,n){if(b.isFunction(t))t=b.negate(t);else{var i=b.map($(arguments,!1,!1,1),String);t=function(e,t){return!b.contains(i,t)}}return b.pick(e,t,n)},b.defaults=w(b.allKeys,!0),b.create=function(e,t){var n=x(e);return t&&b.extendOwn(n,t),n},b.clone=function(e){return b.isObject(e)?b.isArray(e)?e.slice():b.extend({},e):e},b.tap=function(e,t){return t(e),e},b.isMatch=function(e,t){var n=b.keys(t),i=n.length;if(null==e)return!i;for(var s=Object(e),a=0;i>a;a++){var r=n[a];if(t[r]!==s[r]||!(r in s))return!1}return!0};var D=function(e,t,n,i){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof b&&(e=e._wrapped),t instanceof b&&(t=t._wrapped);var s=u.call(e);if(s!==u.call(t))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var a="[object Array]"===s;if(!a){if("object"!=typeof e||"object"!=typeof t)return!1;var r=e.constructor,o=t.constructor;if(r!==o&&!(b.isFunction(r)&&r instanceof r&&b.isFunction(o)&&o instanceof o)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],i=i||[];for(var l=n.length;l--;)if(n[l]===e)return i[l]===t;if(n.push(e),i.push(t),a){if(l=e.length,l!==t.length)return!1;for(;l--;)if(!D(e[l],t[l],n,i))return!1}else{var p,c=b.keys(e);if(l=c.length,b.keys(t).length!==l)return!1;for(;l--;)if(p=c[l],!b.has(t,p)||!D(e[p],t[p],n,i))return!1}return n.pop(),i.pop(),!0};b.isEqual=function(e,t){return D(e,t)},b.isEmpty=function(e){return null==e?!0:T(e)&&(b.isArray(e)||b.isString(e)||b.isArguments(e))?0===e.length:0===b.keys(e).length},b.isElement=function(e){return!(!e||1!==e.nodeType)},b.isArray=h||function(e){return"[object Array]"===u.call(e)},b.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},b.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){b["is"+e]=function(t){return u.call(t)==="[object "+e+"]"}}),b.isArguments(arguments)||(b.isArguments=function(e){return b.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(b.isFunction=function(e){return"function"==typeof e||!1}),b.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},b.isNaN=function(e){return b.isNumber(e)&&e!==+e},b.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===u.call(e)},b.isNull=function(e){return null===e},b.isUndefined=function(e){return void 0===e},b.has=function(e,t){return null!=e&&d.call(e,t)},b.noConflict=function(){return s._=a,this},b.identity=function(e){return e},b.constant=function(e){return function(){return e}},b.noop=function(){},b.property=A,b.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},b.matcher=b.matches=function(e){return e=b.extendOwn({},e),function(t){return b.isMatch(t,e)}},b.times=function(e,t,n){var i=Array(Math.max(0,e));t=v(t,n,1);for(var s=0;e>s;s++)i[s]=t(s);return i},b.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},b.now=Date.now||function(){return(new Date).getTime()};var F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},R=b.invert(F),M=function(e){var t=function(t){return e[t]},n="(?:"+b.keys(e).join("|")+")",i=RegExp(n),s=RegExp(n,"g");return function(e){return e=null==e?"":""+e,i.test(e)?e.replace(s,t):e}};b.escape=M(F),b.unescape=M(R),b.result=function(e,t,n){var i=null==e?void 0:e[t];return void 0===i&&(i=n),b.isFunction(i)?i.call(e):i};var O=0;b.uniqueId=function(e){var t=++O+"";return e?e+t:t},b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var P=/(.)^/,I={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\u2028|\u2029/g,q=function(e){return"\\"+I[e]};b.template=function(e,t,n){!t&&n&&(t=n),t=b.defaults({},t,b.templateSettings);var i=RegExp([(t.escape||P).source,(t.interpolate||P).source,(t.evaluate||P).source].join("|")+"|$","g"),s=0,a="__p+='";e.replace(i,function(t,n,i,r,o){return a+=e.slice(s,o).replace(L,q),s=o+t.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?a+="'+\n((__t=("+i+"))==null?'':__t)+\n'":r&&(a+="';\n"+r+"\n__p+='"),t}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var r=new Function(t.variable||"obj","_",a)}catch(o){throw o.source=a,o}var l=function(e){return r.call(this,e,b)},p=t.variable||"obj";return l.source="function("+p+"){\n"+a+"}",l},b.chain=function(e){var t=b(e);return t._chain=!0,t};var z=function(e,t){return e._chain?b(t).chain():t};b.mixin=function(e){b.each(b.functions(e),function(t){var n=b[t]=e[t];b.prototype[t]=function(){var e=[this._wrapped];return p.apply(e,arguments),z(this,n.apply(b,e))}})},b.mixin(b),b.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];b.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],z(this,n)}}),b.each(["concat","join","slice"],function(e){var t=r[e];b.prototype[e]=function(){return z(this,t.apply(this._wrapped,arguments))}}),b.prototype.value=function(){return this._wrapped},b.prototype.valueOf=b.prototype.toJSON=b.prototype.value,b.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return b})}.call(this),_.max=_.wrap(_.max,function(e){var t=e.apply(this,Array.prototype.slice.call(arguments,1));return t===-(1/0)?void 0:t}),function(){var e,t=this,n=t.Backbone,i=Array.prototype.slice,s=Array.prototype.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="0.9.1";var a=t._;a||"undefined"==typeof require||(a=require("underscore"));var r=t.jQuery||t.Zepto||t.ender;e.setDomLibrary=function(e){r=e},e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1,e.Events={on:function(e,t,n){var i;e=e.split(/\s+/);for(var s=this._callbacks||(this._callbacks={});i=e.shift();){var a=s[i]||(s[i]={}),r=a.tail||(a.tail=a.next={});r.callback=t,r.context=n,a.tail=r.next={}}return this},off:function(e,t,n){var i,s,a;if(e){if(s=this._callbacks)for(e=e.split(/\s+/);i=e.shift();)if(a=s[i],delete s[i],t&&a)for(;(a=a.next)&&a.next;)(a.callback!==t||n&&a.context!==n)&&this.on(i,a.callback,a.context)}else delete this._callbacks;return this},trigger:function(e){var t,n,s,a,r,o,l;if(!(s=this._callbacks))return this;for(o=s.all,(e=e.split(/\s+/)).push(null);t=e.shift();)o&&e.push({next:o.next,tail:o.tail,event:t}),(n=s[t])&&e.push({next:n.next,tail:n.tail});for(l=i.call(arguments,1);n=e.pop();)for(a=n.tail,r=n.event?[n.event].concat(l):l;(n=n.next)!==a;)n.callback.apply(n.context||this,r);return this}},e.Events.bind=e.Events.on,e.Events.unbind=e.Events.off,e.Model=function(e,t){var n;if(e||(e={}),t&&t.parse&&(e=this.parse(e)),(n=y(this,"defaults"))&&(e=a.extend({},n,e)),t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=a.uniqueId("c"),!this.set(e,{silent:!0}))throw new Error("Can't create an invalid model");delete this._changed,this._previousAttributes=a.clone(this.attributes),this.initialize.apply(this,arguments)},a.extend(e.Model.prototype,e.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return a.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.attributes[e];return this._escapedAttributes[e]=a.escape(null==n?"":""+n)},has:function(e){return null!=this.attributes[e]},set:function(t,n,i){var s,r,o;if(a.isObject(t)||null==t?(s=t,i=n):(s={},s[t]=n),i||(i={}),!s)return this;if(s instanceof e.Model&&(s=s.attributes),i.unset)for(r in s)s[r]=void 0;if(!this._validate(s,i))return!1;this.idAttribute in s&&(this.id=s[this.idAttribute]);var l=this.attributes,p=this._escapedAttributes,c=this._previousAttributes||{},u=this._setting;this._changed||(this._changed={}),this._setting=!0;for(r in s)o=s[r],a.isEqual(l[r],o)||delete p[r],i.unset?delete l[r]:l[r]=o,this._changing&&!a.isEqual(this._changed[r],o)&&(this.trigger("change:"+r,this,o,i),this._moreChanges=!0),delete this._changed[r],a.isEqual(c[r],o)&&a.has(l,r)==a.has(c,r)||(this._changed[r]=o);return u||(!i.silent&&this.hasChanged()&&this.change(i),this._setting=!1),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(a.clone(this.attributes),e)},fetch:function(t){t=t?a.clone(t):{};var n=this,i=t.success;return t.success=function(e,s,a){return n.set(n.parse(e,a),t)?void(i&&i(n,e)):!1},t.error=e.wrapError(t.error,n,t),(this.sync||e.sync).call(this,"read",this,t)},save:function(t,n,i){var s,r;a.isObject(t)||null==t?(s=t,i=n):(s={},s[t]=n),i=i?a.clone(i):{},i.wait&&(r=a.clone(this.attributes));var o=a.extend({},i,{silent:!0});if(s&&!this.set(s,i.wait?o:i))return!1;var l=this,p=i.success;i.success=function(e,t,n){var r=l.parse(e,n);return i.wait&&(r=a.extend(s||{},r)),l.set(r,i)?void(p?p(l,e):l.trigger("sync",l,e,i)):!1},i.error=e.wrapError(i.error,l,i);var c=this.isNew()?"create":"update",u=(this.sync||e.sync).call(this,c,this,i);return i.wait&&this.set(r,o),u},destroy:function(t){t=t?a.clone(t):{};var n=this,i=t.success,s=function(){n.trigger("destroy",n,n.collection,t)};if(this.isNew())return s();t.success=function(e){t.wait&&s(),i?i(n,e):n.trigger("sync",n,e,t)},t.error=e.wrapError(t.error,n,t);var r=(this.sync||e.sync).call(this,"delete",this,t);return t.wait||s(),r},url:function(){var e=y(this.collection,"url")||y(this,"urlRoot")||w();return this.isNew()?e:e+("/"==e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(e){if(this._changing||!this.hasChanged())return this;this._changing=!0,this._moreChanges=!0;for(var t in this._changed)this.trigger("change:"+t,this,this._changed[t],e);for(;this._moreChanges;)this._moreChanges=!1,this.trigger("change",this,e);return this._previousAttributes=a.clone(this.attributes),delete this._changed,this._changing=!1,this},hasChanged:function(e){return arguments.length?this._changed&&a.has(this._changed,e):!a.isEmpty(this._changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?a.clone(this._changed):!1;var t,n=!1,i=this._previousAttributes;for(var s in e)a.isEqual(i[s],t=e[s])||((n||(n={}))[s]=t);return n},previous:function(e){return arguments.length&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return a.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=a.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}}),e.Collection=function(e,t){t||(t={}),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})},a.extend(e.Collection.prototype,e.Events,{model:e.Model,initialize:function(){},toJSON:function(){return this.map(function(e){return e.toJSON()})},add:function(e,t){var n,i,r,o,l,p,c={},u={};for(t||(t={}),e=a.isArray(e)?e.slice():[e],n=0,r=e.length;r>n;n++){if(!(o=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");if(c[l=o.cid]||this._byCid[l]||null!=(p=o.id)&&(u[p]||this._byId[p]))throw new Error("Can't add the same model to a collection twice");c[l]=u[p]=o}for(n=0;r>n;n++)(o=e[n]).on("all",this._onModelEvent,this),this._byCid[o.cid]=o,null!=o.id&&(this._byId[o.id]=o);if(this.length+=r,i=null!=t.at?t.at:this.models.length,s.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0}),t.silent)return this;for(n=0,r=this.models.length;r>n;n++)c[(o=this.models[n]).cid]&&(t.index=n,o.trigger("add",o,this,t));return this},remove:function(e,t){var n,i,s,r;for(t||(t={}),e=a.isArray(e)?e.slice():[e],n=0,i=e.length;i>n;n++)r=this.getByCid(e[n])||this.get(e[n]),r&&(delete this._byId[r.id],delete this._byCid[r.cid],s=this.indexOf(r),this.models.splice(s,1),this.length--,t.silent||(t.index=s,r.trigger("remove",r,this,t)),this._removeReference(r));return this},get:function(e){return null==e?null:this._byId[null!=e.id?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},sort:function(e){if(e||(e={}),!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=a.bind(this.comparator,this);return 1==this.comparator.length?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return a.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,{silent:!0,parse:t.parse}),t.silent||this.trigger("reset",this,t),this},fetch:function(t){t=t?a.clone(t):{},void 0===t.parse&&(t.parse=!0);var n=this,i=t.success;return t.success=function(e,s,a){n[t.add?"add":t.upsert?"upsert":"reset"](n.parse(e,a),t),i&&i(n,e)},t.error=e.wrapError(t.error,n,t),(this.sync||e.sync).call(this,"read",this,t)},upsert:function(e,t){var n=this;t||(t={}),e=a.isArray(e)?e.slice():[e];var i=[];a.each(e,function(e){var s=n._prepareModel(e,t),a=n.get(s.id);a?a.set(s,t):i.push(s)}),a.isEmpty(i)||n.add(i,t)},create:function(e,t){var n=this;if(t=t?a.clone(t):{},e=this._prepareModel(e,t),!e)return!1;t.wait||n.add(e,t);var i=t.success;return t.success=function(s,a,r){t.wait&&n.add(s,t),i?i(s,a):s.trigger("sync",e,a,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return a(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(t,n){if(t instanceof e.Model)t.collection||(t.collection=this);else{var i=t;n.collection=this,t=new this.model(i,n),t._validate(t.attributes,n)||(t=!1)}return t},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!=e&&"remove"!=e||n==this)&&("destroy"==e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments))}});var o=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];a.each(o,function(t){e.Collection.prototype[t]=function(){return a[t].apply(a,[this.models].concat(a.toArray(arguments)))}}),e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var l=/:\w+/g,p=/\*\w+/g,c=/[-[\]{}()+?.,\\^$|#\s]/g;a.extend(e.Router.prototype,e.Events,{initialize:function(){},route:function(t,n,i){return e.history||(e.history=new e.History),a.isRegExp(t)||(t=this._routeToRegExp(t)),i||(i=this[n]),e.history.route(t,a.bind(function(s){var a=this._extractParameters(t,s);i&&i.apply(this,a),this.trigger.apply(this,["route:"+n].concat(a)),e.history.trigger("route",this,n,a)},this)),this},navigate:function(t,n){e.history.navigate(t,n)},_bindRoutes:function(){if(this.routes){var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,i=e.length;i>n;n++)this.route(e[n][0],e[n][1],this[e[n][1]])}},_routeToRegExp:function(e){return e=e.replace(c,"\\$&").replace(l,"([^/]+)").replace(p,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}}),e.History=function(){this.handlers=[],a.bindAll(this,"checkUrl")};var u=/^[#\/]/,d=/msie [\w.]+/,h=!1;a.extend(e.History.prototype,e.Events,{interval:50,getFragment:function(e,t){if(null==e)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=window.location.hash;return e=decodeURIComponent(e),e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(u,"")},start:function(e){if(h)throw new Error("Backbone.history has already been started");this.options=a.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,i=d.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);i&&(this.iframe=r('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?r(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?r(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t,h=!0;var s=window.location,o=s.pathname==this.options.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!o?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&o&&s.hash&&(this.fragment=s.hash.replace(u,""),window.history.replaceState({},document.title,s.protocol+"//"+s.host+this.options.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},stop:function(){r(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),h=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t==this.fragment&&this.iframe&&(t=this.getFragment(this.iframe.location.hash)),t==this.fragment||t==decodeURIComponent(this.fragment)?!1:(this.iframe&&this.navigate(t),void(this.loadUrl()||this.loadUrl(window.location.hash)))},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=a.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0});return n},navigate:function(e,t){if(!h)return!1;t&&t!==!0||(t={trigger:t});var n=(e||"").replace(u,"");this.fragment!=n&&this.fragment!=decodeURIComponent(n)&&(this._hasPushState?(0!=n.indexOf(this.options.root)&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.iframe.location.hash)&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e))},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}}),e.View=function(e){this.cid=a.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()};var f=/^(\S+)\s*(.*)$/,m=["model","collection","el","id","attributes","className","tagName"];a.extend(e.View.prototype,e.Events,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var i=document.createElement(e);return t&&r(i).attr(t),n&&r(i).html(n),i},setElement:function(e,t){return this.$el=r(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(e||(e=y(this,"events"))){this.undelegateEvents();for(var t in e){var n=e[t];if(a.isFunction(n)||(n=this[e[t]]),!n)throw new Error('Event "'+e[t]+'" does not exist');var i=t.match(f),s=i[1],r=i[2];n=a.bind(n,this),s+=".delegateEvents"+this.cid,""===r?this.$el.bind(s,n):this.$el.delegate(r,s,n)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=a.extend({},this.options,e));for(var t=0,n=m.length;n>t;t++){var i=m[t];e[i]&&(this[i]=e[i])}this.options=e},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var e=y(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}}});var g=function(e,t){var n=v(this,e,t);return n.extend=this.extend,n};e.Model.extend=e.Collection.extend=e.Router.extend=e.View.extend=g;var _={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(t,n,i){var s=_[t],o={type:s,dataType:"json"};return i.url||(o.url=y(n,"url")||w()),i.data||!n||"create"!=t&&"update"!=t||(o.contentType="application/json",o.data=JSON.stringify(n.toJSON())),e.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),e.emulateHTTP&&("PUT"===s||"DELETE"===s)&&(e.emulateJSON&&(o.data._method=s),o.type="POST",o.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s)}),"GET"===o.type||e.emulateJSON||(o.processData=!1),r.ajax(a.extend(o,i))},e.wrapError=function(e,t,n){return function(i,s){s=i===t?s:i,e?e(t,s,n):t.trigger("error",t,s,n)}};var b=function(){},v=function(e,t,n){var i;return i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){e.apply(this,arguments)},a.extend(i,e),b.prototype=e.prototype,i.prototype=new b,t&&a.extend(i.prototype,t),n&&a.extend(i,n),i.prototype.constructor=i,i.__super__=e.prototype,i},y=function(e,t){return e&&e[t]?a.isFunction(e[t])?e[t]():e[t]:null},w=function(){throw new Error('A "url" property or function must be specified')}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/balances-sidebar"]=function(obj){var __p=[];with(obj||{})__p.push('<div id="view_links">\n  <a href="#/dashboard" id="dashboard_link" ',App.dashboard?"class='open'":"","><span></span> ",App.t("dashboard"),'</a>\n  <a href="#/activity" id="notifications_link" ',App.notifications_view?"class='open'":"",'><i class="icon-flag"></i> ',App.t("recent_activity"),"</a>\n  "),App.groups.size()+App.friends.size()>10&&__p.push('\n    <div class="input-prepend">\n      <span class="add-on"><i class="icon-search"></i></span><input class="span2" id="filter_search" type="text" placeholder="',(""+App.t("filter_by_name")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n    </div>\n  '),__p.push('\n  <div class="expense_filter_links">\n    <a href="#/all" id="group--1" ',App.currentRelationship&&-1==App.currentRelationship.id?"class='open'":"",'><i class="icon-list"></i> ',App.t("all_expenses"),'</a>\n    <div class="tags">\n      <div class="header">\n        ',App.t("groups"),'\n        <a href="/groups/new"><i class="icon-plus"></i> ',App.t("add_group__short"),"</a>\n      </div>\n      "),App.groups.size()<=1&&__p.push('\n        <div class="no-groups">\n          ',App.t("you_do_not_have_any_groups_yet"),'&nbsp;\n          <i class="icon-question-sign icon-large" title="',(""+App.t("group_tooltip")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" rel="tooltip"></i>\n        </div>\n      '),__p.push("\n      "),_.each(_.sortBy(_.select(App.groups.models,function(e){return 0!=e.id}),function(e){return e.name().toLowerCase()}),function(e){__p.push('\n        <a href="#/groups/',e.id,'" data-filterable="true" data-search-string="',(""+e.name().toLowerCase()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" data-active="',e.active(),'" ',App.currentRelationship==e?"class='open'":"",'><i class="icon-tag"></i> ',(""+e.get("name")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</a>\n      ")}),__p.push('\n    </div>\n    <a href="#" class="show_inactive_accounts" id=\'groups_show_inactive_accounts\'>\n      ',App.t("hiding_accounts_explanation"),'\n    </a>\n\n    <div class="people">\n      <div class="header">\n        ',App.t("friends"),'\n        <a data-toggle="modal" href="#invite_friends"><i class="icon-plus"></i> ',App.t("add_friend__short"),"</a>\n      </div>\n      "),_.each(_.sortBy(App.friends.models,function(e){return e.name().toLowerCase()}),function(e){__p.push('\n        <a href="#/friends/',e.id,'" data-filterable="true" data-search-string="',(""+e.name().toLowerCase()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" data-active="',e.active(),'" ',App.currentRelationship==e?"class='open'":"",'><i class="icon-user"></i> ',(""+e.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</a>\n      ")}),__p.push("\n      "),0==App.friends.models.length&&__p.push('\n        <div style="padding: 5px 10px; text-align: center; color: #ccc; font-size: 12px; white-space: normal">\n          ',App.t("you_have_not_added_any_friends_yet"),"\n        </div>\n      "),__p.push('\n    </div>\n    <a href="#" class="show_inactive_accounts" id=\'friends_show_inactive_accounts\'>\n      ',App.t("hiding_accounts_explanation"),'\n    </a>\n  </div>\n  <div style="background: #5bc5a7; color: #fff; border: 1px solid #39a385; font-weight: bold; font-size: 14px; padding: 3px 5px; margin: 15px 0 0 5px; text-shadow: 0 -1px 0 #3eaf8f">\n    ',App.t("invite_friends"),'\n  </div>\n  <div class="sidebar_invites" style="margin: 0 0 0 5px; border: 1px solid #ccc; border-top: none; padding: 5px">\n    <div style="color: #666; line-height: 13px; font-size: 13px; height: 13px; margin-bottom: 5px; display: none">',App.t("send_a_message_to"),'</div>\n    <input class="invite_email" type="email" placeholder="',(""+App.t("enter_an_email_address")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" style="width: 145px; margin: 0 0 5px"><br>\n    <button class="btn btn-cancel send_invite" style="font-size: 12px; padding: 2px 6px">',App.t("send_invite"),'</button>\n    &nbsp; <img class="invite_ajax_indicator" style="display: none" src="https://dx0qysuen8cbs.cloudfront.net/assets/ajax-114d999f10c3c983ba14dfc2b38f2d29c1aa3d4406abd7e73f54bffab6f33c7e.gif" alt="Ajax" />\n    <div class="invite_success" style="margin-top: 10px; border-top: 1px solid #eee; padding-top: 5px; display: none">\n      ',App.t("invite_sent_smiley"),'\n    </div>\n  </div>\n  <div class="social">\n    <a href="http://www.facebook.com/dialog/share?app_id=293864780643203&display=popup&redirect_uri=https%3A%2F%2Fwww.splitwise.com%2Fthanks&href=&href=https%3A%2F%2Fwww.splitwise.com" target="_blank" data-action="share" class="btn btn-facebook">\n      <img src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/social/facebook-1080e416a74acaf0738d7e91f16d08ef671ee62285160f5c189b9840dc753b3b.png" alt="Facebook" />\n      ',App.t("post_to_facebook__short"),'\n    </a>\n    <a href="http://twitter.com/?status=Splitwise%20makes%20it%20easy%20to%20split%20bills%20with%20friends%20and%20roommates.%20Check%20it%20out!%20https%3A%2F%2Fwww.splitwise.com" target="_blank" data-action="tweet" class="btn btn-twitter">\n      <img src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/social/twitter-5685d291f9c14a83b9aabe241b608a48a01e9caaf6f22ae4da6c289166b098c6.png" alt="Twitter" />\n      ',App.t("post_to_twitter__short"),"\n    </a>\n  </div>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/dashboard-balances"]=function(obj){var __p=[];with(obj||{}){__p.push('<div class="total_balances">\n  ');var totals=App.friends.totalBalance();__p.push("\n  <div class=\"block\">\n    <div class='title'>\n      ",App.t("total_balance__header"),"\n    </div>\n    "),totals.total[default_currency]>0?__p.push('\n      <span class="positive">+\n    '):totals.total[default_currency]<0?__p.push('\n      <span class="negative">-\n    '):__p.push('\n      <span class="neutral">\n    '),__p.push("\n\n      ",App.currencies.print(Math.abs(totals.total[default_currency]),default_currency),"",_.find(_.keys(totals.total),function(e){return e!=default_currency})?"*":"","\n    </span>\n  </div>\n  <div class=\"block\">\n    <div class='title'>\n      ",App.t("you_owe__header"),'\n    </div>\n    <span class="',totals.negative[default_currency]<0?"negative":"neutral",'">\n      ',App.currencies.print(Math.abs(totals.negative[default_currency]),default_currency),"",_.find(_.keys(totals.negative),function(e){return e!=default_currency})?"*":"","\n    </span>\n  </div>\n  <div class=\"block\">\n    <div class='title'>\n      ",App.t("you_are_owed__header"),'\n    </div>\n    <span class="',totals.positive[default_currency]>0?"positive":"neutral",'">\n      ',App.currencies.print(totals.positive[default_currency],default_currency),"",_.find(_.keys(totals.positive),function(e){return e!=default_currency})?"*":"","\n    </span>\n  </div>\n  "),_.find(App.friends.totalBalance(),function(e){return _.find(_.keys(e),function(e){return e!=default_currency})})&&__p.push('\n    <div class="multiple_currencies">\n      ',App.t("you_have_balances_in_multiple_currencies"),"\n    </div>\n  "),__p.push('\n</div>\n\n<h2 style="position: relative">\n  ',App.t("you_owe__header"),'\n  <span class="right">',App.t("you_are_owed__header"),'</span>\n\n  <div style="position: absolute; top: 10px; width: 100%; text-align: center; margin-left: 6px">\n    <div class="btn-group toggle-chart-list">\n      <button class="btn active view_as_list"><i class="icon-reorder"></i> ',App.t("view_as_list__web_dashboard"),'</button>\n      <button class="btn view_as_chart"><i class="icon-bar-chart"></i> ',App.t("view_as_chart__web_dashboard"),'</button>\n    </div>\n  </div>\n</h2>\n\n<div class="summary">\n  ');var lists=[["people",App.friends.models]];__p.push("\n  "),_.each(lists,function(e){__p.push("\n    "),relationships=_.sortBy(e[1],function(e){return-Math.abs(e.mainBalance().amount)}),__p.push('\n\n    <div id="',e[0],'_summary">\n      <div class="chart" style="display: none">\n        ');var t=_.max(relationships,function(e){return Math.abs(e.mainBalance().amount)});__p.push("\n        "),t=Math.abs(t?t.mainBalance().amount:0),__p.push("\n        ");var n=.5;__p.push("\n        ");var i=Math.pow(t,n);__p.push('\n        <div class="negative balances">\n          ');var s=_.select(relationships,function(e){return e.mainBalance().amount<0});__p.push("\n          "),0==s.length&&__p.push('\n            <div style="text-align: left; color: #999; font-size: 16px">\n              ',App.t("you_do_not_owe_anything"),"\n            </div>\n          "),__p.push("\n          "),_.each(s,function(e){__p.push("\n            ");var t=Math.pow(Math.abs(e.mainBalance().amount),n)/i*100;__p.push('\n            <a class="bar" href="#/',e.get("relationship_type"),"s/",e.get("id"),'" style="width: ',t,'%" '),20>t&&__p.push('title="',(""+e.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),": ",App.currencies.print(Math.abs(e.mainBalance().amount),e.mainBalance().currency_code),'"'),
__p.push('>\n              <span class="name" title="',(""+e.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n                '),20>t?__p.push("\n                  ",(""+e.name()[0]).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),".\n                "):"friends"==e.get("relationship_type")?(__p.push("\n                  "),40>t?__p.push("\n                    ",(""+e.name().first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n                  "):__p.push("\n                    ",(""+new e.firstNameLastInitial).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n                  "),__p.push("\n                ")):__p.push("\n                  ",(""+e.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n                "),__p.push('\n              </span>\n              <span class="amount">\n                ',App.currencies.print(-e.mainBalance().amount,e.mainBalance().currency_code),"",e.balance().length>1?"*":"","\n              </span>\n            </a><br>\n          ")}),__p.push('\n        </div><div class="img">\n          <img src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/person-2d59b69b3e7431884ebec1a55de75a4153a17c4050e6b50051ca90412e72cf96.png" alt="Person" />\n        </div><div class="positive balances">\n          ');var a=_.select(relationships,function(e){return e.mainBalance().amount>0});__p.push("\n          "),0==a.length&&__p.push('\n            <div style="text-align: right; color: #999; font-size: 16px">\n              ',App.t("you_are_not_owed_anything"),"\n            </div>\n          "),__p.push("\n          "),_.each(a,function(e){__p.push("\n            ");var t=Math.pow(Math.abs(e.mainBalance().amount),n)/i*100;__p.push('\n            <a class="bar" href="#/',e.get("relationship_type"),"s/",e.get("id"),'" style="width: ',t,'%" '),20>t&&__p.push('title="',(""+e.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),": ",App.currencies.print(e.mainBalance().amount,e.mainBalance().currency_code),'"'),__p.push('>\n              <span class="name" title="',(""+e.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n                '),20>t?__p.push("\n                  ",(""+e.name()[0]).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),".\n                "):"friends"==e.get("relationship_type")?(__p.push("\n                  "),40>t?__p.push("\n                    ",(""+e.get("first_name")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n                  "):__p.push("\n                    ",(""+e.firstNameLastInitial()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n                  "),__p.push("\n                ")):__p.push("\n                  ",(""+e.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n                "),__p.push('\n              </span>\n              <span class="amount">\n                ',App.currencies.print(e.mainBalance().amount,e.mainBalance().currency_code),"",e.balance().length>1?"*":"","\n              </span>\n            </a><br>\n          ")}),__p.push('\n        </div>\n      </div>\n      <div class="list">\n        <div class="negatives">\n          ');var s=_.select(relationships,function(e){return e.mainBalance().amount<0||0==e.mainBalance().amount&&e.groupBalances().length>1});__p.push("\n          "),s=_.sortBy(s,function(e){return e.name().toLowerCase()}),__p.push("\n          "),0==s.length&&__p.push('\n            <div style="text-align: left; color: #999; font-size: 16px; margin-top: 6px">\n              ',App.t("you_do_not_owe_anything"),"\n            </div>\n          "),__p.push("\n          "),s.length>0&&(__p.push("\n            <ul>\n              "),_.each(s,function(e){if(__p.push('\n                <li class="relationship">\n                  <a href="#/',e.get("relationship_type"),"s/",e.get("id"),'">\n                    '),"group"==e.get("relationship_type")){__p.push("\n                      ");var t=e.get("group_type");__p.push('\n                      <img src="\n                        '),"apartment"==t||"home"==t?__p.push("\n                          https://dx0qysuen8cbs.cloudfront.net/assets/boilerstrap/icons/home_64-023693f6cc2c95870a973602d0302970657bd5adafd0c293abe6a0b5c2c30e9a.png\n                        "):"travel"==t?__p.push("\n                          https://dx0qysuen8cbs.cloudfront.net/assets/boilerstrap/icons/travel_48-cce5a96e8b9ae7eec12bfea8ab336a48e074be177619bf775acdf0927e03b607.png\n                        "):__p.push("\n                          https://dx0qysuen8cbs.cloudfront.net/assets/boilerstrap/icons/other_48-23b09728a8f908f71fc52af2898c158e09c7820ca97e30c1c14552407603c8b0.png\n                        "),__p.push('" alt="Avatar">\n                    ')}else __p.push('\n                      <img src="',e.get("picture").medium,'" alt="Avatar">\n                    ');__p.push('\n                    <div class="name">',(""+e.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'</div>\n                    <div class="balance i_owe">\n                      ',App.t("you_owe__friend"),'\n                      <span class="amount">',App.currencies.print(-e.mainBalance().amount,e.mainBalance().currency_code)+(e.balance().length>1?"*":""),"</span>\n                    </div>\n                    "),e.groupBalances().length>1&&(__p.push('\n                      <ul class="balance_details">\n                        '),_.each(e.groupBalances(),function(t){__p.push("\n                          <li onclick=\"App.relationshipsRouter.navigate('#/groups/",t.group_id,"', true); return false\">\n                            ");var n=_.find(t.balance,function(e){return 0!=parseFloat(e.amount)});__p.push("\n                            ");var i=App.currencies.print(Math.abs(n.amount),n.currency_code);__p.push("\n                            ");var s=n.amount>0?"positive":"negative";__p.push("\n                            ");var a=App.groups.get(t.group_id)?App.groups.get(t.group_id).name():App.t("unknown_group_name");__p.push("\n                            ",App.t(n.amount>0?"NAME_owes_you_AMOUNT_for_GROUP_html":"you_owe_NAME_AMOUNT_for_GROUP_html",e.get("first_name"),S(i).wrapWithTag("span",{"class":s}),a),"\n                          </li>\n                        ")}),__p.push("\n                      </ul>\n                    ")),__p.push("\n                  </a>\n                </li>\n              ")}),__p.push("\n            </ul>\n          ")),__p.push('\n        </div>\n\n        <div class="positives">\n          ');var a=_.select(relationships,function(e){return e.mainBalance().amount>0});__p.push("\n          "),a=_.sortBy(a,function(e){return e.name().toLowerCase()}),__p.push("\n          "),0==a.length&&__p.push('\n            <div style="text-align: right; color: #999; font-size: 16px; margin-top: 6px">\n              ',App.t("you_are_not_owed_anything"),"\n            </div>\n          "),__p.push("\n          "),a.length>0&&(__p.push("\n            <ul>\n              "),_.each(a,function(e){if(__p.push('\n                <li class="relationship">\n                  <a href="#/',e.get("relationship_type"),"s/",e.get("id"),'">\n                    '),"group"==e.get("relationship_type")){__p.push("\n                      ");var t=e.get("group_type");__p.push('\n                      <img src="\n                        '),"apartment"==t||"home"==t?__p.push("\n                          https://dx0qysuen8cbs.cloudfront.net/assets/boilerstrap/icons/home_64-023693f6cc2c95870a973602d0302970657bd5adafd0c293abe6a0b5c2c30e9a.png\n                        "):"travel"==t?__p.push("\n                          https://dx0qysuen8cbs.cloudfront.net/assets/boilerstrap/icons/travel_48-cce5a96e8b9ae7eec12bfea8ab336a48e074be177619bf775acdf0927e03b607.png\n                        "):__p.push("\n                          https://dx0qysuen8cbs.cloudfront.net/assets/boilerstrap/icons/other_48-23b09728a8f908f71fc52af2898c158e09c7820ca97e30c1c14552407603c8b0.png\n                        "),__p.push('" alt="Avatar">\n                    ')}else __p.push('\n                      <img src="',e.get("picture").medium,'" alt="Avatar">\n                    ');__p.push('\n                    <span class="name">',(""+e.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'</span><br>\n                    <span class="balance owes_me">\n                      ',App.t("owes_you__cell_friend"),'\n                      <span class="amount">',App.currencies.print(e.mainBalance().amount,e.mainBalance().currency_code)+(e.balance().length>1?"*":""),"</span>\n                    </span>\n                    "),e.groupBalances().length>1&&(__p.push('\n                      <ul class="balance_details">\n                        '),_.each(e.groupBalances(),function(t){__p.push("\n                          <li onclick=\"App.relationshipsRouter.navigate('#/groups/",t.group_id,"', true); return false\">\n                            ");var n=_.find(t.balance,function(e){return 0!=parseFloat(e.amount)});__p.push("\n                            ");var i=App.currencies.print(Math.abs(n.amount),n.currency_code);__p.push("\n                            ");var s=n.amount>0?"positive":"negative";__p.push("\n                            ");var a=App.groups.get(t.group_id)?App.groups.get(t.group_id).name():App.t("unknown_group_name");__p.push("\n                            ",App.t(n.amount>0?"NAME_owes_you_AMOUNT_for_GROUP_html":"you_owe_NAME_AMOUNT_for_GROUP_html",e.get("first_name"),S(i).wrapWithTag("span",{"class":s}),a),"\n                          </li>\n                        ")}),__p.push("\n                      </ul>\n                    ")),__p.push("\n                  </a>\n                </li>\n              ")}),__p.push("\n            </ul>\n          ")),__p.push('\n        </div>\n\n        <div class="clearfix"></div>\n      </div>\n    </div>\n  ')}),__p.push("\n</div>\n")}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/dashboard-no-expenses"]=function(obj){var __p=[];with(obj||{})__p.push('<div style="padding: 10px 15px; position: relative; margin: 20px -15px">\n  '),App.friends.models.length>0?(__p.push('\n    <img style="position: absolute; top: 0; left: 65px; width: 150px;" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/empty-table-effed2a2e610373b6407d746cb95858f5d47329c8610bb70f1fd2040dfa35165.png" alt="Empty table" />\n    <div style="text-align: left; padding-left: 235px;">\n    <h3 style="font-size: 28px; line-height: 110%">\n      '),App.notifications.models.length>0?__p.push("\n        ",App.t("youre_all_settled_up_awesome"),"\n      "):__p.push("\n        ",App.t("_exclamation",App.t("lets_get_started")),"\n      "),__p.push('\n    </h3>\n    <div style="margin-top: 15px; color: #999; font-size: 18px; line-height: 24px">\n      ',App.t("to_add_an_expense_click_add_bill"),"\n    </div>\n  </div>\n  ")):__p.push('\n    <img style="position: absolute; top: 0; left: 40px; width: 120px;" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/person-2d59b69b3e7431884ebec1a55de75a4153a17c4050e6b50051ca90412e72cf96.png" alt="Person" />\n    <div style="text-align: left; padding-left: 175px; padding-top: 22px">\n      <h3 style="font-size: 28px; line-height: 110%">\n        ',App.t("_exclamation",App.t("welcome_to_splitwise")),'\n      </h3>\n\n      <div style="margin-top: 15px; color: #999; font-size: 18px; line-height: 24px">\n        ',App.t("splitwise_helps_you_split_bills_with_friends"),'\n        <div style="height: 15px"></div>\n        ',App.t("click_add_bill_or_add_some_friends_first"),'\n      </div>\n\n      <a data-toggle="modal" href="#invite_friends" class="btn btn-orange btn-large" style="margin-top: 18px; font-size: 18px">\n        <i class="icon-plus" style="margin-right: 4px"></i><i class="icon-user icon-large" style="margin-right: 10px"></i>\n        ',App.t("add_friends_on_splitwise"),"\n      </a>\n    </div>\n  "),__p.push("\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/dashboard"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="dashboard header">\n  <div class="topbar">\n    <h1>',App.t("dashboard"),'</h1>\n    <div class="actions">\n      <a class="btn btn-large btn-orange" data-toggle="modal" href="#add_bill">\n        ',App.t("add_a_bill"),'\n      </a>\n      <a class="btn btn-large btn-mint" data-toggle="modal" href="#settle_up_form">\n        ',App.t("settle_up"),'\n      </a>\n    </div>\n  </div>\n</div>\n\n<div class="clearfix">\n  <div id="dashboard_balances">\n    &nbsp;\n  </div>\n  <div id="recent_activity" style="display: none"></div>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/details-sidebar"]=function(obj){var __p=[];with(obj||{}){if(__p.push(""),App.dashboard||App.notifications_view){if(__p.push("\n  "),App.friends.size()>0){__p.push("\n    ");var totals=App.friends.totalBalance();__p.push("\n\n    "),3==(new Date).getMonth()&&1==(new Date).getDate()&&2018==(new Date).getFullYear()?__p.push('\n      <h2><span style="color: #b55">New!</span> from Splitwise</h2>\n\n      <img height="120" style="margin: 5px 0 5px" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/sidebar/smart_homes-71fc0dd06a364e394518b8919eeb88913d7bd66444c15937a6b647a82b5692b0.png" alt="Smart homes" /><br>\n      Splitwise now integrates with <strong>Amazon Echo</strong> and <strong>Alexa</strong>! And smart fridges.\n      And pizza boxes. Check out the new <strong>Splitwise for Smart Homes</strong>.\n\n      <a href="https://youtu.be/Gsw-uWqhpa8" class="btn btn-large btn-red track" style="margin-top: 8px" data-action="emoji_edition" target="_blank">\n        Watch the video\n      </a>\n    '):currentUserObject.translationPrompt?__p.push("\n      <h2>",(""+currentUserObject.translationPrompt.header).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'</h2>\n      <img height="128" style="margin: 5px 0" src="https://dx0qysuen8cbs.cloudfront.net/assets/core/logo-square-65a6124237868b1d2ce2f5db2ab0b7c777e2348b797626816400534116ae22d7.svg" alt="Logo square" /><br>\n      Join our <strong>Volunteer Translator Program</strong> to help make Splitwise available to all\n      ',(""+currentUserObject.translationPrompt.people).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'.<br>\n\n      <a href="',currentUserObject.translationPrompt.url,'" class="btn btn-large btn-orange track" style="margin-top: 8px" data-action="volunteer-translator" target="_blank">\n        Join now\n      </a>\n    '):!currentUserObject.mobile&&_.size(totals.total)>0?__p.push("\n      <h2>",App.t("splitwise_on_the_go"),"</h2>\n      ",App.t("get_the_app_and_add_ious_anywhere"),'\n\n      <a href="https://apps.apple.com/us/app/splitwise/id458023433"><img width="160" height="52" style="margin: 10px 0 5px 0" src="https://dx0qysuen8cbs.cloudfront.net/assets/boilerstrap/badges/app_store@2x-fae3a1a4375c91cec459949638c0f8d069b80198422755b46cdb2b69a68f22df.png" alt="App store@2x" /></a>\n\n      <a href="https://play.google.com/store/apps/details?id=com.Splitwise.SplitwiseMobile"><img width="172" height="60" style="margin: 5px 0" src="https://dx0qysuen8cbs.cloudfront.net/assets/boilerstrap/badges/android-882b8e5e9ea50452c43c46cafa29d8cef4093c62572dd62c8cfedbf1f2d1044a.png" alt="Android" /></a>\n\n      <div style="color: #999; margin-top: 5px; font-size: 12px; line-height: 15px">\n        ',App.t("plus_third_party_apps"),'<br>\n        <a href="https://www.microsoft.com/en-us/search/result.aspx?q=splitwise#nav-apps">',App.t("windows_phone"),"</a>\n      </div>\n    "):(new Date).getDate()%2!=0||currentUserObject.has_pro?__p.push("\n      <h2>",App.t("split_the_dinner_bill"),'</h2>\n      <a href="https://itunes.apple.com/us/app/plates-by-splitwise-split/id669801762?mt=8&uo=4&at=11l4CC" target="_blank"><img height="114" style="margin: 8px 0" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/sidebar/plates-01a8a1ced1d926765746e2638c42d5d829416fb14326e1a1be5cd34440d4ba76.png" alt="Plates" /></a><br>\n      ',App.t("check_out_plates_html"),'<br>\n\n      <a href="https://itunes.apple.com/us/app/plates-by-splitwise-split/id669801762?mt=8&uo=4&at=11l4CC" class="btn btn-large btn-orange track" style="margin-top: 8px" data-action="plates" target="_blank">\n        ',App.t("download_plates"),"\n      </a>\n    "):(__p.push("\n      <h2>",App.t("get_splitwise_pro"),'</h2>\n      <img height="128" style="margin: 5px 0" src="https://dx0qysuen8cbs.cloudfront.net/assets/pro/logo-337b1a7d372db4b56c075c7893d68bfc6873a65d2f77d61b27cb66b6d62c976c.svg" alt="Logo" /><br>\n\n      '),"en"==currentUserObject.locale?__p.push("\n        Subscribe to <strong>Splitwise Pro</strong> for no ads, currency conversion, charts, search, and more.\n      "):__p.push("\n        ",App.t("subscribe_to_sw_pro_for_BENEFITS_html",App.t("an_adfree_experience")),"\n      "),__p.push('\n\n      <br>\n      <a href="/subscriptions/new" class="btn btn-large btn-orange track" style="margin-top: 8px" data-action="pro-sidebar">\n        ',App.t("learn_more"),"\n      </a>\n    ")),__p.push("\n  ")}__p.push("\n")}else{__p.push('\n  <div class="nav">\n    <a href="#relationship_balances" class="btn open" data-type="balances" data-toggle="tab" rel="tooltip" title="',(""+App.t("balances")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'"><i class="icon-align-justify"></i></a>\n    <a href="#recurring" class="btn loadmore" data-type="recurring" data-toggle="tab" rel="tooltip" title="',(""+App.t("upcoming_bills")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'"><i class="icon-calendar"></i></a>\n    <a href="#charts" class="btn loadmore" data-type="charts" data-toggle="tab" rel="tooltip" title="',(""+App.t("trends")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'"><i class="icon-bar-chart"></i></a>\n    '),relationship.isGroup()&&relationship.id>0&&__p.push('\n      <a href="#whiteboard" class="btn" data-type="whiteboard" data-toggle="tab" rel="tooltip" title="',(""+App.t("whiteboard")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'"><i class="icon-comment"></i></a>\n    '),__p.push("\n    "),relationship.id>0&&__p.push('\n      <a href="#relationship_settings" data-type="settings" class="btn" data-toggle="tab" rel="tooltip" title="',(""+App.t("settings")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'"><i class="icon-cog icon-large"></i></a>\n    '),__p.push('\n  </div>\n\n  <div id="relationship_balances" class="active"></div>\n  <div id="charts">\n    <h2>',App.t("trends_this_month"),'</h2>\n    <div id="main_trends"></div>\n    <a data-toggle="modal" href="#charts_modal" class="details">',App.t("view_full_charts"),'</a>\n  </div>\n  <div id="recurring">\n    <h2>',App.t("upcoming_bills"),'</h2>\n    <div id="recurring_list">\n    </div>\n  </div>\n  <div id="whiteboard">\n    <div id="whiteboard_show">\n      <h2>',App.t("whiteboard"),"</h2>\n      ");try{__p.push('\n        <pre id="whiteboard_text">',(""+(relationship.get("whiteboard")&&""!=relationship.get("whiteboard"))?relationship.get("whiteboard"):App.t("click_to_edit_whiteboard")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</pre>\n      ")}catch(e){__p.push('\n        <pre id="whiteboard_text">',App.t("click_to_edit_whiteboard"),"</pre>\n      ")}__p.push('\n      <div style="font-size: 11px; color: #999; line-height: 16px">',App.t("whiteboard_description"),'</div>\n    </div>\n    <div id="whiteboard_edit" style="display:none;">\n      <h2>',App.t("whiteboard"),'</h2>\n      <textarea id="whiteboard_form">',(""+(relationship.get("whiteboard")?relationship.get("whiteboard"):"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'</textarea>\n      <br>\n      <input type="submit" class="btn btn-info" id="save_whiteboard" value="',(""+App.t("save_changes")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'"></input>\n    </div>\n  </div>\n  <div id="relationship_settings">\n    '),relationship.isFriend()?(__p.push("\n      <h2>",App.t("friend_settings"),"</h2>\n      "),("invited"==relationship.get("registration_status")||"dummy"==relationship.get("registration_status"))&&__p.push('\n        <a class="btn" href="/friends/',relationship.id,'/edit">\n          ',App.t("edit_friend_info"),"\n        </a>\n      "),__p.push('\n      <a class="btn" href="/friends/',relationship.id,'/edit">\n        ',App.t("remove_this_friend"),"\n      </a>\n      "),"invited"==relationship.get("registration_status")&&__p.push('\n        <a class="btn resend_invite track" href="#" data-action="resend_invite">\n          ',App.t("resend_invite"),"\n        </a>\n      "),__p.push("\n      "),"dummy"!=relationship.get("registration_status")&&__p.push('\n        <a class="btn" data-toggle="modal" href="#send_reminder">\n          ',App.t("send_a_balance_reminder"),"\n        </a>\n      "),__p.push('\n      <a class="btn" href="/api/v3.0/export_friend/',relationship.id,'.csv">\n        ',App.t("export_as_spreadsheet"),"\n      </a>\n      "),App.groups.involvingUser(relationship.id).length>0&&__p.push('\n        <a class="btn" data-toggle="modal" href="#simplify_debts">\n          ',App.t("simplify_debts_with_this_person"),"\n        </a>\n      "),__p.push("\n      "),currentUserObject.has_pro&&__p.push("\n        <a class=\"btn\" onclick=\"App.currentRelationship.convert(this);\" href='javascript:void(0);'>\n          <span class='label'>",App.t("pro"),"</span>&nbsp; ",App.t("convert_to_CURRENCY",currentUserObject.default_currency),"\n        </a>\n      "),__p.push("\n\n    ")):(__p.push("\n      <h2>",App.t("group_settings"),'</h2>\n      <a class="btn" href="/groups/',relationship.id,'/edit">',App.t("edit_group_settings"),'</a>\n      <a class="btn toggle_involvement" href="#">\n        ',(""+App.settings.show_items_not_involving_me?App.t("hide_items_without_me"):App.t("show_items_without_me")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'\n      </a>\n      <a class="btn" data-toggle="modal" href="#send_reminder">\n        ',App.t("send_a_balance_reminder"),'\n      </a>\n      <a class="btn" href="/groups/',relationship.id,'.csv">\n        ',App.t("export_as_spreadsheet"),"\n      </a>\n      "),currentUserObject.has_pro&&__p.push('\n        <a class="btn" onclick="App.currentRelationship.convert(this);" href=\'javascript:void(0);\'>\n          <span class="label">',App.t("pro"),"</span>&nbsp; ",App.t("convert_to_CURRENCY",currentUserObject.default_currency),"\n        </a>\n      "),__p.push("\n    ")),__p.push("\n  </div>\n")}__p.push("\n")}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/expense-details"]=function(obj){var __p=[];with(obj||{})__p.push('<table>\n  <tr>\n    <td colspan="2">\n      '),receipt.large&&__p.push('\n        <div class="receipt">\n          <h4><i class="icon-camera"></i> ',App.t("receipt").toUpperCase(),'</h4>\n\n          <a href="',receipt.original,'" target="_blank">\n            <img src="',receipt.large,'" class="receipt image" alt="',(""+App.t("receipt").toUpperCase()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n          </a>\n        </div>\n      '),__p.push('\n\n      <img src="',App.expenses.get(id).categoryIcon(),'" class="category" title="',category.name,'" alt="',category.name,'">\n      <h3>',(""+description).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'</h3>\n      <div class="cost">\n        ',App.currencies.print(cost,currency_code),'\n      </div>\n      <div class="creation_info">\n        '),payment&&formattedDate(created_at)!=formattedDate(date)&&__p.push("\n          ",(""+formattedDate(date)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")," ::\n        "),__p.push("\n\n        ",App.t("added_by_PERSON_on_DATE",new App.Models.User(created_by).firstNameLastInitial(),formattedDate(created_at)),"\n\n        "),updated_at==created_at||formattedDate(updated_at)==formattedDate(created_at)&&created_by==updated_by||__p.push("\n          <br>\n          ",App.t("last_updated_by_PERSON_on_DATE",new App.Models.User(updated_by).firstNameLastInitial(),formattedDate(updated_at)),"\n        "),__p.push("\n\n        <br>\n\n        "),repeats&&next_repeat&&__p.push("\n          ",App.t("recurring_bill_next_on_DATE",formattedDate(next_repeat)),'\n          <br>\n          <a href="#" class="cancel_recurrence btn btn-mini btn-orange">',App.t("cancel_future_recurrences"),"</a>\n        "),__p.push("\n\n        "),["paypal","venmo","paytm","payment_demo"].indexOf(transaction_method)>-1&&(__p.push("\n          "),transaction_confirmed?__p.push("\n            ",App.t("sent_via_METHOD_STATUS",$.capitalize(transaction_method),App.t("confirmed__payment_status")),"\n          "):(__p.push('\n            <span style="color: #b33c47">\n              ',App.t("sent_via_METHOD_STATUS",$.capitalize(transaction_method),App.t("incomplete__payment_status")),"\n            </span>\n\n            "),"venmo"==transaction_method&&__p.push("\n              <br>\n              ",App.t("venmo_incomplete_explanation"),"\n            "),__p.push("\n          ")),__p.push("\n          <br>\n        ")),__p.push("\n\n        "),payment?(__p.push('\n          <a data-toggle="modal" href="#settle_up_form" data-expense-id="',id,'" class="btn btn-mini btn-orange">\n            ',App.t("edit_payment"),"\n          </a>\n\n          "),"undefined"!=typeof prepayment&&prepayment.claimable&&prepayment.claim_link&&__p.push('\n            <a href="',prepayment.claim_link,'" class="btn btn-mini btn-orange" target="_blank">\n              ',App.t("claim_payment"),"\n            </a>\n          "),__p.push("\n        ")):__p.push('\n          <a data-toggle="modal" href="#add_bill" data-expense-id="',id,'" class="btn btn-mini btn-orange">\n            ',App.t("edit_bill"),"\n          </a>\n        "),__p.push('\n      </div>\n      <hr style="margin: 0; border-bottom: none; border-top: 1px solid #ddd">\n    </td>\n  </tr>\n  <tr>\n    <td class="left">\n      <table class="shares">\n        '),_.each(users,function(e){if(__p.push("\n          "),0!=parseFloat(e.owed_share||0)||0!=parseFloat(e.paid_share||0)){__p.push("\n            ");var t=new App.Models.User(e.user);__p.push('\n            <tr class="user">\n              <td class="avatar">\n                <img src="',t.get("picture").medium,'" class="avatar" alt="User avatar">\n              </td>\n              <td>\n                ');var n="NAME";__p.push("\n                ",function(){return 0!=parseFloat(e.paid_share||0)&&0!=parseFloat(e.owed_share||0)?(n+="_paid_AMOUNT_and_",n+=payment?"received_AMOUNT_html":"owes_AMOUNT_html",App.t(n,S(t.firstNameLastInitial()).bold(),S(App.currencies.print(parseFloat(e.paid_share),currency_code)).bold(),S(App.currencies.print(parseFloat(e.owed_share),currency_code)).bold())):0!=parseFloat(e.paid_share||0)?App.t(n+"_paid_AMOUNT_html",S(t.firstNameLastInitial()).bold(),S(App.currencies.print(parseFloat(e.paid_share),currency_code)).bold()):(n+=payment?"_received_AMOUNT_html":"_owes_AMOUNT_html",App.t(n,S(t.firstNameLastInitial()).bold(),S(App.currencies.print(parseFloat(e.owed_share),currency_code)).bold()))}(),"\n              </td>\n            </tr>\n          ")}__p.push("\n        ")}),__p.push('\n      </table>\n    </td>\n    <td class="right">\n      '),App.metadata.features.expense_details_chart&&App.metadata.features.expense_details_chart.visible&&__p.push('\n        <iframe src="/api/v3.0/charts/expense_details?expense_id=',id,"&platform=web&height=",App.metadata.features.expense_details_chart.behavior.height,'" style="margin-top: 5px; width: 100%; height: ',App.metadata.features.expense_details_chart.behavior.height,"px; border: none; overflow: hidden\" scrolling=\"no\"></iframe>\n        <a href='#' class='open_charts'>",App.t("view_more_charts"),"</a>\n      "),__p.push('\n\n      <div class="comments">\n        <h4><i class="icon-comment"></i> ',App.t("notes_and_comments"),"</h4>\n        "),details&&__p.push('\n          <div class="comment notes">\n            <strong>',App.t("notes"),"</strong><br>\n            ",_.escape(details).replace(/\n/g,"<br>"),"\n          </div>\n        "),__p.push("\n        "),"undefined"!=typeof comments&&(__p.push("\n          "),_.each(comments,function(e){__p.push("\n            "),e.deleted_at||(__p.push('\n              <div class="comment ',(""+e.comment_type).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" data-id="',(""+e.id).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n                <div class="header">\n                  ',(""+e.user.first_name+(e.user.last_name?" "+e.user.last_name[0]+".":"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'\n                  <span class="timestamp">\n                    ',$.capitalize(formattedDate(e.created_at,"relative")),"\n                  </span>\n                  "),current_user==e.user.id&&void 0!==e.deleted_at&&__p.push('\n                    <a class="delete_comment" href="#" data-id="',e.id,'">&times;</a>\n                  '),__p.push("\n                </div>\n                ",_.escape(e.content).replace(/\n/g,"<br>"),"\n              </div>\n            ")),__p.push("\n          ")}),__p.push("\n        ")),__p.push('\n        <div class="add_comment">\n          <textarea placeholder="',(""+App.t("add_a_comment")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" cols="40" rows="2"></textarea>\n          <br />\n          <button class="btn btn-small btn-orange">',App.t("post"),"</button>\n        </div>\n      </div>\n    </td>\n  </tr>\n</table>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/expense-list-group"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="expense group" onclick="App.relationshipsRouter.navigate(\'#/groups/',group.id,'\', true); return false">\n  <div class="main-block">\n    <div class="date" title="',group.get("updated_at"),'">',SHORT_MONTHS[Date.fromISO(group.get("updated_at")).getMonth()],' <div class="number">',Date.fromISO(group.get("updated_at")).getDate()<10?"0"+Date.fromISO(group.get("updated_at")).getDate():Date.fromISO(group.get("updated_at")).getDate(),'</div></div>\n    <img src="/assets/fat_rabbit/group-icon.png" class="receipt group">\n    <div class="header">\n      <span class="description">\n        <a href="#/groups/',group.id,'">\n          ',(""+group.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'\n        </a>\n      </span>\n    </div>\n  </div><div class="cost">&nbsp;</div><div class="you">\n    '),
mainBalance?(__p.push("\n      "),positiveBalance=mainBalance.amount>0,__p.push("\n      "),keystring=positiveBalance?"PERSON_owes_you__group_cell":"you_owe_PERSON__group_cell",__p.push("\n      "),amountClass=positiveBalance?"positive":"negative",__p.push("\n      "),amountString=App.currencies.print(Math.abs(mainBalance.amount),mainBalance.currency_code)+(balanceCount>1?"*":""),__p.push("\n\n      ",App.t(keystring,App.currentRelationship.get("first_name")),'<br>\n      <span class="',amountClass,'">',amountString,"</span>\n    ")):__p.push("\n      ",App.t("you_owe_PERSON__group_cell",App.currentRelationship.get("first_name")),"<br>\n      ",App.t("nothing__amount"),"\n    "),__p.push("\n\n    "),group.get("simplify_by_default")&&__p.push('\n      <i class="icon-large icon-question-sign" rel="tooltip" title="',(""+App.t("this_group_has_simplify_turned_on_explanation")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'"></i>\n    '),__p.push("\n  </div>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/expense-summary"]=function(obj){var __p=[];with(obj||{}){__p.push("");var user=_.find(users,function(e){return parseInt(e.user_id)==current_user});__p.push("\n");App.currentRelationship.getUser(current_user);__p.push("\n");var uninvolved=void 0==user||(0==parseFloat(user.paid_share)||isNaN(parseFloat(user.paid_share)))&&(0==parseFloat(user.owed_share)||isNaN(parseFloat(user.owed_share)));if(__p.push("\n\n"),payment){__p.push('\n  <div class="expense summary payment ',uninvolved?"uninvolved":"involved",'" data-date="',date,'">\n    <div class="main-block">\n      <div class="header">\n        '),"paypal"==transaction_method?__p.push('\n          <img src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/payment-icon-paypal-7f0ed14f13197f8dc03236ec5f248285a7d10357f1d89a9cfcbdbfafe9ca50d8.png" alt="Payment icon paypal" />\n        '):"venmo"==transaction_method?__p.push('\n          <img src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/payment-icon-venmo-361d18afab754153c5ba576353834c935f1494205f106f65fa9b73729aed79b4.png" alt="Payment icon venmo" />\n        '):"paytm"==transaction_method?__p.push('\n          <img src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/payment-icon-paytm-fd7e4cae081263aea0cb568a9702b1bffd405035ea20d1702e0048307f4b608e.png" alt="Payment icon paytm" />\n        '):"payment_demo"==transaction_method?__p.push('\n          <img src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/payment-icon-payment_demo-aa5045b44eaecb09fcd6d17a5ea834ac2a3e3b75e1670dec0ce996a70e23dd7d.png" alt="Payment icon payment demo" />\n        '):__p.push('\n          <img src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/payment-icon-black-95a84e938aaf0309a3c8c0f8c04992ab52a12c852a4f24bf097ebf8581d456a6.png" alt="Payment icon black" />\n        '),__p.push('\n        <span class="description">\n          '),"paypal"!=transaction_method&&"venmo"!=transaction_method&&"paytm"!=transaction_method&&"payment_demo"!=transaction_method||transaction_confirmed||__p.push('<span class="label pending">',App.t("pending").toUpperCase(),"</span>"),__p.push("\n          "),"paypal"==transaction_method&&transaction_confirmed&&__p.push('<span class="label paypal">PAYPAL</span>'),__p.push("\n          "),"venmo"==transaction_method&&transaction_confirmed&&__p.push('<span class="label paypal">VENMO</span>'),__p.push("\n          "),"paytm"==transaction_method&&transaction_confirmed&&__p.push('<span class="label paypal">PAYTM</span>'),__p.push("\n          "),"payment_demo"==transaction_method&&transaction_confirmed&&__p.push('<span class="label paypal">PAYMENT DEMO</span>'),__p.push('\n          <a href="#" onclick="return false">\n            ');var payer=new App.Models.User(users[0].user).firstNameLastInitial();__p.push("\n            ");var payee=new App.Models.User(users[void 0==users[1]?0:1].user).firstNameLastInitial();__p.push("\n            ");var keystring="Payment"!==description?"NAME_paid_NAME_AMOUNT_for_DESCRIPTION":"NAME_paid_NAME_AMOUNT";if(__p.push("\n\n            ",App.t(keystring,payer,payee,App.currencies.print(cost,currency_code),description),"\n\n            "),!group_id||"group"==App.currentRelationship.get("relationship_type")&&App.currentRelationship.id==group_id||__p.push("\n              ",App.t("in_GROUP",App.groups.get(group_id)?App.groups.get(group_id).name():App.t("unknown_group_name")),"\n            "),__p.push('\n          </a>\n        </span>\n      </div>\n    </div><div class="cost">\n      '),uninvolved?__p.push("\n        &nbsp;\n      "):App.expenses.get(id).netBalance()>0?__p.push("\n        ",App.t("you_paid__expense_cell"),"\n      "):App.expenses.get(id).netBalance()<0&&__p.push("\n        ",App.t("you_received__expense_cell"),"\n      "),__p.push('\n    </div><div class="you ',simplified_debt?"simplified":"",'">\n      '),uninvolved)__p.push("\n        ",App.t("not_involved__expense_cell_oneline_html"),"\n      ");else{__p.push("\n        ");var netBalance=App.expenses.get(id).netBalance();__p.push("\n\n        "),0!==netBalance&&__p.push('\n          <span class="',netBalance>0?"positive":"negative",'">',App.currencies.print(Math.abs(netBalance),currency_code),"</span>\n        "),__p.push("\n      ")}__p.push('\n    </div><div class="actions">\n      <a href="#" class="delete" data-method="delete">\xd7</a>\n    </div>\n  </div>\n\n')}else{__p.push('\n  <div class="expense summary ',uninvolved?"uninvolved":"involved",'" data-date="',date,'" data-involved="',!uninvolved,'">\n    <div class="main-block">\n      <div class="date" title="',date,'">',SHORT_MONTHS[Date.fromISO(date).getMonth()],' <div class="number">',Date.fromISO(date).getDate()<10?"0"+Date.fromISO(date).getDate():Date.fromISO(date).getDate(),'</div></div>\n      <img src="',App.categories.get(category.id)?App.categories.get(category.id).get("icon"):"https://s3.amazonaws.com/splitwise/uploads/category/icon/slim/uncategorized/general.png",'" class="receipt">\n      <div class="header">\n        <span class="description ',!group_id||"group"==App.currentRelationship.get("relationship_type")&&App.currentRelationship.id==group_id?"":"grouped",'">\n          <a href="#" onclick="return false">\n            ',(""+description).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n            "),(details||comments_count>0)&&__p.push('<i class="icon-comment"></i>'),__p.push("\n            "),receipt.large&&__p.push('<i class="icon-camera"></i>'),__p.push("\n            "),repeats&&__p.push('<span class="label recurring">',App.t("recurring").toUpperCase(),"</span>"),__p.push("\n            "),!group_id||"group"==App.currentRelationship.get("relationship_type")&&App.currentRelationship.id==group_id||__p.push('<br><a href="#/groups/',group_id,'"><span class="label group">',(""+(App.groups.get(group_id)?App.groups.get(group_id).name():App.t("unknown_group_name"))).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</span></a>"),__p.push('\n          </a>\n        </span>\n      </div>\n    </div><div class="cost">\n      '),1==payers.length&&payers[0].user.id==current_user?__p.push("\n        ",App.t("you_paid__expense_cell"),"<br>\n      "):1==payers.length?(__p.push("\n        "),payer=App.expenses.get(id).payers()[0].user.first_name.length>10?App.expenses.get(id).payers()[0].user.first_name[0]+".":new App.Models.User(payers[0].user).firstNameLastInitial(),__p.push("\n\n        ",App.t("NAME_paid__expense_cell",payer),"<br>\n      ")):__p.push("\n        ",App.t("N_people_paid__expense_cell",payers.length),"<br>\n      "),__p.push('\n      <span class="number">',App.currencies.print(cost,currency_code),"</span>\n    ");var simplified_debt=-1==App.currentRelationship.id&&group_id&&App.groups.get(group_id)&&1==App.groups.get(group_id).get("simplify_by_default");if(__p.push('\n    </div><div class="you ',simplified_debt?"simplified":"",'">\n      '),uninvolved)__p.push("\n        ",App.t("not_involved__expense_cell_html"),"\n      ");else if(App.expenses.get(id).netBalance()>0){__p.push("\n        ");var lentName,owers=_.select(App.expenses.get(id).owers(),function(e){return e.user_id!=current_user});__p.push("\n\n        "),App.currentRelationship&&App.currentRelationship.isFriend()?(__p.push("\n          "),lentName=App.currentRelationship.firstNameLastInitial(),__p.push("\n        ")):1==owers.length&&(__p.push("\n          "),lentName=owers[0].user.first_name.length>10?owers[0].user.first_name[0]+".":owers[0].user.first_name,__p.push("\n        ")),__p.push("\n\n        ",void 0!==lentName?App.t("you_lent_NAME__expense_cell",lentName):App.t("you_lent__expense_cell"),'\n\n        <br />\n        <span class="positive">',App.currencies.print(App.expenses.get(id).netBalance(),currency_code),"</span>\n      ")}else App.expenses.get(id).netBalance()<0?(__p.push("\n        "),App.currentRelationship&&App.currentRelationship.isFriend()?__p.push("\n          ",App.t("NAME_lent_you__expense_cell",App.currentRelationship.firstNameLastInitial()),"\n        "):1==App.expenses.get(id).payers().length?__p.push("\n          ",App.t("NAME_lent_you__expense_cell",App.expenses.get(id).payers()[0].user.first_name.length>10?App.expenses.get(id).payers()[0].user.first_name[0]+".":App.expenses.get(id).payers()[0].user.first_name),"\n        "):__p.push("\n          ",App.t("you_borrowed__expense_cell"),"\n        "),__p.push('\n\n        <br>\n        <span class="negative">',App.currencies.print(-App.expenses.get(id).netBalance(),currency_code),"</span>\n      ")):__p.push("\n        ",App.t("you_borrowed_nothing__expense_cell_html"),"\n      ");__p.push('\n    </div><div class="actions">\n      <a href="/expenses/',id,'" class="delete" data-method="delete">\xd7</a>\n    </div>\n    <div class="category_picker"></div>\n  </div>\n')}__p.push("\n")}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/expense"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="summary"></div>\n<div class="users"></div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/flash-message"]=function(obj){var __p=[];with(obj||{})__p.push("<div class='alert-message ",type,"'>\n  <a href='#' class='close' onclick='$(this).parent().slideUp(250, function() { $(this).remove() }); return false'>\xd7</a>\n  ",(""+message).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/identities"]=function(obj){var __p=[];with(obj||{})__p.push("<style>\n  .identities-container{\n    border: 1px solid #ccc;\n    background: #eee;\n    padding: 2px 5px;\n    border-radius: 3px;\n    margin-bottom: 10px;\n    font-size: 13px;\n  }\n\n  .identities-container label{\n    font-size: inherit;\n  }\n\n  .identities-list {\n    width: 100%;\n  }\n\n  .identities-list td{\n    padding: 5px 3px;\n  }\n\n  .identity .identity-email{\n    color: #888;\n    text-align: left;\n  }\n\n  .identity.primary .identity-email{\n    color: #000;\n  }\n\n  .identity {\n    margin-bottom: 10px;\n  }\n\n  .identity.new h4{\n    border-top: 1px solid #ccc;\n    padding-top: 10px;\n    color: #333 !important;\n  }\n\n  .identity .delete {\n    color: #c00;\n    font-size: 20px;\n  }\n\n  .identity .actions {\n    text-align: right;\n  }\n\n  .confirm-remove {\n    border: 1px solid #ccc;\n  }\n\n  .confirm-remove td {\n    padding: 10px;\n  }\n\n  .identity .primary-radio {\n    width: 10px;\n  }\n\n  .identity-title{\n    display: inline;\n    cursor: pointer;\n    overflow-wrap: break-word;\n    word-wrap: break-word;\n    word-break: break-word;\n  }\n\n  .identities-list .label-success{\n    font-size: 90%;\n  }\n\n  .identities-list input[type=text], .identities-list input[type=password], .identities-list input[type=email]{\n    width: 190px;\n    width: calc(100% - 12px);\n  }\n\n  .confirm-remove .remove-current-password{\n    margin: 5px 0 10px;\n  }\n\n  /* Special styling for mobile screens */\n  @media screen and (max-width: 800px) {\n    .identities-container{\n      margin-top: 3px;\n      font-size: 16px;\n      padding: 3px 5px;\n    }\n\n    .identities-list {\n      margin-top: 5px;\n    }\n\n    .identities-list input[type=radio]{\n      min-width: 30px;\n      min-height: 30px;\n    }\n\n    .identity .delete {\n      font-size: 36px;\n    }\n\n    .identity .delete:hover {\n      text-decoration: none;\n    }\n  }\n</style>\n\n<div class='identities-container'>\n  <table class='identities-list'>\n    "),identities.each(function(e,t){__p.push("\n      <tr class='identity ",e.confirmationState()," ",e.isPrimary()?"primary":""," ",e.isNew()?"new":"","'>\n        "),e.isNew()?__p.push("\n          <td colspan=3>\n            <h4>",App.t("add_new_email"),"</h4>\n            <input class='disable-on-save' id='raw-string' type='email' placeholder='",App.t("email_address"),"' />\n            <br />\n            <input class='disable-on-save' id='identity-current-password' type='password' placeholder='",App.t("your_current_password"),"' />\n            <br />\n            <button class='disable-on-save btn btn-cancel'>",App.t("cancel"),"</button>\n            <button class='disable-on-save btn btn-mint' id='submit-identity'>",App.t("add"),"</button>\n          </td>\n\n        "):(__p.push("\n          "),email=e.get("raw_string"),__p.push("\n          <td class='primary-radio'>\n            <input type='radio' id='identity",(""+e.id).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"' value='",(""+email).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"' name='primary' ",e.isPrimary()?"checked=true":"","' />\n          </td>\n          <td class='identity-email'>\n            <label class='identity-title' for='identity",(""+e.id).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"'>\n              ",(""+email).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n            </label>\n\n            "),e.isConfirmed()||__p.push("\n              <a href='#' class='resend-confirmation' data-email='",(""+email).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"' rel='tooltip' title='",App.t("unconfirmed_identity_tooltip"),"'>\n                (",App.t("unconfirmed__email_address"),")</a>\n            "),__p.push("\n\n            "),e.isPrimary()&&__p.push("\n              <span class='label label-success'>",App.t("primary__email_address"),"</span>\n            "),__p.push("\n          </td>\n\n          <td class='actions'>\n            "),e.isPrimary()||__p.push("\n              <a href='#' class='delete' data-email='",(""+email).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"'>\xd7</a>\n            "),__p.push("\n          </td>\n        ")),__p.push("\n      </tr>\n    ")}),__p.push("\n\n    "),identities.all(function(e){return!e.isNew()})&&__p.push("\n      <tr class='add-identity'>\n        <td colspan=3>\n          <a href='#' class='btn btn-mint'>",App.t("add_new_email"),"</a>\n        </td>\n      </tr>\n    "),__p.push("\n  </table>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/main-trends"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="stat">\n  <h4>',App.t("total_you_paid_for"),"</h4>\n  "),_.each(data.expenses_paid,function(e,t){__p.push('\n    <div class="amount ',e>0?"positive":"",'">\n      ',App.currencies.print(e,t),"\n    </div>\n  ")}),__p.push('\n</div>\n<div class="stat">\n  <h4>',App.t("your_total_share"),"</h4>\n  "),_.each(data.expenses_owed,function(e,t){__p.push('\n    <div class="amount ',e>0?"negative":"",'">\n      ',App.currencies.print(e,t),"\n    </div>\n  ")}),__p.push('\n</div>\n<div class="stat">\n  <h4>',App.t("payments_made"),"</h4>\n  "),_.each(data.payments_made,function(e,t){__p.push('\n    <div class="amount ',e>0?"positive":"",'">\n      ',App.currencies.print(e,t),"\n    </div>\n  ")}),__p.push('\n</div>\n<div class="stat">\n  <h4>',App.t("payments_received"),"</h4>\n  "),_.each(data.payments_received,function(e,t){__p.push('\n    <div class="amount ',e>0?"negative":"",'">\n      ',App.currencies.print(e,t),"\n    </div>\n  ")}),__p.push('\n</div>\n<div class="stat">\n  <h4>',App.t("total_change_in_balance"),"</h4>\n  "),_.each(data.net_change,function(e,t){__p.push('\n    <div class="amount big ',e>0?"positive":0>e?"negative":"",'">\n      ',e>=0?"+":"-"," ",App.currencies.print(Math.abs(e),t),"\n    </div>\n  ")}),__p.push("\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/add-a-bill-form"]=function(obj){var __p=[];with(obj||{}){__p.push('<div class="relative-container">\n  <div class="input-data"></div>\n  <div class="main-window">\n    <header>\n      '),editMode?__p.push("\n        ",App.t("edit_bill"),"\n      "):__p.push("\n        ",App.t("add_a_bill"),"\n      "),__p.push('\n      <a class="dismiss" href="#" data-dismiss="modal">&times;</a>\n    </header>\n    ');App.currentRelationship&&"group"==App.currentRelationship.get("relationship_type")&&App.currentRelationship.id>0;__p.push('\n    <div class="with_field ',tokenizedPromptWith?"group":"",'">\n      '),tokenizedPromptWith?__p.push('\n        <span class="with">',App.t("with__add_bill"),"</span>\n      "):__p.push('\n        <span class="with">',App.t("with_you_and__add_bill_html"),"</span>\n      "),__p.push('\n      <input type="text" class="involved" id="add_bill_with">\n    </div>\n    <div class="body">\n      <div class="main_fields">\n        <img src="',model.categoryIcon(),'" class="category">\n        <input type="text" class="description" placeholder="',(""+App.t("enter_a_description__short")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" value="',(""+(model.get("description")?model.get("description"):"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n        <div class="cost_container">\n          <span class="currency_code">',App.currencies.unit(model.get("currency_code")),'</span><input type="text" class="cost" placeholder="0.00" value="',model.get("cost")?model.get("cost").toFixed(2):"",'">\n        </div>\n      </div>\n\n      <div class="human_summary"></div>\n\n      <a class="date slim-button">',formattedDate(model.get("date")),'</a>\n      <a class="notes slim-button">',App.t("add_image_or_notes"),"</a>\n      "),App.groups.size()>1&&__p.push('\n        <a class="group slim-button">\n          ',(""+App.groups.get(model.get("group_id")||0).shortName()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n        </a>\n      "),__p.push('\n    </div>\n    <footer>\n      <button class="btn btn-large btn-cancel" data-dismiss="modal">',App.t("cancel"),'</button>\n      <button class="btn btn-large btn-mint submit">\n        ',App.t("save"),"\n      </button>\n    </footer>\n  </div>\n</div>\n")}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/add-notes"]=function(obj){var __p=[];with(obj||{})__p.push("<header>\n  ",App.t("add_image_or_notes"),'\n  <a class="dismiss" href="#">&times;</a>\n</header>\n<div class="body">\n  '),payment&&__p.push('\n    <div class="memo">\n      ',App.t("include_a_memo"),':\n      <input type="text" value="',(""+("Payment"==description?"":description)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n    </div>\n  '),__p.push("\n\n  "),App.formDataSupported&&__p.push('\n    <div class="upload">\n      ',App.t("attach_an_image_or_pdf"),':\n      <input type="file" id="bill_file">\n    </div>\n  '),__p.push('\n  <textarea placeholder="',(""+App.t("add_notes")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">',(""+(notes?notes:"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'</textarea>\n</div>  \n<footer>\n  <button class="btn btn-large btn-mint dismiss">',App.t("done"),"</button>\n</footer>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/charts-details"]=function(obj){var __p=[];with(obj||{})__p.push('<td><a href="#/all">',(""+description).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</a></td>\n<td>",App.currencies.printWithCurrentCurrency(parseFloat(cost)),"</td>\n<td>",formattedDate(Date.fromISO(date)),"</td>\n<td>",formattedDate(next_repeat),"</td>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/charts-modal"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="input-data"></div>\n<div class="modal-header">\n  <button type="button" class="close" data-dismiss="modal">\xd7</button>\n  <h3>Charts</h3>\n</div>\n<div class="modal-body">\n  <h4>\n    <a href="#" class="btn previous">&laquo; previous</a>\n    Spending breakdown for ',MONTHS[time.getMonth()]," ",time.getFullYear(),'\n    <a href="#" class="btn next">next &raquo;</a>\n  </h4>\n  <img src="https://chart.googleapis.com/chart?chf=a,s,00000091|bg,s,FFFFFF&chxs=0,000000,11&chxt=x&chs=550x250&cht=p&chco=3072F3,80C65A,FF3131,FF9900,9C4F82&chd=t:100&chdl=General&chp=0.1&chl=$0.00&chma=0,140,0,5|75&chts=676767,11&chdls=000000,12" id="charts_graphic">\n  <div class="no_spending" style="display: none; padding: 20px 20px 30px; text-align: center; font-size: 24px; color: #ccc; line-height: 28px">\n    No expenses have been<br>\n    added yet for this month.\n  </div>\n  <table>\n    <thead>\n      <tr class=\'block top\'>\n        <th>Category</th>\n        <th class=\'total\'>Total spending</th>\n        <th>You paid for</th>\n        <th class=\'small\'></th>\n        <th>Your share</th>\n        <th class=\'small\'></th>\n        <th>Net balance</th>\n    </thead>\n    <tbody>\n    </tbody>\n  </table>\n</div>\n<div class="modal-footer">\n  <a href="#" class="btn btn-large" data-dismiss="modal">Close</a>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/choose-category"]=function(obj){var __p=[];with(obj||{})__p.push("<header>\n  ",App.t("choose_a_category"),'\n  <a class="dismiss" href="#">&times;</a>\n</header>\n<div class="body">\n  <ul>\n    '),_.each(App.categories.rootCategories(),function(e){__p.push("\n      ");var t=selected.id==e.id||selected.get("parent_id")==e.id;__p.push('\n      <li data-id="',e.get("id"),'" class="',t?"selected":"",'">\n        ',e.get("name"),'\n        <i class="icon-chevron-right"></i>\n        <ul>\n          '),_.each(App.categories.childCategories(e),function(e){__p.push('\n            <li data-id="',e.get("id"),'" class="',selected.id==e.id?"selected":"",'">\n              ',e.get("name"),"\n            </li>\n          ")}),__p.push("\n        </ul>\n      </li>\n    ")}),__p.push("\n  </ul>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/choose-currency"]=function(obj){var __p=[];with(obj||{})__p.push("<header>\n  ",App.t("choose_a_currency"),'\n  <a class="dismiss" href="#">&times;</a>\n</header>\n<div class="body">\n  <ul>\n    '),_.each(App.currencies.models,function(e){__p.push("\n      ");var t=currency_code==e.get("currency_code");__p.push('\n      <li data-currency-code="',e.get("currency_code"),'" class="',t?"selected":"",'">\n        ',e.get("currency_code"),"\n      </li>\n    ")}),__p.push("\n  </ul>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/choose-date"]=function(obj){var __p=[];with(obj||{})__p.push("<header>\n  ",App.t("choose_date"),'\n  <a class="dismiss" href="#">&times;</a>\n</header>\n<div class="body">\n  <div data-toggle="true" id="datepicker" data-date="',date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate(),'" data-date-format="yyyy-mm-dd"></div>\n\n  '),showRecurringOptions&&__p.push('\n    <div class="recurring_options">\n      ',App.t("repeats"),":\n      <div class=\"container-for-select\"></div>\n      <select id=\"repeat_interval\" data-onchange=\"if ($(this).find('input[type=hidden]').val() == 'never'){ $('#recurrence_options').slideUp(150) } else { $('#recurrence_options').slideDown(150); }\">\n        <option value=\"never\" ","never"==repeat_interval?"selected":"",">",App.t("just_this_once"),'</option>\n        <option value="weekly" ',"weekly"==repeat_interval?"selected":"",">",App.t("weekly"),'</option>\n        <option value="fortnightly" ',"fortnightly"==repeat_interval?"selected":"",">",App.t("fortnightly"),'</option>\n        <option value="monthly" ',"monthly"==repeat_interval?"selected":"",">",App.t("monthly"),'</option>\n        <option value="yearly" ',"yearly"==repeat_interval?"selected":"",">",App.t("yearly"),'</option>\n      </select>\n\n      <div id="recurrence_options">\n        ',App.t("reminder"),':\n        <div class="container-for-select"></div>\n        <select id="email_reminder_in_advance">\n          <option value="-1" ',-1==email_reminder_in_advance?"selected":"",">",App.t("no_reminder"),'</option>\n          <option value="0" ',0==email_reminder_in_advance?"selected":"",">",App.t("on_the_day_of"),'</option>\n          <option value="1" ',1==email_reminder_in_advance?"selected":"",">",App.t("one_day_early"),'</option>\n          <option value="3" ',3==email_reminder_in_advance?"selected":"",">",App.t("N_days_early",3),'</option>\n          <option value="5" ',5==email_reminder_in_advance?"selected":"",">",App.t("N_days_early",5),'</option>\n          <option value="7" ',7==email_reminder_in_advance?"selected":"",">",App.t("one_week_early"),'</option>\n          <option value="14" ',14==email_reminder_in_advance?"selected":"",">",App.t("two_weeks_early"),"</option>\n        </select>\n      </div>\n    </div>\n  "),__p.push("\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/choose-group"]=function(obj){var __p=[];with(obj||{})__p.push("<header>\n  ",App.t("choose_group"),'\n  <a class="dismiss" href="#">\xd7</a>\n</header>\n\n<div class="body">\n  <ul>\n    '),_.each(App.groups.models,function(e){__p.push('\n      <li data-id="',e.id,'" class="',group_id==e.id?"selected":"",'">\n        ',(""+e.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n      </li>\n    ")}),__p.push("\n  </ul>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/choose-payer"]=function(obj){var __p=[];with(obj||{})__p.push("<header>\n  "),"onePayee"==field?__p.push("\n    ",App.t("choose_a_recipient"),"\n  "):"oneReimburser"==field?__p.push("\n    ",App.t("choose_a_person"),"\n  "):__p.push("\n    ",App.t("choose_payer"),"\n  "),__p.push('\n  <a class="dismiss" href="#">&times;</a>\n</header>\n<div class="body">\n  <ul>\n    '),_.each(users,function(e){__p.push('\n      <li data-id="',e.id,'" class="main_payer ',active==e.id?"selected":"",'">\n        <img src="',e.picture.small,'">\n        ',(""+e.first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")," ",(""+(e.last_name||"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n      </li>\n    ")}),__p.push("\n    "),payment||"oneReimburser"==field||(__p.push('\n      <li class="main_payer ',null==active?"selected":"",'">\n        ',App.t("multiple_people"),'\n        <ul style="display: ',null==active?"":"none",'">\n          <li>\n            <label>\n              <input type="checkbox" ',eachPaidOwnShare?"checked":"",">\n              ",App.t("each_person_paid_own_share"),"\n            </label>\n          </li>\n          "),_.each(users,function(e){__p.push('\n            <li data-id="',e.id,'">\n              ');var t=_.find(userShares,function(t){return t.user_id==e.id});__p.push("\n              ",(""+e.first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")," ",(""+(e.last_name||"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'\n              <div class="input-prepend">\n                <span class="add-on currency_symbol">',currency_symbol,'</span><input type="text" value="',t&&t.paid_share>0?t.paid_share.toFixed(2):"",'" data-id="',e.id,'" ',eachPaidOwnShare?"disabled='true'":"",">\n              </div>\n            </li>\n          ")}),__p.push("\n        </ul>\n      </li>\n    ")),__p.push("\n  </ul>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/choose-split"]=function(obj){var __p=[];with(obj||{}){if(__p.push("<header>\n  ",App.t("choose_split_options"),'\n  <a class="dismiss" href="#">&times;</a>\n</header>\n<div class="body">\n  '),2==users.length){__p.push('\n    <div style="text-align: center; " class="iou_buttons">\n      ');var you=_.find(users,function(e){return e.id==current_user});__p.push("\n      ");var amount=0==safe_parse_float(cost)?"":App.currencies.print(cost,currency_code);if(__p.push('\n      <a class="slim-button wide" data-split-type="split">',App.t("split_the_bill"),"</a>\n\n      "),you){__p.push("\n        ");var otherPerson=_.find(users,function(e){return e.id!=current_user});__p.push("\n        ");var otherPersonName=otherPerson?otherPerson.first_name:App.t("fallback_person_name");__p.push("\n\n        "),amount?__p.push('\n          <a class="slim-button wide" data-split-type="iou">',App.t("you_owe_PERSON_AMOUNT",otherPersonName,amount),'</a>\n          <a class="slim-button wide" data-split-type="uoi">',App.t("PERSON_owes_you_AMOUNT",otherPersonName,amount),"</a>\n        "):__p.push('\n          <a class="slim-button wide" data-split-type="iou">',App.t("you_owe_the_full_amount"),'</a>\n          <a class="slim-button wide" data-split-type="uoi">',App.t("they_owe_the_full_amount"),"</a>\n        "),__p.push("\n\n      ")}else __p.push('\n        <a class="slim-button wide" data-split-type="iou">\n          ',App.t("NAME_owes_NAME_AMOUNT_html",users[0].first_name,users[1].first_name,amount),'\n        </a>\n        <a class="slim-button wide" data-split-type="uoi">\n          ',App.t("NAME_owes_NAME_AMOUNT_html",users[1].first_name,users[0].first_name,amount),"\n        </a>\n      ");__p.push("\n\n      "),"split"==model.get("split")&&__p.push('\n        <hr style="background: #eee; border: none; height: 1px; margin: 10px 0">\n      '),__p.push("\n    </div>\n\n  ")}if(__p.push("\n\n  "),"split"==model.get("split")){__p.push('\n    <div class="split-details">\n      <div class="btn-group btn-group-inline" data-toggle="buttons-radio" id="split_method">\n        <button class="split_button btn btn-gray active equal" data-split-subtype="equal" title="',(""+App.t("split_equally")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" rel="tooltip">=</button>\n        <button class="split_button btn btn-gray unequal" data-split-subtype="unequal" title="',(""+App.t("split_by_exact_amounts")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" rel="tooltip">1.23</button>\n        <button class="split_button btn btn-gray percent" data-split-subtype="percent" title="',(""+App.t("split_by_percentages")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" rel="tooltip">%</button>\n        <button class="split_button btn btn-gray shares" data-split-subtype="shares" title="',(""+App.t("split_by_shares")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" rel="tooltip"><i class="icon-tasks"></i></button>\n        <button class="split_button btn btn-gray adjustment" data-split-subtype="adjustment" title="',(""+App.t("split_by_adjustment")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" rel="tooltip">+/-</button>\n        <button class="split_button btn btn-gray reimbursement" data-split-subtype="reimbursement" title="',(""+App.t("reimbursement")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" rel="tooltip"><i class="icon-money"></i></button>\n        <button class="split_button btn btn-gray itemized" data-split-subtype="itemized" title="',(""+App.t("itemized_bill")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" rel="tooltip"><i class="icon-th-list"></i></button>\n      </div>\n      <div class="split_method equal">\n        <h3>',App.t("split_equally"),"</h3>\n        "),
_.each(users,function(e){__p.push("\n          ");var t=_.find(userShares,function(t){return t.user_id==e.id});__p.push("\n          ");var n=void 0==model.get("equal_users")||model.get("equal_users")[e.id];__p.push('\n          <div class="person ',n?"":"nope",'" data-id=',e.id,'>\n            <span class="amount">\n              ',App.currencies.print(t.owed_share,currency_code),'\n            </span>\n            <input class="share" type="checkbox" ',n?'checked="checked"':"",'>\n            <img src="',e.picture.medium,'">\n            <span class="name"><strong>',(""+e.first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</strong> ",(""+(e.last_name||"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</span>\n          </div>\n        ")}),__p.push('\n      </div>\n      <div class="split_method unequal">\n        <h3>',App.t("split_by_exact_amounts"),"</h3>\n        "),_.each(users,function(e){__p.push("\n          ");var t=_.find(userShares,function(t){return t.user_id==e.id});__p.push('\n          <div class="person" data-id=',e.id,'>\n            <div class="input-prepend">\n              <span class="add-on currency_symbol">',currency_symbol,'</span><input type="text" value="',t.owed_share?t.owed_share.toFixed(2):"",'">\n            </div>\n            <img src="',e.picture.medium,'">\n            <span class="name"><strong>',(""+e.first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</strong> ",(""+(e.last_name||"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</span>\n          </div>\n        ")}),__p.push('\n        <div class="totals">\n          <strong style="text-transform: uppercase">',App.t("total"),'</strong>\n          <div class="subtotals">\n            <span class="owed_total">\n              ',App.currencies.print(_.reduce(userShares,function(e,t){return e+(t.owed_share?t.owed_share:0)},0),currency_code),'\n            </span>\n            <div class="remaining">\n              <span class="owed_remaining">\n                ',App.t("AMOUNT_left",App.currencies.print(cost-_.reduce(userShares,function(e,t){return e+(t.owed_share?t.owed_share:0)},0),currency_code)),'\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="split_method percent">\n        <h3>',App.t("split_by_percentages"),"</h3>\n        ");var percents=model.get("percents");__p.push("\n        "),_.each(users,function(e){__p.push('\n          <div class="person" data-id=',e.id,'>\n            <div class="input-append">\n              <input type="text" value="',percents&&percents[e.id]>0?100*percents[e.id]:"",'"><span class="add-on">%</span>\n            </div>\n            <img src="',e.picture.medium,'">\n            <span class="name"><strong>',(""+e.first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</strong> ",(""+(e.last_name||"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</span>\n          </div>\n        ")}),__p.push('\n        <div class="totals">\n          <strong style="text-transform: uppercase">',App.t("total"),'</strong>\n          <div class="subtotals">\n            ');var sum=percents?_.reduce(percents,function(e,t){return e+100*t},0):0;__p.push('\n            <span class="owed_total">\n              ',sum.toFixed(2),'%\n            </span>\n            <div class="remaining">\n              <span class="owed_remaining">',App.t("PERCENT_left",(100-sum).toFixed(2)),'</span>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="split_method shares">\n        <h3>',App.t("split_by_shares"),"</h3>\n        ");var shares=model.get("shares");__p.push("\n        "),_.each(users,function(e){__p.push("\n          ");var t=_.find(userShares,function(t){return t.user_id==e.id});__p.push('\n          <div class="person" data-id=',e.id,'>\n            <div class="input-append">\n              <input type="text" style="width: 20px" value="',shares&&null!=shares[e.id]?shares[e.id]:1,'" placeholder="0">\n              <span class="add-on">\n                <span style="font-size: 11px">',App.t("share_or_shares").toLowerCase(),'</span>\n              </span>\n            </div>\n            <img src="',e.picture.medium,'">\n            <span class="name">\n              <strong>',(""+e.first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</strong> ",(""+(e.last_name||"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'<br>\n              <span class="subsummary">\n                ',App.t("total_share_AMOUNT",currency_symbol+(t&&t.owed_share?t.owed_share.toFixed(2):"0.00")),"\n              </span>\n            </span>\n          </div>\n        ")}),__p.push('\n      </div>\n      <div class="split_method adjustment">\n        <h3>',App.t("split_by_adjustment"),"</h3>\n        ");var adjustments=model.get("adjustments");__p.push("\n        "),_.each(users,function(e){__p.push("\n          ");var t=_.find(userShares,function(t){return t.user_id==e.id});__p.push('\n          <div class="person" data-id=',e.id,'>\n            <div class="input-prepend">\n              <span class="add-on">+ <span class="currency_symbol">',currency_symbol,'</span></span><input type="text" value="',adjustments&&adjustments[e.id]?adjustments[e.id]:"",'" placeholder="0.00" style="width: 30px">\n            </div>\n            <img src="',e.picture.medium,'">\n            <span class="name">\n              <strong>',(""+e.first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</strong> ",(""+(e.last_name||"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'<br>\n              <span class="subsummary">\n                ',App.t("total_share_AMOUNT",currency_symbol+(t&&t.owed_share?t.owed_share.toFixed(2):"0.00")),"\n              </span>\n            </span>\n\n          </div>\n        ")}),__p.push('\n      </div>\n      <div class="split_method reimbursement">\n        <h3>',App.t("reimbursement"),'</h3>\n\n        <div style="margin-bottom:5px">\n          ',App.t("_colon",App.t("each_person_gets_back")),"\n        </div>\n\n        "),_.each(users,function(e){__p.push("\n          ");var t=_.find(userShares,function(t){return t.user_id==e.id});__p.push("\n          ");var n=void 0==model.get("reimbursements")||model.get("reimbursements")[e.id];__p.push('\n          <div class="person ',n?"":"nope",'" data-id=',e.id,'>\n            <span class="amount">\n              ',App.currencies.print(t.paid_share,currency_code),'\n            </span>\n            <input class="share" type="checkbox" ',n?'checked="checked"':"",'>\n            <img src="',e.picture.medium,'">\n            <span class="name"><strong>',(""+e.first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</strong> ",(""+(e.last_name||"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</span>\n          </div>\n        ")}),__p.push('\n      </div>\n\n      <div class="split_method itemized">\n        ');var item_data=model.get("items");__p.push("\n        <h3>",App.t("itemized_bill"),'</h3>\n        <table id="itemized_items" class="itemized_items">\n          <tbody>\n            <tr>\n              <th>',App.t("itemized_bill_item"),'</th><th style="text-align: center;" class="amount_column currency_symbol">',currency_symbol,"</th>\n              "),_.each(users,function(e){__p.push('\n                <th class="small initials" data-id="',e.id,'" title="',(""+e.first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")," ",(""+(e.last_name||"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n                  ',(""+e.first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"<br />\n                  ",(""+(e.last_name||"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n                </th>\n              ")}),__p.push('\n            </tr>\n          </tbody>\n          <tbody id="item_holder">\n          '),_.each(item_data.items,function(e){__p.push("\n            ");var t=JST["backbone/templates/modals/itemized-item"]({users:users,item:e});__p.push("\n            ",t,"\n          ")}),__p.push("\n            ");var b=JST["backbone/templates/modals/itemized-item"]({users:users,item:null});__p.push("\n            ",b,'\n          </tbody>\n          <tbody>\n            <tr id="itemized_total">\n              <td style="font-size: 13px">',App.t("subtotal"),'</td><td class="amount_column" style="font-size: 13px">\n                ',safe_sum(item_data.subtotals).toFixed(2),"\n              </td>\n              "),_.each(users,function(e){__p.push('\n                <td class="small cost" data-id="',e.id,'">\n                  ',safe_parse_float(item_data.subtotals[e.id]).toFixed(2),"\n                </td>\n              ")}),__p.push('\n            </tr>\n            <tr id="itemized_tax">\n              <td class="small">&nbsp;&nbsp;&nbsp;+ ',App.t("bill_tax"),'</td>\n              <td class="amount_column" style="padding-bottom: 5px">\n                <input type="text" name="tax" class="tax_percent" placeholder="6.5%" value="',item_data.tax.total,'">\n                </input>\n              </td>\n              '),_.each(users,function(e){__p.push('\n                <td class="small cost input">\n                  <input type="text" name="tax_amount" class="tax_amount" data-id="',e.id,'" value="',safe_parse_float(item_data.tax.users[e.id]).toFixed(2),'">\n\n                  </input>\n                </td>\n              ')}),__p.push('\n            </tr>\n            <tr id="itemized_tip">\n              <td class="small">&nbsp;&nbsp;&nbsp;+ ',App.t("bill_tip"),'</td>\n              <td class="amount_column">\n                <input type="text" name="tip" class="tip_percent" placeholder="18%" value="',item_data.tip.total,'">\n                </input>\n              </td>\n              '),_.each(users,function(e){__p.push('\n                <td class="small cost input">\n                  <input type="text" name="tip_amount" class="tip_amount" data-id="',e.id,'" value="',safe_parse_float(item_data.tip.users[e.id]).toFixed(2),'">\n\n                  </input>\n                </td>\n              ')}),__p.push('\n            </tr>\n            <tr id="itemized_grand_total">\n              <td>',App.t("grand_total"),'</td><td class="amount_column">\n                ',safe_sum(item_data.totals).toFixed(2),"\n              </td>\n              "),_.each(users,function(e){__p.push('\n                <td class="grand_total small cost" data-id="',e.id,'">\n\n                  ',safe_parse_float(item_data.totals[e.id]).toFixed(2),"\n                </td>\n              ")}),__p.push('\n            </tr>\n          </tbody>\n        </table>\n        <button class="btn btn-large btn-mint dismiss">Done</button>\n      </div>\n    </div>\n  ')}__p.push("\n</div>\n")}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/custom-prompt"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="custom_prompt_overlay">&nbsp;</div>\n<div class="prompt_body">\n  <h3>',(""+prompt).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'</h3>\n  <input type="text">\n  <div class="error_message">',App.t("invalid_value_try_again"),'</div>\n  <div class="buttons">\n    <button class="btn btn-large btn-cancel cancel">',App.t("cancel"),'</button>\n    <button class="btn btn-large btn-mint ok">',App.t("ok"),"</button>\n  </div>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/first-launch"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="input-data"></div>\n<div class="padding_wrapper clearfix">\n  <img class="person" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/drawings/person-orange-132756aba0816bfed6540e25d57d59f6900f36b6854ef71b361ac24d7db53d39.png" alt="Person orange" />\n  <h1>\n    <img height="128" width="128" src="https://dx0qysuen8cbs.cloudfront.net/assets/core/logo-square-65a6124237868b1d2ce2f5db2ab0b7c777e2348b797626816400534116ae22d7.svg" alt="Logo square" />\n    ',App.t("_exclamation",App.t("welcome_to_splitwise")),'\n  </h1>\n  <div class="big_buttons">\n    <div class="main_buttons">\n      <div style="font-size: 20px; margin: 20px 0 26px; line-height: 24px">\n        ',App.t("what_would_you_like_to_do_first"),'\n      </div>\n      <a href="/groups/new/apartment" class="btn btn-large btn-orange" onclick="setTimeout(\'window.location=\\x22/groups/new/apartment\\x22;\', 125); return false" data-choice="apartment">\n        <i class="icon icon-home"></i>\n        ',(""+$.trim(App.t("add_your_apartment"))).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'\n      </a>\n      <a href="/groups/new/travel" class="btn btn-large btn-orange" onclick="setTimeout(\'window.location=\\x22/groups/new/travel\\x22;\', 125); return false" data-choice="travel">\n        <i class="icon icon-globe"></i>\n        ',(""+$.trim(App.t("add_a_group_trip"))).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'\n      </a>\n      <a href="#" class="btn btn-large btn-cancel" onclick="$(\'#first_launch\').fadeOut(); return false" style="text-align: center" data-choice="skip">\n        ',App.t("skip_setup_for_now"),"\n      </a>\n\n      ",App.t("looking_for_our_fairness_calculators"),' <a href="/calculators" onclick="setTimeout(\'window.location=\\x22/calculators\\x22;\', 125); return false" data-choice="calculators">\n        ',App.t("click_here"),".\n      </a>\n    </div>\n  </div>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/group-member-details"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="input-data"></div>\n'),void 0!=member&&group==App.currentRelationship&&(__p.push('\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">\xd7</button>\n    <img class="avatar" src="',(""+member.get("picture").large).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n    <h3>',(""+member.fullName()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'</h3>\n    <div style="color: #999; font-size: 14px">\n      ',(""+member.displayEmail()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n      "),"invited"==member.get("registration_status")?__p.push("\n       (",App.t("invite_pending").toLowerCase(),")\n      "):"unsubscribed"==member.get("registration_status")&&__p.push("\n       <span class='red'>(",App.t("this_person_has_unsubscribed_from_all_splitwise_messages"),")</span>\n      "),__p.push('\n    </div>\n    <div style="margin-top: 7px">\n      '),"dummy"==member.get("registration_status")?__p.push('\n        <a href="/friends/',(""+member.id).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'/edit" class="btn btn-orange track" data-action="group_member_add_email">\n          ',App.t("invite_PERSON_to_splitwise",member.get("first_name")),"\n        </a>\n      "):(__p.push('\n        <a href="/friends/',(""+member.id).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'/edit" class="btn btn-orange">\n          ',App.t("invited"==member.get("registration_status")?"edit_friend_info":"friend_settings"),"\n        </a>\n\n        "),"invited"==member.get("registration_status")&&__p.push('\n          <a class="btn btn-orange resend_invite track" href="#" data-action="resend_invite_group">\n            ',App.t("resend_invite"),"\n          </a>\n        "),__p.push('\n\n        <a class="btn btn-orange" data-toggle="modal" data-to="',member.id,'" href="#send_reminder">\n          ',App.t("send_a_balance_reminder"),"\n        </a>\n      ")),__p.push('\n    </div>\n  </div>\n  <div class="modal-body">\n    <h4>',App.t("suggested_repayments_for_GROUP",App.currentRelationship.name()),'</h4>\n    <div class="repayments">\n      '),0==App.currentRelationship.repayments(member.id).length&&__p.push("\n        <div>\n          ",App.t("NAME_is_all_settled_up",member.get("first_name")),"\n        </div>\n      "),__p.push("\n      "),_.each(App.currentRelationship.repayments(member.id),function(e){__p.push("\n        <div>\n          "),e.from==member.id?(__p.push("\n            "),ower=member.get("first_name"),__p.push("\n            "),owee=S(App.currentRelationship.getUser(e.to).firstNameLastInitial()).bold(),__p.push("\n            "),amount=App.currencies.print(e.amount,e.currency_code),__p.push("\n            "),amountClass="negative",__p.push("\n          ")):(__p.push("\n            "),ower=S(App.currentRelationship.getUser(e.from).firstNameLastInitial()).bold(),__p.push("\n            "),owee=member.get("first_name"),__p.push("\n            "),amount=App.currencies.print(e.amount,e.currency_code),__p.push("\n            "),amountClass="positive",__p.push("\n          ")),__p.push("\n\n          \u2022 ",App.t("NAME_owes_AMOUNT_to_NAME_html",ower,S(amount).wrapWithTag("span",{"class":amountClass}).bold(),owee),'\n\n          <button style="float: right" class="btn btn-mint" data-toggle="modal" data-from="',e.from,'" data-to="',e.to,'" data-amount="',e.amount,'" data-currency_code="',e.currency_code,'" data-group_id="',App.currentRelationship.id,'" href="#settle_up_form">\n            ',App.t("settle_up"),"\n          </button>\n        </div>\n      ")}),__p.push("\n    </div>\n  </div>\n")),__p.push("\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/invite-friends"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="input-data"></div>\n<div class="padding_wrapper clearfix">\n  <h3>\n    <img src="https://dx0qysuen8cbs.cloudfront.net/assets/core/logo-square-65a6124237868b1d2ce2f5db2ab0b7c777e2348b797626816400534116ae22d7.svg" alt="Logo square" />\n    ',App.t("invite_friends"),'\n  </h3>\n  <button type="button" class="close" data-dismiss="modal">\xd7</button>\n\n  <div class="pick_a_method">\n    <button class="btn btn-large btn-gray" onclick="window.open(\'/contacts/gmail\', \'\', \'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=375,width=700\'); return false;">\n      <img width="44" height="30" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/gmail-36691cc31abacb53cbe1ed1b8c74f45a3bbbb3dd44f33e3229843b67af4cb348.png" alt="Gmail" />\n      <br>\n      ',App.t("add_friends_from_gmail"),'\n    </button>\n    <span class="or">',App.t("or"),'</span>\n    <button class="btn btn-large btn-gray">\n      <img height="30" width="44" style="opacity: 0.6" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/email-db939b398a4bea03ee3f5fe956e3476f1d9eab86ca731b9293e53082be9f11e2.png" alt="Email" />\n      <br>\n      ',App.t("invite_friends_by_email_address"),'\n    </button>\n  </div>\n\n  <div class="invite_method email">\n    <div class="to">\n      <div class=\'to_label\'>',App.t("to__email_field"),'</div>\n      <input type="text" class="invite-input" id="invite-input" placeholder="Enter names or email addresses">\n    </div>\n\n    <textarea placeholder="',(""+App.t("include_an_optional_message")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'"></textarea>\n\n    <a href="#" class="btn btn-large btn-orange submit">',App.t("send_invites_and_add_friends"),'</a>\n\n    <span class="import_success">\n      <img width="22" height="15" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/gmail-36691cc31abacb53cbe1ed1b8c74f45a3bbbb3dd44f33e3229843b67af4cb348.png" alt="Gmail" />\n      <span class="count"></span>\n    </span>\n    <br>\n    <a href="/friend_invite" target="_blank" class="see_invite">\n      ',App.t("preview_the_message_youll_send"),'\n    </a>\n  </div>\n</div>\n\n<div class="friends_on_splitwise">\n  &nbsp;\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/itemized-item"]=function(obj){var __p=[];with(obj||{}){__p.push('<tr class="itemized_item">\n  <td class="input">\n    ');var description=item?item.description:"";__p.push('\n    <input type="text" name="item_name" class="item_name" value="',(""+description).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" placeholder="',(""+App.t("expense_description")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n  </td>\n  <td class="input amount_column">\n    ');var cost=item?item.cost:"";__p.push('\n    <input type="text" name="amount" class="amount" value="',(""+cost).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" />\n  </td>\n  '),_.each(users,function(e){__p.push("\n    ");var t=item?safe_parse_float(item.shares[e.id]):0;__p.push("\n    "),!item||t>0||_.contains(item.users,e.id)?__p.push('\n      <td class="itemized_item_selector selected cost very small" data-id="',e.id,'">\n    '):__p.push('\n      <td class="itemized_item_selector cost very small" data-id="',e.id,'">\n    '),__p.push("\n     ",t>0?t.toFixed(2):"","\n    </td>\n  ")}),__p.push('\n  <td class="input" style="padding-left:6px;padding-right:16px;">\n    <input type="checkbox" name="row_selector" class="row_selector" checked="<@= (item && item[\'shares\'].count == 0)"></input>\n  </td>\n</tr>\n')}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/repayments"]=function(obj){var __p=[];with(obj||{}){__p.push('<div class="input-data"></div>\n\n<div class="modal-header">\n  <button type="button" class="close" data-dismiss="modal">\xd7</button>\n\n  <h3>',App.t("group_balances"),'</h3>\n\n  <div id="simplified_handler"></div>\n\n  <div id="simplified_toggle">\n    '),simplifiedDebtsState=App.t(App.currentRelationship.get("simplify_by_default")?"on__enabled":"off__disabled"),__p.push("\n    "),simplifyDebtsLink="/groups/"+App.currentRelationship.id+"/edit",__p.push("\n\n    ",App.t("simplify_debts_is_STATE_with_LINK_html",simplifiedDebtsState,simplifyDebtsLink),'\n\n    <i class="icon-question-sign icon-large" title="',(""+App.t("simplify_debts_tooltip")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" rel="tooltip"></i>\n  </div>\n</div>\n\n<div class="modal-body">\n  ');var members=_.sortBy(App.currentRelationship.get("members"),function(e){return App.currentRelationship.getUser(e.id).firstNameLastInitial()});__p.push("\n\n  <table>\n    "),_.each(members,function(e){__p.push('\n      <tr>\n        <td class="avatar">\n          <a href="',e.id==current_user?"#/dashboard":"#/friends/"+e.id,"\" onclick=\"$('#settle_up').modal('hide'); return true\">\n            <img src=\"",App.currentRelationship.getUser(e.id).get("picture").medium,'">\n          </a>\n        </td>\n\n        <td class="name">\n          '),nonZeroBalances=_.select(e.balance,function(e){return 0!=parseFloat(e.amount)}),__p.push("\n          "),balance=nonZeroBalances[0],__p.push("\n          "),amount=balance?balance.amount:0,__p.push("\n          "),currencyCode=balance?balance.currency_code:default_currency,__p.push("\n          "),amountClass=amount>0?"gets_back":balance?"owes":"settled_up",__p.push("\n          "),amountValue=App.currencies.print(Math.abs(amount),currencyCode),__p.push("\n          "),nonZeroBalances.length>1?amountValue+="*":"",__p.push("\n\n\n          ",App.t(amount>0?"NAME_gets_back_AMOUNT_in_total":"NAME_owes_AMOUNT_in_total",S(App.currentRelationship.getUser(e.id).firstNameLastInitial()).bold({"class":"name"}),S(amountValue).wrapWithTag("span",{"class":"amount"}).wrapWithTag("span",{"class":"balance "+amountClass}).breakBefore()),'\n        </td>\n\n        <td class="repayments">\n          <ul class="raw_repayments">\n            '),_.each(original_debts,function(t){__p.push("\n              "),(t.from==e.id||t.to==e.id)&&(__p.push("\n                <li>\n                  "),t.from==e.id?__p.push("\n                    ",App.t("NAME_owes_AMOUNT_to_NAME_html",App.currentRelationship.getUser(e.id).firstNameLastInitial(),S(App.currencies.print(parseFloat(t.amount),t.currency_code)).bold(),S(App.currentRelationship.getUser(t.to).firstNameLastInitial()).bold()),"\n                  "):__p.push("\n                    ",App.t("NAME_owes_NAME_AMOUNT_html",S(App.currentRelationship.getUser(t.from).firstNameLastInitial()).bold(),App.currentRelationship.getUser(e.id).firstNameLastInitial(),S(App.currencies.print(parseFloat(t.amount),t.currency_code)).bold()),"\n                  "),__p.push('\n\n                  <div style="float: right">\n                    <button class="btn btn-mini btn-info" data-toggle="modal" data-from="',t.from,'" data-to="',t.to,'" data-amount="',t.amount,'" data-currency_code="',t.currency_code,'" data-group_id="',App.currentRelationship.id,'" href="#settle_up_form">\n                      ',App.t("settle_up"),'\n                    </button>\n\n                    <button class="btn btn-mini" data-toggle="modal" data-to="',t.from==current_user?t.to:t.from,'" href="#send_reminder">\n                      ',App.t("send_reminder"),"\n                    </button>\n                  </div>\n                </li>\n              ")),__p.push("\n            ")}),__p.push('\n          </ul>\n\n          <ul class="simplified_repayments">\n            '),_.each(simplified_debts,function(t){__p.push("\n              "),t.from==e.id?__p.push("\n                <li>\n                  ",App.t("NAME_owes_AMOUNT_to_NAME_html",App.currentRelationship.getUser(e.id).firstNameLastInitial(),S(App.currencies.print(parseFloat(t.amount),t.currency_code)).bold(),S(App.currentRelationship.getUser(t.to).firstNameLastInitial()).bold()),'\n\n                  <div style="float: right">\n                    <button class="btn btn-mini btn-info" data-toggle="modal" data-from="',t.from,'" data-to="',t.to,'" data-amount="',t.amount,'" data-currency_code="',t.currency_code,'" data-group_id="',App.currentRelationship.id,'" href="#settle_up_form">\n                      ',App.t("settle_up"),'\n                    </button>\n\n                    <button class="btn btn-mini" data-toggle="modal" data-to="',t.from==current_user?t.to:t.from,'" href="#send_reminder">\n                      ',App.t("send_reminder"),"\n                    </button>\n                  </div>\n                </li>\n\n              "):t.to==e.id&&__p.push("\n                <li>\n                  ",App.t("NAME_owes_NAME_AMOUNT_html",S(App.currentRelationship.getUser(t.from).firstNameLastInitial()).bold(),App.currentRelationship.getUser(e.id).firstNameLastInitial(),S(App.currencies.print(parseFloat(t.amount),t.currency_code)).bold()),'\n\n                  <div style="float: right">\n                    <button class="btn btn-mini btn-info" data-toggle="modal" data-from="',t.from,'" data-to="',t.to,'" data-amount="',t.amount,'" data-currency_code="',t.currency_code,'" data-group_id="',App.currentRelationship.id,'" href="#settle_up_form">\n                      ',App.t("settle_up"),'\n                    </button>\n\n                    <button class="btn btn-mini" data-toggle="modal" data-to="',t.from==current_user?t.to:t.from,'" href="#send_reminder">\n                      ',App.t("send_reminder"),"\n                    </button>\n                  </div>\n                </li>\n              "),__p.push("\n            ")}),__p.push("\n          </ul>\n        </td>\n      </tr>\n    ")}),__p.push("\n  </table>\n</div>\n")}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/send-reminder"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="input-data"></div>\n<div class="modal-header">\n  <button type="button" class="close" data-dismiss="modal">\xd7</button>\n  <h3>',App.t("send_a_balance_reminder"),'</h3>\n</div>\n<div class="modal-body">\n  ',App.t("send_a_message_to"),"\n  "),"friend"==App.currentRelationship.get("relationship_type")?__p.push("\n    ",(""+App.currentRelationship.name()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),':\n    <input type="hidden" id="reminder_user_id" value="',App.currentRelationship.id,'">\n  '):(__p.push('\n    <span class="container-for-select"></span>\n    <select id="reminder_user_id" data-group-class="btn-group-inline">\n      '),_.each(App.currentRelationship.get("members"),function(e){__p.push('\n        <option value="',e.id,'" ',e.id!=current_user?"selected='selected'":"",">\n          ",(""+App.currentRelationship.getUser(e.id).firstNameLastInitial()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"",e.id!=current_user&&App.friends.get(parseInt(e.id)).noEmail()?" ("+App.t("no_email_address")+")":"","\n        </option>\n      ")}),__p.push("\n    </select>\n  ")),__p.push('\n  <span id="reminder_summary"></span>\n  <textarea>',App.t("informal_message_opening"),"\n\n",App.t("informal_message_settle_up"),"\n\nhttps://secure.splitwise.com/#/",App.currentRelationship.get("relationship_type"),"s/","group"==App.currentRelationship.get("relationship_type")?App.currentRelationship.get("id"):current_user,"\n\n",App.t("thanks_person",new App.Models.User(currentUserObject).get("first_name")),'\n  </textarea>\n</div>\n\n<div class="modal-footer">\n  <a href="#" class="btn btn-large" data-dismiss="modal">\n    ',App.t("cancel"),'\n  </a>\n  <a href="#" class="btn btn-info btn-large" id="reminder_submit">\n    ',(""+$.capitalize(App.t("send"))).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n  </a>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/settle-up-form"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="relative-container">\n  <div class="input-data"></div>\n  '),model&&(__p.push('\n    <div class="main-window">\n      <header>\n        '),editMode?__p.push("\n          ",App.t("edit_payment"),"\n        "):__p.push("\n          ",App.t("settle_up"),"\n        "),__p.push('\n        <a class="dismiss" href="#" data-dismiss="modal">&times;</a>\n      </header>\n      <div class="body" style="position: relative">\n        '),model.get("transaction_method")||(__p.push('\n          <div class="overlay">\n            <div class="prompt">\n              ',App.t("choose_a_payment_method"),'\n            </div>\n            <button class="btn btn-large btn-mint" data-transaction-method="offline" style="margin: 6px auto">\n              ',App.t("record_a_cash_payment"),"\n            </button>\n            "),
App.metadata.features.paypal&&App.metadata.features.paypal.visible&&__p.push('\n              <button class="btn btn-large btn-paypal" data-transaction-method="paypal" style="margin: 6px auto">\n                <img height="25" style="margin: -7px 0 -3px" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/paypal_logo_small-ce8e5d692b93bd15ce29ecd18c4d49bcb0f0ba942258652d88fcd294d24a68fd.png" alt="Paypal logo small" />\n              </button>\n            '),__p.push("\n            "),App.metadata.features.venmo&&App.metadata.features.venmo.visible&&__p.push('\n              <button class="btn btn-large btn-venmo" data-transaction-method="venmo" style="margin: 6px auto">\n                <img height="15" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/venmo_logo_white_small-448714ca03d23e858b9595b8ed5ca255b4727d22ee2bde18c8dbf821365c6302.png" alt="Venmo logo white small" />\n              </button>\n            '),__p.push("\n            "),App.metadata.features.wavy&&App.metadata.features.wavy.visible&&__p.push('\n              <button class="btn btn-large btn-wavy" data-transaction-method="wavy" style="margin: 6px auto">\n                Wavy\n              </button>\n            '),__p.push("\n            "),App.metadata.features.payment_demo&&App.metadata.features.payment_demo.visible&&__p.push('\n              <button class="btn btn-large btn-paypal" data-transaction-method="payment_demo" style="margin: 6px auto">\n                Payment demo\n              </button>\n            '),__p.push('\n            <div class="fine_print">\n              ',App.t("note_paypal_payments_via_debit_or_credit_card_incur_fees"),"\n            </div>\n          </div>\n        ")),__p.push('\n        <div class="main_fields">\n          '),App.groups.size()<=1&&__p.push("\n            <br>\n          "),__p.push('\n\n          <div class="images">\n            <img class="avatar payer" src="',model.payer().get("picture").medium,'">\n            <img class="arrow" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/settle-up-arrow-83553d33b6848bbdfa3499d7e217748aab1f75ff2073ec5ac67cba5246e12459.png" alt="Settle up arrow" />\n            <img class="avatar payee" src="',model.payee().get("picture").medium,'">\n          </div>\n\n          <div class="human_summary">\n            <a class="payer">',(""+model.payer().firstNameLastInitial()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'</a>\n            <span class="transaction_human_summary">\n              '),["paypal","venmo"].indexOf(model.get("transaction_method"))>-1?__p.push("\n                ",App.t(model.payer().id==current_user?"are_sending__legacy":"is_sending__legacy"),"\n              "):__p.push("\n                ",App.t("paid__legacy"),"\n              "),__p.push('\n            </span>\n            <a class="payee">',(""+model.payee().firstNameLastInitial()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'</a>\n          </div>\n\n          <div class="cost_container">\n            <span class="currency_code">',App.currencies.unit(model.get("currency_code")),'</span><input type="text" class="cost" placeholder="0.00" value="',model.get("cost")?parseFloat(model.get("cost")).toFixed(2):"",'" size="',model.get("cost")?parseFloat(model.get("cost")).toFixed(2).length-1:3,'">\n          </div>\n        </div>\n\n        <a class="date slim-button">',formattedDate(model.get("date")),'</a>\n        <a class="notes slim-button">',App.t("add_image_or_notes"),"</a>\n        "),App.groups.size()>1?__p.push('\n          <a class="group slim-button">\n            ',(""+App.groups.get(model.get("group_id")||0).shortName()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n          </a>\n        "):__p.push("\n          <br>\n          <br>\n        "),__p.push('\n      </div>\n\n      <footer>\n        <button class="btn btn-large btn-cancel" data-dismiss="modal">',App.t("cancel"),'</button>\n        <button class="btn btn-large btn-mint submit">\n          '),["paypal","venmo"].indexOf(model.get("transaction_method"))>-1?__p.push("\n            ",App.t("next"),"\n          "):__p.push("\n            ",App.t("save"),"\n          "),__p.push("\n        </button>\n      </footer>\n    </div>\n  ")),__p.push("\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/modals/simplify-debts"]=function(obj){var __p=[];with(obj||{})__p.push(""),"friend"==App.currentRelationship.get("relationship_type")&&__p.push('\n  <div class="input-data"></div>\n  <div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal">\xd7</button>\n    <h3>',App.t("simplify_debts_with_NAME",first_name),'</h3>\n  </div>\n  <div class="modal-body">\n    ',App.t("you_have_multiple_balances_with_NAME_html",first_name),"\n    <br>\n    <br>\n    ",App.t("simplify_explaination_with_NAME_NAME_html",first_name,first_name),'\n  </div>\n  <div class="modal-footer">\n    <a href="#" class="btn btn-large" data-dismiss="modal">',App.t("cancel"),'</a>\n    <a href="#" class="btn btn-info btn-large" id="simplify_debts_submit">\n      ',App.t("simplify_debts_with_NAME",first_name),"\n    </a>\n  </div>\n"),__p.push("\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/month-divider"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="month-divider ',settled?"settled":"",'">\n  <span>',MONTHS[month-1]," ",year,"</span>\n  "),"group"==App.currentRelationship.get("relationship_type")&&App.currentRelationship.id>0&&__p.push('\n    <a href="/api/v3.0/get_printable_summary?group_id=',App.currentRelationship.get("id"),"&date=",year,"-",month<10?"0"+month:month,'" target="_blank">',App.t("view_printable_summary"),"</a>\n  "),__p.push("\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/no-expenses"]=function(obj){var __p=[];with(obj||{})__p.push('<div style="margin-top: 30px; padding: 10px 15px; position: relative">\n  <img style="position: absolute; top: 0; left: 65px; width: 150px;" src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/empty-table-effed2a2e610373b6407d746cb95858f5d47329c8610bb70f1fd2040dfa35165.png" alt="Empty table" />\n  <div style="text-align: left; padding-left: 235px;">\n    <h2 style="font-size: 28px; line-height: 110%">\n      ',App.t("you_have_not_added_any_expenses_yet"),'\n    </h2>\n    <p style="margin-top: 15px; color: #999; font-size: 18px; line-height: 24px">\n      ',App.t("to_add_an_expense_click_add_bill"),"\n    </p>\n  </div>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/notification"]=function(obj){var __p=[];with(obj||{})__p.push(""),url="",__p.push("\n\n"),_.contains(["Group","Expense"],notification.source.type)?(__p.push("\n  "),url+="#/"+notification.source.type.toLowerCase()+"s/"+notification.source.id,__p.push("\n")):10==notification.type?(__p.push("\n  "),url=notification.source.url,__p.push("\n")):(__p.push("\n  "),url+=16==notification.type?"/groups/new":"#/all",__p.push("\n")),__p.push("\n\n<a href='",url,"' class=\"notification ",unread?"unread":"",'">\n  '),(6===notification.type||2===notification.type)&&(__p.push("\n    "),type=notification.source.type.toLowerCase(),__p.push("\n\n    <span class='undelete btn btn-cancel ",type,"' data-id='",notification.id,"'>\n      ",App.t("undelete_"+type),"\n    </span>\n  ")),__p.push("\n\n  <img src='",notification.image_url,"' class='",notification.image_shape,"'>\n  <img src='",createdByImageUrl,"' class='action_taker'>\n\n  <div class='notification-content'>",notification.content,"</div>\n\n  "),16==notification.type?__p.push('\n    <br />\n    <span class="btn btn-orange">',(""+notification.source.url).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</span>\n\n  "):__p.push('\n    <span class="date">\n      ',(""+$.capitalize(formattedDate(notification.created_at,"relative"))).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n    </span>\n  "),__p.push("\n</a>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/notifications"]=function(obj){var __p=[];with(obj||{})__p.push(""),0==App.notifications.models.length?__p.push('\n  <div style="padding: 20px 15px; font-size: 16px; color: #999">\n    ',App.t("there_is_no_activity_in_your_account_yet"),"\n  </div>\n\n"):(__p.push("\n  "),_.each(App.notifications.models,function(e){__p.push("\n    ",JST["backbone/templates/notification"]({notification:e.toJSON(),unread:e.unread(read_timestamp),createdByImageUrl:e.createdByImageUrl()}),"\n  ")}),__p.push("\n")),__p.push("\n\n"),App.notifications.size()>=5&&__p.push('\n  <a href="#" id="load_more_notifications" class="btn btn-cancel btn-large" onclick="App.notifications.loadMore(); return false;">\n    ',App.t("show_more"),"\n  </a>\n"),__p.push("\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/quick-add"]=function(obj){var __p=[];with(obj||{})__p.push('<form class="form-inline">\n  <input type="text" class="input-medium" id="quickadd">\n  <button class="btn btn-info" data-loading-text="Add" autocomplete="off">Add</button>\n  ',"<script>","\n    var quickAddUpdateDelay;\n\n    $('#quickadd').keyup(function(e) {\n      // Parse the input for a preview display\n      if (e.keyCode != 13) {   // Don't update on enter\n        clearTimeout(quickAddUpdateDelay);\n        quickAddUpdateDelay = setTimeout(\"quickAddRequest()\", 200);\n      }\n    });\n\n    function quickAddRequest() {\n      var dataHash = {};\n\n      if (App.currentRelationship) {\n        if (App.currentRelationship.get(\"relationship_type\") == \"group\") {\n          if (App.currentRelationship.id > 0) {\n            dataHash['group_id'] = App.currentRelationship.get(\"id\");\n          }\n        } else {\n          dataHash['friend_id'] = App.currentRelationship.get(\"id\");\n        }\n      }\n\n      dataHash['input'] = $('#quickadd').val();\n      dataHash['autosave'] = false;\n\n      $.ajax({\n        url: \"/api/v3.0/parse_sentence\",\n        data: dataHash,\n        type: \"POST\",\n        dataType: \"json\",\n        success: function(data, status) {\n          if (status == \"success\") {\n            quickAddUpdate(new App.Models.Expense(data[\"expense\"]));\n          }\n        }\n      });\n    }\n\n    function quickAddUpdate(expense){\n      quickadd = $('#quickadd');\n\n      if (quickadd.val() == \"\" || expense == undefined) {\n        $('#quick_add .sample').show();\n        $('#quick_add .status').hide();\n        return;\n      }\n\n      $('#quick_add .sample').hide();\n      $('#quick_add .status').show();\n      $('#quickadd_popover').attr('class', null);\n\n      var cost, payer, payerString, to, toString,\n          headerText = 'Divide a bill',\n          category_pic = \"<img src='\" + App.categories.get(expense.get(\"category\").id).get('icon') + \"'>\";\n      // escape the description to prevent XSS\n      var description = ' for ' + _.escape(expense.get('description'));\n\n      if (parseFloat(expense.get(\"cost\")) == 0.0)\n        cost = \"???\";\n      else\n        cost = App.currencies.print(parseFloat(expense.get(\"cost\")), expense.get(\"currency_code\"));\n\n      if (expense.get(\"payers\")[0] && expense.get(\"payers\")[0]['user_id'] !== current_user) {\n        payer = App.friends.get(expense.get(\"payers\")[0]['user_id']);\n      } else {\n        payer = new App.Models.User(currentUserObject);\n      }\n\n      payerString = payer.firstNameLastInitial();\n\n      if (expense.isPayment()) {\n        headerText = 'Record a payment';\n        category_pic = \"<img src='https://splitwise.s3.amazonaws.com/uploads/category/icon/slim/payment.png'>\";\n\n        try {\n          to = _.find(expense.get(\"users\"), function(u){ return u.user_id != payer.get('id'); })['user_id'];\n        } catch (e) {\n          to = current_user;    // Javascript error when paying oneself\n        }\n\n        if (to == current_user) {\n          to = new App.Models.User(currentUserObject);\n        } else {\n          to = App.friends.get(to);\n        }\n        toString = to.firstNameLastInitial();\n\n        if (description == \" for Payment\") {\n          description = \"\";\n        }\n\n        $('#quickadd_popover').html(payerString + ' paid ' + cost + ' to ' + toString\xa0+ description + '.');\n\n      } else if (expense.get(\"creation_method\") == \"iou\") {\n        headerText = 'Add an IOU';\n\n        try { // catch an IE8 error\n          to = _.find(expense.get(\"users\"), function(u){ return u.user_id != payer.get('id'); })['user_id'];\n\n          if (to == current_user) {\n            to = new App.Models.User(currentUserObject);\n          } else {\n            to = App.friends.get(to);\n          }\n\n          toString = to.firstNameLastInitial();\n        } catch (e) {\n          toString = \"???\"\n        }\n\n        if (expense.get(\"description\") == \"IOU\") {\n          description = \"\";\n        }\n\n        $('#quickadd_popover').html(toString + ' owes ' + payerString + ' ' + cost + description + '.');\n\n      } else {\n        if (expense.get(\"users\")[0]) {\n          share = App.currencies.print(parseFloat(expense.get(\"users\")[0].owed_share), expense.get(\"currency_code\"));\n        } else {\n          share = \"???\"\n        }\n\n        $('#quickadd_popover').attr('class', 'bill')\n                              .html(payerString + ' paid ' +\xa0cost + description + '.')\n                              .append('<div class=\"more_info\">Each person&rsquo;s share is ' + share + '.</div>');\n      }\n\n      $('#quick_add .status h3').text(headerText);\n      $('#quickadd_popover').prepend(category_pic);\n    }\n  ","</script>",'\n</form>\n\n<div class="sample">\n  Example: ',["I owe Steve $12 for movie tickets","4/15 Electric bill $80","Groceries $60.22"][Math.floor(2*Math.random())],'\n</div>\n\n<div class="status" style="display: none">\n  <h3>Divide a bill</h3>\n  <div class="content">\n    <div id=\'quickadd_popover\'></div>\n  </div>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/recurring"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="bill">\n  <h3>',(""+description).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</h3>\n  ",App.currencies.print(parseFloat(cost),currency_code),"<br>\n  ",formattedDate(next_repeat),"\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/relationship-balances"]=function(obj){var __p=[];with(obj||{}){if(__p.push(""),App.currentRelationship&&-1==App.currentRelationship.id){__p.push("\n  ");var totals=App.friends.totalBalance();__p.push("\n\n  <h2>",App.t("your_total_balance"),"</h2>\n  "),0==_.size(totals.total)&&__p.push("\n    <div class='balance_summary'>\n      ",App.t("you_are_all_settled_up"),"\n    </div>\n  "),__p.push("\n  "),_.each(totals.total,function(e,t){__p.push("\n    "),e>0?__p.push('\n      <div class="balance_summary positive">\n        ',App.t("you_are_owed__header"),'\n        <span class="amount">',App.currencies.print(e,t),"</span>\n      </div>\n    "):__p.push('\n      <div class="balance_summary negative">\n        ',App.t("you_owe__header"),'\n        <span class="amount">',App.currencies.print(Math.abs(e),t),"</span>\n      </div>\n    "),__p.push("\n  ")}),__p.push("\n")}else if(App.currentRelationship&&App.currentRelationship.isGroup()){__p.push("\n  <h2>",App.t("group_balances"),"</h2>\n\n  "),App.currentRelationship.get("simplify_by_default")&&(__p.push('\n    <div class="simplify_on">\n      '),simplifyDebtsLink="/groups/"+App.currentRelationship.id+"/edit",__p.push("\n      ",App.t("simplify_debts_is_STATE_with_LINK_html",App.t("on__enabled").toUpperCase(),simplifyDebtsLink),'\n      <i class="icon-question-sign icon-large" title="',(""+App.t("this_setting_automatically_combines_debts")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" rel="tooltip"></i>\n    </div>\n  ')),__p.push('\n\n  <div class="full_group summary">\n    ');var members=_.sortBy(App.currentRelationship.get("members"),function(e){return App.currentRelationship.getUser(e.id).firstNameLastInitial().toLowerCase()});__p.push("\n    "),_.each(members,function(e){__p.push('<a data-toggle="modal" href="#group_member_details" data-id="',(""+e.id).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" data-group-id="',(""+App.currentRelationship.id).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" class="personal_balance ',e.registration_status,'" title="',(""+App.currentRelationship.userTooltipAsHTML(e.id)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'" rel="tooltip">\n      <img src="',e.picture.medium,'" class="avatar">\n      '),registration_status=e.id==current_user?"confirmed":App.friends.get(e.id).get("registration_status"),__p.push('\n      <div class="name">'),"dummy"==registration_status?__p.push("<i class=\"icon-large icon-warning-sign\" style='color:#e2b649'></i> "):"invited"==registration_status&&__p.push("<i class=\"icon-large icon-warning-sign\" style='color:#999999'></i> "),__p.push("",(""+e.first_name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")," ",(""+(e.last_name?e.last_name:"")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</div>\n\n      ");var t=_.max(e.balance,function(e){return Math.abs(parseFloat(e.amount))});__p.push("\n      ");var n=_.select(e.balance,function(e){return 0!=parseFloat(e.amount)}).length;if(__p.push("\n\n      "),t&&0!=t.amount){__p.push("\n        ");var i=t.amount<0;__p.push("\n        ");var s=i?"i_owe":"owes_me";__p.push("\n        ");var a=i?"owes_AMOUNT__group_short_html":"gets_back_AMOUNT__group_short_html";__p.push('\n\n        <div class="balance ',s,'">\n          ',App.t(a,S(App.currencies.print(Math.abs(t.amount),t.currency_code)+(n>1?"*":"")).wrapWithTag("span",{"class":"amount"})),"\n        </div>\n      ")}else __p.push("\n        "),App.currentRelationship.repayments(e.id).length>0&&!App.currentRelationship.get("simplify_by_default")?__p.push('\n          <div class="balance settled_up">\n            ',App.t("owes_AMOUNT_in_total_but_not_settled_up_with_group",App.currencies.print(0,App.currentRelationship.repayments(e.id)[0].currency_code)),"\n          </div>\n        "):__p.push('\n          <div class="balance settled_up">',App.t("settled_up__group_short"),"</div>\n        "),__p.push("\n      ");__p.push("\n    </a>")}),__p.push("\n\n    "),_.uniq(_.pluck(App.currentRelationship.repayments(),"currency_code")).length>1&&__p.push('\n      <div style="background: #b55; color: #fff; padding: 10px; margin-bottom: 8px; margin-top: 5px; font-size: 13px">\n        ',App.t("this_group_has_balances_in_multiple_currencies"),"\n        <br />\n        (",(""+_.uniq(_.pluck(App.currentRelationship.repayments(),"currency_code")).join(" + ")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),')\n\n        <a onclick="App.currentRelationship.convert(this);" href="javascript:void(0);" class="btn btn-black btn-large" style="display: block; margin-top: 10px">\n          ',App.t("convert_all_bills_to_CURRENCY",currentUserObject.default_currency),'\n        </a>\n\n        <ul class="exchange_rates">\n          <li><img src="https://dx0qysuen8cbs.cloudfront.net/assets/ajax-114d999f10c3c983ba14dfc2b38f2d29c1aa3d4406abd7e73f54bffab6f33c7e.gif" alt="Ajax" /></li>\n        </ul>\n      </div>\n    '),__p.push('\n\n    <a data-toggle="modal" href="#settle_up" class="details">',App.t("view_details")," &raquo;</a>\n  </div>\n")}else if(App.currentRelationship&&App.currentRelationship.isFriend()){__p.push("\n  <h2>",App.t("your_balance"),"</h2>\n  ");var balances=App.currentRelationship.balance();__p.push("\n  "),0==balances.length||1==balances.length&&0==balances[0].amount?__p.push('\n    <div class="balance_summary">\n      ',App.t("you_are_all_settled_up"),"\n    </div>\n  "):(__p.push("\n    "),_.each(balances,function(e){__p.push("\n      "),negativeBalance=e.amount<=0,__p.push("\n      "),keystring=negativeBalance?"you_owe_PERSON_AMOUNT":"PERSON_owes_you_AMOUNT",__p.push("\n      "),summaryClass=negativeBalance?"negative":"positive",__p.push('\n      <div class="balance_summary ',(""+summaryClass).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n        ',App.t(keystring,App.currentRelationship.get("first_name"),S(App.currencies.print(Math.abs(e.amount),e.currency_code)).wrapWithTag("span",{"class":"amount"})),"\n      </div>\n    ")}),__p.push("\n  ")),__p.push("\n\n  ");var detailsCount=0;__p.push("\n\n  "),_.each(App.currentRelationship.get("groups"),function(e){__p.push("\n    "),_.each(e.balance,function(e){__p.push("\n      "),0!==safe_parse_float(e.amount)&&detailsCount++,__p.push("\n    ")}),__p.push("\n  ")}),__p.push("\n\n  "),detailsCount>1&&(__p.push('\n    <div class="breakdown">\n      <h2>',App.t("details"),"</h2>\n\n      <ul>\n        "),_.each(App.currentRelationship.get("groups"),function(e){__p.push("\n          "),_.each(e.balance,function(t){__p.push("\n            ");var n=safe_parse_float(t.amount);__p.push("\n            ");var i=n>0?"positive":"negative";__p.push("\n            ");var s=n>0?"NAME_owes_you_AMOUNT_for_GROUP_html":"you_owe_NAME_AMOUNT_for_GROUP_html";__p.push('\n\n            <li class="',i,'">\n              ',App.t(s,App.currentRelationship.get("first_name"),S(App.currencies.print(Math.abs(n),t.currency_code)).wrapWithTag("span",{"class":"amount"}),App.groups.get(e.group_id).name()),"\n            </li>\n          ")}),__p.push("\n        ")}),__p.push("\n      </ul>\n    </div>\n  ")),__p.push("\n")}__p.push("\n")}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/relationship-details"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="topbar ',relationship_type,'">\n  '),"friend"==relationship_type?(__p.push('\n    <img src="',picture.medium,'">\n    <h1 title="',(""+App.friends.get(id).displayEmail()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n      ',(""+(first_name+" "+(null==last_name?"":last_name))).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"\n      "),"invited"==registration_status?__p.push('\n        <span class="label label-info">',App.t("invite_pending").toLowerCase(),"</span>\n      "):"unsubscribed"==registration_status&&__p.push('\n        <span class="label label-important" title="',(""+App.t("this_person_has_unsubscribed_from_all_splitwise_messages")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">',App.t("unsubscribed").toLowerCase(),"</span>\n      "),__p.push("\n    </h1>\n  ")):(__p.push("\n    "),"undefined"!=typeof avatar&&__p.push("\n      <img src='",avatar.small,"'>\n    "),__p.push("\n    <h1>",(""+name).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),"</h1>\n  ")),__p.push('\n\n  <div class="actions">\n    <div class="btn-group">\n      <a class="btn btn-large btn-orange" data-toggle="modal" href="#add_bill">\n        ',App.t("add_a_bill"),'\n      </a>\n      <a class="btn btn-large btn-orange dropdown-toggle" data-toggle="dropdown" rel="tooltip" data-original-title="',(""+App.t("quickadd")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n        <span class="caret"></span>\n      </a>\n      <ul class="dropdown-menu quick-add">\n        <li id="quick_add"></li>\n      </ul>\n    </div>\n    <a class="btn btn-large btn-mint" data-toggle="modal" href="#settle_up_form">\n      ',App.t("settle_up"),'\n    </a>\n  </div>\n</div>\n<div id="expenses">\n  <div id="expenses_list"></div>\n  <div id="load_more_expenses" style="display: none; text-align: center">\n    <button class="btn btn-large" id="load_more_expenses_button" style="margin-bottom: 10px" data-loading-text="',(""+App.t("loading")).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"),'">\n      ',App.t("show_more"),"\n    </button>\n  </div>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["backbone/templates/settle-point"]=function(obj){var __p=[];with(obj||{})__p.push('<div class="settle-point ',0==expensesCount?"no-expenses":"",'">\n  '),0==expensesCount?(__p.push('\n    <img src="https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/checkmark-circle-ae319506ad7196dc77eede0aed720a682363d68160a6309f6ebe9ce1983e45f0.png" alt="Checkmark circle" /><br>\n    '),App.currentRelationship&&App.currentRelationship.isGroup()?__p.push("\n      ",App.t("you_are_all_settled_up_in_this_group"),"\n    "):__p.push("\n      ",App.t("you_and_PERSON_are_all_settled_up",App.currentRelationship.name()),"\n    "),__p.push("\n  ")):__p.push("\n    ",App.t("all_bills_before_this_date_have_been_settled_up"),"\n  "),__p.push('\n  <br>\n  <a href="#/show_settled_bills" id="show_settled_bills">',App.t("show_settled_bills"),"</a>\n</div>\n");return __p.join("")}}.call(this);var patch_js_template_settings=function(){_.templateSettings={interpolate:/\<\@\=(.+?)\@\>/g,evaluate:/\<\@(.+?)\@\>/g}},safe_divide_evenly_amounts=function(e,t){var n=e/t;n=isNaN(n)||!isFinite(n)?0:n,n=parseFloat(n.toFixed(2));for(var i=[];t--;)i.push(n);for(var s=_.reduce(i,function(e,t){return e+t},0),a=e-s,r=0;a>.001;r++,a-=.01)i[r]+=.01;for(var r=0;-.001>a;r++,a+=.01)i[r]-=.01;return i},safe_parse_float=function(e){return parseFloat(e)||0},safe_sum=function(e){return _.reduce(e,function(e,t){return e+safe_parse_float(t)},0)},App={Routers:{},Views:{},Models:{},Collections:{},settings:{show_items_not_involving_me:!0,show_settled_bills:!1},loadBootstrapDataAndInit:function(e){FlashMessage.flashEntryPoint="#center_container",$("#loading .ajax").activity({steps:10,width:4,space:5,length:10,align:"center",valign:"top",padding:0}),App.currencies=new App.Collections.Currencies(e.currencies),App.categories=new App.Collections.Categories,App.categories.reset(App.categories.parse({categories:e.categories})),App.groups=new App.Collections.Groups,App.friends=new App.Collections.Friends,App.notifications=new App.Collections.Notifications,$.get("/api/v3.0/get_main_data?no_expenses=1&limit=3&cachebust="+Math.random(),function(t){if(App.groups.reset(t.groups),App.friends.reset(t.friends),App.notifications.reset(t.notifications),App.metadata=t.metadata,App.init(),e.loadThirdPartyContacts&&App.loadThirdPartyContacts(),App.metadata.fullscreen_ad){$("#fullscreen_ad").html('<iframe frameborder="0" id="fullscreen_ad_iframe"></iframe>');var n=document.getElementById("fullscreen_ad_iframe").contentWindow.document;n.write(App.metadata.fullscreen_ad.html),n.close(),$("#fullscreen_ad").modal({show:!0,backdrop:"static"})}})},init:function(e){$("#loading").fadeOut(),setInterval(function(){App.notifications.fetch({upsert:!0,data:{background_sync:!0}})},36e5),App.dashboard=!1,page_loaded=new Date,App.friends.size()<=0&&App.groups.size()<=1&&App.notifications.size()<=0?(App.firstLaunch=new App.Views.FirstLaunch,$("#first_launch").fadeIn(),setTimeout(this.initRouter,500)):this.initRouter(),App.formDataSupported=!0;try{new FormData}catch(t){App.formDataSupported=!1}if(console.log("Curious how Splitwise works? Come join us! https://www.splitwise.com/jobs"),params&&params.add_bill){var n;try{n=App.currentRelationship&&App.currentRelationship.isGroup()?App.currentRelationship.id:App.groups.defaultGroup().id}catch(t){n=0}var i={group_id:n,cost:params.cost,description:params.description,details:params.notes};params.date&&(i.date=new Date(params.date));var s=new App.Models.Expense(i);params.category_id&&s.set({categorySetManually:!0,category:{id:params.category_id}}),App.relationshipsRouter.relationshipDetailsView.addABill?App.relationshipsRouter.relationshipDetailsView.addABill.setModel(s):App.relationshipsRouter.relationshipDetailsView.addABill=new App.Views.AddBillForm({model:s}),params.split_type&&0==n&&App.relationshipsRouter.relationshipDetailsView.addABill.model.set("split",params.split_type),$("#add_bill").modal("show"),setTimeout("$('#token-input-add_bill_with').click()",250)}},initRouter:function(){var e="#/dashboard";if(App.relationshipsRouter=new App.Routers.Relationships,Backbone.history.start(),!Backbone.history.fragment||Backbone.history.fragment.length<2){if(default_group>0&&App.groups.get(default_group))e="#/groups/"+default_group;else if(-1==default_group){var t=_.select(App.groups.models,function(e){return 0!=e.id})[0],n=[],i=App.groups.get(0).get("original_debts");t&&(n=_.map(App.friends.models,function(e){return e.id}),n=_.difference(n,_.map(t.get("members"),function(e){return e.id}))),t&&!n.length&&!i.length&&App.groups.size()<=2&&(e="#/groups/"+t.id)}else{var t=_.select(App.groups.models,function(e){return 0!=e.id})[0];t&&(e="#/"+t.get("relationship_type")+"s/"+t.id)}App.relationshipsRouter.navigate(e,!0)}},loadThirdPartyContacts:function(){$.ajax("/api/v3.0/get_google_access_token",{dataType:"json",type:"POST",success:function(e,t){return e.error?alert("Unable to access Google Contacts. Please contact support@splitwise.com if you need more help."):void $.ajax({url:"https://www.google.com/m8/feeds/contacts/default/thin",dataType:"jsonp",data:{"max-results":5e3,access_token:e.access_token,alt:"json"},success:function(e){var t=App.friends.emailAddresses(),n=[],i=[];_.each(e.feed.entry,function(e){var s=[],a=[],r=!1;_.each(e.gd$email,function(o){var l=_.escape(e.title.$t),p=_.escape(o.address);0==l.length&&(l=p),p.length>0&&(r||(r=_.contains(t,p)),a.push(CryptoJS.SHA1(p)),s.push({name:l,email:p,signed_up:!1,friends:!1})),r||(n=n.concat(s),i.push({email_addresses:p}))})}),window.addThirdPartyToken("gmail",n)},error:function(e){console.log("Google Contacts failed to load successfully."),console.log(e)}})}})},setActive:function(e){this.active!==e&&(this.active=e,$("#left_sidebar a").removeClass("active"),$("#"+e).addClass("active"))},setPageTitle:function(e,t){switch(t){case"prepend":document.title=e+" "+document.title;break;case"append":document.title=document.title+" "+e;break;default:document.title=e}return document.title},showLoader:function(e){this.loaderOpen=!0,clearTimeout(this.loaderTimeout),this.loaderTimeout=setTimeout("$('#ajax_loading p').html('(Still waiting...)');",1e4),$("#ajax_loading p").html(e),$("#ajax_loading").fadeIn(100)},closeLoader:function(e){this.loaderOpen=!1,clearTimeout(this.loaderTimeout),e&&e.type?(void 0==e.message&&(e.message=App.t("success"==e.type?"done":"failed")),$("#ajax_success p, #ajax_error p").html(e.message),$("#ajax_loading").hide(),$("success"==e.type?"#ajax_success":"#ajax_error").show().delay(500).fadeOut(400)):$("#ajax_loading").fadeOut(500)},renderError:function(e){}};$(document).ajaxError(function(e,t,n){switch(t.status){case 410:window.location="/login?logged_out=true";break;case 403:alert("It looks like you don't have permission to perform that action. If you think you've received this message in error, please email us at support@splitwise.com and give us details about what you were trying to do. Thanks!")}}),App.Models.Currency=Backbone.Model.extend({
defaults:{unit:""},unit:function(){var e=this.get("currency_code");return e==default_currency?this.get("unit"):e}}),App.Models.Category=Backbone.Model.extend({parentCategory:function(){var e=this.get("parent_id");return e?App.categories.get(e):null}}),App.Models.Relationship=Backbone.Model.extend({getUser:function(e){var t={};return _.each(this.get("members"),function(n){parseInt(n.id)==parseInt(e)&&(t=n)}),new App.Models.User(t)},mainBalance:function(){return 0==this.balance().length?{currency_code:default_currency,amount:0}:_.max(this.balance(),function(e){return Math.abs(e.amount)})},active:function(){return 0!=this.mainBalance().amount||Date.fromISO(this.get("updated_at"))>new Date-26784e5},isFriend:function(){return"friend"==this.get("relationship_type")},isGroup:function(){return"group"==this.get("relationship_type")&&this.id>0},convert:function(e){return this.isConverting!==!0?currentUserObject.has_pro?void(confirm(this._convertConfirmMessage())&&(App.showLoader(App.t("working")),this.isConverting=!0,$(e).attr("disabled",!0),$.post(this._convertUrl(),this._convertParams()).done(function(e){e.success?window.location.reload():FlashMessage.add({type:"error",message:e.errors.join("\\n")})}).fail(function(e,t,n){403!==e.status&&FlashMessage.add({type:"error",message:App.t("general_unknown_error")})}).always(_.bind(function(){App.closeLoader(),this.isConverting=!1,$(e).attr("disabled",!1)},this)))):($("#fullscreen_ad").html('<iframe frameborder="0" src="/api/v3.0/subscriptions/new?ad_variant=currency_conversion"></iframe>'),void $("#fullscreen_ad").modal({show:!0})):void 0},_convertConfirmMessage:function(){return App.t(this.isFriend()?"nongroup_currency_conversion_confirmation":"group_currency_conversion_confirmation",default_currency)},_convertUrl:function(){return this.isFriend()?"/api/v3.0/convert_friend_to_currency/":"/api/v3.0/convert_group_to_currency/"},_convertParams:function(){return Object.assign({currency_code:default_currency},this.isFriend()?{friend_id:this.id}:{group_id:this.id})}}),App.Models.Group=App.Models.Relationship.extend({defaults:{relationship_type:"group"},name:function(){return this.get("name")},shortName:function(){return 0===this.id?App.t("non_group_expenses__short"):this.name()},setAttrs:function(){if(this.get("members")){var e=this;_.each(this.get("members"),function(t){t.id==current_user&&(e.attributes.balance=parseFloat(t.balance))})}else this.attributes.balance=parseFloat(this.attributes.balance)},parse:function(e){return e.group||e},balance:function(){try{return _.find(this.get("members"),function(e){return e.id==current_user}).balance}catch(e){return[{amount:0,currency_code:default_currency}]}},balances:function(){var e={};return _.each(this.get("members"),function(t){e[t.id]=[],_.each(t.balance,function(n){e[t.id].push(_.clone(n))}),0==e[t.id].length&&e[t.id].push({amount:0,currency_code:default_currency})}),e},adjustBalances:function(e,t){if(t.get("group_id")==this.id){var n="subtract"==e?-1:1;if(_.each(this.get("members"),function(e){var i=_.find(e.balance,function(e){return e.currency_code==t.get("currency_code")});i?i.amount=parseFloat(i.amount)+n*t.netBalance(e.id):(e.balance||(e.balance=[]),e.balance.push({amount:n*t.netBalance(e.id),currency_code:t.get("currency_code")}))}),!this.get("simplify_by_default")){var i=this.get("original_debts");i||(i=[]),_.each(t.get("repayments"),function(e){var s=_.find(i,function(n){return n.to==e.to&&n.from==e.from&&n.currency_code==t.get("currency_code")});return s?void(s.amount=parseFloat(s.amount)+n*parseFloat(e.amount)):(s=_.find(i,function(n){return n.to==e.from&&n.from==e.to&&n.currency_code==t.get("currency_code")}))?void(s.amount=parseFloat(s.amount)-n*parseFloat(e.amount)):void i.push({to:e.to,from:e.from,currency_code:t.get("currency_code"),amount:n*parseFloat(e.amount)})})}this.trigger("optimisticUpdate")}},methodUrl:function(){return"/api/v3.0/get_group/"+this.id},sync:function(e,t,n){this.id<0||(n=n||{},n.url=this.methodUrl(),Backbone.sync(e,t,n))},expensesInvolving:function(e){var t=this.get(this.get("simplify_by_default")?"simplified_debts":"original_debts");return null==e?t:_.select(t,function(t){return(t.to==e||t.from==e)&&0!=parseFloat(t.amount)})},repayments:function(e){return this.expensesInvolving(e)},repaymentsAsHTML:function(e){var t=this.repayments(e);return 0==t.length?["All settled up!"]:_.collect(t,function(t){var n,i,s,a=App.currencies.print(t.amount,t.currency_code);return t.from==e?(n="bullet_owes_AMOUNT_to_NAME__short_html",i={"class":"negative"},s=t.to):(n="bullet_gets_back_AMOUNT_from_NAME__short_html",i={"class":"positive"},s=t.from),App.t(n,S(a).wrapWithTag("span",i),App.currentRelationship.getUser(s).firstNameLastInitial())})},userTooltipAsHTML:function(e){var t,n;return t=e==current_user?new App.Models.User(currentUserObject):App.friends.get(e),t||(t=this.getUser(e)),n="<div class='left'><h2>"+_.escape(t.fullName())+"</h2>","dummy"==t.get("registration_status")?(n+="<div class='registration_status'><i class='icon-large icon-warning-sign' style='color:#e2b649'></i> ",n+=_.escape(App.t("this_person_does_not_have_an_email_click_to_update")),n+="</div>"):"invited"==t.get("registration_status")?(-1==t.get("email").indexOf("@phone.com")?n+="<h3>"+t.get("email")+"</h3>":(n+="<h3>",n+=_.escape(App.t("no_email_address")),n+="</h3>"),n+="<div class='registration_status'><i class='icon-large icon-warning-sign' style='color:#999999'></i> ",n+=_.escape(App.t("this_person_has_not_claimed_their_invite_click_to_update")),n+="</div>"):n+="<h3>"+t.displayEmail()+"</h3>",n+="<hr>"+App.currentRelationship.repaymentsAsHTML(t.id).join("<br>")+"</div>",n.replace(/"/g,"")},balanceWith:function(e){var t={};return _.each(this.repayments(current_user),function(n){(n.to==e||n.from==e)&&(t[n.currency_code]||(t[n.currency_code]=0),n.to==e?t[n.currency_code]-=n.amount:n.from==e&&(t[n.currency_code]+=n.amount))}),0==_.size(t)&&(t[default_currency]=0),t},defaultSplit:function(){var e=this.get("members").find(function(e){return e.id===current_user});return null==e?void 0:e.default_split}}),App.Models.Friend=App.Models.Relationship.extend({defaults:{relationship_type:"friend"},fullName:function(){return null==this.get("first_name")?this.get("email"):void 0==this.get("last_name")||""==$.trim(this.get("last_name"))?this.get("first_name"):this.get("first_name")+" "+this.get("last_name")},name:function(){return this.fullName()},firstNameLastInitial:function(){var e=this.get("first_name"),t=$.trim(this.get("last_name"));return t.length>0&&(e+=" "+t[0].toUpperCase()+"."),e},displayEmail:function(){var e=this.get("email");return _.isEmpty(e)||/@example\.com$/.test(e)?App.t("no_email_address"):/@phone\.com$/.test(e)?App.t("invited_via_sms"):e},balance:function(){var e=_.select(this.get("balance"),function(e){return 0!=e.amount});return e.length>0?e:[{amount:0,currency_code:default_currency}]},balances:function(){var e=this.get("balance"),t={};if(0==e.length)t[current_user]=[{amount:0,currency_code:default_currency}],t[this.id]=[{amount:0,currency_code:default_currency}];else{var n=this.id;t[current_user]=[],t[this.id]=[],_.each(e,function(e){t[current_user].push(_.clone(e)),t[n].push({amount:-parseFloat(e.amount),currency_code:e.currency_code})})}return t},adjustBalances:function(e,t){var n="subtract"==e?-1:1,i=_.find(this.get("balance"),function(e){return e.currency_code==t.get("currency_code")});i?i.amount=parseFloat(i.amount)+n*t.netBalance():(i={amount:n*t.netBalance(),currency_code:t.get("currency_code")},this.get("balance").push(i)),this.trigger("optimisticUpdate")},sharedTabs:function(){return _.select(this.get("groups"),function(e){return 0!=e.group_id})},groupBalances:function(){return _.select(this.get("groups"),function(e){return _.find(e.balance,function(e){return 0!=parseFloat(e.amount)})})},parse:function(e){return e.friends||e.friend||e},methodUrl:function(){return"/api/v3.0/get_friend/"+this.id},sync:function(e,t,n){n=n||{},n.url=this.methodUrl(),Backbone.sync(e,t,n)},noEmail:function(){return"dummy"==this.get("registration_status")||/@(splittherent-dummy|example|phone)\.com$/.test(this.get("email"))}}),App.Models.Expense=Backbone.Model.extend({initialize:function(){this.setAttrs(),this.bind("change",this.setUsersList,this),this.bind("change:usersList",this.cancelIOU,this),this.bind("change:description",this.guessCategory,this),this.bind("change:cost change:onePayer change:users change:usersList change:eachPaidOwnShare change:split change:split_type change:oneReimburser",this.updatePaidShares,this),this.bind("change:cost change:onePayee change:users change:usersList change:split change:split_type",this.updateOwedShares,this),this.bind("change:equal_users change:unequal_amounts change:percents change:adjustments change:reimbursements change:shares change:items",this.updateOwedShares,this),this.bind("change:users",this.usersChanged,this),this.bind("change:percents change:adjustments change:shares change:split_type",this.removeDefaultSplit,this)},defaults:function(){return{cost:0,currency_code:default_currency,group_id:0,users:[],category:{id:18},categorySetManually:!1,items:{items:[],subtotals:{},tax:{users:{}},tip:{users:{}},totals:{}}}},parse:function(e){return e.expense||e},setAttrs:function(){this.set({cost:parseFloat(this.get("cost"))},{silent:!0}),this.get("date")||this.set({date:new Date},{silent:!0});var e=this.get("users");e&&void 0!=e&&e.sort(function(e,t){return parseFloat(t.net_balance)-parseFloat(e.net_balance)}),_.each(e,function(e){isNaN(parseFloat(e.owed_share))||(e.owed_share=parseFloat(e.owed_share)),isNaN(parseFloat(e.paid_share))||(e.paid_share=parseFloat(e.paid_share))}),this.set({users:e,relationship_type:this.get("group_id")?"group":"friendship"},{silent:!0}),this.set({relationship_:e},{silent:!0});var e=_.filter(this.get("users"),function(e){return e.paid_share>0});if(this.set({payers:e},{silent:!0}),1==e.length?this.set({onePayer:e[0].user_id},{silent:!0}):0==e.length?this.set({onePayer:current_user},{silent:!0}):this.set({onePayer:null},{silent:!0}),this.get("created_at")&&this.set({categorySetManually:!0},{silent:!0}),this.get("cost")<0)this.set({split:"split",split_type:"unequal"});else if(this.get("cost")>0&&this.get("users").length>=1){var t=_.min(this.get("users"),function(e){return e.owed_share}).owed_share,n=_.max(this.get("users"),function(e){return e.owed_share}).owed_share,i=_.find(this.get("users"),function(e){return e.user_id==current_user}),s=_.find(this.get("users"),function(e){return e.user_id!=current_user});if(this.isPayment())this.set("split","payment");else if(2==this.get("users").length&&i&&parseFloat(i.net_balance)==this.get("cost")&&s&&parseFloat(s.net_balance)==-this.get("cost"))this.set({split:"uoi",split_type:"equal"});else if(2==this.get("users").length&&i&&parseFloat(i.net_balance)==-this.get("cost")&&s&&parseFloat(s.net_balance)==this.get("cost"))this.set({split:"iou",split_type:"equal"});else if(isNaN(parseFloat(t)))this.set({split:"split",split_type:"unequal"});else if(this.get("details")&&this.get("details").indexOf("Tax")>=0&&this.get("details").indexOf("Tip")>=0){this.setUsersList();var a=this.get("usersList"),r={items:[],subtotals:{},tax:{users:{}},tip:{users:{}},totals:{}},o=this.get("details").split("\n\r\n"),l=o.slice(-1)[0];l=l.split("\n");var p={},c={};_.each(a,function(e){c[e.id]=0,p[e.id]=0}),_.each(l,function(e){try{if(e.length<3);else if(0==e.indexOf("Tax:"))if(e.indexOf("%")>=0)r.tax.total=e.split(": ")[1];else{var t=e.split(": ")[1].split(", "),n=_.map(t,function(e){return e.split(" - ")[1]}),i=_.map(t,function(e){return e.split(" - ")[0]});_.each(i,function(e,t){var i=_.find(a,function(t){return e==t.first_name+(t.last_name?" "+t.last_name:"")});i&&(r.tax.users[i.id]=safe_parse_float(n[t]))})}else if(0==e.indexOf("Tip:"))if(e.indexOf("%")>=0)r.tip.total=e.split(": ")[1];else{var t=e.split(": ")[1].split(", "),s=_.map(t,function(e){return e.split(" - ")[1]}),o=_.map(t,function(e){return e.split(" - ")[0]});_.each(o,function(e,t){var n=_.find(a,function(t){return e==t.first_name+(t.last_name?" "+t.last_name:"")});n&&(r.tip.users[n.id]=safe_parse_float(s[t]))})}else{var l={},p=e.split(" - ");l.cost=p[p.length-1].split(" (")[0];var u=parseFloat(l.cost);p.pop(),l.description=p.join(" - ");var d=e.match(/- [0-9]+\.[0-9]+ \((.+)\)/)[1].split(", "),h=[],f={},m=safe_divide_evenly_amounts(u,d.length);_.each(d,function(e,t){var n=_.find(a,function(t){return e==t.first_name+(t.last_name?" "+t.last_name:"")});n&&(c[n.id]+=m[t],h.push(n.id),f[n.id]=m[t])}),l.users=h,l.shares=f,r.items.push(l)}}catch(g){console.log(g)}}),_.each(a,function(e){var t=c[e.id];_.each(["tax","tip"],function(n){var i=r[n].users[e.id];if(!i){var s=r[n].total;s?(s=safe_parse_float(s.replace(/%/,""))/100,i=c[e.id]*s):i=0}t+=i}),p[e.id]=t}),r.subtotals=c,r.totals=p,this.set("items",r),this.set({split:"split",split_type:"itemized"})}else t==n||this.get("cost")>1&&t+.01*this.get("users").length>n?this.set({split:"split",split_type:"equal"}):this.set({split:"split",split_type:"unequal"})}if(this.get("cost")>0){this.set({eachPaidOwnShare:!0},{silent:!0});var u=this;_.each(this.get("users"),function(e){e.paid_share!=e.owed_share&&u.set({eachPaidOwnShare:!1},{silent:!0})})}else this.set({eachPaidOwnShare:!1},{silent:!0})},guessCategoryFromDescription:guess_category,guessCategory:function(){this.get("categorySetManually")||this.set({category:{id:this.guessCategoryFromDescription(this.get("description"))}})},payer:function(){return this.getUser(this.get("onePayer"))},payee:function(){return this.getUser(this.get("onePayee"))},guessPayee:function(){var e=_.find(this.get("users"),function(e){return e.owed_share>0});if(e)this.set("onePayee",e.user_id);else{var t=this.payer().id,n=_.map(this.get("usersList"),function(e){return e.id}),i=_.find(n,function(e){return e!=t});this.set("onePayee",i)}},categoryIcon:function(){if(this.isPayment())return"paypal"==this.get("transaction_method")?"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/payment-icon-square/paypal-94655ce530950a61457677733b5662b8d641b6b8e92a43c6fa46ce501e54c743.png":"venmo"==this.get("transaction_method")?"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/payment-icon-square/venmo-0d880cb7fb5578a9031a63f61fb438c761b41cdc7edcb144fcd295b24e1d4533.png":"paytm"==this.get("transaction_method")?"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/payment-icon-square/paytm-0ba940ec937b7ab8fb6c1598c06040a3250422f9b4bafb577ba02f3a0dd5ef97.png":"payment_demo"==this.get("transaction_method")?"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/payment-icon-big-payment_demo-92a5ccb73e058dd5d2c066c68c8b887154441a84b48ef252a34afe910594fe28.png":"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/app/payment-icon-square/cash-00e972d4543e516da48b4a5614379eb5ebd457d4904c71e9de041fb9ff05da4e.png";var e=App.categories.get(this.get("category").id);return e?e.get("icon"):"blah"},cancelIOU:function(){var e=this.get("split");("iou"==e||"uoi"==e)&&this.get("usersList").length>2&&this.set({split:"split",split_type:"equal"})},updatePaidShares:function(){var e=this.get("split");if("iou"==e||"uoi"==e){var t=this.get("cost"),n=this.get("users");return void _.each(n,function(n,i){n.user_id==current_user?n.paid_share="iou"==e?0:t:n.paid_share="iou"==e?t:0})}if("reimbursement"==this.get("split_type")){var i=this.get("oneReimburser"),t=this.get("cost");return void _.each(this.get("users"),function(e){e.owed_share=e.user_id==i?t:0})}var s=this.get("onePayer");if(s){this.get("usersList")&&!_.find(this.get("usersList"),function(e){return e.id==s})&&(0==this.get("usersList").length&&s==current_user||(0==this.get("usersList").length?this.set("onePayer",current_user):this.set("onePayer",this.get("usersList")[0].id)));var n=this.get("users"),a=this.get("onePayer"),r=this.get("cost");_.each(n,function(e){e.paid_share=e.user_id==a?r:0})}else if(this.previous("onePayer")){var n=this.get("users");_.each(n,function(e){e.paid_share=null})}!s&&this.get("eachPaidOwnShare")&&_.each(this.get("users"),function(e){e.paid_share=e.owed_share})},updateOwedShares:function(e,t,n){if(!n||!n.itemized){var i=this.get("split");if("iou"==i||"uoi"==i){var s=this.get("cost"),a=this.get("users");_.each(a,function(e,t){e.user_id==current_user?e.owed_share="iou"==i?s:0:e.owed_share="iou"==i?0:s})}else if("payment"==i){var r=this.get("onePayee"),s=this.get("cost"),a=this.get("users");_.each(a,function(e,t){e.user_id==r?e.owed_share=s:e.owed_share=0})}else if("split"==this.get("split"))if("equal"==this.get("split_type")){var a=this.get("users"),o=parseFloat(this.get("cost")),l=this.get("equal_users");if(l)var p=_.select(l,function(e){return e}).length;else var p=this.get("users").length;var c=safe_divide_evenly_amounts(o,p);_.each(a,function(e,t){l?l[e.user_id]?e.owed_share=c.pop():e.owed_share=0:e.owed_share=c.pop()})}else if("unequal"==this.get("split_type")){var a=this.get("users"),c=this.get("unequal_amounts");c&&_.each(a,function(e){try{e.owed_share=c[e.user_id]}catch(t){e.owed_share=null}})}else if("shares"==this.get("split_type")){var u=this.get("shares");try{var d=1*_.reduce(u,function(e,t){return e+t}),s=parseFloat(this.get("cost")),h=s,f=0;_.each(this.get("users"),function(e){var t=u[e.user_id];if(t){var n=t/d;f+=100*n,f>99.99&&100.01>f?e.owed_share=h:e.owed_share=Math.round(s*n*100)/100,h-=e.owed_share}else e.owed_share=0})}catch(m){_.each(this.get("users"),function(e){e.owed_share=0})}}else if("percent"==this.get("split_type")){var g=this.get("percents"),s=parseFloat(this.get("cost")),h=s,a=this.get("users"),f=0;_.each(a,function(e){try{var t=g[e.user_id];t?(f+=100*t,f>99.99&&100.01>f?e.owed_share=h:e.owed_share=Math.round(s*t*100)/100,h-=e.owed_share):e.owed_share=0}catch(n){e.owed_share=0}})}else if("adjustment"==this.get("split_type")){var b=this.get("adjustments"),s=parseFloat(this.get("cost")),v=s-_.reduce(b,function(e,t){return e+t},0),c=safe_divide_evenly_amounts(v,_.size(b));_.each(this.get("users"),function(e){e.owed_share=0;try{var t=b[e.user_id]}catch(n){var t=0}e.owed_share=t+c.pop()})}else if("reimbursement"==this.get("split_type")){var a=this.get("users"),o=Math.abs(parseFloat(this.get("cost"))),l=this.get("reimbursements");if(l)var p=_.select(l,function(e){return e}).length;else var p=this.get("users").length;var c=safe_divide_evenly_amounts(o,p);_.each(a,function(e,t){l?l[e.user_id]?e.paid_share=c.pop():e.paid_share=0:e.paid_share=c.pop()})}else if("itemized"==this.get("split_type")){var y=this.get("items").totals;_.each(this.get("users"),function(e){e.owed_share=0;try{e.owed_share=y[e.user_id]}catch(t){e.owed_share=0}});var s=safe_parse_float(_.reduce(y,function(e,t){return e+t},0));s=Math.round(100*s)/100,this.get("cost")!=s&&this.set("cost",s,{itemized:!0})}}},setUsersList:function(){if(this.changedAttributes()){var e=_.keys(this.changedAttributes());if((-1!=$.inArray("comments",e)||-1!=$.inArray("comments_count",e))&&-1==$.inArray("users",e))return}var t;t=this.get("users")?_.collect(this.get("users"),function(e){var t=null;e.user_id?t=e.user_id:e.user&&e.user.user_id&&(t=e.user.user_id);var n=parseInt(t)>0;if(t&&t==current_user)return currentUserObject;if(t&&n){var i=App.friends.get(t);return i?App.friends.get(t).attributes:e.user?e.user:{id:t,first_name:"[Unknown or removed]",last_name:null,email:null,phone:null,picture:{small:"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/avatars/50-31b0bb2f5aec77f11d60a1dc3fa14c23a958fed79261b32e94a73e9c27473ebb.png",medium:"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/avatars/100-4c516cdaad9fa42b890727b03e49634a199eaba880df708835105dfa42fac74b.png",large:"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/avatars/200-6baef68eb0735452002c63cc4d7b78a828f0e9ebb24bcfa9c3288eafeebf31b3.png"}}}return{id:t,first_name:e.user.first_name,last_name:e.user.last_name,email:e.user.email,phone:e.user.phone,picture:{small:"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/avatars/50-31b0bb2f5aec77f11d60a1dc3fa14c23a958fed79261b32e94a73e9c27473ebb.png",medium:"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/avatars/100-4c516cdaad9fa42b890727b03e49634a199eaba880df708835105dfa42fac74b.png",large:"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/avatars/200-6baef68eb0735452002c63cc4d7b78a828f0e9ebb24bcfa9c3288eafeebf31b3.png"}}}):{},t.sort(function(e,t){return e.first_name.localeCompare(t.first_name)}),_.isEqual(t,this.get("usersList"))||this.set("usersList",t)},payers:function(){return _.filter(this.get("users"),function(e){return e.paid_share>0})},owers:function(){return _.filter(this.get("users"),function(e){return e.owed_share>0})},getUser:function(e,t){try{var n=App.friends.get(e);return e==current_user?new App.Models.User(currentUserObject):n?n:(n=_.find(this.get("users"),function(t){return t.user_id==e}),new App.Models.User(n.user))}catch(i){return new App.Models.User(currentUserObject)}},getShare:function(e){return _.find(this.get("users"),function(t){return t.user_id==e||t.user_id==parseInt(e)})},netBalance:function(e){if(e){var t=_.find(this.get("users"),function(t){return parseInt(t.user_id)==e});return t?parseFloat(t.net_balance):0}if(App.currentRelationship&&"friend"==App.currentRelationship.get("relationship_type")){var n=App.currentRelationship.id,i=_.find(this.get("repayments"),function(e){return[parseInt(e.from),parseInt(e.to)].sort().toString()==[current_user,n].sort().toString()});return i?i.from==current_user?-parseFloat(i.amount):parseFloat(i.amount):0}var s=_.find(this.get("users"),function(e){return parseInt(e.user_id)==current_user});return s?parseFloat(s.net_balance):0},equalSplit:function(e){if(0==this.get("users").length)return{standard:0,leftover:0};void 0===e&&(e=_.select(this.get("equal_users"),function(e){return e}).length),e||(e=this.get("users").length);var t=parseFloat(this.get("cost"))||0,n=t/e,i=Math.round(100*n)/100,s=parseFloat(this.get("cost"))-i*(e-1);return{standard:i,leftover:s}},toApiJSON:function(){expense_hash={};for(key in this.attributes)-1!=["cost","creation_method","currency_code","date","description","details","email_reminder","email_reminder_in_advance","group_id","id","payment","repeat_interval","repeats","transaction_method"].indexOf(key)?null!=this.attributes[key]&&void 0!=this.attributes[key]&&(expense_hash[key]=this.attributes[key]):"category"==key?expense_hash.category_id=this.attributes.category.id:"users"==key&&_.each(this.attributes.users,function(e,t){var n,i,n=parseFloat(e.owed_share);i=parseFloat(e.paid_share),isNaN(n)&&(n=0),isNaN(i)&&(i=0),(0!=n||0!=i)&&(e.user_id&&parseInt(e.user_id)>0?expense_hash["users__"+t+"__user_id"]=parseInt(e.user_id):(expense_hash["users__"+t+"__first_name"]=e.user.first_name,expense_hash["users__"+t+"__last_name"]=e.user.last_name,expense_hash["users__"+t+"__email"]=e.user.email),expense_hash["users__"+t+"__paid_share"]=i.toFixed(2),expense_hash["users__"+t+"__owed_share"]=n.toFixed(2))});if("itemized"==this.attributes.split_type){var e="",t=this.get("usersList"),n=this.get("items");_.each(n.items,function(n){var i=n.description,s=parseFloat(n.cost);if(!isNaN(s)&&isFinite(s)){e+=i+" - "+s.toFixed(2)+" (";var a=[];_.each(t,function(e){_.contains(n.users,e.id)&&a.push(e.first_name+(e.last_name?" "+e.last_name:""))}),e+=a.join(", ")+")\n"}});var i=n.tax.total;if(i&&i.indexOf("%")>=0)e+="Tax: "+i+"\n";else{var s=[];_.each(t,function(e){var t=n.tax.users[e.id];t=isNaN(t)?0:t,s.push(e.first_name+(e.last_name?" "+e.last_name:"")+" - "+t.toFixed(2))}),e+="Tax: "+s.join(", ")+"\n"}var a=n.tip.total;if(a&&a.indexOf("%")>=0)e+="Tip: "+a+"\n";else{var r=[];_.each(t,function(e){var t=n.tip.users[e.id];t=isNaN(t)?0:t,r.push(e.first_name+(e.last_name?" "+e.last_name:"")+" - "+t.toFixed(2))}),e+="Tip: "+r.join(", ")+"\n"}if(expense_hash.details){var o=expense_hash.details;if(o.indexOf("Tax")>=0&&o.indexOf("Tip")>=0){var l=o.split("\n\r\n\r").slice(0,-1);o=l.join("\n\n")}expense_hash.details=o+"\n\n"+e}else expense_hash.details=e}return expense_hash.creation_method||(this.isPayment()?expense_hash.creation_method="payment":expense_hash.creation_method=this.get("split_type")),expense_hash},unread:function(){if(this.get("created_by")==current_user)return!1;if(App.notifications_read){var e=Date.fromISO(this.get("updated_at")),t=Date.fromISO(App.notifications_read);return e>t}return!1},isRecurring:function(){return this.get("repeats")&&"never"!=this.get("repeat_interval")},isPayment:function(){return this.get("payment")},isP2P:function(){return["paypal","venmo","paytm","payment_demo"].indexOf(this.get("transaction_method"))>=0},formattedP2PName:function(){switch(this.get("transaction_method")){case"paypal":return"PayPal";case"venmo":return"Venmo";case"paytm":return"Paytm";case"payment_demo":return"Demo"}},setDefaultSplit:function(){var e=this.defaultSplitData();this.set(_.extend({split:"split"},e)),Object.keys(e).length>1&&this.set("defaultSplitApplied",!0)},usersChanged:function(){this.get("defaultSplitApplied")!==!0||this.onlyGroupUsers()||(this.removeDefaultSplit(),this.set("split_type","equal"))},removeDefaultSplit:function(){this.get("defaultSplitApplied")===!0&&(this.set("defaultSplitApplied",!1),this.unset((this.hasChanged("split_type")?this.previous("split_type"):this.get("split_type"))+"s"))},defaultSplitData:function(){var e=this.splitData();if(!e||"equal"===e.split_type)return{split_type:"equal"};var t=e.owed_shares.reduce(function(e,t){return e[t.user_id]=parseFloat(t.owed_share),e},{});switch(e.split_type){case"percent":for(var n in t)t[n]/=100;return{split_type:"percent",percents:t};case"shares":return{split_type:"shares",shares:t};case"adjustment":return{split_type:"adjustment",adjustments:t}}},splitData:function(){return this.forGroup()&&this.onlyGroupUsers()?App.groups.get(this.get("group_id")).defaultSplit():void 0},forGroup:function(){return 0!==this.get("group_id")},onlyGroupUsers:function(){var e=_.pluck(App.groups.get(this.get("group_id")).get("members"),"id"),t=_.pluck(this.get("users"),"user_id");return t.every(function(t){return e.includes(t)})}}),App.Models.User=Backbone.Model.extend({defaults:function(){return{first_name:"[Removed]",last_name:"",picture:{small:"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/avatars/50-31b0bb2f5aec77f11d60a1dc3fa14c23a958fed79261b32e94a73e9c27473ebb.png",medium:"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/avatars/100-4c516cdaad9fa42b890727b03e49634a199eaba880df708835105dfa42fac74b.png",large:"https://dx0qysuen8cbs.cloudfront.net/assets/fat_rabbit/avatars/200-6baef68eb0735452002c63cc4d7b78a828f0e9ebb24bcfa9c3288eafeebf31b3.png"}}},initialize:function(){this.bind("change",this.setAttrs,this),this.setAttrs()},setAttrs:function(){this.has("user_id")&&this.set({id:this.get("user_id")},{silent:!0}),this.set({net_balance:parseFloat(this.get("net_balance"))},{silent:!0})},firstNameLastInitial:function(){return void 0==this.get("last_name")||""==$.trim(this.get("last_name"))?this.get("first_name"):this.get("first_name")+" "+this.get("last_name").substr(0,1).toUpperCase()+"."},fullName:function(){return void 0==this.get("last_name")||""==$.trim(this.get("last_name"))?this.get("first_name"):this.get("first_name")+" "+this.get("last_name")},displayEmail:function(){return this.get("email")?-1!=this.get("email").indexOf("@phone.com")?"invited via SMS":-1!=this.get("email").indexOf("@example.com")?"no email address":this.get("email"):"no email address"}}),App.Models.Notification=Backbone.Model.extend({unread:function(e){if(e||(e=App.notifications_read),this.get("created_by")==current_user)return!1;if(e){var t=Date.fromISO(this.get("created_at")),n=Date.fromISO(e);return t>n}return!0},createdByImageUrl:function(){var e=this.get("created_by"),t=App.friends.get(e);return e===current_user?currentUserObject.picture.small:t?t.get("picture").small:"https://dx0qysuen8cbs.cloudfront.net/assets/core/default-avatar-f8125acd776267b4a913117d89f38c0926296a5475d4035a3c57aaff8868da36.png"},canUndelete:function(){var e=this.get("type");return 2===e||6===e},undeleteUrl:function(){var e=this.get("source");return"/api/v3.0/undelete_"+e.type.toLowerCase()+"/"+e.id},undelete:function(){this.canUndelete()&&$.post(this.undeleteUrl(),{success:function(){window.location.reload()}})}}),App.Collections.Currencies=Backbone.Collection.extend({model:App.Models.Currency,url:"/api/v3.0/get_currencies",comparator:function(e,t){return"USD"==e.get("currency_code")?-1:"USD"==t.get("currency_code")?1:e.get("currency_code").localeCompare(t.get("currency_code"))},print:function(e,t){e=e||0;var n="";0>e&&(n="-",e=-e);try{return n+this.unit(t)+parseFloat(e).toFixed(2)}catch(i){return n+parseFloat(e).toFixed(2)}},unit:function(e){e=e||"ZZZ";var t=_.find(this.models,function(t){return t.get(3==e.length?"currency_code":"country_code")==e});try{return t.get(t.get("currency_code")==default_currency?"unit":"currency_code")}catch(n){return""}},printWithCurrentCurrency:function(e){try{var t=default_currency}catch(n){var t="unknown"}return this.print(e,t)}}),App.Collections.Categories=Backbone.Collection.extend({model:App.Models.Category,url:"/api/v3.0/get_categories",parse:function(e){var t=[];return _.each(e.categories,function(e){_.each([e].concat(e.subcategories),function(n){t.push(App.Collections.Categories.processCategoryData(n,e))})}),_.flatten(t)},rootCategories:function(){return this.filter(function(e){return null==e.get("parent_id")})},childCategories:function(e){return this.filter(function(t){return t.get("parent_id")==e.id})}}),App.Collections.Categories.processCategoryData=function(e,t){try{e.icon=e.icon_types.square.large,e.parent_id=t&&t.id!==e.id?t.id:null}catch(n){}return _.omit(e,"subcategories","icon_types")},App.Collections.Groups=Backbone.Collection.extend({model:App.Models.Group,url:"/api/v3.0/get_group",parse:function(e){return e.groups?e.groups:e},comparator:function(e,t){return t.get("updated_at").localeCompare(e.get("updated_at"))},involvingUser:function(e){return this.filter(function(t){return _.any(t.get("members"),function(t){return t.id==e})})},defaultGroup:function(){if(2!=App.groups.size())return App.groups.get(0);var e=App.groups.get(0).repayments().length>0;return e=e||App.friends.find(function(e){return _.find(e.groupBalances(),function(e){return 0==e.group_id})}),e?App.groups.get(0):App.groups.find(function(e){return 0!=e.id})}}),App.Collections.Friends=Backbone.Collection.extend({model:App.Models.Friend,url:"/api/v3.0/get_friend",parse:function(e){return e.friends?e.friends:e},totalBalance:function(){var e={},t={},n={};return _.each(this.models,function(i){_.each(i.balance(),function(i){i.amount=parseFloat(i.amount),0!=i.amount&&(null==e[i.currency_code]&&(e[i.currency_code]=0),i.amount>0?(null==n[i.currency_code]&&(n[i.currency_code]=0),n[i.currency_code]+=i.amount,e[i.currency_code]+=i.amount):i.amount<0&&(null==t[i.currency_code]&&(t[i.currency_code]=0),t[i.currency_code]+=i.amount,e[i.currency_code]+=i.amount))})}),{total:e,positive:n,negative:t}},emailAddresses:function(){return this.pluck("email")},owed:function(){return this.filter(function(e){return _.any(e.get("balance"),function(e){return e.amount<0})})}}),App.Collections.Expenses=Backbone.Collection.extend({model:App.Models.Expense,url:"/api/v3.0/get_expenses?visible=true&order=date",comparator:function(e,t){return t.get("date").localeCompare(e.get("date"))+.1*t.get("updated_at").localeCompare(e.get("updated_at"))},initialize:function(){this.bind("reset",function(){this.fullyLoaded=this.models.length<25})},parse:function(e){return e.expenses?e.expenses:e},loadMore:function(e){if(!this.fullyLoaded){var t=this;$("#load_more_expenses_button").button("loading"),e.data.limit=100,e.data.offset=this.models.length,e.upsert=!0,e.silent=!0,e.success=function(e,n,i){var s=window.scrollY;t.trigger("reset"),window.scrollTo(0,s);try{n&&n.expenses&&n.expenses.length<100?($("#load_more_expenses_button").remove(),t.fullyLoaded=!0):$("#load_more_expenses_button").button("reset")}catch(a){$("#load_more_expenses_button").button("reset")}},this.fetch(e)}},thisMonth:function(e){return this.filter(function(t){var n=Date.fromISO(t.get("date"));return n.getMonth()==e.getMonth()&&n.getYear()==e.getYear()})},thisMonthSummary:function(e){var t={expenses_paid:{},expenses_owed:{},payments_made:{},payments_received:{},net_change:{}};return _.each(this.thisMonth(e),function(e){var n=e.getShare(current_user);n&&(e.isPayment()?(n.paid_share>0&&(t.payments_made[e.get("currency_code")]||(t.payments_made[e.get("currency_code")]=0),t.payments_made[e.get("currency_code")]+=n.paid_share),n.owed_share>0&&(t.payments_received[e.get("currency_code")]||(t.payments_received[e.get("currency_code")]=0),t.payments_received[e.get("currency_code")]+=n.owed_share)):(n.paid_share>0&&(t.expenses_paid[e.get("currency_code")]||(t.expenses_paid[e.get("currency_code")]=0),
t.expenses_paid[e.get("currency_code")]+=n.paid_share),n.owed_share>0&&(t.expenses_owed[e.get("currency_code")]||(t.expenses_owed[e.get("currency_code")]=0),t.expenses_owed[e.get("currency_code")]+=n.owed_share)),t.net_change[e.get("currency_code")]||(t.net_change[e.get("currency_code")]=0),n.paid_share>0&&(t.net_change[e.get("currency_code")]+=n.paid_share),n.owed_share>0&&(t.net_change[e.get("currency_code")]-=n.owed_share))}),_.each(t,function(e){0==_.size(e)&&(e[default_currency]=0)}),t},recurringExpenses:function(){return this.select(function(e){return e.isRecurring()})}}),App.Collections.Notifications=Backbone.Collection.extend({initialize:function(){this.bind("change",this.setNotificationsFlag,this),this.bind("reset",this.setNotificationsFlag,this),this.bind("add",this.setNotificationsFlag,this)},model:App.Models.Notification,url:"/api/v3.0/get_notifications?limit=5",comparator:function(e,t){return t.get("created_at").localeCompare(e.get("created_at"))},parse:function(e){return e.notifications?e.notifications:e},loadMore:function(e){e=e||{data:{}};var t=this;$("#load_more_notifications").text(App.t("_in_progress",App.t("loading"))),e.data.limit=this.size()+25,e.upsert=!0,e.silent=!0,e.success=function(e,n,i){t.trigger("reset"),$("#load_more_notifications").text(App.t("show_more"))},this.fetch(e)},after:function(e){return this.filter(function(t){var n=Date.fromISO(t.get("created_at"));return n>e})},setNotificationsFlag:function(){if($("#notifications_link").removeClass("unread"),App.notifications_count_at_page_load>0&&$("#notifications_link").addClass("unread"),this&&this.first()){var e=Date.fromISO(this.first().get("created_at")),t=Date.fromISO(App.notifications_read);if(e==t)return;"undefined"==t?$("#notifications_link").addClass("unread"):_.each(this.after(t),function(e){e.unread()&&$("#notifications_link").addClass("unread")})}}}),Backbone.View.prototype.close=function(){this.el&&$(this.el).empty(),this.unbind(),"function"==typeof this.onClose&&this.onClose()},App.Views.BalancesSidebar=Backbone.View.extend({el:"#left_sidebar",template:JST["backbone/templates/balances-sidebar"],events:{"click a.show_inactive_accounts":"expand","click button.send_invite":"sendInvite","keyup #filter_search":"filterSearch","keypress input[type=email]":"sendInviteOnEnter"},initialize:function(e){App.groups.bind("reset",this.render,this),App.groups.bind("change",this.render,this),App.groups.bind("add",this.render,this),App.friends.bind("reset",this.render,this),App.friends.bind("change",this.render,this),App.friends.bind("add",this.render,this),this.render(),this.filterSearch(),this.clickToExpand=!1},expand:function(){return $(".show_inactive_accounts").hide(),this.clickToExpand=!0,this.filterSearch(),!1},render:function(){$(this.el).html(this.template()),0==this.$('.tags a[data-active="false"]').size()&&this.$("#groups_show_inactive_accounts").hide(),0==this.$('.people a[data-active="false"]').size()&&this.$("#friends_show_inactive_accounts").hide(),this.clickToExpand||this.$('a[data-active="false"]').hide(),this.$("[rel=tooltip]").tooltip({placement:"right"}),App.notifications&&App.notifications.setNotificationsFlag()},filterSearch:function(){""==$("#filter_search").val()||void 0==$("#filter_search").val()?(this.$('a[data-filterable="true"]').show(),this.$(".add-on").removeClass("active")):(this.$('a[data-filterable="true"]').hide(),this.$('a[data-search-string*="'+$("#filter_search").val().toLowerCase()+'"]').show(),this.$(".add-on").addClass("active")),this.clickToExpand||this.$('a[data-active="false"]').hide()},sendInvite:function(){if(""==this.$(".invite_email").val()||-1==this.$(".invite_email").val().indexOf("@"))return alert(App.t("invalid_email_alert"));var e=this;this.$(".invite_ajax_indicator").show(),$.ajax({url:"/api/v3.0/create_friends",data:{users:[{name:e.$(".invite_email").val(),email:e.$(".invite_email").val()}]},type:"POST",dataType:"json",success:function(t){e.$(".invite_ajax_indicator").hide(),t.users[0]&&t.users[0].id?(e.$(".invite_email").val("").focus(),App.friends.add(t.users[0]),setTimeout("$('#left_sidebar .invite_success').slideDown()",100),setTimeout("$('#left_sidebar .invite_success').slideUp(250)",3e3)):alert(App.t("general_unknown_error"))},error:function(t){e.$(".invite_ajax_indicator").hide(),data=t.responseJSON,data&&data.errors&&data.errors.base?alert(data.errors.base):alert(App.t("general_unknown_error"))}})},sendInviteOnEnter:function(e){13==e.keyCode&&this.sendInvite()}}),App.Views.DetailsSidebar=Backbone.View.extend({el:"#right_sidebar_content",template:JST["backbone/templates/details-sidebar"],events:{"click .nav a":"setActive","click .toggle_involvement":"toggleInvolvement","click .resend_invite":"resendInvite","click .nav a.loadmore":"loadMoreExpenses","click #edit_whiteboard":"showWhiteboardForm","click #save_whiteboard":"updateWhiteboard","click #whiteboard_text":"showWhiteboardForm"},initialize:function(e){App.groups.bind("reset",this.render,this),App.groups.bind("change",this.render,this),App.friends.bind("reset",this.render,this),App.friends.bind("change",this.render,this)},render:function(){App.currentRelationship||App.dashboard||App.notifications_view?$(this.el).html(this.template({relationship:App.currentRelationship})):$(this.el).empty(),App.currentRelationship&&(this.relationshipBalances&&this.relationshipBalances.close(),this.relationshipBalances=new App.Views.RelationshipBalances({model:App.currentRelationship}),this.relationshipBalances.render()),this.recurringList&&this.recurringList.close(),this.recurringList=new App.Views.RecurringList,this.recurringList.render(),this.mainTrends&&this.mainTrends.close(),this.mainTrends=new App.Views.MainTrends,this.mainTrends.render(),this.monthlyChart&&this.monthlyChart.close(),this.monthlyChart=new App.Views.MonthlyChart,this.monthlyChart.render(),$(".tooltip").hide(),this.$(".nav *[rel=tooltip]").tooltip({placement:"bottom"})},setActive:function(e){var t=$(e.currentTarget);this.$(".nav a").removeClass("open"),t.addClass("open")},toggleInvolvement:function(){return App.settings.show_items_not_involving_me=!App.settings.show_items_not_involving_me,App.settings.show_items_not_involving_me?(App.settings.show_settled_bills?$(".expense.uninvolved").slideDown(250):$(".expense.uninvolved:not(.settled)").slideDown(250),$(".toggle_involvement").text(App.t("hide_items_without_me"))):($(".expense.uninvolved").slideUp(250),$(".toggle_involvement").text(App.t("show_items_without_me"))),!1},resendInvite:function(){"friend"==App.currentRelationship.get("relationship_type")&&(App.showLoader(App.t("sending")),$.ajax({url:"/api/v3.0/resend_invite/"+App.currentRelationship.get("id"),data:{},type:"POST",dataType:"json",success:function(e,t){"success"==t&&1==e.success?App.closeLoader({type:"success",message:App.t("invite_resent")}):App.closeLoader({type:"error"})},error:function(e,t){alert(App.t("general_unknown_error"))}}))},loadMoreExpenses:function(){-1==App.currentRelationship.id?App.expenses.loadMore({data:{}}):"group"==App.currentRelationship.get("relationship_type")?App.expenses.loadMore({data:{group_id:App.currentRelationship.get("id")}}):App.expenses.loadMore({data:{friend_id:App.currentRelationship.get("id"),group_id:0}})},showWhiteboardForm:function(){this.$("#whiteboard_show").hide(),this.$("#whiteboard_edit").show(),this.$("#whiteboard_form").focus()},updateWhiteboard:function(){var e=this;"group"==App.currentRelationship.get("relationship_type")&&(App.showLoader(App.t("saving")),$.ajax({url:"/api/v3.0/update_group_settings",data:{id:App.currentRelationship.get("id"),whiteboard:e.$("#whiteboard_form").val()},type:"POST",dataType:"json",success:function(e,t){var n=null;"success"==t&&(e.group.errors?n=App.t("general_unknown_error"):$("#whiteboard_text").text(e.group.whiteboard)),n||"success"!=t?(App.closeLoader({type:"error"}),alert(n?n:t)):(App.closeLoader({type:"success",message:App.t("success")}),$("#whiteboard_show").show(),$("#whiteboard_edit").hide())},error:function(e,t){alert(App.t("general_unknown_error"))}}))}}),App.Views.InviteFriends=Backbone.View.extend({el:"#invite_friends",template:JST["backbone/templates/modals/invite-friends"],events:{addContacts:"addContacts","click a.submit":"inviteFriends","click .input-data":function(){this.render(),setTimeout("$('#token-input-invite-input').click()",100)},"click .pick_a_method button":"showMainForm"},initialize:function(e){_.bindAll(this,"render","addPerson"),this.render()},render:function(){var e=this,t=!1;return $(this.el).html(this.template()),this.setupTokenInput([]),_.each(third_party_tokens,function(n,i){e.addContacts(null,i,n),t=!0}),t&&this.showMainForm(),this},setupTokenInput:function(e){e&&e.length>0?this.$(".invite-input").tokenInput("setOptions",{local_data:e,hintText:null,noResultsText:"[blank]"}):this.$(".invite-input").tokenInput(e,{theme:"mac",preventDuplicate:!0,placeholder:App.t("enter_names_or_emails"),hintText:e.length>0?App.t("hit_enter_to_add_person"):null,searchDelay:0,prePopulate:this.removeTokenInput(),animateDropdown:!1,noResultsText:"[blank]",searchDelay:0,resultsLimit:8,initialWidth:300,leftPadding:28,allowTabOut:!0,allowFreeTagging:!0,onFreeTaggingAdd:this.addPerson,resultsFormatter:function(e){var t="<li><p>";return t+=e.name,-1==e.name.indexOf("@")&&(t+=" ("+e.email+")"),t+="</p></li>"}})},removeTokenInput:function(){return this.$(".token-input-list-mac").get(0)?this.$(".invite-input").tokenInput("get"):void 0},showMainForm:function(){this.$(".pick_a_method").fadeOut(),this.$(".invite_method.email").fadeIn(),this.$("#token-input-invite-input").click()},inviteFriends:function(){if(!this.$("a.submit").hasClass("disabled")){var e=this,t=[];this.$("a.submit").addClass("disabled"),this.$(".invite-input").tokenInput("get").map(function(e){t.push({name:e.name,email:e.email})}),$.ajax({url:"/api/v3.0/create_friends",data:{users:t,message:this.$("textarea").val(),allow_partial_success:!0},type:"POST",dataType:"json",success:function(t){e.$("a.submit").removeClass("disabled"),_.each(t.users,function(e){App.friends.add(e)}),e.$(".invite-input").tokenInput("clear"),$(e.el).modal("hide")},error:function(t){e.$("a.submit").removeClass("disabled"),alert(App.t("general_unknown_error"))}})}},addContacts:function(e,t,n){var i=[];n=n.sort(function(e,t){var n=0;e.friends&&!t.friends&&(n+=1e4),!e.friends&&t.friends&&(n-=1e4),e.signed_up&&!t.signed_up&&(n-=100),!e.signed_up&&t.signed_up&&(n+=100);try{n+=e.name.toLowerCase().localeCompare(t.name.toLowerCase())}catch(i){}return n}),_.each(n,function(e){i.push({name:e.name,email:e.email})}),this.setupTokenInput(i),this.$(".gmail").hide(),this.$(".import_success").show(),this.$(".import_success .count").text(App.t("NUMBER_contacts_imported",n.length)),this.$("#token-input-invite-input").click()},emailAddressRegexp:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,isEmailAddress:function(e){return this.emailAddressRegexp.test(e)},isPhoneNumber:function(e){if(!e||e.length<10)return!1;var t=e.replace(/[^0-9]/g,"");return 10==t.length},addPerson:function(e){if(e.length<1)return!1;if(this.isEmailAddress(e))return{name:e,email:e};var t=this;return this.isPhoneNumber(e)?new App.Views.CustomPrompt({prompt:App.t("enter_a_name_for_this_person"),data:{email:e.replace(/[^0-9]/g,"")},validator:function(e){return!(void 0==e||0==e.length)},success:function(e){this.data.name=e,$("#invite_friends .invite-input").tokenInput("add",this.data).focus()},failure:function(){$("#invite_friends .invite-input").focus()}}):new App.Views.CustomPrompt({prompt:App.t("enter_an_email_address_for_NAME",e),data:{name:e},validator:function(e){return!(void 0==e||0==e.length)&&(t.isEmailAddress(e)||t.isPhoneNumber(e))},success:function(e){this.data.email=e,$("#invite_friends .invite-input").tokenInput("add",this.data).focus()},failure:function(){$("#invite_friends .invite-input").focus()}}),{name:"DELETE ME",email:"deleteme@example.com"}}}),App.Views.FirstLaunch=Backbone.View.extend({el:"#first_launch",template:JST["backbone/templates/modals/first-launch"],events:{},initialize:function(e){_.bindAll(this,"render"),this.render()},render:function(){return $(this.el).html(this.template()),this}}),App.Views.CustomPrompt=Backbone.View.extend({tagName:"div",className:"custom_prompt",template:JST["backbone/templates/modals/custom-prompt"],events:{"click .cancel":"cancel","click .ok":"ok",keydown:"keydown"},keys:{TAB:9,ENTER:13,ESCAPE:27,NUMPAD_ENTER:108},initialize:function(e){this.prompt=e.prompt,this.data=e.data,this.validator=e.validator,this.success=e.success,this.failure=e.failure,$(document.body).append(this.el),_.bindAll(this,"render"),this.render(),this.$("input[type=text]").focus()},render:function(){return $(this.el).html(this.template({prompt:this.prompt})),this},cancel:function(){this.failure(void 0),this.close()},ok:function(){var e=this.$("input[type=text]").val();this.validator(e)?(this.success(e),this.close()):this.$(".error_message").show()},close:function(){this.remove(),this.unbind()},keydown:function(e){switch(e.keyCode){case this.keys.TAB:return e.preventDefault(),!1;case this.keys.ENTER:case this.keys.NUMPAD_ENTER:this.ok();break;case this.keys.ESCAPE:this.cancel()}}}),App.Views.DashboardBalances=Backbone.View.extend({el:"#dashboard_balances",template:JST["backbone/templates/dashboard-balances"],emptyTemplate:JST["backbone/templates/dashboard-no-expenses"],collection:App.notifications,events:{"click .toggle-root-view button":"toggleRootView","click .toggle-chart-list button":"toggleChartList","click .bar":function(){return $(".tooltip").hide(),!0}},initialize:function(e){_.bindAll(this,"render"),this.render(),App.groups.bind("reset",this.render,this),App.groups.bind("change",this.render,this),App.groups.bind("add",this.render,this),App.friends.bind("reset",this.render,this),App.friends.bind("change",this.render,this),App.friends.bind("add",this.render,this)},render:function(){var e=!0;return _.each(App.friends.models.concat(App.groups.models),function(t){e&=0==t.mainBalance().amount}),!e&&(App.groups.size()>1||App.friends.size()>0)?($(this.el).html(this.template()),this.$(".negative .bar").tooltip({placement:"left"}),this.$(".positive .bar").tooltip({placement:"right"}),this.$("div.img").tooltip({placement:"top"}),this.$(".toggle-root-view button").tooltip({placement:"bottom"}),this.loadCookies()):$(this.el).html(this.emptyTemplate()),this},toggleRootView:function(e){this.$(".toggle-root-view button").removeClass("active"),$(e.currentTarget).addClass("active"),$(e.currentTarget).hasClass("people")?(this.$("#people_summary").show(),this.$("#groups_summary").hide()):(this.$("#people_summary").hide(),this.$("#groups_summary").show()),this.setCookies()},toggleChartList:function(e){this.$(".toggle-chart-list button").removeClass("active"),$(e.currentTarget).addClass("active"),$(e.currentTarget).hasClass("view_as_list")?(this.$(".list").show(),this.$(".chart").hide()):(this.$(".list").hide(),this.$(".chart").show()),this.setCookies()},loadCookies:function(){var e=$.cookies.get("dashboardView");$.cookies.test()&&e&&(this.$(".toggle-root-view button."+e.rootView).click(),this.$(".toggle-chart-list button."+e.chartList).click())},setCookies:function(){$.cookies.test()&&$.cookies.set("dashboardView",{rootView:this.$(".toggle-root-view button.active").hasClass("people")?"people":"groups",chartList:this.$(".toggle-chart-list button.active").hasClass("view_as_list")?"view_as_list":"view_as_chart"})},close:function(){this.undelegateEvents()}}),App.Views.NotificationsView=Backbone.View.extend({el:"#recent_activity",template:JST["backbone/templates/notifications"],collection:App.notifications,events:{"click .undelete":"undelete"},initialize:function(e){_.bindAll(this,"render"),App.notifications.bind("reset",this.render,this),App.notifications.bind("add",this.render,this),App.notifications.bind("remove",this.render,this)},undelete:function(e){e.preventDefault(),App.notifications.get($(e.target).data("id")).undelete()},setLocalReadTimestamp:function(e){this.read_timestamp=e},render:function(){return this.el="#recent_activity",$(this.el).html(this.template({read_timestamp:this.read_timestamp})),App.notifications.first()&&"/activity"==Backbone.history.fragment&&App.notifications_read!=App.notifications.first().get("created_at")&&!currentUserObject.read_only&&($.ajax({url:"/api/v3.0/update_user/"+current_user,data:{notifications_read:App.notifications.first().get("created_at")},type:"POST",dataType:"json"}),App.notifications_read=App.notifications.first().get("created_at"),$("#notifications_link").removeClass("unread"),delete App.notifications_count_at_page_load),this}}),App.Views.RelationshipDetails=Backbone.View.extend({el:"#center_column",template:JST["backbone/templates/relationship-details"],dashboardTemplate:JST["backbone/templates/dashboard"],events:{"click #load_more_expenses_button":"loadMoreExpenses","click #show_settled_bills":"toggleSettledBills",'click a[data-toggle="modal"]':"showModal","click .topbar .dropdown-toggle":function(){$(".tooltip").hide(),setTimeout("$('#quick_add input').focus()",50)}},initialize:function(e){_.bindAll(this,"setRelationship"),this.detailsSidebar=new App.Views.DetailsSidebar,this.sendReminder=new App.Views.SendReminderForm,this.simplifyDebts=new App.Views.SimplifyDebtsModal,this.settleUpForm=new App.Views.SettleUpForm,this.groupMemberDetails=new App.Views.GroupMemberDetails,this.groupMemberDetails.render()},showModal:function(e){if("#add_bill"==e.target.hash){if($(e.currentTarget).data("expenseId")){var t=$.extend(!0,{},App.expenses.get($(e.currentTarget).data("expenseId")).attributes);s=new App.Models.Expense(t)}else{var n;try{n=App.currentRelationship&&App.currentRelationship.isGroup()?App.currentRelationship.id:App.groups.defaultGroup().id}catch(i){n=0}var s=new App.Models.Expense({group_id:n})}this.addABill?this.addABill.setModel(s):this.addABill=new App.Views.AddBillForm({model:s})}else if("#settle_up_form"==e.target.hash){var n;try{n=App.currentRelationship&&App.currentRelationship.isGroup()?App.currentRelationship.id:App.groups.defaultGroup().id}catch(i){n=0}var a,s=new App.Models.Expense({description:"Payment",group_id:n,payment:!0,split:"payment"});if(App.currentRelationship&&App.currentRelationship.isFriend()?(a=App.currentRelationship.mainBalance(),a={from:a.amount>0?App.currentRelationship.id:current_user,to:a.amount>0?current_user:App.currentRelationship.id,amount:Math.abs(a.amount),currency_code:a.currency_code}):App.currentRelationship&&App.currentRelationship.isGroup()&&(a=_.find(App.currentRelationship.repayments(current_user),function(e){return e.from==current_user}),a||(a=App.currentRelationship.repayments(current_user)[0])),!a){var r=current_user;try{r=App.currentRelationship&&App.currentRelationship.isGroup()?_.find(App.currentRelationship.get("members"),function(e){return e.id!=current_user}).id:(App.friends.owed()[0]||App.friends.first()).id}catch(i){}a={from:current_user,to:r,currency_code:default_currency,amount:0}}s.set("users",[{user_id:a.from,paid_share:0,owed_share:0},{user_id:a.to,paid_share:0,owed_share:0}]),s.set({cost:Math.abs(a.amount),currency_code:a.currency_code,onePayer:a.from,onePayee:a.to}),this.settleUpForm.setModel(s)}},setRelationship:function(e){if(e){("all"==e||-1==e.get("id"))&&(App.groups.fetch({url:"/api/v3.0/get_groups"}),App.friends.fetch({url:"/api/v3.0/get_friends"})),"all"==e?App.currentRelationship=this.relationship=e=null:(App.setActive(e.get("relationship_type")+"-"+e.get("id")),App.currentRelationship=this.relationship=e,page_loaded&&new Date-page_loaded<5e3||App.currentRelationship.fetch()),this.render(),App.expenses.relationship=this.relationship,$("#expenses_list").html('<div style="padding: 15px; text-align: center; padding: 40px; color: #ccc; font-size: 20px">'+_.escape(App.t("loading"))+'<br><img src="https://dx0qysuen8cbs.cloudfront.net/assets/ajax-114d999f10c3c983ba14dfc2b38f2d29c1aa3d4406abd7e73f54bffab6f33c7e.gif"></div>');var t=App.currentExpenseId?0:25;0==t&&($("#load_more_expenses_button").remove(),App.expenses.fully_loaded=!0),null==App.currentRelationship?App.expenses.fetch({data:{limit:t}}):"group"==App.currentRelationship.get("relationship_type")&&-1==App.currentRelationship.id?App.expenses.fetch({data:{limit:t}}):"group"==App.currentRelationship.get("relationship_type")?App.expenses.fetch({data:{group_id:e.get("id"),limit:t}}):App.expenses.fetch({data:{friend_id:e.get("id"),limit:t,group_id:0}})}else App.currentRelationship=this.relationship=e,this.render()},setActiveExpenseId:function(e){App.currentExpenseId=e},render:function(){if(this.relationship)App.setPageTitle(this.relationship.name()+" \xb7 "+STRINGS.App),$(this.el).html(this.template(this.relationship.toJSON())),this.detailsSidebar.render(),this.quickAdd&&this.quickAdd.close(),this.quickAdd=new App.Views.QuickAddForm,this.quickAdd.render(),-1!=this.relationship.id&&0!=this.relationship.id&&(this.sendReminder.render(),this.simplifyDebts.render()),this.expensesList||(this.expensesList=new App.Views.ExpensesList),this.expensesList.render(),$("#load_more_expenses").hide();else if(App.dashboard)App.setPageTitle(App.t("dashboard")+" \xb7 "+STRINGS.App),$(this.el).html(this.dashboardTemplate()),this.detailsSidebar.render(),this.dashboardBalances&&this.dashboardBalances.close(),this.dashboardBalances=new App.Views.DashboardBalances,this.dashboardBalances.render(),this.quickAdd&&this.quickAdd.close(),this.quickAdd=new App.Views.QuickAddForm,this.quickAdd.render(),this.$(".dashboard.header h1").text(App.t("dashboard")),this.$("#dashboard_balances").show(),this.$("#recent_activity").hide(),page_loaded&&new Date-page_loaded<5e3||App.friends.fetch({url:"/api/v3.0/get_friends"});else if(App.notifications_view){App.setPageTitle(App.t("recent_activity")+" \xb7 "+STRINGS.App),$(this.el).html(this.dashboardTemplate()),this.detailsSidebar.render();var e=new App.Views.NotificationsView;e.setLocalReadTimestamp(App.notifications_read),e.render(),this.$(".dashboard.header h1").text(App.t("recent_activity")),this.$(".dashboard.header .actions").hide(),this.$("#dashboard_balances").hide(),this.$("#recent_activity").show()}else App.setPageTitle(STRINGS.App),$(this.el).html("<div style='padding:20px;text-align:center;color:#999'>"+App.t("cannot_view_permission_error_html")+"</div>");return this.$(".topbar *[rel=tooltip]").tooltip({placement:"bottom"}),this},loadMoreExpenses:function(){-1==App.currentRelationship.id?App.expenses.loadMore({data:{}}):"group"==App.currentRelationship.get("relationship_type")?App.expenses.loadMore({data:{group_id:App.currentRelationship.get("id")}}):App.expenses.loadMore({data:{friend_id:App.currentRelationship.get("id"),group_id:0}})},toggleSettledBills:function(){return App.settings.show_settled_bills=!App.settings.show_settled_bills,App.settings.show_settled_bills&&($("#expenses_list .settle-point").hide(),$("#load_more_expenses.settled").show(),App.settings.show_items_not_involving_me?$("#expenses_list .settled").show():$("#expenses_list .settled:not(.uninvolved)").show()),!1}}),App.Views.RelationshipBalances=Backbone.View.extend({el:"#relationship_balances",template:JST["backbone/templates/relationship-balances"],initialize:function(e){_.bindAll(this,"render"),this.model.bind("change optimisticUpdate",this.render),App.groups.bind("change",this.render),App.friends.bind("change",this.render)},render:function(){if($(this.el).html(this.template()),this.settleUp&&this.settleUp.close(),this.settleUp=new App.Views.SettleUp,this.settleUp.render(),this.$("*[rel=tooltip]").tooltip({placement:"left"}),App.currentRelationship&&App.currentRelationship.isGroup()&&_.uniq(_.pluck(App.currentRelationship.repayments(),"currency_code")).length>1){var e=_.uniq(_.pluck(App.currentRelationship.repayments(),"currency_code")),t=currentUserObject.default_currency,n=this.$(".exchange_rates");$.get("/api/v3.0/get_exchange_rates",function(i){n.empty(),_.each(e,function(e){try{if(e!=t){var s=1*i.rates[t]/i.rates[e],a=.001>s?7:4;n.append("<li>1 "+e+" = "+s.toFixed(a)+" "+t+"</li>")}}catch(r){this.$(".exchange_rates").html("<li>1 "+e+" = ???? "+t+"</li>")}})})}return this},onClose:function(){this.model.unbind("change optimisticUpdate",this.render),App.groups.unbind("change",this.render),App.friends.unbind("change",this.render)}}),App.Views.QuickAddForm=Backbone.View.extend({el:"#quick_add",events:{"click button":"customSubmit","click input":function(e){e.stopPropagation()}},template:JST["backbone/templates/quick-add"],initialize:function(e){_.bindAll(this,"render")},render:function(){return this.el="#quick_add",$(this.el).html(this.template(App.currentRelationship)),this},customSubmit:function(){$("#quick_add button").button("loading");var e={autosave:!0};e.input=this.$("input[type=text]").val(),App.currentRelationship&&("group"==App.currentRelationship.get("relationship_type")?App.currentRelationship.id>0&&(e.group_id=App.currentRelationship.get("id")):e.friend_id=App.currentRelationship.get("id")),App.showLoader(App.t("saving"));var t=this.$("input[type=text]");return $.ajax({url:"/api/v3.0/parse_sentence",data:e,type:"POST",dataType:"json",success:function(e,n){var i=null;"success"==n&&(e.error?i=e.error:e.expense.errors?i=App.t("an_unknown_quickadd_problem_occured"):(App.currentRelationship&&App.currentRelationship.adjustBalances("add",new App.Models.Expense(e.expense)),App.expenses.add(e.expense),$("#expense-"+e.expense.id).hide().slideDown(),$("#quick_add .sample").show(),$("#quick_add .status").hide(),t.val(""),setTimeout("$('#quickadd').popover('hide');",100),App.currentRelationship&&App.currentRelationship.id>0?App.currentRelationship.fetch():App.friends.fetch({url:"/api/v3.0/get_friends"}))),i||"success"!=n?(App.closeLoader({type:"error"}),alert(i?i:n),$("#quickadd").focus()):App.closeLoader({type:"success",message:App.t("expense_added")}),$("#quick_add button").button("reset")}}),!1}}),App.Views.ExpenseListGroupView=Backbone.View.extend({tagName:"div",className:"expense",template:JST["backbone/templates/expense-list-group"],initialize:function(e){_.bindAll(this,"render"),this.currentRelationship=App.currentRelationship,this.currentRelationship.bind("change",this.render),this.settled=e.settled},render:function(){try{if(this.model&&App.currentRelationship){var e=this.model.group_id,t=_.find(App.currentRelationship.get("groups"),function(t){return t.group_id==e});t&&(this.model=t)}var n=_.max(this.model.balance,function(e){return Math.abs(e.amount)}),i=this.template({group:App.groups.get(this.model.group_id),mainBalance:n,balance:this.model.balance,balanceCount:_.select(this.model.balance,function(e){return 0!=parseFloat(e.amount)}).length})}catch(s){var i="<div style='padding: 10px; background: #fee'><div style='color: #c00; font-weight: bold; font-size: 18px; margin-bottom: 5px'>Render error!</div>"+_.escape(App.t("error_expense_list_group_render"))+"</div>"}return $(this.el).html(i),this.settled&&$(this.el).addClass("settled"),this},onClose:function(){this.currentRelationship.unbind("change",this.render)}}),App.Views.ExpenseView=Backbone.View.extend({tagName:"div",className:"expense",template:JST["backbone/templates/expense"],summaryTemplate:JST["backbone/templates/expense-summary"],detailsTemplate:JST["backbone/templates/expense-details"],events:{"click img.receipt:not(.image)":"showCategoryPicker","click .category_picker img":"setCategory","click a.cancel_recurrence":"cancelRecurrence","click a.delete":"removeConfirm","click div.main-block":"toggleDetails","click div.cost":"toggleDetails","click div.you":"toggleDetails","click .add_comment button:not(.disabled)":"addComment","keypress .add_comment textarea":"addCommentOnEnter","click a.delete_comment":"removeCommentConfirm","click a.open_charts":"openCharts"},initialize:function(e){_.bindAll(this,"render"),this.model.bind("change",this.render),this.model.bind("remove",this.remove,this),this.settled=e.settled,this.id=this.model.Id,$(this.el).attr({id:"expense-"+this.model.get("id"),"data-date":this.model.get("date")}).html(this.template())},toggleDetails:function(e){this.$(".category_picker").fadeOut(100),this.$(".users").is(":visible")||(this.$(".users").html(this.detailsTemplate(this.model.toJSON())),this.model.fetch({url:"/api/v3.0/get_comments?expense_id="+this.model.id})),this.$(".users").slideToggle(250)},removeConfirm:function(e){var t;return this.model.isPayment()?(t=App.t("delete_payment_confirmation"),this.model.isP2P()&&1==this.model.get("transaction_confirmed")&&(t+="\n\n"+App.t("note_deleting_the_payment_on_splitwise_does_not_cancel_the_transfer_on_PLATFORM",this.model.formattedP2PName())+".")):(t=App.t("delete_expense_confirmation"),t+=["debt_consolidation","debt_simplification"].indexOf(this.model.get("creation_method"))>=0?" "+App.t("delete_with_simplification"):" "+App.t("delete_expense_confirmation_warning")),confirm(t)&&this.deleteAndRemove(e),!1},removeCommentConfirm:function(e){return confirm(App.t("delete_comment_confirmation"))&&this.deleteAndRemoveComment(e),!1},showCategoryPicker:function(e){e.stopPropagation();var t="",n=!0,i=this.model.get("category").id;_.each(App.categories.models,function(e){e.get("parent_id")?t+="<img src='"+e.get("icon")+"' class='category_icon "+(i==e.get("id")?"active":"")+"' data-id='"+e.get("id")+"' data-name='"+e.get("name")+"' title='"+App.categories.get(e.get("parent_id")).get("name")+": "+e.get("name")+"'>":(n?n=!1:t+="<br>",t+="<span class='parent_category'>"+e.get("name")+":</span>")}),this.$(".category_picker").is(":visible")||$(".category_picker").fadeOut(100),this.$(".category_picker").html(t).fadeToggle(100),this.$(".category_picker .category_icon").tooltip({placement:"top",delay:0})},setCategory:function(e){this.$(".category_picker").fadeOut(100);var t=this.model.get("category");this.model.set("category",{id:$(e.currentTarget).data("id"),name:$(e.currentTarget).data("name")}),$(".tooltip.top.fade.in").remove(),App.showLoader(App.t("saving")),$.ajax({url:"/api/v3.0/update_expense/"+this.model.get("id"),type:"POST",data:{category_id:$(e.currentTarget).data("id")},dataType:"json",success:function(e,n){var i=null;"success"==n&&e.errors&&_.size(e.errors)>0&&(i=_.reduce(e.errors,function(e,t,n){return e+_.reduce(t,function(e,t){return e+"\n- "+("base"==n?"":$.capitalize(n)+" ")+t},"")},App.t("these_errors_occurred"))),i||"success"!=n?(App.closeLoader({type:"error"}),this.model.set("category",t),alert(i?i:n)):App.closeLoader({type:"success",message:App.t("success")})}.bind(this)})},addComment:function(){App.showLoader("Adding comment"),this.$(".add_comment button").addClass("disabled");var e=this;$.ajax({url:"/api/v3.0/create_comment",type:"POST",data:{expense_id:this.model.get("id"),content:this.$(".add_comment textarea").val()},dataType:"json",success:function(t,n){var i=null;"success"==n&&t.errors&&t.errors.count>0&&(i=_.reduce(t.errors,function(e,t){e+"\n"+k+" "+v},"")),i||"success"!=n?(App.closeLoader({type:"error"}),e.$(".add_comment button").removeClass("disabled"),alert(i?i:n)):(App.closeLoader({type:"success",message:App.t("success")}),e.model.set({comments_count:e.model.get("comments_count")+1},{silent:!0}),e.$(".add_comment textarea").val(""),e.$(".add_comment button").removeClass("disabled"),e.model.fetch({url:"/api/v3.0/get_comments?expense_id="+e.model.id}))},error:function(t){alert(App.t("general_unknown_error")),App.closeLoader({type:"error"}),e.$(".add_comment button").removeClass("disabled")}})},addCommentOnEnter:function(e){13!=e.keyCode||e.shiftKey||this.addComment()},cancelRecurrence:function(e){confirm(App.t("cancel_recurrence_confirmation"))&&(this.model.set({repeats:!1,repeat_interval:"never"}),App.showLoader(App.t("saving")),$.ajax({url:"/api/v3.0/update_expense/"+this.model.get("id"),data:{repeats:!1,repeat_interval:"never"},dataType:"json",type:"POST",success:function(e,t){var n=null;"success"==t&&e.errors&&e.errors.count>0&&(n=_.reduce(e.errors,function(e,t){e+"\n"+k+" "+v},"")),n||"success"!=t?(App.closeLoader({type:"error"}),alert(n?n:t)):App.closeLoader({type:"success",message:App.t("success")})}}))},deleteAndRemove:function(e){e.stopPropagation(),e.preventDefault(),App.showLoader(App.t("deleting"));var t=this;return $.ajax({url:"/api/v3.0/delete_expense/"+this.model.get("id"),type:"POST",dataType:"json",success:function(e,n){var i=null;"success"==n&&(e.errors&&_.size(e.errors)>0?i=_.reduce(e.errors,function(e,t,n){return e+_.reduce(t,function(e,t){return e+"\n- "+("base"==n?"":$.capitalize(n)+" ")+t},"")},App.t("these_errors_occurred")):(App.currentRelationship&&App.currentRelationship.adjustBalances("subtract",t.model),$(t.el).slideUp("normal",function(){("debt_consolidation"==t.model.get("creation_method")||"debt_simplification"==t.model.get("creation_method"))&&App.groups.fetch({
url:"/api/v3.0/get_groups"}),$(this).remove(),App.expenses.remove(t.model),App.currentRelationship&&App.currentRelationship.id>0&&App.currentRelationship.fetch()}),App.currentRelationship&&0!=App.currentRelationship.id||App.friends.fetch({url:"/api/v3.0/get_friends"}))),i||"success"!=n?(App.closeLoader({type:"error"}),alert(i?i:n)):App.closeLoader({type:"success",message:App.t("success")})}}),!1},deleteAndRemoveComment:function(e){e.stopPropagation(),e.preventDefault(),App.showLoader(App.t("deleting"));var t=this;return $.ajax({url:"/api/v3.0/delete_comment/"+$(e.currentTarget).data("id"),type:"POST",dataType:"json",success:function(e,n){var i=null;"success"==n&&e.errors&&e.errors.count>0&&(i=_.reduce(e.errors,function(e,t){e+"\n"+k+" "+v},"")),i||"success"!=n?(App.closeLoader({type:"error"}),alert(i?i:n)):(App.closeLoader({type:"success",message:App.t("success")}),t.model.set({comments_count:t.model.get("comments_count")-1},{silent:!0}),t.model.fetch({url:"/api/v3.0/get_comments?expense_id="+t.model.id}))},error:function(e){alert(App.t("general_unknown_error")),App.closeLoader({type:"error"})}}),!1},remove:function(){$(this.el).slideUp("normal",function(){$(this).remove()})},render:function(){try{var e=this.summaryTemplate(this.model.toJSON())}catch(t){var e="<div class='expense payment' style='padding: 10px 20px; background: #fee'><div style='color: #c00; font-weight: bold; font-size: 18px'>Render error!</div>"+_.escape(App.t("error_expense_render_ID",this.model.id))+"</div>"}if(this.$(".summary").html(e),this.settled?$(this.el).addClass("settled"):$(this.el).removeClass("settled"),App.currentExpenseId==this.model.id){var n=this.el;$(n).addClass("current-expense"),this.settled&&!App.settings.show_settled_bills&&App.relationshipsRouter.relationshipDetailsView.toggleSettledBills(),setTimeout(function(){$("html, body").animate({scrollTop:$(n).offset().top-60},250)},400)}else $(this.el).removeClass("current-expense");return this.$(".users").is(":visible")&&this.$(".users").html(this.detailsTemplate(this.model.toJSON())),this},openCharts:function(){if(App.metadata.features.charts&&0!=App.metadata.features.charts.enabled)window.open("/api/v3.0/charts?expense_id="+this.model.id);else{var e=App.metadata.features.charts.behavior.webview.url;$("#fullscreen_ad").html('<iframe frameborder="0" src="/api/v3.0/'+e+'"></iframe>'),$("#fullscreen_ad").modal({show:!0})}return!1}}),App.Views.ExpensesList=Backbone.View.extend({el:"#expenses_list",template:JST["backbone/templates/no-expenses"],month_divider_template:JST["backbone/templates/month-divider"],settle_point_template:JST["backbone/templates/settle-point"],collection:App.expenses,initialize:function(e){this._expenseViews=[],_.bindAll(this,"render"),App.expenses.bind("add",this.render,this),App.expenses.bind("remove",this.render,this),App.expenses.bind("reset",this.render,this)},_allBalancesAreZero:function(e){return _.all(e,function(e){return _.all(e,function(e){return Math.abs(e.amount)<.001})})},render:function(){if(!App.currentRelationship)return this;this.el="#expenses_list";var e,t,n=0,i=0,s=App.expenses.models,a=!1,r=App.currentRelationship.balances(),o=[];for($(this.el).empty();this._expenseViews.length>0;)this._expenseViews.pop().close();$(this.el).hide(),App.currentRelationship.isFriend()&&(s=App.expenses.models.concat(App.currentRelationship.sharedTabs()).sort(function(e,t){var n=e.group_id?new Date:Date.fromISO(e.get("date")),i=t.group_id?new Date:Date.fromISO(t.get("date"));return e.group_id&&App.groups.get(e.group_id)&&(n=Date.fromISO(App.groups.get(e.group_id).get("updated_at"))),t.group_id&&App.groups.get(t.group_id)&&(i=Date.fromISO(App.groups.get(t.group_id).get("updated_at"))),i-n})),_.each(App.currentRelationship.get("groups"),function(e){var t=_.any(e.balance,function(e){return 0!==safe_parse_float(e.amount)});t&&e.group_id>0&&o.push(e.group_id)});var l=this;return _.each(s,function(s){if(!a&&App.currentRelationship&&App.currentRelationship.id>0&&l._allBalancesAreZero(r)&&_.isEmpty(o))$(l.el).append(l.settle_point_template({expensesCount:n+i})),a=!0;else if(s.group_id){var p=App.groups.get(s.group_id).balanceWith(App.currentRelationship.id);_.each(p,function(e,t){var n=_.find(r[current_user],function(e){return e.currency_code==t}),i=_.find(r[App.currentRelationship.id],function(e){return e.currency_code==t});n||(n={currency_code:t,amount:0},r[current_user].push(n)),i||(i={currency_code:t,amount:0},r[current_user].push(i)),n.amount-=parseFloat(e),i.amount+=parseFloat(e)}),o=_.without(o,s.group_id)}else s.has("deleted_at")||_.each(r,function(e,t){var n=_.find(e,function(e){return e.currency_code==s.get("currency_code")});n||(n={currency_code:s.get("currency_code"),amount:0},e.push(n)),App.currentRelationship&&App.currentRelationship.isGroup()?n.amount-=s.netBalance(t):t==current_user?n.amount-=s.netBalance():n.amount+=s.netBalance()});if(s.group_id){var c=new App.Views.ExpenseListGroupView({model:s,settled:a});try{var u=App.groups.get(s.group_id).get("updated_at")}catch(d){var u=new Date}var h=Date.fromISO(u).getFullYear(),f=Date.fromISO(u).getMonth()+1;i++,l._expenseViews.push(c)}else{if(App.currentRelationship&&-1==App.currentRelationship.id&&s.has("group_id")&&!App.groups.get(s.get("group_id")))return;if(!s.has("deleted_at")){var c=new App.Views.ExpenseView({model:s,settled:a}),h=Date.fromISO(s.get("date")).getFullYear(),f=Date.fromISO(s.get("date")).getMonth()+1;n++}}(h!=e||f!=t)&&(e=h,t=f,$(l.el).append(l.month_divider_template({month:t,year:e,settled:a}))),$(l.el).append(c.render().el)}),0!=n||App.currentRelationship.isFriend()&&0!=App.currentRelationship.sharedTabs().length||$(l.el).append(l.template({settled:a})),App.expenses.fullyLoaded||0==App.expenses.models.length?$("#load_more_expenses").hide():a&&!App.settings.show_settled_bills?$("#load_more_expenses").addClass("settled").hide():$("#load_more_expenses").removeClass("settled").show(),App.settings.show_settled_bills&&($(this.el).find(".settled").show(),$(this.el).find(".settle-point").hide()),App.settings.show_items_not_involving_me||$(this.el).find(".expense.uninvolved").hide(),$(this.el).show(),$(this.el).find("i[rel=tooltip]").tooltip({placement:"top"}),this},clear:function(){$(this.el).empty()}}),App.Views.MainTrends=Backbone.View.extend({el:"#main_trends",template:JST["backbone/templates/main-trends"],initialize:function(e){_.bindAll(this,"render"),App.expenses.bind("add",this.render,this),App.expenses.bind("change",this.render,this),App.expenses.bind("reset",this.render,this)},render:function(){return $(this.el).html(this.template({data:App.expenses.thisMonthSummary(new Date)})),this}}),App.Views.MonthlyChart=Backbone.View.extend({el:"#charts_modal",template:JST["backbone/templates/modals/charts-modal"],events:{"click h4 a":"changeMonth"},initialize:function(e){_.bindAll(this,"render"),App.expenses.bind("add",this.render,this),App.expenses.bind("change",this.render,this),App.expenses.bind("reset",this.render,this),this.time=new Date},render:function(){var e=this.template({time:this.time});return $(this.el).html(e),this.chartsList&&this.chartsList.close(),this.chartsList=new App.Views.ChartsList({time:this.time}),this.chartsList.render(),this},changeMonth:function(e){var t=this.time.getMonth()+($(e.currentTarget).hasClass("previous")?-1:1),n=this.time.getFullYear();return t>11?(n+=1,t-=12):0>t&&(n-=1,t+=12),this.time=new Date(n,t),this.render(),!1},onClose:function(){App.expenses.unbind("add",this.render),App.expenses.unbind("change",this.render),App.expenses.unbind("reset",this.render)}}),App.Views.ChartsList=Backbone.View.extend({el:"#charts_modal tbody",template:JST["backbone/templates/charts-details"],collection:App.expenses,initialize:function(e){_.bindAll(this,"render"),App.expenses.bind("add",this.render,this),App.expenses.bind("change",this.render,this),App.expenses.bind("reset",this.render,this),this.time=e.time},render:function(){var e=this,t={},n=void 0,i=100;this.el="#charts_modal tbody",$(this.el).empty(),_.each(App.expenses.thisMonth(this.time),function(e){if(n||(n=e.get("currency_code")),!e.has("deleted_at")&&e.get("currency_code")==n){var s=e.isPayment()?{id:i}:e.get("category"),a=_.find(e.get("users"),function(e){return parseInt(e.user_id)==current_user});void 0==a&&(a={paid_share:0,owed_share:0}),(isNaN(a.paid_share)||null==a.paid_share)&&(a.paid_share=0),(isNaN(a.owed_share)||null==a.owed_share)&&(a.owed_share=0),void 0==t[s.id]?t[s.id]={name:s.id===i?App.t("payments"):App.categories.get(s.id).get("name"),total:parseFloat(e.get("cost")),paid:parseFloat(a.paid_share),owed:parseFloat(a.owed_share)}:(t[s.id].total+=parseFloat(e.get("cost")),t[s.id].paid+=parseFloat(a.paid_share),t[s.id].owed+=parseFloat(a.owed_share))}}),n||(n=currentUserObject.default_currency),_.each(t,function(t,i){var s=t.name;s==App.t("other")&&(s=App.t("other")+" ("+App.categories.get(i).parentCategory().get("name")+")"),$(e.el).append("<tr><td>"+s+"</td>                             <td class='total'>"+App.currencies.print(t.total,n)+"</td>                             <td>"+App.currencies.print(t.paid,n)+"</td>                             <td class='small'>-</td>                             <td>"+App.currencies.print(t.owed,n)+"</td>                             <td class='small'>=</td>                             <td class='summary'>"+App.currencies.print(t.paid-t.owed,n)+"</td></tr>")});var s=_.reduce(t,function(e,t){return e+t.total},0),a=_.reduce(t,function(e,t){return e+t.paid},0),r=_.reduce(t,function(e,t){return e+t.owed},0);return $(e.el).append("<tr class='block total'><td>"+_.escape(App.t("total"))+"</td>                       <td class='total'>"+App.currencies.print(s,n)+"</td>                       <td>"+App.currencies.print(a,n)+"</td>                       <td class='small'>-</td>                       <td>"+App.currencies.print(r,n)+"</td>                       <td class='small'>=</td>                       <td class='summary'><div>"+_.escape(App.t(a-r>0?"you_are_owed__header":"you_owe__header"))+"</div>"+App.currencies.print(Math.abs(a-r),n)+"</td></tr>"),delete t[i],fractions=_.map(t,function(e,t){return e.total/s*100}).join(","),labels=_.map(t,function(e,t){return e.name}).join("|").replace(" ","+"),totals=_.map(t,function(e,t){return App.currencies.print(e.total,n)}).join("|"),""==totals?($("#charts_modal img").hide(),$("#charts_modal .no_spending").show()):($("#charts_modal img").attr("src","https://chart.googleapis.com/chart?chf=a,s,00000091|bg,s,FFFFFF&chxs=0,000000,11&chxt=x&chs=550x250&cht=p&chco=3072F3,80C65A,FF3131,FF9900,9C4F82&chd=t:"+fractions+"&chdl="+labels+"&chp=0.1&chl="+totals+"&chma=0,140,0,5|75&chts=676767,11&chdls=000000,12").show(),$("#charts_modal .no_spending").hide()),this},clear:function(){$(this.el).empty()},close:function(){App.expenses.unbind("add",this.render),App.expenses.unbind("change",this.render),App.expenses.unbind("reset",this.render),Backbone.View.prototype.close()}}),App.Views.RecurringList=Backbone.View.extend({el:"#recurring_list",collection:App.expenses,events:{"click .bill a":"showBill"},initialize:function(e){_.bindAll(this,"render"),App.expenses.bind("add",this.render,this),App.expenses.bind("change",this.render,this),App.expenses.bind("reset",this.render,this)},render:function(){this.el="#recurring_list";var e=this;$(this.el).empty();var t=App.expenses.recurringExpenses(),n=0;return _.each(t,function(t){if(!t.has("deleted_at")){var i=new App.Views.RecurringView({model:t});$(e.el).append(i.render().el),n++}}),0==n&&$(this.el).append(App.t("no_recurring_bills_added_html")),this},clear:function(){$(this.el).empty()},showBill:function(e){return $("#expense-"+$(e.currentTarget).data("id")).click(),!1}}),App.Views.RecurringView=Backbone.View.extend({tagName:"tr",className:"recurring",template:JST["backbone/templates/recurring"],events:{"click a.delete":"render"},initialize:function(e){_.bindAll(this,"render"),this.model.bind("change",this.render),this.model.bind("remove",this.remove)},render:function(){var e=this.template(this.model.toJSON());return this.id=this.model.Id,$(this.el).attr({id:"recurring-"+this.model.get("id"),"data-date":this.model.get("date")}).html(e),this}}),App.Views.SettleUp=Backbone.View.extend({el:"#settle_up",events:{"click #simplified_handler":"toggleAndSave"},initialize:function(e){_.bindAll(this,"render")},render:function(){return App.currentRelationship&&"group"==App.currentRelationship.get("relationship_type")?($("#settle_up").html(JST["backbone/templates/modals/repayments"](App.currentRelationship.toJSON())),this.toggleSimplified(App.currentRelationship.get("simplify_by_default")),this.$("*[rel=tooltip]").tooltip({placement:"top"})):$("#settle_up").empty(),this},toggleAndSave:function(e){this.toggleSimplified(e),this.saveSimplifiedSetting()},toggleSimplified:function(e){var t="boolean"==typeof e?e:!!this.$(":checkbox").attr("checked");t?("boolean"==typeof e?this.$(".raw_repayments").hide():this.$(".raw_repayments").slideUp(),this.$(".simplified_repayments").slideDown(),this.$(".simplify").fadeOut()):(this.$(".simplified_repayments").slideUp(),this.$(".raw_repayments").slideDown())},saveSimplifiedSetting:function(){App.showLoader(App.t("saving")),$.ajax({url:"/api/v3.0/update_group_settings/"+App.currentRelationship.get("id"),data:{simplify_by_default:!!this.$(":checkbox").attr("checked")},type:"POST",dataType:"json",success:function(e,t){var n;"success"==t&&e.errors&&e.errors.length>0&&(n=App.t("general_unknown_error")),n||"success"!=t?(App.closeLoader({type:"error"}),alert(n?n:t)):(App.closeLoader({type:"success",message:App.t("settings_updated_successfully")}),App.currentRelationship.set("simplify_by_default",e.group.simplify_by_default))}})},close:function(){$(this.el).undelegate("#simplified_handler","click")}}),App.Views.GroupMemberDetails=Backbone.View.extend({el:"#group_member_details",events:{"click .input-data":"setMember","click .resend_invite":"resendInvite"},initialize:function(e){_.bindAll(this,"render"),App.groups.bind("reset",this.render,this),App.groups.bind("change",this.render,this),App.friends.bind("reset",this.render,this),App.friends.bind("change",this.render,this)},render:function(){return $(this.el).html(JST["backbone/templates/modals/group-member-details"]({member:this.member,group:this.group})),this},setMember:function(){var e,t=this.$(".input-data").data("id");e=t==current_user?new App.Models.User(currentUserObject):App.friends.get(t),e||(e=App.currentRelationship.getUser(t)),this.member=e;var n=this.$(".input-data").data("group-id");this.group=App.groups.get(n),this.render()},resendInvite:function(){var e=this;this.$(".resend_invite").attr("disabled",!0).text(App.t("sending")),App.showLoader(App.t("sending")),$.ajax({url:"/api/v3.0/resend_invite/"+this.member.id,data:{},type:"POST",dataType:"json",success:function(t,n){"success"==n&&1==t.success?(App.closeLoader({type:"success",message:App.t("invite_resent")}),e.$(".resend_invite").attr("disabled",!0).text(App.t("invite_resent"))):(alert(App.t("general_unknown_error")),App.closeLoader({type:"error"}),e.$(".resend_invite").attr("disabled",!1).text(App.t("resend_invite")))},error:function(t,n){alert(App.t("general_unknown_error")),App.closeLoader({type:"error"}),e.$(".resend_invite").attr("disabled",!1).text(App.t("resend_invite"))}})},close:function(){this.undelegateEvents()}}),App.Views.SendReminderForm=Backbone.View.extend({el:"#send_reminder",events:{"click .input-data":"updateDefault","click .dropdown-menu a":"updateForm","click #reminder_submit":"sendReminder","keypress input[type=text]":"sendReminderOnEnter"},initialize:function(e){_.bindAll(this,"render"),this.updateForm()},render:function(){return App.currentRelationship?$(this.el).html(JST["backbone/templates/modals/send-reminder"](App.currentRelationship.toJSON())):$(this.el).empty(),this},updateDefault:function(e){var t=this.$(".input-data").data();t.to&&$("#select-group-reminder_user_id a[data-value="+t.to+"]").click()},updateForm:function(e){if(App.currentRelationship){var t=App.currentRelationship.getUser($("#reminder_user_id").val());this.updateBalance(t),this.updateSend(t)}},updateBalance:function(e){try{var t=parseFloat(e.get("balance")[0].amount),n=e.get("balance")[0].currency_code}catch(i){var t=0}0>t?$("#reminder_summary").text(App.t("NAME_currently_owes_AMOUNT",e.firstNameLastInitial(),App.currencies.print(-t,n))):t>0?$("#reminder_summary").text(App.t("NAME_is_currently_owed_AMOUNT",e.firstNameLastInitial(),App.currencies.print(t,n))):$("#reminder_summary").text(App.t("NAME_currently_owes_nothing",e.firstNameLastInitial()))},updateSend:function(e){var t=App.friends.get(e.id),n=t?t.noEmail():!1;this.$("#reminder_submit").attr("disabled",n)},sendReminderOnEnter:function(e){13==e.keyCode&&this.sendReminder(e)},sendReminder:function(e){var t={},n=this.$("#reminder_user_id").val(),i=App.friends.get(parseInt(n));if(!i||!i.noEmail())return"group"==App.currentRelationship.get("relationship_type")&&(t.group_id=App.currentRelationship.get("id")),t.user_id=n,t.reminder_note=this.$("textarea").val(),App.showLoader(App.t("sending")),$.ajax({url:"/api/v3.0/send_reminder",data:t,dataType:"json",type:"POST",success:function(e,t){var n=null;"success"==t&&_.size(e.errors)>0&&(n=_.reduce(e.errors,function(e,t,n){return e+_.reduce(t,function(e,t){return e+"\n- "+("base"==n?"":$.capitalize(n)+" ")+t},"")},App.t("these_errors_occurred"))),n||"success"!=t?(App.closeLoader({type:"error"}),alert(n?n:t)):($("#send_reminder").modal("hide"),App.closeLoader({type:"success",message:App.t("reminder_sent")}))},error:function(e){alert(App.t("general_unknown_error")),App.closeLoader({type:"error"})}}),!1}}),App.Views.SimplifyDebtsModal=Backbone.View.extend({el:"#simplify_debts",events:{"click #simplify_debts_submit":"simplifyDebts"},initialize:function(e){_.bindAll(this,"render")},render:function(){return App.currentRelationship?(template=JST["backbone/templates/modals/simplify-debts"](App.currentRelationship.toJSON()),$(this.el).html(template),this):($(this.el).empty(),this)},simplifyDebts:function(e){return App.currentRelationship.isFriend()&&(App.showLoader(App.t("saving")),$.ajax({url:"/api/v3.0/consolidate_debts/"+App.currentRelationship.id,dataType:"json",type:"POST",success:function(e,t){var n=null;"success"==t&&e.errors&&_.size(e.errors)>0&&(n=_.reduce(e.errors,function(e,t,n){return e+_.reduce(t,function(e,t){return e+"\n- "+("base"==n?"":$.capitalize(n)+" ")+t},"")},App.t("these_errors_occurred"))),n||"success"!=t?(App.closeLoader({type:"error"}),alert(n?n:t)):($("#simplify_debts").modal("hide"),App.groups.fetch({url:"/api/v3.0/get_groups"}),App.currentRelationship.fetch(),App.expenses.fetch({data:{friend_id:App.currentRelationship.get("id"),limit:25,group_id:0}}),App.closeLoader({type:"success",message:App.t("success")}))},error:function(e){alert(App.t("general_unknown_error")),App.closeLoader({type:"error"})}})),!1}}),App.Routers.Relationships=Backbone.Router.extend({routes:{"/all":"all","/all/":"all","/all/expenses/:expense_id":"all","/groups":"group","/groups/:id":"group","/groups/:id/":"group","/groups/:id/:mode/:expense_id":"group","/expenses/:id":"expense","/friends":"friend","/friends/":"friend","/friends/:id":"friend","/friends/:id/":"friend","/dashboard":"dashboard","/dashboard/":"dashboard","/activity":"activity","/activity/admin":"activity","/admin/activity":"activity","_=_":"facebook_login"},initialize:function(){App.expenses=this.expenses=new App.Collections.Expenses,this.balancesSidebar=new App.Views.BalancesSidebar,this.relationshipDetailsView=new App.Views.RelationshipDetails,this.inviteFriends=new App.Views.InviteFriends},activity:function(e){App.dashboard=!1,App.notifications_view=!0,this.relationshipDetailsView.setRelationship(null),$("#left_sidebar a").removeClass("open"),$('#view_links a[href="#/activity"]').addClass("open"),this.scrollToTop(),App.notifications.size()<10?App.notifications.loadMore():App.notifications.fetch({upsert:!0})},dashboard:function(e){App.dashboard=!0,App.notifications_view=!1,this.relationshipDetailsView.setRelationship(null),$("#left_sidebar a").removeClass("open"),$('#view_links a[href="#/dashboard"]').addClass("open"),this.scrollToTop()},all:function(e){this.relationship("all",0,null,e)},facebook_login:function(e){App.relationshipsRouter.navigate("#/dashboard",!0)},expense:function(e,t,n){$.getJSON("/api/v3.0/get_expense/"+e,function(e){e&&e.expense&&e.expense.group_id?App.relationshipsRouter.navigate("#/groups/"+e.expense.group_id,!0):App.relationshipsRouter.navigate("#/all",!0)}).fail(function(){alert("It looks like you don't have permission to view this expense! This could be because you have been removed from the expense, or from the group that the expense was in. Sorry!")})},group:function(e,t,n){void 0==e&&App.groups.first()&&(e=App.groups.first().get("id")),this.relationship("group",e,t,n)},friend:function(e,t,n){void 0==e&&App.friends.first()&&(e=App.friends.first().get("id")),this.relationship("friend",e,t,n)},relationship:function(e,t,n,i){$("#left_sidebar a").removeClass("open"),"all"==e?$('#view_links a[href="#/all"]').addClass("open"):$('#view_links a[href="#/'+e+"s/"+t+'"]').addClass("open"),i?(this.relationshipDetailsView.setActiveExpenseId(parseInt(i)),console.log("find that expenseeeee: "+i)):App.currentExpenseId=null,App.currentRelationship&&App.currentRelationship.get("relationship_type")==e&&App.currentRelationship.get("id")==t||(App.dashboard=!1,App.notifications_view=!1,App.settings.show_settled_bills=!1,App.settings.show_items_not_involving_me=!0,"all"==e?this.relationshipDetailsView.setRelationship(new App.Models.Group({id:-1,name:App.t("all_expenses"),members:[]})):null==t?this.relationshipDetailsView.setRelationship(null):"group"==e?this.relationshipDetailsView.setRelationship(App.groups.get(t)):this.relationshipDetailsView.setRelationship(App.friends.get(t)),this.scrollToTop())},scrollToTop:function(){$(window).scrollTop()>0&&$("html, body").animate({scrollTop:0},250)}}),App.Views.Utils=App.Views.Utils||{},App.Views.Utils._evaluateCostExpression=function(){var INVALID_EXPRESSION_CHARS_REGEXP=/[^\s\d\.\+\-\*\/\(\)]*/g,INVALID_EXPRESSION_NUM_REGEXP=/^0*/g,NUMBER_SPLIT_REGEXP=/((?:\d*\.)?\d+)/;return function(costAsString){var evaluation,expression=costAsString.replace(INVALID_EXPRESSION_CHARS_REGEXP,"");expression=expression.split(NUMBER_SPLIT_REGEXP).map(function(e){return e.replace(INVALID_EXPRESSION_NUM_REGEXP,"")}).join("");try{return evaluation=parseFloat(eval(expression)),isFinite(evaluation)?Math.round(100*evaluation)/100:null}catch(error){}}}(),App.Views.AddBillForm=Backbone.View.extend({el:"#add_bill",events:{"click .input-data":function(e){if($(e.target)&&$(e.target).data("amount")){var t=new App.Models.Expense;t.set("description",$(e.target).data("description")),t.set("cost",safe_parse_float($(e.target).data("amount"))),$(e.target).data("date")&&t.set("date",$(e.target).data("date")),this.setModel(t)}this.editMode||(App.currentRelationship&&App.currentRelationship.id>0?setTimeout("$('#add_bill .description').focus()",250):setTimeout("$('#token-input-add_bill_with').click()",250))},"click .relative-container":"closeModal","click .switch_back":"openDivideABill","click .subview .dismiss":"closeSubview","click .expense_submit":"render","click .category":"chooseCategory","click .currency_code":"chooseCurrency","click .payer":"choosePayer","click .reimburser":"chooseReimburser","click .split":"chooseSplit","click .date.slim-button":"chooseDate","click .notes.slim-button":"addNotes","click .group.slim-button":"chooseGroup","click .submit":"submit","click span.with":function(){$("#token-input-add_bill_with").click()},"change .main_fields .description":"setMainDetails","keyup .main_fields .description":"setMainDetails","change .main_fields .cost":"setMainDetails","keyup .main_fields .cost":"setMainDetails","change .main_fields .cost":"checkForReimbursement","keypress .main_fields input.description":"submitOnEnter","keypress .main_fields input.cost":"submitOnEnter","keypress #token-input-add_bill_with":function(){this.$(".main-window .body").removeClass("inactive")},"paste #token-input-add_bill_with":function(){this.$(".main-window .body").removeClass("inactive")},"change #token-input-add_bill_with":function(){this.$(".main-window .body").removeClass("inactive")}},initialize:function(e){_.bindAll(this,"render","setModel","updateUsers","updateHumanSummary","updateCategory"),this.setModel(e.model)},closeModal:function(e){$(e.target).hasClass("relative-container")&&$(this.el).modal("hide")},openDivideABill:function(e){$("#add_bill").modal("hide"),App.relationshipsRouter.relationshipDetailsView.showModal({target:{hash:"#divide_a_bill"}}),$("#divide_a_bill .input-data").click(),$("#divide_a_bill").modal("show")},submitOnEnter:function(e){13==e.keyCode&&this.submit(e)},setModel:function(e){this.model=e,this.editMode=this.model&&this.model.id,this.editMode||this.model.setDefaultSplit(),this.model.bind("change",this.updateHumanSummary,this),this.model.bind("change:category",this.updateCategory,this),this.model.bind("change:currency_code",this.updateCurrency,this),this.model.bind("change:date",this.updateDate,this),this.model.bind("change:onePayer",this.closePayersWindow,this),this.model.bind("change:group_id",this.updateGroup,this),this.model.bind("change:cost",this.updateCost,this),this.render(),setTimeout("$('.description').trigger('keyup')",300)},render:function(){if(this.tokenizedPromptWith=this.editMode&&this.model.get("group_id"),template=JST["backbone/templates/modals/add-a-bill-form"]({model:this.model,tokenizedPromptWith:this.tokenizedPromptWith,editMode:this.editMode}),$(this.el).html(template),this.editMode)var e=this.model.get("users");var t=[];this.model&&this.model.get("cost")>0&&this.$(".main-window .body").removeClass("inactive"),this.model&&this.model.id?(prepop_members=this.model.get("users"),this.model.get("group_id")||(prepop_members=_.filter(prepop_members,function(e){return e.user_id!=current_user})),t=_.collect(prepop_members,function(e){return{id:e.user_id,name:e.user.first_name+(e.user.last_name?" "+e.user.last_name:"")}})):App.currentRelationship&&App.currentRelationship.isFriend()?t=[{id:App.currentRelationship.id,name:App.currentRelationship.fullName(),email:App.currentRelationship.get("email")}]:App.currentRelationship&&App.currentRelationship.id>0?t=[{group_id:App.currentRelationship.id,name:App.currentRelationship.name()}]:this.model.get("cost")>0?this.$(".main-window .body").removeClass("inactive"):this.$(".main-window .body").addClass("inactive");var n=_.collect(App.friends.models,function(e){return{id:e.id,name:e.name()}}),i=_.collect(App.groups.filter(function(e){return e.isGroup()}),function(e){return{group_id:e.id,name:e.name()}});this.tokenizedPromptWith&&(currentUserName=currentUserObject.first_name,currentUserObject.last_name&&(currentUserName+=" "+currentUserObject.last_name),n=n.concat([{id:current_user,name:currentUserName}])),this.$(".token-input-dropdown-mac").remove(),this.$(".token-input-list-mac").remove();var s=n.concat(i);return _.each(third_party_tokens,function(e){s=s.concat(e)}),$("#add_bill #add_bill_with").tokenInput(s,{theme:"mac",preventDuplicates:!0,prePopulate:t,placeholder:App.t("enter_names_or_emails"),hintText:null,searchDelay:0,animateDropdown:!1,noResultsText:App.t("hit_enter_to_add_person"),resultsLimit:8,allowFreeTagging:!0,allowTabOut:!0,leftPadding:this.tokenizedPromptWith?45:99,onFreeTaggingAdd:function(e){return e.match(/\S+@\S+\.\S+/)?{name:e,email:e}:(new App.Views.CustomPrompt({prompt:App.t("enter_an_email_address_for_NAME",e),data:{name:e},validator:function(e){return!(void 0==e||0==e.length)&&e.match(/\S+@\S+\.\S+/)},success:function(e){this.data.email=e,$("#add_bill #add_bill_with").tokenInput("add",this.data).focus()},failure:function(){$("#add_bill #add_bill_with").focus()}}),{name:"DELETE ME",email:""})},resultsFormatter:function(e){if(e.group_id){var t="<li><p>";return t+="<img src='/assets/fat_rabbit/group-icon.png'>",t+=_.escape(e.name),t+="</p></li>"}if(e.id==current_user){var t="<li><p>";return t+="<img src='"+currentUserObject.picture.small+"'>",t+=_.escape(currentUserObject.first_name),currentUserObject.last_name&&(t+=_.escape(" "+currentUserObject.last_name)),t+="</p></li>"}if(e.id){var n=App.friends.get(e.id),t="<li><p>";return t+="<img src='"+n.get("picture").small+"'>",t+=_.escape(e.name),t+="</p></li>"}var t="<li><p>",i="/assets/fat_rabbit/avatars/50.png";return t+="<img src='"+i+"'>",t+=_.escape(e.name),t+=" ("+_.escape(e.email)+")",t+="</p></li>"},tokenFormatter:function(e){var t;if(e.group_id)t="<li data-group-id='"+e.group_id+"'>",t+="<p><img src='/assets/fat_rabbit/group-icon.png'>",t+=App.t("all_of_GROUP",e.name),t+="</p></li>";else{t="<li ";try{if(t+="data-id='"+e.id+"' ",e.id==current_user)var n=currentUserObject.picture.medium;else var n=App.friends.get(e.id).get("picture").small}catch(i){t+='data-email="'+_.escape(e.email)+'" data-name="'+_.escape(e.name)+'"';var n="/assets/fat_rabbit/avatars/50.png"}t+="><p>",t+="<img src='"+n+"'>";var s=e.name.split(/[ ]+/);t+=s.length>1&&s[1].length>0?_.escape(s[0]+" "+s[1][0]+"."):_.escape(s[0]),t+="</p></li>"}return t},onAdd:this.updateUsers,onDelete:this.updateUsers,onReady:this.updateUsers}),this.setSubview(null),this.$(".description").inputfit({maxSize:20}),this.$(".cost").inputfit({maxSize:36}),this.updateHumanSummary(),this.chooseCategoryWindow&&this.chooseCategoryWindow.remove(),this.chooseCategoryWindow=new App.Views.ChooseCategory({model:this.model}),this.$(".relative-container").append(this.chooseCategoryWindow.el),this.bind("remove",this.chooseCategoryWindow.remove),this.chooseCurrencyWindow&&this.chooseCurrencyWindow.remove(),this.chooseCurrencyWindow=new App.Views.ChooseCurrency({model:this.model}),this.$(".relative-container").append(this.chooseCurrencyWindow.el),this.bind("remove",this.chooseCurrencyWindow.remove),this.chooseDateWindow&&this.chooseDateWindow.remove(),this.chooseDateWindow=new App.Views.ChooseDate({model:this.model}),this.$(".relative-container").append(this.chooseDateWindow.el),this.bind("remove",this.chooseDateWindow.remove),this.addNotesWindow&&this.addNotesWindow.remove(),this.addNotesWindow=new App.Views.AddNotes({model:this.model}),this.$(".relative-container").append(this.addNotesWindow.el),this.bind("remove",this.addNotesWindow.remove),this.addNotesWindow.render(),this.choosePayerWindow&&this.choosePayerWindow.remove(),this.choosePayerWindow=new App.Views.ChoosePerson({model:this.model,field:"onePayer"}),this.$(".relative-container").append(this.choosePayerWindow.el),this.bind("remove",this.choosePayerWindow.remove),this.choosePayerWindow.render(),this.chooseReimburserWindow&&this.chooseReimburserWindow.remove(),this.chooseReimburserWindow=new App.Views.ChoosePerson({model:this.model,field:"oneReimburser"}),this.$(".relative-container").append(this.chooseReimburserWindow.el),this.bind("remove",this.chooseReimburserWindow.remove),this.chooseReimburserWindow.render(),this.chooseSplitWindow&&this.chooseSplitWindow.remove(),this.chooseSplitWindow=new App.Views.ChooseSplit({model:this.model}),this.$(".relative-container").append(this.chooseSplitWindow.el),this.bind("remove",this.chooseSplitWindow.remove),this.chooseSplitWindow.render(),this.chooseGroupWindow&&this.chooseGroupWindow.remove(),this.chooseGroupWindow=new App.Views.ChooseGroup({model:this.model}),this.$(".relative-container").append(this.chooseGroupWindow.el),this.bind("remove",this.chooseGroupWindow.remove),this.chooseGroupWindow.render(),this.editMode&&this.model.set("users",e),this.$("[placeholder]:not(.antiplaceholder)").placeholder(),this},updateUsers:function(){var e,t=this.model,n=this;e=this.tokenizedPromptWith?[]:[{user_id:current_user,user:currentUserObject,saved:!0}],this.$("li.token-input-token-mac").each(function(i,s){s=$(s);var a,r=_.find(t.get("users"),function(e){return e.user_id==s.data("id")});if(s.data("group-id")){var o=App.groups.get(s.data("group-id")),l=o.get("members");n.editMode||(l=_.filter(l,function(e){return e.id!=current_user})),new_users=_.collect(l,function(e){return{user_id:e.id,saved:!0}}),e=e.concat(new_users),t.set("group_id",o.id)}else{if(isNaN(s.data("id"))){var p=s.data("name").split(/[ ]+/),c=p.shift(),u=p.join(" ");a={user_id:"NEW"+Math.random().toString(16).substr(2,6),user:{first_name:c,last_name:u,email:s.data("email"),saved:!1}}}else a={user_id:s.data("id"),saved:!0};r&&(a.paid_share=parseFloat(r.paid_share),a.owed_share=parseFloat(r.owed_share)),e.push(a)}}),e=_.uniq(e,!1,function(e){return e.user_id}),this.model.set("users",e)},updateHumanSummary:function(){if("split"==this.model.get("split")){this.$(".human_summary").text(App.t("paid_by__legacy")).append(" <a class='payer'></a> ").append(_.escape(App.t("and_split"))).append(" <a class='split'></a>").append(_.escape(App.t("and_split__after"))).append(_.escape(App.t("_period",""))).append("<div class='details'></div>"),
"reimbursement"==this.model.get("split_type")&&this.$(".human_summary").text(App.t("money_received_by")).append(" <a class='reimburser'></a> ").append(_.escape(App.t("and_split"))).append(" <a class='split'></a>").append(_.escape(App.t("and_split__after"))).append(_.escape(App.t("_period",""))).append("<div class='details'></div>"),this.$(".human_summary .split").text(App.t("equally").toLowerCase());var e=this.model.get("onePayer");if(e?e==current_user?this.$(".payer").text(App.t("you__legacy")):this.$(".payer").text(this.model.getUser(e).firstNameLastInitial()):this.$(".payer").text(App.t("multiple_people").toLowerCase()),"equal"==this.model.get("split_type"))this.$(".human_summary .details").text("("+App.t("AMOUNT_per_person",App.currencies.print(this.model.equalSplit().standard.toFixed(2),this.model.get("currency_code")))+")");else if("reimbursement"==this.model.get("split_type")){var t=this.model.get("oneReimburser");t&&(t==current_user?this.$(".reimburser").text(App.t("you__legacy")):this.$(".reimburser").text(this.model.getUser(t).firstNameLastInitial()));var n=_.select(this.model.get("reimbursements"),function(e,t){return e}).length;this.$(".human_summary .details").text("("+App.t("AMOUNT_per_person",App.currencies.print(this.model.equalSplit(n).standard.toFixed(2),this.model.get("currency_code")))+")")}else{var i=_.find(this.model.get("users"),function(e){return e.user_id==current_user}),s=App.t(this.model.get("defaultSplitApplied")===!0?"by_default":"unequally").toLowerCase();if(this.$(".human_summary .split").text(s),i){var a=i.paid_share||0,r=i.owed_share||0,o=a-r;0>o?this.$(".human_summary .details").text("("+App.t("you_owe_AMOUNT",App.currencies.print(-o,this.model.get("currency_code")))+")"):o>0?this.$(".human_summary .details").text("("+App.t("you_get_back_AMOUNT",App.currencies.print(o,this.model.get("currency_code")))+")"):this.$(".human_summary .details").text("("+App.t("you_owe_nothing")+")")}else this.$(".human_summary .details").text("("+App.t("you_are_not_involved")+")")}}else if("iou"==this.model.get("split")){var l=_.find(this.model.get("usersList"),function(e){return e.id!=current_user});this.$(".human_summary").html("<a class='split'></a>"),this.$(".human_summary .split").html(App.t("you_owe_PERSON_AMOUNT",l?l.first_name:App.t("fallback_person_name"),App.currencies.print(this.model.get("cost"),this.model.get("currency_code")))+".")}else if("uoi"==this.model.get("split")){var l=_.find(this.model.get("usersList"),function(e){return e.id!=current_user});this.$(".human_summary").html("<a class='split'></a>"),this.$(".human_summary .split").html(App.t("PERSON_owes_you_AMOUNT",l?l.first_name:App.t("fallback_person_name"),App.currencies.print(this.model.get("cost"),this.model.get("currency_code")))+".")}},updateCategory:function(){this.$(".main-window img.category").attr("src",App.categories.get(this.model.get("category").id).get("icon")),this.closeSubview()},updateCurrency:function(){this.$(".main-window span.currency_code").text(App.currencies.unit(this.model.get("currency_code"))),this.closeSubview()},updateCost:function(){isNaN(parseFloat(this.model.get("cost")))||"itemized"!=this.model.get("split_type")&&"reimbursement"!=this.model.get("split_type")||this.$(".main-window .cost").val(this.model.get("cost").toFixed(2))},updateDate:function(){this.$(".main-window .date").text(formattedDate(this.model.get("date"))),this.closeSubview()},updateGroup:function(){this.$(".main-window .group.slim-button").text(App.groups.get(this.model.get("group_id")).shortName()),this.closeSubview()},closePayersWindow:function(){this.model.get("onePayer")&&(this.updateHumanSummary(),this.closeSubview())},setMainDetails:function(){this.model.set({description:this.$(".description").val(),cost:App.Views.Utils._evaluateCostExpression(this.$(".cost").val())})},checkForReimbursement:function(){var e=parseFloat(this.$(".cost").val().replace(/(\,|\$|\\xa3|\\u20ac)/g,""));if(0>e){this.model.set("split_type","reimbursement");var t=this.model.get("onePayer")||current_user;this.model.set("oneReimburser",t),this.model.set("cost",-1*e),this.$(".cost").val((-1*e).toFixed(2))}},chooseCategory:function(){this.model.set("categorySetManually",!0),this.chooseCategoryWindow.render(),this.setSubview(this.chooseCategoryWindow)},chooseCurrency:function(){this.chooseCurrencyWindow.render(),this.setSubview(this.chooseCurrencyWindow)},choosePayer:function(){this.choosePayerWindow.render(),this.setSubview(this.choosePayerWindow)},chooseReimburser:function(){this.chooseReimburserWindow.render(),this.setSubview(this.chooseReimburserWindow)},chooseSplit:function(){this.chooseSplitWindow.render(),this.setSubview(this.chooseSplitWindow)},chooseDate:function(){this.chooseDateWindow.render(),this.setSubview(this.chooseDateWindow)},addNotes:function(){this.setSubview(this.addNotesWindow)},chooseGroup:function(){this.chooseGroupWindow.render(),this.setSubview(this.chooseGroupWindow)},setSubview:function(e){if(null==e||e==this.activeSubview)this.hideSubview(),this.activeSubview=null;else{this.activeSubview&&this.activeSubview.setActive(!1),this.activeSubview=e,this.activeSubview.setActive(!0);var t=this.$(".main-window").width();t+=20,t+=4,t+=this.$(".subview.active").width(),$(this.el).css({width:t,marginLeft:-t/2})}},closeSubview:function(){return this.setSubview(null),!1},hideSubview:function(e){var t=this.$(".main-window").width();t+=2,$(this.el).css({width:t,marginLeft:-t/2}),this.activeSubview&&this.activeSubview.setActive(!1),this.activeSubview=null},submit:function(e){if(!this.saving){if(this.$(".cost").blur(),0==this.model.get("usersList").length)return void alert(App.t("alert_no_users_involved"));if(1!=this.model.get("usersList").length||confirm(App.t("alert_only_one_user_confirmation"))){if(""===$.trim(this.model.get("description")))return alert(App.t("_period",App.t("you_must_enter_a_description")));if(!parseFloat(this.model.get("cost")))return alert(App.t("_period",App.t("you_must_enter_an_amount")));expense_hash=this.model.toApiJSON();var t=App.formDataSupported&&$("#bill_file").val();if(t){var n=new FormData;if(_.each(expense_hash,function(e,t){e&&e.getMonth?n.append(t,e.toJSON()):n.append(t,e)}),$("#bill_file").val())if(document.getElementById("bill_file").files[0].size>2048e3){if(!confirm(App.t("alert_file_size_exceeded_confirmation")))return!1}else n.append("receipt",document.getElementById("bill_file").files[0]);expense_hash=n}App.showLoader(App.t("saving"));var i=this;this.saving=!0,$.ajax({url:this.editMode?"/api/v3.0/update_expense/"+this.model.id:"/api/v3.0/create_expense",data:expense_hash,dataType:"json",type:"POST",processData:!t,contentType:t?!1:"application/x-www-form-urlencoded",success:function(e,t){var n=null;"success"==t&&(e.errors&&_.size(e.errors)>0?n=_.reduce(e.errors,function(e,t,n){return e+_.reduce(t,function(e,t){return e+"\n- "+("base"==n?"":$.capitalize(n)+" ")+t},"")},App.t("these_errors_occurred")):(_.each(e.expenses,function(e){var t;App.currentRelationship&&(t="group"==App.currentRelationship.get("relationship_type")?App.currentRelationship.get("id")==e.group_id||-1==App.currentRelationship.get("id"):null==e.group_id&&_.indexOf(_.pluck(e.users,"user_id"),App.currentRelationship.id)>=0,i.editMode&&(App.currentRelationship&&App.currentRelationship.adjustBalances("subtract",App.expenses.get(i.model.id)),App.expenses.remove(App.expenses.get(i.model.id),{silent:t})),t&&(App.currentRelationship&&App.currentRelationship.adjustBalances("add",new App.Models.Expense(e)),App.expenses.add(e),i.editMode||$("#expense-"+e.id+(App.settings.show_settled_bills?"":":not(.settled)")).hide().slideDown())),Backbone.Events.trigger("data:expenseUpdated",e)}),App.currentRelationship&&App.currentRelationship.id>0?App.currentRelationship.fetch():(App.groups.fetch({url:"/api/v3.0/get_groups"}),App.friends.fetch({url:"/api/v3.0/get_friends"})))),n||"success"!=t?(i.saving=!1,App.closeLoader({type:"error"}),alert(n?n:t)):($("#add_bill").modal("hide"),setTimeout(function(){i.saving=!1},500),App.closeLoader({type:"success",message:App.t("expense_added")}))},error:function(e){i.saving=!1,alert(App.t("general_unknown_error")),App.closeLoader({type:"error"})}})}}}}),App.Views.AddBillSubview=Backbone.View.extend({tagName:"div",setActive:function(e){e?$(this.el).addClass("active"):$(this.el).removeClass("active")}}),App.Views.ChooseCategory=App.Views.AddBillSubview.extend({tagName:"div",events:{"click li":"setCategory"},initialize:function(e){$(this.el).addClass("subview").attr("id","choose_category"),_.bindAll(this,"render","setCategory")},render:function(){template=JST["backbone/templates/modals/choose-category"]({selected:App.categories.get(this.model.get("category").id)}),$(this.el).html(template)},setCategory:function(e){var t=$(e.currentTarget);t.find("ul").size()>0&&(t=t.find("li").filter(function(e,t){return"Other"==$.trim($(t).text())||"General"==$.trim($(t).text())}).first()),this.$("li").removeClass("selected"),t.addClass("selected"),t.parents("li").addClass("selected"),this.model.set("category",{id:t.data("id")}),e.preventDefault(),e.stopImmediatePropagation()}}),App.Views.ChooseCurrency=App.Views.AddBillSubview.extend({tagName:"div",events:{"click li":"setCurrency"},initialize:function(e){$(this.el).addClass("subview").attr("id","choose_currency"),_.bindAll(this,"render","setCurrency")},render:function(){$(this.el).html(JST["backbone/templates/modals/choose-currency"]({currency_code:this.model.get("currency_code")}))},setCurrency:function(e){this.$("li").removeClass("selected"),$(e.currentTarget).addClass("selected"),this.model.set("currency_code",$(e.currentTarget).data("currency-code"))}}),App.Views.ChooseDate=App.Views.AddBillSubview.extend({tagName:"div",events:{"changeDate #datepicker":"setDate","change #repeat_interval":"setRepeats","change #email_reminder_in_advance":"setRepeats"},initialize:function(e){$(this.el).addClass("subview").attr("id","choose_date"),_.bindAll(this,"render","setDate"),null!=e.showRecurringOptions?this.showRecurringOptions=e.showRecurringOptions:this.showRecurringOptions=!0},render:function(){var e=new Date(this.model.get("date"));(!e||isNaN(e))&&(e=Date.fromISO(this.model.get("date"))),$(this.el).html(JST["backbone/templates/modals/choose-date"]({date:e,repeat_interval:this.model.get("repeat_interval"),email_reminder_in_advance:this.model.get("email_reminder_in_advance"),showRecurringOptions:this.showRecurringOptions})),this.$("#datepicker").datepicker({inPlace:!0});try{$.modernizeSelects()}catch(t){}},setDate:function(e){this.model.set("date",e.date)},setRepeats:function(e){this.model.set({repeats:"never"!=this.$("#repeat_interval").val(),repeat_interval:this.$("#repeat_interval").val(),email_reminder:"-1"!=this.$("#email_reminder_in_advance").val(),email_reminder_in_advance:this.$("#email_reminder_in_advance").val()})}}),App.Views.AddNotes=App.Views.AddBillSubview.extend({tagName:"div",events:{"keyup input[type=text]":"setDescription","keyup textarea":"setNotes"},initialize:function(e){$(this.el).addClass("subview").attr("id","add_notes"),_.bindAll(this,"render","setNotes")},render:function(){var e=this.model.get("details");if("split"===this.model.get("split")&&"itemized"===this.model.get("split_type")){console.log("relax, marshall, this code is running");var t=e.split("\n\r\n");console.log(t),console.log(e),t.pop(),e=t.join("\n\r\n")}$(this.el).html(JST["backbone/templates/modals/add-notes"]({payment:this.model.isPayment(),description:this.model.get("description"),notes:e}))},setDescription:function(){this.model.set("description",this.$("input[type=text]").val())},setNotes:function(){this.model.set("details",this.$("textarea").val())}}),App.Views.ChoosePerson=App.Views.AddBillSubview.extend({tagName:"div",events:{"click li.main_payer":"updateOnePayer","change input":"updateMultiplePeopleShares","keyup input":"updateMultiplePeopleShares"},initialize:function(e){this.field=e.field,$(this.el).addClass("subview").attr("id","choose_payer"),this.model.bind("change:usersList change:onePayer",this.render,this),this.model.bind("change:cost",this.updateMultiplePeopleShares,this),_.bindAll(this,"render","updateOnePayer","updateMultiplePeopleShares")},render:function(){$(this.el).html(JST["backbone/templates/modals/choose-payer"]({field:this.field,payment:this.model.isPayment(),users:this.model.get("usersList"),userShares:this.model.get("users"),active:this.model.get(this.field),eachPaidOwnShare:this.model.get("eachPaidOwnShare"),currency_symbol:App.currencies.unit(this.model.get("currency_code"))}))},updateOnePayer:function(e){e&&e.currentTarget&&(this.$("li").removeClass("selected"),$(e.currentTarget).addClass("selected"),this.model.set(this.field,$(e.currentTarget).data("id")))},updateMultiplePeopleShares:function(e){if(null==this.model.get("onePayer")){var t=this.model;if(this.$("input[type=checkbox]").is(":checked"))t.set("eachPaidOwnShare",!0),this.$("input[type=text]").attr("disabled",!0).each(function(e){var n=t.getShare($(this).data("id")).owed_share;isNaN(n)&&(n=0),$(this).val(n.toFixed(2))});else{this.model.set("eachPaidOwnShare",!1);var n=t.get("users");this.$("input[type=text]").attr("disabled",!1).each(function(e){var t=$(this).data("id"),i=_.find(n,function(e){return e.user_id==parseInt(t)||e.user_id==t});i&&(i.paid_share=parseFloat($(this).val())||0)}),t.set("users",n),this.model.trigger("change")}}}}),App.Views.ChooseSplit=App.Views.AddBillSubview.extend({tagName:"div",events:{"click .slim-button":"updateSlimButton","click .split_button":"changeForm","keyup .unequal input":"updateUnequalData","change .unequal input":"updateUnequalData","click .equal .person":"togglePerson","click .reimbursement .person":"togglePerson","keyup .percent input":"updatePercentData","change .percent input":"updatePercentData","keyup .shares input":"updateShareData","change .shares input":"updateShareData","keyup .adjustment input":"updateAdjustmentData","change .adjustment input":"updateAdjustmentData","keyup #itemized_tip .tip_amount":"updateRawTip","keyup #itemized_tax .tax_amount":"updateRawTax","click td.itemized_item_selector":"toggleItemizedItem","keyup .itemized_item input[type=text]":"updateItemizedData","keyup #itemized_tax .tax_percent":"updateItemizedData","keyup #itemized_tip .tip_percent":"updateItemizedData","click .itemized .initials":"updateItemizedColumn","change .row_selector":"toggleItemizedRow"},initialize:function(e){$(this.el).addClass("subview").attr("id","choose_split"),this.model.bind("change:usersList change:cost change:split_type",this.render,this),_.bindAll(this,"render")},render:function(e,t,n){n&&n.itemized||($(this.el).html(JST["backbone/templates/modals/choose-split"]({users:this.model.get("usersList"),userShares:this.model.get("users"),cost:this.model.get("cost"),currency_code:this.model.get("currency_code"),currency_symbol:App.currencies.unit(this.model.get("currency_code")),model:this.model})),this.$(".slim-button[data-split-type="+this.model.get("split")+"]").addClass("selected"),"split"==this.model.get("split")&&this.$("#split_method button[data-split-subtype="+this.model.get("split_type")+"]").click(),this.$("[rel=tooltip]").tooltip({placement:"top"}))},updateSlimButton:function(e){this.$(".slim-button").removeClass("selected"),$(e.target).addClass("selected"),this.model.set("split",$(e.target).data("split-type")),"itemized"==this.model.get("split_type")&&"split"==this.model.get("split")?$(this.el).addClass("itemized_form"):$(this.el).removeClass("itemized_form"),this.render()},togglePerson:function(e){var t=$(e.currentTarget),n=$(t).find("input[type=checkbox]");$(t).toggleClass("nope"),n.attr("checked",!$(t).hasClass("nope")),"equal"==this.model.get("split_type")?this.updateEqualData():"reimbursement"==this.model.get("split_type")&&this.updateReimbursementData()},changeForm:function(e){var t=$(e.currentTarget).data("split-subtype"),n="split"!=this.model.get("split")||this.model.get("split_type")!=t;if(this.$(".split_method").hide(),this.$("."+t).show(),"itemized"==t?($(this.el).addClass("itemized_form"),this.updateItemizedData()):$(this.el).removeClass("itemized_form"),n)if(this.model.set({split:"split",split_type:t},{silent:!0}),$(".tooltip").hide(),"equal"==t)this.updateEqualData();else if("unequal"==t)this.updateUnequalData();else if("percent"==t)this.updatePercentData();else if("shares"==t)this.updateShareData();else if("adjustment"==t)this.updateAdjustmentData();else if("reimbursement"==t){var i=this.model.get("onePayer")||current_user;this.model.set("oneReimburser",i),this.model.get("cost")<0&&this.model.set("cost",-1*this.model.get("cost")),this.updateReimbursementData()}else"itemized"==t?this.updateItemizedData():alert("Invalid split type! You should email mgod@splitwise.com and tell him he messed up :)")},updateEqualData:function(){var e=this.$(".equal .person"),t={};_.each(e,function(e){t[$(e).data("id")]=$(e).find("input[type=checkbox]").is(":checked")}),this.model.set("equal_users",t),_.each(e,function(e){var t=this.model.getShare($(e).data("id")).owed_share;$(e).find(".amount").text(App.currencies.print(t,this.model.get("currency_code")))},this)},updateUnequalData:function(){var e=this.$(".unequal .person"),t={};_.each(e,function(e){var n=safe_parse_float($(e).find("input[type=text]").val());t[$(e).data("id")]=n}),this.model.set("unequal_amounts",t);var n=_.reduce(t,function(e,t){return e+t},0);this.$(".unequal .owed_total").text(App.currencies.print(n,this.model.get("currency_code")));var i=parseFloat(this.model.get("cost"))-n;this.$(".unequal .owed_remaining").text(App.t("AMOUNT_left",App.currencies.print(i,this.model.get("currency_code"))))},updatePercentData:function(){var e=this.$(".percent .person"),t={};_.each(e,function(e){t[$(e).data("id")]=safe_parse_float($(e).find("input[type=text]").val())/100}),this.model.set("percents",t);var n=_.reduce(t,function(e,t){return e+100*t},0);this.$(".percent .owed_total").text(n.toFixed(2)+"%"),this.$(".percent .owed_remaining").text(App.t("PERCENT_left",(100-n).toFixed(2)))},updateShareData:function(){var e=this.$(".shares .person"),t={};_.each(e,function(e){t[$(e).data("id")]=safe_parse_float($(e).find("input[type=text]").val())}),this.model.set("shares",t),_.each(e,function(e){var t=this.model.getShare($(e).data("id")).owed_share;$(e).find(".subsummary").text(App.t("total_share_AMOUNT",App.currencies.print(t,this.model.get("currency_code"))))},this)},updateAdjustmentData:function(){var e=this.$(".adjustment .person"),t={};_.each(e,function(e){t[$(e).data("id")]=safe_parse_float($(e).find("input[type=text]").val())}),this.model.set("adjustments",t),_.each(e,function(e){var t=this.model.getShare($(e).data("id")).owed_share;$(e).find(".subsummary").text(App.t("total_share_AMOUNT",App.currencies.print(t,this.model.get("currency_code"))))},this)},updateReimbursementData:function(){var e=this.$(".reimbursement .person"),t={};_.each(e,function(e){t[$(e).data("id")]=$(e).find("input[type=checkbox]").is(":checked")}),this.model.set("reimbursements",t),_.each(e,function(e){var t=this.model.getShare($(e).data("id")).paid_share;$(e).find(".amount").text(App.currencies.print(t,this.model.get("currency_code")))},this)},toggleItemizedItem:function(e){var t=$(e.currentTarget);t.hasClass("selected")?(t.addClass("unselected"),t.removeClass("selected")):(t.addClass("selected"),t.removeClass("unselected")),this.updateItemizedData()},toggleItemizedRow:function(e){var t=$(e.currentTarget).parent().parent().find(".itemized_item_selector");$(e.currentTarget).is(":checked")?(t.addClass("selected"),t.removeClass("unselected")):(t.addClass("unselected"),t.removeClass("selected")),this.updateItemizedData()},updateRawTip:function(e){var t=$(e.currentTarget).data("id"),n=this.model.get("items").tip.users[t],i=safe_parse_float($(e.currentTarget).val());n!=i&&(this.$(".tip_percent").val(""),this.updateItemizedData())},updateRawTax:function(e){var t=$(e.currentTarget).data("id"),n=this.model.get("items").tax.users[t],i=safe_parse_float($(e.currentTarget).val());n!=i&&(this.$(".tax_percent").val(""),this.updateItemizedData())},updateItemizedColumn:function(e){user_id=$(e.currentTarget).data("id");var t=$(".itemized td.cost[data-id="+user_id+"]");t.hasClass("selected")?(t.addClass("unselected"),t.removeClass("selected")):(t.addClass("selected"),t.removeClass("unselected")),this.updateItemizedData()},addItemizedEntry:function(){var e=JST["backbone/templates/modals/itemized-item"]({users:this.model.get("usersList"),item:null});this.$("#itemized_items #item_holder").append(e)},updateItemizedData:function(){var e={},t={},n=[],i=this;_.each(this.model.get("usersList"),function(t){e[t.id]=0}),_.each(this.$("#item_holder tr"),function(t){var i=safe_parse_float($(".amount",$(t)).val());i=Math.round(100*i)/100;var s=safe_divide_evenly_amounts(i,$(".itemized_item_selector.selected",$(t)).length),a={},r=[];_.each($(".itemized_item_selector.selected",$(t)),function(t,n){var i=$(t).data("id");$(t).html(s[n].toFixed(2)),a[i]=s[n],e[i]+=s[n],r.push(i)}),$("td.unselected",$(t)).html("");var o={};o.cost=$(".amount",$(t)).val(),o.description=$(".item_name",$(t)).val(),o.shares=a,o.users=r,n.push(o)});var s=parseFloat($("#itemized_tax .tax_percent").val().replace(/%/,"")),a=!isNaN(s);s=isNaN(s)?0:Math.round(100*s)/100;var r=parseFloat($("#itemized_tip .tip_percent").val().replace(/%/,"")),o=!isNaN(r);r=isNaN(r)?0:Math.round(100*r)/100;var l=safe_sum(e),p={total:$("#itemized_tip .tip_percent").val(),users:{}},c={total:$("#itemized_tax .tax_percent").val(),users:{}},u={};_.each(e,function(e,t){var n=$("#itemized_total .cost[data-id="+t+"]");$(n).html(e.toFixed(2));var d=i.$(".tax_amount[data-id="+t+"]");if(1==a){var h=Math.round(e*s)/100,f=$("#itemized_tax .tax_percent").val().indexOf("%")>=0;!f&&l>0&&(h=Math.round(s*e*100/l)/100),d.val(h.toFixed(2)),c.users[t]=h}else c.users[t]=Math.round(100*safe_parse_float(d.val()))/100;var m=i.$(".tip_amount[data-id="+t+"]");if(1==o){var g=Math.round(e*r)/100,_=$("#itemized_tip .tip_percent").val().indexOf("%")>=0;!_&&l>0&&(g=Math.round(r*e*100/l)/100),m.val(g.toFixed(2)),p.users[t]=g}else p.users[t]=Math.round(100*safe_parse_float(m.val()))/100;var b=e+c.users[t]+p.users[t];$("#itemized_grand_total .grand_total[data-id="+t+"]").html(b.toFixed(2)),u[t]=b});var d=_.last(n);d&&0==d.cost&&""==d.description?n.pop():this.addItemizedEntry(),this.$("#itemized_total .amount_column").html(safe_sum(e).toFixed(2)),this.$("#itemized_grand_total .amount_column").html(safe_sum(u).toFixed(2)),t.items=n,t.subtotals=e,t.tax=c,t.tip=p,t.totals=u,i.model.set("items",t)},updateMultiplePeopleShares:function(e){}}),App.Views.ChooseGroup=App.Views.AddBillSubview.extend({tagName:"div",events:{"click li":"setGroupId"},initialize:function(e){$(this.el).addClass("subview").attr("id","choose_group"),_.bindAll(this,"render","setGroupId")},render:function(){$(this.el).html(JST["backbone/templates/modals/choose-group"]({group_id:this.model.get("group_id")}))},setGroupId:function(e){this.$("li").removeClass("selected"),$(e.currentTarget).addClass("selected"),this.model.set("group_id",$(e.currentTarget).data("id"))}}),App.Views.SettleUpForm=Backbone.View.extend({el:"#settle_up_form",events:{"click .input-data":function(){var e=this.$(".input-data").data("expenseId");if(e){var t=$.extend(!0,{},App.expenses.get(e).attributes);e=new App.Models.Expense(t),this.setModel(e)}else{var n=this.$(".input-data").data("from"),i=this.$(".input-data").data("to"),s=this.$(".input-data").data("amount"),a=this.$(".input-data").data("currency_code"),r=this.$(".input-data").data("group_id");if(n&&i&&s&&a){var o=new App.Models.Expense({split:"payment",payment:!0,description:"Payment",cost:safe_parse_float(s),currency_code:a});r&&o.set("group_id",r),this.setModel(o),o.set("onePayer",n),o.set("onePayee",i)}}},"click .relative-container":"closeModal","click .subview .dismiss":"closeSubview","click .expense_submit":"render","click .overlay button":"chooseTransactionMethod","click .currency_code":"chooseCurrency","click .date.slim-button":"chooseDate","click .notes.slim-button":"addNotes","click .group.slim-button":"chooseGroup","click .submit":"submit","click .payer":"choosePayer","click .payee":"choosePayee","change .cost":"setMainDetails","keyup .cost":"setMainDetails","keypress input.cost":"submitOnEnter"},initialize:function(e){_.bindAll(this,"render","setModel"),this.render()},closeModal:function(e){$(e.target).hasClass("relative-container")&&$(this.el).modal("hide")},submitOnEnter:function(e){13==e.keyCode&&this.submit(e)},setModel:function(e){this.model=e,this.editMode=!this.model.isNew(),e.get("onePayee")||e.guessPayee();var t=[{user_id:current_user,user:currentUserObject,saved:!0}];App.currentRelationship&&App.currentRelationship.isGroup()?t=_.collect(App.currentRelationship.get("members"),function(e){return{user_id:e.id,saved:!0}}):App.currentRelationship&&App.currentRelationship.isFriend()?t.push({user_id:App.currentRelationship.id,saved:!0}):_.each(App.friends.models,function(e){t.push({user_id:e.id,saved:!0})}),t=_.uniq(t,!1,function(e){return e.user_id}),this.model.set("users",t),this.model.bind("change:transaction_method change:onePayer change:onePayee",this.updateHumanSummary,this),this.model.bind("change:currency_code",this.updateCurrency,this),this.model.bind("change:date",this.updateDate,this),this.model.bind("change:group_id",this.updateGroup,this),this.model.bind("change:onePayer change:onePayee",this.closeSubview,this),this.model.bind("change:onePayer change:onePayee",this.guessCost,this),this.render()},render:function(){return $(this.el).html(JST["backbone/templates/modals/settle-up-form"]({model:this.model,editMode:this.editMode})),this.setSubview(null),this.model?(this.choosePayerWindow&&this.choosePayerWindow.remove(),this.choosePayerWindow=new App.Views.ChoosePerson({model:this.model,field:"onePayer"}),this.$(".relative-container").append(this.choosePayerWindow.el),this.bind("remove",this.choosePayerWindow.remove),this.choosePayerWindow.render(),this.choosePayeeWindow&&this.choosePayeeWindow.remove(),this.choosePayeeWindow=new App.Views.ChoosePerson({model:this.model,field:"onePayee"}),this.$(".relative-container").append(this.choosePayeeWindow.el),this.bind("remove",this.choosePayeeWindow.remove),this.choosePayeeWindow.render(),this.chooseCurrencyWindow&&this.chooseCurrencyWindow.remove(),this.chooseCurrencyWindow=new App.Views.ChooseCurrency({model:this.model}),this.$(".relative-container").append(this.chooseCurrencyWindow.el),this.bind("remove",this.chooseCurrencyWindow.remove),this.chooseDateWindow&&this.chooseDateWindow.remove(),this.chooseDateWindow=new App.Views.ChooseDate({model:this.model,showRecurringOptions:!1}),this.$(".relative-container").append(this.chooseDateWindow.el),this.bind("remove",this.chooseDateWindow.remove),this.addNotesWindow&&this.addNotesWindow.remove(),this.addNotesWindow=new App.Views.AddNotes({model:this.model}),this.$(".relative-container").append(this.addNotesWindow.el),this.bind("remove",this.addNotesWindow.remove),this.addNotesWindow.render(),this.chooseGroupWindow&&this.chooseGroupWindow.remove(),this.chooseGroupWindow=new App.Views.ChooseGroup({model:this.model}),this.$(".relative-container").append(this.chooseGroupWindow.el),this.bind("remove",this.chooseGroupWindow.remove),this.chooseGroupWindow.render(),this):this},guessCost:function(){if(!this.model.id)if(App.currentRelationship&&App.currentRelationship.isGroup()){var e=this.model,t=_.find(App.currentRelationship.repayments(),function(t){return t.from==e.get("onePayer")&&t.to==e.get("onePayee")});t&&(this.model.set({cost:parseFloat(t.amount),currency_code:t.currency_code}),this.$(".main-window .cost").val(this.model.get("cost").toFixed(2)))}else if(this.model.get("onePayer")==current_user){var n=App.friends.get(this.model.get("onePayee"));n&&n.mainBalance().amount<0&&(this.model.set({cost:Math.abs(n.mainBalance().amount),currency_code:n.mainBalance().currency_code}),this.$(".main-window .cost").val(this.model.get("cost").toFixed(2)))}else if(this.model.get("onePayee")==current_user){var n=App.friends.get(this.model.get("onePayer"));n&&n.mainBalance().amount>0&&(this.model.set({cost:parseFloat(n.mainBalance().amount),currency_code:n.mainBalance().currency_code}),this.$(".main-window .cost").val(this.model.get("cost").toFixed(2)))}},updateHumanSummary:function(){if(["paypal","venmo","wavy","payment_demo"].indexOf(this.model.get("transaction_method"))>-1){var e=this.model.payer().id==current_user?"are_sending__legacy":"is_sending__legacy",t=this.$("footer button.submit");this.$(".transaction_human_summary").text(App.t(e)),t.text(App.t("next")),"venmo"==this.model.get("transaction_method")?t.removeClass("btn-mint btn-orange").addClass("btn-venmo"):t.removeClass("btn-mint btn-venmo").addClass("btn-orange")}else this.$(".transaction_human_summary").text(App.t("paid__legacy"));this.$("a.payer").text(this.model.payer().firstNameLastInitial()),this.$("a.payee").text(this.model.payee().firstNameLastInitial()),"en"==currentUserObject.locale&&(this.model.payer().id==current_user&&this.$("a.payer").text("You"),this.model.payee().id==current_user&&this.$("a.payee").text("you")),this.$("img.avatar.payer").attr("src",this.model.payer().get("picture").medium),this.$("img.avatar.payee").attr("src",this.model.payee().get("picture").medium)},updateCurrency:function(){this.$(".main-window span.currency_code").text(App.currencies.unit(this.model.get("currency_code"))),this.closeSubview()},updateDate:function(){this.$(".main-window .date").text(formattedDate(this.model.get("date"))),this.closeSubview()},updateGroup:function(){this.$(".main-window .group.slim-button").text(App.groups.get(this.model.get("group_id")).shortName()),this.closeSubview()},setMainDetails:function(){var e=App.Views.Utils._evaluateCostExpression(this.$(".cost").val().replace(/(\,|\$|\\xa3|\\u20ac)/g,""));this.model.set("cost",isNaN(e)?null:e);var t=this.$(".cost").val().length;this.$(".cost").val().indexOf(".")>0&&(t-=1),this.$(".cost").attr("size",Math.max(t,3))},chooseTransactionMethod:function(e){var t=$(e.currentTarget).data("transaction-method"),n=App.metadata.features[t];"offline"==t||n&&n.enabled?(this.model.set("transaction_method",t),this.$(".overlay").fadeOut(250)):(alert(n.behavior.alert_dialog.content),n.behavior.alert_dialog.url&&window.open(n.behavior.alert_dialog.url))},choosePayer:function(){this.choosePayerWindow.render(),this.setSubview(this.choosePayerWindow)},choosePayee:function(){this.choosePayeeWindow.render(),this.setSubview(this.choosePayeeWindow)},chooseCurrency:function(){this.chooseCurrencyWindow.render(),this.setSubview(this.chooseCurrencyWindow)},chooseDate:function(){this.chooseDateWindow.render(),this.setSubview(this.chooseDateWindow)},addNotes:function(){this.setSubview(this.addNotesWindow)},chooseGroup:function(){this.chooseGroupWindow.render(),this.setSubview(this.chooseGroupWindow)},setSubview:function(e){if(null==e||e==this.activeSubview)this.hideSubview(),this.activeSubview=null;else{this.activeSubview&&this.activeSubview.setActive(!1),this.activeSubview=e,this.activeSubview.setActive(!0);var t=this.$(".main-window").width();t+=20,t+=4,t+=this.$(".subview.active").width(),$(this.el).css({width:t,marginLeft:-t/2})}},closeSubview:function(){return this.setSubview(null),!1},hideSubview:function(e){var t=this.$(".main-window").width();t+=2,$(this.el).css({width:t,marginLeft:-t/2}),this.activeSubview&&this.activeSubview.setActive(!1),this.activeSubview=null},openWindowForPayment:function(){var e=void 0!==window.screenTop?window.screenTop:window.screenY,t=void 0!==window.screenLeft?window.screenLeft:window.screenX,n=600,i=500,s=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,r=s/2-n/2+e,o=a/2-i/2+t,l=window.open("/loading","_blank","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height="+n+",width="+i+",top="+r+",left="+o);return l},validForSubmit:function(){if(this.saving)return!1;if(0==this.model.get("usersList").length)return alert(App.t("alert_no_users_involved")),!1;if(1==this.model.get("usersList").length&&!confirm(App.t("alert_only_one_user_confirmation")))return!1;if(!this.model.get("cost")>0)return alert(App.t("_period",App.t("you_must_enter_an_amount"))),!1;if("venmo"==this.model.get("transaction_method")){if("USD"!=this.model.get("currency_code"))return alert("Venmo only accepts USD, sorry!"),!1;if(this.model.payer().id!=current_user)return alert(App.t("alert_request_via_venmo_unsupported")),!1}return!0},handleApiError:function(e){this.saving=!1,alert(e),App.closeLoader({type:"error"})},setSavingState:function(){
App.showLoader(App.t("saving")),this.saving=!0},resetSavingState:function(){this.saving=!1},resetSavingStateAndClose:function(){var e=this;$("#settle_up_form").modal("hide"),setTimeout(function(){e.resetSavingState()},500),App.closeLoader({type:"success",message:App.t("success")})},formatErrors:function(e){return 0===_.size(e)?App.t("general_unknown_error"):_.reduce(e,function(e,t,n){return e+_.reduce(t,function(e,t){return e+"\n- "+("base"==n?"":$.capitalize(n)+" ")+t},"")},App.t("these_errors_occurred"))},updateCurrentRelationship:function(e){var t=this;_.each(e,function(e){if(App.currentRelationship){if("group"==App.currentRelationship.get("relationship_type"))var n=App.currentRelationship.get("id")==e.group_id||-1==App.currentRelationship.get("id");else var n=isNaN(parseInt(e.group_id));t.editMode&&(App.currentRelationship&&App.currentRelationship.adjustBalances("subtract",App.expenses.get(t.model.id)),App.expenses.remove(App.expenses.get(t.model.id),{silent:n})),n&&(App.currentRelationship&&(App.currentRelationship.isFriend()&&"debt_consolidation"==e.creation_method||App.currentRelationship.adjustBalances("add",new App.Models.Expense(e))),App.expenses.add(e),t.editMode||$("#expense-"+e.id+(App.settings.show_settled_bills?"":":not(.settled)")).hide().slideDown())}}),App.currentRelationship&&App.currentRelationship.id>0?App.currentRelationship.fetch():(App.groups.fetch({url:"/api/v3.0/get_groups"}),App.friends.fetch({url:"/api/v3.0/get_friends"}))},paymentWindowCompleteHandler:function(e){var t=this;clearInterval(t.paymentCompletionCallbackInterval),clearInterval(t.paymentCompletionClosedInterval),t.saving||(t.setSavingState(),$.ajax({url:"/api/v3.0/prepayments/"+t.prepaymentId,data:e,dataType:"json",type:"PUT",success:function(e){"success"==e.result?(t.updateCurrentRelationship(e.expenses),t.resetSavingStateAndClose()):(t.resetSavingState(),App.closeLoader({type:"error",message:App.t("canceled")}))},error:function(e){var n=e.responseJSON,i=t.formatErrors(n.errors);t.handleApiError(i)}}))},submit:function(e){if(this.validForSubmit()){var t=this,n=this.model.toApiJSON();if(n.settle_all=!0,App.formDataSupported){var i=new FormData;if(_.each(n,function(e,t){e&&e.getMonth?i.append(t,e.toJSON()):i.append(t,e)}),$("#bill_file").val())if(document.getElementById("bill_file").files[0].size>2048e3){if(!confirm(App.t("alert_file_size_exceeded_confirmation")))return!1}else i.append("receipt",document.getElementById("bill_file").files[0]);n=i}var s="paypal"==this.model.get("transaction_method")||"venmo"==this.model.get("transaction_method")||"wavy"==this.model.get("transaction_method")||"payment_demo"==this.model.get("transaction_method");if(s&&!this.editMode)return t.paymentCompletionWindow&&!t.paymentCompletionWindow.closed&&t.paymentCompletionWindow.close(),t.paymentCompletionWindow=this.openWindowForPayment(),void $.ajax({url:"/api/v3.0/prepayments",data:n,dataType:"json",type:"POST",processData:!App.formDataSupported,contentType:App.formDataSupported?!1:"application/x-www-form-urlencoded",success:function(e){if(_.size(e.errors)>0||!e.prepayment){t.paymentCompletionWindow.close();var n=t.formatErrors(e.errors);return void setTimeout(function(){t.handleApiError(n)},10)}var i=t.paymentCompletionWindow;window.addEventListener("message",function(n){return"https://secure.splitwise.com"!=n.origin&&"https://www.splitwise.com"!=n.origin&&n.origin+"/"!=STRINGS.Url||n.source!=i||"hi_there"==n.data?void 0:"ready_for_url"==n.data?void(i.location.href=e.prepayment.webview.url):void t.paymentWindowCompleteHandler({response:{flow:"webview",result:"success"},service_data:n.data})},!1),t.prepaymentId=e.prepayment.id,clearInterval(t.paymentCompletionCallbackInterval),t.paymentCompletionCallbackInterval=setInterval(function(){try{t.paymentCompletionWindow.postMessage("hi_there","*")}catch(e){}},200),clearInterval(t.paymentCompletionClosedInterval),t.paymentCompletionClosedInterval=setInterval(function(){t.paymentCompletionWindow.closed!==!1&&(clearInterval(t.paymentCompletionClosedInterval),t.paymentWindowCompleteHandler({response:{flow:"webview",result:"canceled"}}))},100)},error:function(e){t.paymentCompletionWindow.close();var n=e.responseJSON,i=t.formatErrors(n.errors);setTimeout(function(){t.handleApiError(i)},10)}});this.setSavingState(),$.ajax({url:this.editMode?"/api/v3.0/update_expense/"+this.model.id:"/api/v3.0/create_expense",data:n,dataType:"json",type:"POST",processData:!App.formDataSupported,contentType:App.formDataSupported?!1:"application/x-www-form-urlencoded",success:function(e,n){if("success"===n&&0===_.size(e.errors))t.updateCurrentRelationship(e.expenses),t.resetSavingStateAndClose();else{var i=t.formatErrors(e.errors);t.handleApiError(i)}},error:function(e){t.handleApiError(App.t("general_unknown_error"))}})}}}),TranslationString.prototype={bold:function(e){return this.wrapWithTag("strong",e),this},wrapWithTag:function(e,t){return t=t?" "+this._expandAttributes(t):"",this._addToLeft("<"+e+t+">"),this._addToRight("</"+e+">"),this},breakBefore:function(){return this._addBreak("before"),this},breakAfter:function(){return this._addBreak("after"),this},toString:function(){return this._leftTags+_.escape(this._content)+this._rightTags},_addToLeft:function(e){this._leftTags=e+this._leftTags},_addToRight:function(e){this._rightTags=this._rightTags+e},_expandAttributes:function(e){return _.reduce(e,function(e,t,n){return t=t.replace(/\"/g,"'"),e+" "+n+'="'+t+'"'},"")},_addBreak:function(e){this["after"===e.toLowerCase()?"_addToRight":"_addToLeft"]("<br />")}},!function(e){e(function(){"use strict";e.support.transition=function(){var e=function(){var e,t=document.createElement("bootstrap"),n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};for(e in n)if(void 0!==t.style[e])return n[e]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function n(){i.trigger("closed").remove()}var i,s=e(this),a=s.attr("data-target");a||(a=s.attr("href"),a=a&&a.replace(/.*(?=#[^\s]*$)/,"")),i=e(a),t&&t.preventDefault(),i.length||(i=s.hasClass("alert")?s:s.parent()),i.trigger(t=e.Event("close")),t.isDefaultPrevented()||(i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,n):n())},e.fn.alert=function(t){return this.each(function(){var i=e(this),s=i.data("alert");s||i.data("alert",s=new n(this)),"string"==typeof t&&s[t].call(i)})},e.fn.alert.Constructor=n,e(function(){e("body").on("click.alert.data-api",t,n.prototype.close)})}(window.jQuery),!function(e){"use strict";function t(){var t=this,i=setTimeout(function(){t.$element.off(e.support.transition.end),n.call(t)},500);this.$element.one(e.support.transition.end,function(){clearTimeout(i),n.call(t)})}function n(e){this.$element.hide().trigger("hidden"),i.call(this)}function i(t){var n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&n;this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(document.body),"static"!=this.options.backdrop&&this.$backdrop.click(e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(s,this)):s.call(this)):t&&t()}function s(){this.$backdrop.remove(),this.$backdrop=null}function a(){var t=this;this.isShown&&this.options.keyboard?e(document).on("keyup.dismiss.modal",function(e){27==e.which&&t.hide()}):this.isShown||e(document).off("keyup.dismiss.modal")}var r=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this))};r.prototype={constructor:r,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(e("body").addClass("modal-open"),this.isShown=!0,a.call(this),i.call(this,function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in"),n?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")}))},hide:function(i){i&&i.preventDefault();i=e.Event("hide"),this.$element.trigger(i),this.isShown&&!i.isDefaultPrevented()&&(this.isShown=!1,e("body").removeClass("modal-open"),a.call(this),this.$element.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?t.call(this):n.call(this))}},e.fn.modal=function(t){return this.each(function(){var n=e(this),i=n.data("modal"),s=e.extend({},e.fn.modal.defaults,n.data(),"object"==typeof t&&t);i||n.data("modal",i=new r(this,s)),"string"==typeof t?i[t]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=r,e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n,i=e(this),s=e(i.attr("data-target")||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")),a=s.data("modal")?"toggle":e.extend({},s.data(),i.data());t.preventDefault(),s.modal(a)})})}(window.jQuery),!function(e){"use strict";function t(){e(n).parent().removeClass("open")}var n='[data-toggle="dropdown"]',i=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};i.prototype={constructor:i,toggle:function(n){var i,s,a,r=e(this);if(!r.is(".disabled, :disabled"))return s=r.attr("data-target"),s||(s=r.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,"")),i=e(s),i.length||(i=r.parent()),a=i.hasClass("open"),t(),a||i.toggleClass("open"),!1}},e.fn.dropdown=function(t){return this.each(function(){var n=e(this),s=n.data("dropdown");s||n.data("dropdown",s=new i(this)),"string"==typeof t&&s[t].call(n)})},e.fn.dropdown.Constructor=i,e(function(){e("html").on("click.dropdown.data-api",t),e("body").on("click.dropdown",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",n,i.prototype.toggle)})}(window.jQuery),!function(e){"use strict";function t(t,n){var i,s=e.proxy(this.process,this),a=e(e(t).is("body")?window:t);this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=a.on("scroll.scroll.data-api",s),this.selector=(this.options.target||(i=e(t).attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t,n=this;this.offsets=e([]),this.targets=e([]),t=this.$body.find(this.selector).map(function(){var t=e(this),n=t.data("target")||t.attr("href"),i=/^#\w/.test(n)&&e(n);return i&&n.length&&[[i.position().top,n]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){n.offsets.push(this[0]),n.targets.push(this[1])})},process:function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,n=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,i=n-this.$scrollElement.height(),s=this.offsets,a=this.targets,r=this.activeTarget;if(t>=i)return r!=(e=a.last()[0])&&this.activate(e);for(e=s.length;e--;)r!=a[e]&&t>=s[e]&&(!s[e+1]||t<=s[e+1])&&this.activate(a[e])},activate:function(t){var n,i;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),i=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(i).parent("li").addClass("active"),n.parent(".dropdown-menu")&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}},e.fn.scrollspy=function(n){return this.each(function(){var i=e(this),s=i.data("scrollspy"),a="object"==typeof n&&n;s||i.data("scrollspy",s=new t(this,a)),"string"==typeof n&&s[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e(function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t,n,i,s=this.element,a=s.closest("ul:not(.dropdown-menu)"),r=s.attr("data-target");r||(r=s.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),s.parent("li").hasClass("active")||(t=a.find(".active a").last()[0],i=e.Event("show",{relatedTarget:t}),s.trigger(i),i.isDefaultPrevented()||(n=e(r),this.activate(s.parent("li"),a),this.activate(n,n.parent(),function(){s.trigger({type:"shown",relatedTarget:t})})))},activate:function(t,n,i){function s(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),r?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),i&&i()}var a=n.find("> .active"),r=i&&e.support.transition&&a.hasClass("fade");r?a.one(e.support.transition.end,s):s(),a.removeClass("in")}},e.fn.tab=function(n){return this.each(function(){var i=e(this),s=i.data("tab");s||i.data("tab",s=new t(this)),"string"==typeof n&&s[n]()})},e.fn.tab.Constructor=t,e(function(){e("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,i){var s,a;this.type=t,this.$element=e(n),this.options=this.getOptions(i),this.enabled=!0,"manual"!=this.options.trigger&&(s="hover"==this.options.trigger?"mouseenter":"focus",a="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(s,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);return n.options.delay&&n.options.delay.show?(clearTimeout(this.timeout),n.hoverState="in",void(this.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show))):n.show()},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),n.options.delay&&n.options.delay.hide?(n.hoverState="out",void(this.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide))):n.hide()},show:function(){var e,t,n,i,s,a,r;if(this.hasContent()&&this.enabled){switch(e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),a="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(a),e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body),n=this.getPosition(t),i=e[0].offsetWidth,s=e[0].offsetHeight,t?a.split(" ")[1]:a){case"bottom":r={top:n.top+n.height,left:n.left+n.width/2-i/2};break;case"top":r={top:n.top-s,left:n.left+n.width/2-i/2};break;case"left":r={top:n.top+n.height/2-s/2,left:n.left-i};break;case"right":r={top:n.top+n.height/2-s/2,left:n.left+n.width}}e.css(r).addClass(a).addClass("in")}},isHTML:function(e){return"string"!=typeof e||"<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(e)},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.isHTML(t)?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function t(){var t=setTimeout(function(){n.off(e.support.transition.end).remove()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.remove()})}var n=this.tip();n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?t():n.remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}},e.fn.tooltip=function(n){return this.each(function(){var i=e(this),s=i.data("tooltip"),a="object"==typeof n&&n;s||i.data("tooltip",s=new t(this,a)),"string"==typeof n&&s[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.isHTML(t)?"html":"text"](t),e.find(".popover-content > *")[this.isHTML(n)?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-content")||("function"==typeof n.content?n.content.call(t[0]):n.content)},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip}}),e.fn.popover=function(n){return this.each(function(){var i=e(this),s=i.data("popover"),a="object"==typeof n&&n;s||i.data("popover",s=new t(this,a)),"string"==typeof n&&s[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,i=n.data(),s=n.is("input")?"val":"html";e+="Text",i.resetText||n.data("resetText",n[s]()),n[s](i[e]||this.options[e]),setTimeout(function(){"loadingText"==e?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.parent('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")},e.fn.button=function(n){return this.each(function(){var i=e(this),s=i.data("button"),a="object"==typeof n&&n;s||i.data("button",s=new t(this,a)),"toggle"==n?s.toggle():n&&s.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,i,s;if(!this.transitioning){if(t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),i=this.$parent&&this.$parent.find("> .accordion-group > .in"),i&&i.length){if(s=i.data("collapse"),s&&s.transitioning)return;i.collapse("hide"),s||i.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),this.$element[t](this.$element[0][n])}},hide:function(){var t;this.transitioning||(t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0))},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[null!==e?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,i){var s=this,a=function(){"show"==n.type&&s.reset(),s.transitioning=0,s.$element.trigger(i)};this.$element.trigger(n),n.isDefaultPrevented()||(this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,a):a())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},e.fn.collapse=function(n){return this.each(function(){var i=e(this),s=i.data("collapse"),a="object"==typeof n&&n;s||i.data("collapse",s=new t(this,a)),"string"==typeof n&&s[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e(function(){e("body").on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n,i=e(this),s=i.attr("data-target")||t.preventDefault()||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),a=e(s).data("collapse")?"toggle":i.data();e(s).collapse(a)})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=n,this.options.slide&&this.slide(this.options.slide),"hover"==this.options.pause&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},to:function(t){var n=this.$element.find(".active"),i=n.parent().children(),s=i.index(n),a=this;if(!(t>i.length-1||0>t))return this.sliding?this.$element.one("slid",function(){a.to(t)}):s==t?this.pause().cycle():this.slide(t>s?"next":"prev",e(i[t]))},pause:function(e){return e||(this.paused=!0),clearInterval(this.interval),this.interval=null,this},next:function(){return this.sliding?void 0:this.slide("next")},prev:function(){return this.sliding?void 0:this.slide("prev")},slide:function(t,n){var i=this.$element.find(".active"),s=n||i[t](),a=this.interval,r="next"==t?"left":"right",o="next"==t?"first":"last",l=this,p=e.Event("slide");if(this.sliding=!0,a&&this.pause(),s=s.length?s:this.$element.find(".item")[o](),!s.hasClass("active")){if(e.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(p),p.isDefaultPrevented())return;s.addClass(t),s[0].offsetWidth,i.addClass(r),s.addClass(r),this.$element.one(e.support.transition.end,function(){s.removeClass([t,r].join(" ")).addClass("active"),i.removeClass(["active",r].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger("slid")},0)})}else{if(this.$element.trigger(p),p.isDefaultPrevented())return;i.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return a&&this.cycle(),this}}},e.fn.carousel=function(n){return this.each(function(){var i=e(this),s=i.data("carousel"),a=e.extend({},e.fn.carousel.defaults,"object"==typeof n&&n);s||i.data("carousel",s=new t(this,a)),"number"==typeof n?s.to(n):"string"==typeof n||(n=a.slide)?s[n]():a.interval&&s.cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e(function(){e("body").on("click.carousel.data-api","[data-slide]",function(t){var n,i=e(this),s=e(i.attr("data-target")||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"")),a=!s.data("modal")&&e.extend({},s.data(),i.data());s.carousel(a),t.preventDefault()})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=e(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:t.top+t.height,left:t.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n,i=this;return this.query=this.$element.val(),this.query?(n=e.grep(this.source,function(e){return i.matcher(e)}),n=this.sorter(n),n.length?this.render(n.slice(0,this.options.items)).show():this.shown?this.hide():this):this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){for(var t,n=[],i=[],s=[];t=e.shift();)t.toLowerCase().indexOf(this.query.toLowerCase())?~t.indexOf(this.query)?i.push(t):s.push(t):n.push(t);return n.concat(i,s)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,i){return t=e(n.options.item).attr("data-value",i),t.find("a").html(n.highlighter(i)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),i=n.next();i.length||(i=e(this.$menu.find("li")[0])),i.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),(e.browser.webkit||e.browser.msie)&&this.$element.on("keydown",e.proxy(this.keypress,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},keyup:function(e){switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},keypress:function(e){if(this.shown){switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:if("keydown"!=e.type)break;e.preventDefault(),this.prev();break;case 40:if("keydown"!=e.type)break;e.preventDefault(),this.next()}e.stopPropagation()}},blur:function(e){var t=this;setTimeout(function(){t.hide()},150)},click:function(e){e.stopPropagation(),e.preventDefault(),this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")}},e.fn.typeahead=function(n){return this.each(function(){var i=e(this),s=i.data("typeahead"),a="object"==typeof n&&n;s||i.data("typeahead",s=new t(this,a)),"string"==typeof n&&s[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>'},e.fn.typeahead.Constructor=t,e(function(){e("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);n.data("typeahead")||(t.preventDefault(),n.typeahead(n.data()))})})}(window.jQuery),function(e){function t(t,n){var i=document.createElementNS("http://www.w3.org/2000/svg",t||"svg");return n&&e.each(n,function(e,t){i.setAttributeNS(null,e,t)}),e(i)}e.fn.activity=function(t){return this.each(function(){var s=e(this),a=s.data("activity");if(a&&(clearInterval(a.data("interval")),a.remove(),s.removeData("activity")),t!==!1){t=e.extend({color:s.css("color")},e.fn.activity.defaults,t),a=n(s,t).css("position","absolute").prependTo(t.outside?"body":s);var r=s.outerHeight()-a.height(),o=s.outerWidth()-a.width(),l={top:"top"==t.valign?t.padding:"bottom"==t.valign?r-t.padding:Math.floor(r/2),left:"left"==t.align?t.padding:"right"==t.align?o-t.padding:Math.floor(o/2)},p=s.offset();t.outside?a.css({top:p.top+"px",left:p.left+"px"}):(l.top-=a.offset().top-p.top,l.left-=a.offset().left-p.left),a.css({marginTop:l.top+"px",marginLeft:l.left+"px"}),i(a,t.segments,Math.round(10/t.speed)/10),s.data("activity",a)}}),this},e.fn.activity.defaults={segments:12,space:3,length:7,width:4,speed:1.2,align:"center",valign:"center",padding:4},e.fn.activity.getOpacity=function(e,t){var n=e.steps||e.segments-1,i=void 0!==e.opacity?e.opacity:1/n;return 1-Math.min(t,n)*(1-i)/n};var n=function(){return e("<div>").addClass("busy")},i=function(){};if(document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect)if(n=function(n,i){for(var s=2*i.width+i.space,a=s+i.length+Math.ceil(i.width/2)+1,r=t().width(2*a).height(2*a),o=t("g",{"stroke-width":i.width,"stroke-linecap":"round",stroke:i.color}).appendTo(t("g",{transform:"translate("+a+","+a+")"}).appendTo(r)),l=0;l<i.segments;l++)o.append(t("line",{x1:0,y1:s,x2:0,y2:s+i.length,transform:"rotate("+360/i.segments*l+", 0, 0)",opacity:e.fn.activity.getOpacity(i,l)}));return e("<div>").append(r).width(2*a).height(2*a)},void 0!==document.createElement("div").style.WebkitAnimationName){var s={};i=function(e,t,n){if(!s[t]){for(var i="spin"+t,a="@-webkit-keyframes "+i+" {",r=0;t>r;r++){var o=Math.round(1e5/t*r)/1e3,l=Math.round(1e5/t*(r+1)-1)/1e3,p="% { -webkit-transform:rotate("+Math.round(360/t*r)+"deg); }\n";a+=o+p+l+p}a+="100% { -webkit-transform:rotate(100deg); }\n}";var c=document.createElement("style");c.innerHTML=a,document.body.appendChild(c),s[t]=i}e.css("-webkit-animation",s[t]+" "+n+"s linear infinite")}}else i=function(e,t,n){var i=0,s=e.find("g g").get(0);e.data("interval",setInterval(function(){s.setAttributeNS(null,"transform","rotate("+ ++i%t*(360/t)+")")},1e3*n/t))};else{var a=e("<shape>").css("behavior","url(#default#VML)");if(e("body").append(a),a.get(0).adj){var r=document.createStyleSheet();e.each(["group","shape","stroke"],function(){r.addRule(this,"behavior:url(#default#VML);")}),n=function(t,n){for(var i=2*n.width+n.space,s=i+n.length+Math.ceil(n.width/2)+1,a=2*s,r=-Math.ceil(a/2),o=e("<group>",{coordsize:a+" "+a,coordorigin:r+" "+r}).css({top:r,left:r,width:a,height:a}),l=0;l<n.segments;l++)o.append(e("<shape>",{path:"m "+i+",0  l "+(i+n.length)+",0"}).css({width:a,height:a,rotation:360/n.segments*l+"deg"}).append(e("<stroke>",{color:n.color,weight:n.width+"px",endcap:"round",opacity:e.fn.activity.getOpacity(n,l)})));return e("<group>",{coordsize:a+" "+a}).css({width:a,height:a,overflow:"hidden"}).append(o)},i=function(e,t,n){var i=0,s=e.get(0);e.data("interval",setInterval(function(){s.style.rotation=++i%t*(360/t)},1e3*n/t))}}e(a).remove()}}(jQuery),!function(e){var t=function(t,i){this.element=e(t),this.format=n.parseFormat(i.format||this.element.data("date-format")||"mm/dd/yyyy"),this.picker=e(n.template).appendTo(i.inPlace?t:"body").on({click:e.proxy(this.click,this),mousedown:e.proxy(this.mousedown,this)}),this.isInput=this.element.is("input"),this.component=this.element.is(".date")?this.element.find(".add-on"):!1,this.isInput?this.element.on({focus:e.proxy(this.show,this),blur:e.proxy(this.hide,this),keyup:e.proxy(this.update,this)}):this.component?this.component.on("click",e.proxy(this.show,this)):this.element.on("click",e.proxy(this.show,this)),this.viewMode=0,this.inPlace=i.inPlace,this.weekStart=i.weekStart||this.element.data("date-weekstart")||0,this.weekEnd=0==this.weekStart?6:this.weekStart-1,this.fillDow(),this.fillMonths(),this.update(),this.showMode()};t.prototype={constructor:t,show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),e(window).on("resize",e.proxy(this.place,this)),t&&(t.stopPropagation(),t.preventDefault()),this.isInput||e(document).on("mousedown",e.proxy(this.hide,this)),this.element.trigger({type:"show",date:this.date})},hide:function(){this.inPlace||(this.picker.hide(),e(window).off("resize",this.place),this.viewMode=0,this.showMode(),this.isInput||e(document).off("mousedown",this.hide),this.element.trigger({type:"hide",date:this.date}))},setValue:function(){var e=n.formatDate(this.date,this.format);this.isInput?this.element.prop("value",e):(this.component&&this.element.find("input").prop("value",e),this.element.data("date",e))},place:function(){if(this.inPlace)this.picker.css({position:"relative",top:"auto",left:"auto"});else{
var e=this.component?this.component.offset():this.element.offset();this.picker.css({top:e.top+this.height,left:e.left})}},update:function(){this.date=n.parseDate(this.isInput?this.element.prop("value"):this.element.data("date"),this.format),this.viewDate=new Date(this.date),this.fill()},fillDow:function(){for(var e=this.weekStart,t="<tr>";e<this.weekStart+7;)t+='<th class="dow">'+n.dates.daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;12>t;)e+='<span class="month">'+n.dates.monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").append(e)},fill:function(){var e=new Date(this.viewDate),t=e.getFullYear(),i=e.getMonth(),s=this.date.valueOf();this.picker.find(".datepicker-days th:eq(1)").text(n.dates.months[i]+" "+t);var a=new Date(t,i-1,28,0,0,0,0),r=n.getDaysInMonth(a.getFullYear(),a.getMonth());a.setDate(r),a.setDate(r-(a.getDay()-this.weekStart+7)%7);var o=new Date(a);o.setDate(o.getDate()+42),o=o.valueOf(),html=[];for(var l;a.valueOf()<o;)a.getDay()==this.weekStart&&html.push("<tr>"),l="",a.getMonth()<i?l=" old":a.getMonth()>i&&(l=" new"),a.getFullYear()<t?l=" old":a.getFullYear()>t&&(l=" new"),a.valueOf()==s&&(l+=" active"),html.push('<td class="day'+l+'">'+a.getDate()+"</td>"),a.getDay()==this.weekEnd&&html.push("</tr>"),a.setDate(a.getDate()+1);this.picker.find(".datepicker-days tbody").empty().append(html.join(""));var p=this.date.getFullYear(),c=this.picker.find(".datepicker-months").find("th:eq(1)").text(t).end().find("span").removeClass("active");p==t&&c.eq(this.date.getMonth()).addClass("active"),html="",t=10*parseInt(t/10,10);var u=this.picker.find(".datepicker-years").find("th:eq(1)").text(t+"-"+(t+9)).end().find("td");t-=1;for(var d=-1;11>d;d++)html+='<span class="year'+(-1==d||10==d?" old":"")+(p==t?" active":"")+'">'+t+"</span>",t+=1;u.html(html)},click:function(t){t.stopPropagation(),t.preventDefault();var i=e(t.target).closest("span, td, th");if(1==i.length)switch(i[0].nodeName.toLowerCase()){case"th":switch(i[0].className){case"switch":this.showMode(1);break;case"prev":case"next":this.viewDate["set"+n.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate["get"+n.modes[this.viewMode].navFnc].call(this.viewDate)+n.modes[this.viewMode].navStep*("prev"==i[0].className?-1:1)),this.fill()}break;case"span":if(i.is(".month")){var s=i.parent().find("span").index(i);this.viewDate.setMonth(s)}else{var a=parseInt(i.text(),10)||0;this.viewDate.setFullYear(a)}this.showMode(-1),this.fill();break;case"td":if(i.is(".day")){var r=parseInt(i.text(),10)||1,s=this.viewDate.getMonth();i.is(".old")?s-=1:i.is(".new")&&(s+=1);var a=this.viewDate.getFullYear();this.date=new Date(a,s,r,0,0,0,0),this.viewDate=new Date(a,s,r,0,0,0,0),this.fill(),this.setValue(),this.element.trigger({type:"changeDate",date:this.date})}}},mousedown:function(e){e.stopPropagation(),e.preventDefault()},showMode:function(e){e&&(this.viewMode=Math.max(0,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".datepicker-"+n.modes[this.viewMode].clsName).show()}},e.fn.datepicker=function(n){return this.each(function(){var i=e(this),s=i.data("datepicker"),a="object"==typeof n&&n;s||(i.data("datepicker",s=new t(this,e.extend({},e.fn.datepicker.defaults,a))),s.show()),"string"==typeof n&&s[n]()})},e.fn.datepicker.defaults={},e.fn.datepicker.Constructor=t;var n={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],dates:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,n.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},parseFormat:function(e){var t=e.match(/[.\/-].*?/),n=e.split(/\W+/);if(!t||!n||0==n.length)throw new Error("Invalid date format.");return{separator:t,parts:n}},parseDate:function(e,t){var n,i=e.split(t.separator),e=new Date(1970,1,1,0,0,0);if(i.length==t.parts.length)for(var s=0,a=t.parts.length;a>s;s++)switch(n=parseInt(i[s],10)||1,t.parts[s]){case"dd":case"d":e.setDate(n);break;case"mm":case"m":e.setMonth(n-1);break;case"yy":e.setFullYear(2e3+n);break;case"yyyy":e.setFullYear(n)}return e},formatDate:function(e,t){var n={d:e.getDate(),m:e.getMonth()+1,yy:e.getFullYear().toString().substring(2),yyyy:e.getFullYear()};n.dd=(n.d<10?"0":"")+n.d,n.mm=(n.m<10?"0":"")+n.m;for(var e=[],i=0,s=t.parts.length;s>i;i++)e.push(n[t.parts[i]]);return e.join(t.separator)},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};n.template='<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">'+n.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+n.headTemplate+n.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+n.headTemplate+n.contTemplate+"</table></div></div>"}(window.jQuery),$.extend({modernizeSelects:function(){$("select:not(.modernized)").each(function(e,t){if("no"!=$(t).data("convert")){var n=$(t).attr("id"),i=$("#"+n+" option:selected").text(),s=$(t).data("group-class"),a=$(t).data("class"),r=$(t).data("onchange"),o="select-group-"+$(t).attr("id");$(t).prev().html('<div class="btn-group '+s+'" id="'+o+'" data-id="'+n+'" onclick="'+r+'" /></div>');var l=$("#"+o),p=$('<a class="btn dropdown-toggle '+a+'" data-toggle="dropdown" href="#"></a>');p.text(i),p.append(' <span class="caret"></span>'),l.empty(),l.append(p),l.append('<ul class="dropdown-menu"></ul><input type="hidden" value="'+$(t).val()+'" name="'+$(t).attr("name")+'" id="'+$(t).attr("id")+'" class="'+$(t).attr("class")+'" />'),$(t).find("optgroup").each(function(e,t){l.find("> .dropdown-menu").append('<li id="'+n+"-optgroup-"+e+'"><a href="javascript:;" data-title="'+$(t).attr("label")+'" data-value="'+$(t).data("value")+'"><i class="icon-chevron-right"></i>'+$(t).attr("label")+'</a><ul class="dropdown-menu"></ul></li>'),$(t).find("option").each(function(i,s){l.find("#"+n+"-optgroup-"+e+" .dropdown-menu").append('<li><a href="javascript:;" data-title="'+$(s).text()+'" data-value="'+$(s).attr("value")+'">'+$(s).html()+"</a></li>"),$(t).attr("selected")&&l.find("#"+n+"-optgroup-"+e+" .dropdown-menu li:eq("+i+")").click()})}).remove(),$(t).find("option").each(function(e,t){if($(t).data("raw-html"))var n=$(t).data("raw-html");else var n=$(t).text().replace('"',"'");var i=$("<li></li>");if($(t).attr("value"))var s=$("<a href='javascript:;' data-value='"+parseInt($(t).attr("value"))+"'></a>");else var s=$("<a href='javascript:;'></a>");s.data("title",n),s.data("value",$(t).attr("value")),s.text(n),i.append(s),l.find(".dropdown-menu").append(i),$(t).attr("selected")&&l.find(".dropdown-menu li:eq("+e+")").click()}),l.find(".dropdown-menu a").click(function(){l.find("input[type=hidden]").on().val($(this).data("value")).change(),l.find(".btn:eq(0)").text($(this).text()),l.find(".btn:eq(0)").append(' <span class="caret"></span>')}),$(t).remove()}})}}),$(document).on("ready ajaxSuccess convertSelect",function(){try{$.modernizeSelects()}catch(e){}}),function(){jQuery(function(){return $("a[rel=popover]").popover(),$("a[rel=tooltip]").tooltip()}),$(document).on("click","[data-toggle='modal']",function(){var e;return e=$($(this).attr("href")+" .input-data"),e.removeData(),e.data($(this).data()),e.removeData("toggle"),e.click()})}.call(this),function(e,t){function n(t,n){var s,a,r,o=t.nodeName.toLowerCase();return"area"===o?(s=t.parentNode,a=s.name,t.href&&a&&"map"===s.nodeName.toLowerCase()?(r=e("img[usemap=#"+a+"]")[0],!!r&&i(r)):!1):(/input|select|textarea|button|object/.test(o)?!t.disabled:"a"===o?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var s=0,a=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,i){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),i&&i.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,s,a=e(this[0]);a.length&&a[0]!==document;){if(i=a.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(a.css("zIndex"),10),!isNaN(s)&&0!==s))return s;a=a.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++s)})},removeUniqueId:function(){return this.each(function(){a.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),s=isNaN(i);return(s||i>=0)&&n(t,!s)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function s(t,n,i,s){return e.each(a,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var a="Width"===i?["Left","Right"]:["Top","Bottom"],r=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?o["inner"+i].call(this):this.each(function(){e(this).css(r,s(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(r,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var s,a=e.ui[t].prototype;for(s in i)a.plugins[s]=a.plugins[s]||[],a.plugins[s].push([n,i[s]])},call:function(e,t,n){var i,s=e.plugins[t];if(s&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;s.length>i;i++)e.options[s[i][0]]&&s[i][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",s=!1;return t[i]>0?!0:(t[i]=1,s=t[i]>0,t[i]=0,s)}})}(jQuery),function(e,t){var n=0,i=Array.prototype.slice,s=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(a){}s(t)},e.widget=function(n,i,s){var a,r,o,l,p={},c=n.split(".")[0];n=n.split(".")[1],a=c+"-"+n,s||(s=i,i=e.Widget),e.expr[":"][a.toLowerCase()]=function(t){return!!e.data(t,a)},e[c]=e[c]||{},r=e[c][n],o=e[c][n]=function(e,n){return this._createWidget?(arguments.length&&this._createWidget(e,n),t):new o(e,n)},e.extend(o,r,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),l=new i,l.options=e.widget.extend({},l.options),e.each(s,function(n,s){return e.isFunction(s)?(p[n]=function(){var e=function(){return i.prototype[n].apply(this,arguments)},t=function(e){return i.prototype[n].apply(this,e)};return function(){var n,i=this._super,a=this._superApply;return this._super=e,this._superApply=t,n=s.apply(this,arguments),this._super=i,this._superApply=a,n}}(),t):(p[n]=s,t)}),o.prototype=e.widget.extend(l,{widgetEventPrefix:r?l.widgetEventPrefix:n},p,{constructor:o,namespace:c,widgetName:n,widgetFullName:a}),r?(e.each(r._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,o,n._proto)}),delete r._childConstructors):i._childConstructors.push(o),e.widget.bridge(n,o)},e.widget.extend=function(n){for(var s,a,r=i.call(arguments,1),o=0,l=r.length;l>o;o++)for(s in r[o])a=r[o][s],r[o].hasOwnProperty(s)&&a!==t&&(n[s]=e.isPlainObject(a)?e.isPlainObject(n[s])?e.widget.extend({},n[s],a):e.widget.extend({},a):a);return n},e.widget.bridge=function(n,s){var a=s.prototype.widgetFullName||n;e.fn[n]=function(r){var o="string"==typeof r,l=i.call(arguments,1),p=this;return r=!o&&l.length?e.widget.extend.apply(null,[r].concat(l)):r,o?this.each(function(){var i,s=e.data(this,a);return s?e.isFunction(s[r])&&"_"!==r.charAt(0)?(i=s[r].apply(s,l),i!==s&&i!==t?(p=i&&i.jquery?p.pushStack(i.get()):i,!1):t):e.error("no such method '"+r+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+r+"'")}):this.each(function(){var t=e.data(this,a);t?t.option(r||{})._init():e.data(this,a,new s(r,this))}),p}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var s,a,r,o=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(o={},s=n.split("."),n=s.shift(),s.length){for(a=o[n]=e.widget.extend({},this.options[n]),r=0;s.length-1>r;r++)a[s[r]]=a[s[r]]||{},a=a[s[r]];if(n=s.pop(),i===t)return a[n]===t?null:a[n];a[n]=i}else{if(i===t)return this.options[n]===t?null:this.options[n];o[n]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(n,i,s){var a,r=this;"boolean"!=typeof n&&(s=i,i=n,n=!1),s?(i=a=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,a=this.widget()),e.each(s,function(s,o){function l(){return n||r.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?r[o]:o).apply(r,arguments):t}"string"!=typeof o&&(l.guid=o.guid=o.guid||l.guid||e.guid++);var p=s.match(/^(\w+)\s*(.*)$/),c=p[1]+r.eventNamespace,u=p[2];u?a.delegate(u,c,l):i.bind(c,l)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var s,a,r=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],a=n.originalEvent)for(s in a)s in n||(n[s]=a[s]);return this.element.trigger(n,i),!(e.isFunction(r)&&r.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,s,a){"string"==typeof s&&(s={effect:s});var r,o=s?s===!0||"number"==typeof s?n:s.effect||n:t;s=s||{},"number"==typeof s&&(s={duration:s}),r=!e.isEmptyObject(s),s.complete=a,s.delay&&i.delay(s.delay),r&&e.effects&&e.effects.effect[o]?i[t](s):o!==t&&i[o]?i[o](s.duration,s.easing,a):i.queue(function(n){e(this)[t](),a&&a.call(i[0]),n()})}})}(jQuery),function(e,t){function n(e,t,n){return[parseFloat(e[0])*(h.test(e[0])?t/100:1),parseFloat(e[1])*(h.test(e[1])?n/100:1)]}function i(t,n){return parseInt(e.css(t,n),10)||0}function s(t){var n=t[0];return 9===n.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var a,r=Math.max,o=Math.abs,l=Math.round,p=/left|center|right/,c=/top|center|bottom/,u=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,h=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(a!==t)return a;var n,i,s=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),r=s.children()[0];return e("body").append(s),n=r.offsetWidth,s.css("overflow","scroll"),i=r.offsetWidth,n===i&&(i=s[0].clientWidth),s.remove(),a=n-i},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),i=t.isWindow?"":t.element.css("overflow-y"),s="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,a="scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),i=e.isWindow(n[0]);return{element:n,isWindow:i,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:i?n.width():n.outerWidth(),height:i?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return f.apply(this,arguments);t=e.extend({},t);var a,h,m,g,_,b,v=e(t.of),y=e.position.getWithinInfo(t.within),w=e.position.getScrollInfo(y),x=(t.collision||"flip").split(" "),A={};return b=s(v),v[0].preventDefault&&(t.at="left top"),h=b.width,m=b.height,g=b.offset,_=e.extend({},g),e.each(["my","at"],function(){var e,n,i=(t[this]||"").split(" ");1===i.length&&(i=p.test(i[0])?i.concat(["center"]):c.test(i[0])?["center"].concat(i):["center","center"]),i[0]=p.test(i[0])?i[0]:"center",i[1]=c.test(i[1])?i[1]:"center",e=u.exec(i[0]),n=u.exec(i[1]),A[this]=[e?e[0]:0,n?n[0]:0],t[this]=[d.exec(i[0])[0],d.exec(i[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===t.at[0]?_.left+=h:"center"===t.at[0]&&(_.left+=h/2),"bottom"===t.at[1]?_.top+=m:"center"===t.at[1]&&(_.top+=m/2),a=n(A.at,h,m),_.left+=a[0],_.top+=a[1],this.each(function(){var s,p,c=e(this),u=c.outerWidth(),d=c.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),k=u+f+i(this,"marginRight")+w.width,S=d+b+i(this,"marginBottom")+w.height,T=e.extend({},_),C=n(A.my,c.outerWidth(),c.outerHeight());"right"===t.my[0]?T.left-=u:"center"===t.my[0]&&(T.left-=u/2),"bottom"===t.my[1]?T.top-=d:"center"===t.my[1]&&(T.top-=d/2),T.left+=C[0],T.top+=C[1],e.support.offsetFractions||(T.left=l(T.left),T.top=l(T.top)),s={marginLeft:f,marginTop:b},e.each(["left","top"],function(n,i){e.ui.position[x[n]]&&e.ui.position[x[n]][i](T,{targetWidth:h,targetHeight:m,elemWidth:u,elemHeight:d,collisionPosition:s,collisionWidth:k,collisionHeight:S,offset:[a[0]+C[0],a[1]+C[1]],my:t.my,at:t.at,within:y,elem:c})}),t.using&&(p=function(e){var n=g.left-T.left,i=n+h-u,s=g.top-T.top,a=s+m-d,l={target:{element:v,left:g.left,top:g.top,width:h,height:m},element:{element:c,left:T.left,top:T.top,width:u,height:d},horizontal:0>i?"left":n>0?"right":"center",vertical:0>a?"top":s>0?"bottom":"middle"};u>h&&h>o(n+i)&&(l.horizontal="center"),d>m&&m>o(s+a)&&(l.vertical="middle"),l.important=r(o(n),o(i))>r(o(s),o(a))?"horizontal":"vertical",t.using.call(this,e,l)}),c.offset(e.extend(T,{using:p}))})},e.ui.position={fit:{left:function(e,t){var n,i=t.within,s=i.isWindow?i.scrollLeft:i.offset.left,a=i.width,o=e.left-t.collisionPosition.marginLeft,l=s-o,p=o+t.collisionWidth-a-s;t.collisionWidth>a?l>0&&0>=p?(n=e.left+l+t.collisionWidth-a-s,e.left+=l-n):e.left=p>0&&0>=l?s:l>p?s+a-t.collisionWidth:s:l>0?e.left+=l:p>0?e.left-=p:e.left=r(e.left-o,e.left)},top:function(e,t){var n,i=t.within,s=i.isWindow?i.scrollTop:i.offset.top,a=t.within.height,o=e.top-t.collisionPosition.marginTop,l=s-o,p=o+t.collisionHeight-a-s;t.collisionHeight>a?l>0&&0>=p?(n=e.top+l+t.collisionHeight-a-s,e.top+=l-n):e.top=p>0&&0>=l?s:l>p?s+a-t.collisionHeight:s:l>0?e.top+=l:p>0?e.top-=p:e.top=r(e.top-o,e.top)}},flip:{left:function(e,t){var n,i,s=t.within,a=s.offset.left+s.scrollLeft,r=s.width,l=s.isWindow?s.scrollLeft:s.offset.left,p=e.left-t.collisionPosition.marginLeft,c=p-l,u=p+t.collisionWidth-r-l,d="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,h="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>c?(n=e.left+d+h+f+t.collisionWidth-r-a,(0>n||o(c)>n)&&(e.left+=d+h+f)):u>0&&(i=e.left-t.collisionPosition.marginLeft+d+h+f-l,(i>0||u>o(i))&&(e.left+=d+h+f))},top:function(e,t){var n,i,s=t.within,a=s.offset.top+s.scrollTop,r=s.height,l=s.isWindow?s.scrollTop:s.offset.top,p=e.top-t.collisionPosition.marginTop,c=p-l,u=p+t.collisionHeight-r-l,d="top"===t.my[1],h=d?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>c?(i=e.top+h+f+m+t.collisionHeight-r-a,e.top+h+f+m>c&&(0>i||o(c)>i)&&(e.top+=h+f+m)):u>0&&(n=e.top-t.collisionPosition.marginTop+h+f+m-l,e.top+h+f+m>u&&(n>0||u>o(n))&&(e.top+=h+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,i,s,a,r=document.getElementsByTagName("body")[0],o=document.createElement("div");t=document.createElement(r?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(a in i)t.style[a]=i[a];t.appendChild(o),n=r||document.documentElement,n.insertBefore(t,n.firstChild),o.style.cssText="position: absolute; left: 10.7432222px;",s=e(o).offset().left,e.support.offsetFractions=s>10&&11>s,t.innerHTML="",n.removeChild(t)}()}(jQuery),function(e){var t=0;e.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,n,i,s=this.element[0].nodeName.toLowerCase(),a="textarea"===s,r="input"===s;this.isMultiLine=a?!0:r?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[a||r?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(s){if(this.element.prop("readOnly"))return t=!0,i=!0,void(n=!0);t=!1,i=!1,n=!1;var a=e.ui.keyCode;switch(s.keyCode){case a.PAGE_UP:t=!0,this._move("previousPage",s);break;case a.PAGE_DOWN:t=!0,this._move("nextPage",s);break;case a.UP:t=!0,this._keyEvent("previous",s);break;case a.DOWN:t=!0,this._keyEvent("next",s);break;case a.ENTER:case a.NUMPAD_ENTER:this.menu.active&&(t=!0,s.preventDefault(),this.menu.select(s));break;case a.TAB:this.menu.active&&this.menu.select(s);break;case a.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(s),s.preventDefault());break;default:n=!0,this._searchTimeout(s)}},keypress:function(i){if(t)return t=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&i.preventDefault());if(!n){var s=e.ui.keyCode;switch(i.keyCode){case s.PAGE_UP:this._move("previousPage",i);break;case s.PAGE_DOWN:this._move("nextPage",i);break;case s.UP:this._keyEvent("previous",i);break;case s.DOWN:this._keyEvent("next",i)}}},input:function(e){return i?(i=!1,void e.preventDefault()):void this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(e),void this._change(e))}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(i){i.target===t.element[0]||i.target===n||e.contains(n,i.target)||t.close()})})},menufocus:function(t,n){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});var i=n.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:i})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(i.value):this.liveRegion.text(i.value)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item"),i=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i,this.selectedItem=n})),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,n,i=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,i){i(e.ui.autocomplete.filter(t,n.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,s){i.xhr&&i.xhr.abort(),i.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){s(e)},error:function(){s([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,n=++t;return function(i){n===t&&e.__response(i),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty();this._renderMenu(n,t),this.isNewMenu=!0,this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var i=this;e.each(n,function(e,n){i._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<a>").text(n.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),void this.menu.blur()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var i=RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return i.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery),function(e){e.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),
this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var n=e(t.target).closest(".ui-menu-item");!this.mouseHandled&&n.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(t),n.has(".ui-menu").length?this.expand(t):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var i,s,a,r,o,l=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:l=!1,s=this.previousFilter||"",a=String.fromCharCode(t.keyCode),r=!1,clearTimeout(this.filterTimer),a===s?r=!0:a=s+a,o=RegExp("^"+n(a),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return o.test(e(this).children("a").text())}),i=r&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(a=String.fromCharCode(t.keyCode),o=RegExp("^"+n(a),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return o.test(e(this).children("a").text())})),i.length?(this.focus(t,i),i.length>1?(this.previousFilter=a,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}l&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n=this.options.icons.submenu,i=this.element.find(this.options.menus);i.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.prev("a"),s=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(s),t.attr("aria-labelledby",i.attr("id"))}),t=i.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var n,i;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),i=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,i,s,a,r,o;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,s=t.offset().top-this.activeMenu.offset().top-n-i,a=this.activeMenu.scrollTop(),r=this.activeMenu.height(),o=t.height(),0>s?this.activeMenu.scrollTop(a+s):s+o>r&&this.activeMenu.scrollTop(a+s-r+o))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var i=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));i.length||(i=this.element),this._close(i),this.blur(t),this.activeMenu=i},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var i;this.active&&(i="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),i&&i.length&&this.active||(i=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(n,i)},nextPage:function(t){var n,i,s;return this.active?void(this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,s=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),0>n.offset().top-i-s}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(t)},previousPage:function(t){var n,i,s;return this.active?void(this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,s=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-i+s>0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item").first()))):void this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}})}(jQuery);var jaaulde=window.jaaulde||{};jaaulde.utils=jaaulde.utils||{},jaaulde.utils.cookies=function(){var e,t,n,i,s={expiresAt:null,path:"/",domain:null,secure:!1};return e=function(e){var t,n;return"object"!=typeof e||null===e?t=s:(t={expiresAt:s.expiresAt,path:s.path,domain:s.domain,secure:s.secure},"object"==typeof e.expiresAt&&e.expiresAt instanceof Date?t.expiresAt=e.expiresAt:"number"==typeof e.hoursToLive&&0!==e.hoursToLive&&(n=new Date,n.setTime(n.getTime()+60*e.hoursToLive*60*1e3),t.expiresAt=n),"string"==typeof e.path&&""!==e.path&&(t.path=e.path),"string"==typeof e.domain&&""!==e.domain&&(t.domain=e.domain),e.secure===!0&&(t.secure=e.secure)),t},t=function(t){return t=e(t),("object"==typeof t.expiresAt&&t.expiresAt instanceof Date?"; expires="+t.expiresAt.toGMTString():"")+"; path="+t.path+("string"==typeof t.domain?"; domain="+t.domain:"")+(t.secure===!0?"; secure":"")},n=function(){var e,t,n,i,s,a={},r=document.cookie.split(";");for(e=0;e<r.length;e+=1){t=r[e].split("="),n=t[0].replace(/^\s*/,"").replace(/\s*$/,"");try{i=decodeURIComponent(t[1])}catch(o){i=t[1]}if("object"==typeof JSON&&null!==JSON&&"function"==typeof JSON.parse)try{s=i,i=JSON.parse(i)}catch(l){i=s}a[n]=i}return a},i=function(){},i.prototype.get=function(e){var t,i,s=n();if("string"==typeof e)t="undefined"!=typeof s[e]?s[e]:null;else if("object"==typeof e&&null!==e){t={};for(i in e)"undefined"!=typeof s[e[i]]?t[e[i]]=s[e[i]]:t[e[i]]=null}else t=s;return t},i.prototype.filter=function(e){var t,i={},s=n();"string"==typeof e&&(e=new RegExp(e));for(t in s)t.match(e)&&(i[t]=s[t]);return i},i.prototype.set=function(e,n,i){if(("object"!=typeof i||null===i)&&(i={}),"undefined"==typeof n||null===n)n="",i.hoursToLive=-8760;else if("string"!=typeof n){if("object"!=typeof JSON||null===JSON||"function"!=typeof JSON.stringify)throw new Error("cookies.set() received non-string value and could not serialize.");n=JSON.stringify(n)}var s=t(i);document.cookie=e+"="+encodeURIComponent(n)+s},i.prototype.del=function(e,t){var n,i={};("object"!=typeof t||null===t)&&(t={}),"boolean"==typeof e&&e===!0?i=this.get():"string"==typeof e&&(i[e]=!0);for(n in i)"string"==typeof n&&""!==n&&this.set(n,null,t)},i.prototype.test=function(){var e=!1,t="cT",n="data";return this.set(t,n),this.get(t)===n&&(this.del(t),e=!0),e},i.prototype.setOptions=function(t){"object"!=typeof t&&(t=null),s=e(t)},new i}(),function(){window.jQuery&&!function(e){e.cookies=jaaulde.utils.cookies;var t={cookify:function(t){return this.each(function(){var n,i,s,a=["name","id"],r=e(this);for(n in a)if(!isNaN(n)&&(i=r.attr(a[n]),"string"==typeof i&&""!==i)){r.is(":checkbox, :radio")?r.attr("checked")&&(s=r.val()):s=r.is(":input")?r.val():r.html(),("string"!=typeof s||""===s)&&(s=null),e.cookies.set(i,s,t);break}})},cookieFill:function(){return this.each(function(){var t,n,i,s,a=["name","id"],r=e(this);for(n=function(){return t=a.pop(),!!t};n();)if(i=r.attr(t),"string"==typeof i&&""!==i){s=e.cookies.get(i),null!==s&&(r.is(":checkbox, :radio")?r.val()===s?r.attr("checked","checked"):r.removeAttr("checked"):r.is(":input")?r.val(s):r.html(s));break}})},cookieBind:function(t){return this.each(function(){var n=e(this);n.cookieFill().change(function(){n.cookify(t)})})}};e.each(t,function(t){e.fn[t]=this})}(window.jQuery)}(),function(e){e.fn.inputfit=function(t){var n=e.extend({minSize:12,maxSize:24},t);return this.each(function(){e(this).is(":input")&&e(this).bind("keyup click",function(){var t=e(this),i=this.id+"_size-changing-clone",s=e(this).width();e("#"+i).length||e("<div></div>",{id:i,css:{fontSize:e(this).css("font-size"),position:"absolute",left:"-9999px",fontFamily:e(this).css("font-family")}}).insertAfter(this);var a=e("#"+i);a.text(t.val());var r=parseInt(t.css("font-size"));if(a.width()<s-10){for(;a.width()<s-20&&r<n.maxSize;)r++,a.css("font-size",r+"px");t.css("font-size",r+"px")}else{for(;a.width()>s-20&&r>n.minSize;)r--,a.css("font-size",r+"px");t.css("font-size",r+"px")}})}),this}}(jQuery),function(e){var t="placeholder"in document.createElement("input");e.fn.placeholder=function(n){if(!t){if(n){switch(n){case"clear":this.each(function(){var t=e(this);(t.data("isEmpty")||t.val()==t.attr("placeholder"))&&t.val("")})}return this}this.each(function(){e(this).data("gotPlaceholder")||(e(this).focus(function(){var t=e(this);t.data("isEmpty")&&t.val("").removeClass("placeholder")}).blur(function(){var t=e(this);(t.data("isEmpty")||!t.val().length)&&t.val(t.attr("placeholder")).addClass("placeholder")}).keyup(function(){var t=e(this);t.data("isEmpty",0==t.val().length)}).data("gotPlaceholder",!0),e(this).val().length&&e(this).val()!=e(this).attr("placeholder")||e(this).val(e(this).attr("placeholder")).addClass("placeholder").data("isEmpty",!0))})}return e("form").submit(function(){e("input",this).each(function(){e(this).val()==e(this).attr("placeholder")&&e(this).val("")})}),this}}(jQuery),function(e){function t(e){return String(null===e||void 0===e?"":e)}function n(e){return t(e).replace(l,function(e){return o[e]})}var i={method:"GET",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,contentType:"json",prePopulate:null,processPrePopulate:!1,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&times;",animateDropdown:!0,placeholder:null,alwaysShowPlaceholder:!1,theme:null,zindex:999,resultsLimit:null,leftPadding:99,initialWidth:210,enableHTML:!1,resultsFormatter:function(e){var t=e[this.propertyToSearch];return"<li>"+(this.enableHTML?t:n(t))+"</li>"},tokenFormatter:function(e){var t=e[this.propertyToSearch];return"<li><p>"+(this.enableHTML?t:n(t))+"</p></li>"},tokenLimit:null,tokenDelimiter:",",preventDuplicates:!1,tokenValue:"id",allowFreeTagging:!1,allowTabOut:!1,onResult:null,onCachedResult:null,onAdd:null,onFreeTaggingAdd:null,onDelete:null,onReady:null,idPrefix:"token-input-",disabled:!1},s={tokenList:"token-input-list",token:"token-input-token",tokenReadOnly:"token-input-token-readonly",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token",focused:"token-input-focused",disabled:"token-input-disabled"},a={BEFORE:0,AFTER:1,END:2},r={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188},o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},l=/[&<>"'\/]/g,p={init:function(t,n){var s=e.extend({},i,n||{});return this.each(function(){e(this).data("settings",s),e(this).data("tokenInputObject",new e.TokenList(this,t,s))})},clear:function(){return this.data("tokenInputObject").clear(),this},add:function(e){return this.data("tokenInputObject").add(e),this},remove:function(e){return this.data("tokenInputObject").remove(e),this},get:function(){return this.data("tokenInputObject").getTokens()},toggleDisabled:function(e){return this.data("tokenInputObject").toggleDisabled(e),this},setOptions:function(t){return e(this).data("settings",e.extend({},e(this).data("settings"),t||{})),this}};e.fn.tokenInput=function(e){return p[e]?p[e].apply(this,Array.prototype.slice.call(arguments,1)):p.init.apply(this,arguments)},e.TokenList=function(t,i,o){function l(i){return e(t).data("settings").enableHTML?i:n(i)}function p(n){"boolean"==typeof n?e(t).data("settings").disabled=n:e(t).data("settings").disabled=!e(t).data("settings").disabled,q.attr("disabled",e(t).data("settings").disabled),H.toggleClass(e(t).data("settings").classes.disabled,e(t).data("settings").disabled),B&&g(e(B),a.END),z.attr("disabled",e(t).data("settings").disabled)}function c(){return null!==e(t).data("settings").tokenLimit&&I>=e(t).data("settings").tokenLimit?(q.hide(),void y()):void 0}function u(){if(O!==(O=q.val()))if(0==I)q.width(e(t).data("settings").initialWidth);else{var i=H.width()-q.offset().left-H.offset().left;G.html(n(O)),q.width(Math.min(H.width(),Math.max(i,G.width()+30)))}}function d(){if(!e(t).data("isAddingFreetaggingTokens")){e(t).data("isAddingFreetaggingTokens",!0);var n=e.trim(q.val()),i=n.split(e(t).data("settings").tokenDelimiter);e.each(i,function(n,i){if(i&&(!e.isFunction(e(t).data("settings").onFreeTaggingAdd)||(i=e(t).data("settings").onFreeTaggingAdd.call(z,i),"DELETE ME"!=i.name))){var s={};s.constructor==Object?(s.name=i.name,s.email=i.email):s[e(t).data("settings").tokenValue]=s[e(t).data("settings").propertyToSearch]=i,f(s)}}),e(t).data("isAddingFreetaggingTokens",!1),e(q).val("")}}function h(n){var i=e(e(t).data("settings").tokenFormatter(n)),s=n.readonly===!0?!0:!1;s&&i.addClass(e(t).data("settings").classes.tokenReadOnly),i.addClass(e(t).data("settings").classes.token).insertBefore(J),s||e("<span>"+e(t).data("settings").deleteText+"</span>").addClass(e(t).data("settings").classes.tokenDelete).appendTo(i).click(function(){return e(t).data("settings").disabled?void 0:(b(e(this).parent()),z.change(),!1)});var a=n;return e.data(i.get(0),"tokeninput",n),P=P.slice(0,W).concat([a]).concat(P.slice(W)),W++,v(P,z),I+=1,null!==e(t).data("settings").tokenLimit&&I>=e(t).data("settings").tokenLimit&&(q.hide(),y()),i}function f(n){var i=e(t).data("settings").onAdd;if(I>0&&e(t).data("settings").preventDuplicates){var s=null;if(H.children().each(function(){var t=e(this),i=e.data(t.get(0),"tokeninput");try{if(i&&void 0!=i.id&&i[o.tokenValue]===n[o.tokenValue])return s=t,!1;if(void 0!=i.email&&i.email===n.email)return s=t,!1}catch(a){}}),s)return void alert("This item has already been added to the list!")}q.width(0),(null==e(t).data("settings").tokenLimit||I<e(t).data("settings").tokenLimit)&&(h(n),o.alwaysShowPlaceholder||q.attr("placeholder",null),c()),q.val(""),y(),e.isFunction(i)&&i.call(z,n)}function m(n){e(t).data("settings").disabled||(B&&g(e(B)),n.addClass(e(t).data("settings").classes.selectedToken),B=n.get(0),q.val("").focus(),y())}function g(n,i){n.removeClass(e(t).data("settings").classes.selectedToken),B=null,i===a.BEFORE?(J.insertBefore(n),W--):i===a.AFTER?(J.insertAfter(n),W++):(J.appendTo(H),W=I),F(q)}function _(t){var n=B;B&&g(e(B),a.END),n===t.get(0)?g(t,a.END):m(t)}function b(n){var i=e.data(n.get(0),"tokeninput"),s=e(t).data("settings").onDelete,a=n.prevAll().length;a>W&&a--,n.remove(),B=null,F(q),P=P.slice(0,a).concat(P.slice(a+1)),0==P.length&&q.attr("placeholder",o.placeholder),W>a&&W--,v(P,z),I-=1,null!==e(t).data("settings").tokenLimit&&(q.show().val(""),F(q)),e.isFunction(s)&&s.call(z,i)}function v(n,i){var s=e.map(n,function(n){return"function"==typeof e(t).data("settings").tokenValue?e(t).data("settings").tokenValue.call(this,n):n[e(t).data("settings").tokenValue]});i.val(s.join(e(t).data("settings").tokenDelimiter))}function y(){V.hide().empty(),U=null}function w(){V.css({position:"fixed",top:e(H).offset().top-e(window).scrollTop()+e(H).height()+10,left:e(H).offset().left-e(t).data("settings").leftPadding,width:e(H).width()+(e(t).data("settings").leftPadding+9),"z-index":9999999}).show()}function x(){e(t).data("settings").hintText&&(V.html("<p>"+l(e(t).data("settings").hintText)+"</p>"),w())}function A(e){return e.replace(X,"\\$&")}function k(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+A(t)+")(?![^<>]*>)(?![^&;]+;)","gi"),function(e,t){return"<b>"+l(t)+"</b>"})}function S(e,t,n){try{return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+A(t)+")(?![^<>]*>)(?![^&;]+;)","g"),k(t,n))}catch(i){return e}}function T(n){return e(t).data("settings").resultsLimit&&n.length>e(t).data("settings").resultsLimit&&(n=n.slice(0,e(t).data("settings").resultsLimit)),n}function C(n,i){if(i&&i.length){V.empty();var s=e("<ul>").appendTo(V).mouseover(function(t){$(e(t.target).closest("li"))}).mousedown(function(t){return f(e(t.target).closest("li").data("tokeninput")),z.change(),!1}).hide();e.each(i,function(i,a){var r=e(t).data("settings").resultsFormatter(a);r=S(r,a[e(t).data("settings").propertyToSearch],n),r=e(r).appendTo(s),i%2?r.addClass(e(t).data("settings").classes.dropdownItem):r.addClass(e(t).data("settings").classes.dropdownItem2),0===i&&$(r),e.data(r.get(0),"tokeninput",a)}),w(),e(t).data("settings").animateDropdown?s.slideDown("fast"):s.show()}else e(t).data("settings").noResultsText&&("[blank]"==e(t).data("settings").noResultsText?y():(V.html("<p>"+l(e(t).data("settings").noResultsText)+"</p>"),w()),U=null)}function $(n){n&&(U&&E(e(U)),n.addClass(e(t).data("settings").classes.selectedDropdownItem),U=n.get(0))}function E(n){n.removeClass(e(t).data("settings").classes.selectedDropdownItem),U=null}function N(){var n=q.val();n&&n.length&&(B&&g(e(B),a.AFTER),n.length>=e(t).data("settings").minChars?(clearTimeout(M),M=setTimeout(function(){j(n)},e(t).data("settings").searchDelay)):y())}function j(n){var i=n+D(),s=L.get(i);if(s)e.isFunction(e(t).data("settings").onCachedResult)&&(s=e(t).data("settings").onCachedResult.call(z,s)),C(n,s);else if(e(t).data("settings").url){var a=D(),r={};if(r.data={},a.indexOf("?")>-1){var o=a.split("?");r.url=o[0];var l=o[1].split("&");e.each(l,function(e,t){var n=t.split("=");r.data[n[0]]=n[1]})}else r.url=a;r.data[e(t).data("settings").queryParam]=n,r.type=e(t).data("settings").method,r.dataType=e(t).data("settings").contentType,e(t).data("settings").crossDomain&&(r.dataType="jsonp"),r.success=function(s){s=T(s),L.add(i,e(t).data("settings").jsonContainer?s[e(t).data("settings").jsonContainer]:s),e.isFunction(e(t).data("settings").onResult)&&(s=e(t).data("settings").onResult.call(z,s)),q.val()===n&&C(n,e(t).data("settings").jsonContainer?s[e(t).data("settings").jsonContainer]:s)},e.ajax(r)}else if(e(t).data("settings").local_data){var p=e.grep(e(t).data("settings").local_data,function(i){return i[e(t).data("settings").propertyToSearch].toLowerCase().indexOf(n.toLowerCase())>-1});p=T(p),p=p.sort(function(i,s){return row1_match=i[e(t).data("settings").propertyToSearch].substr(0,n.length).toLowerCase()!=n.toLowerCase(),row2_match=s[e(t).data("settings").propertyToSearch].substr(0,n.length).toLowerCase()!=n.toLowerCase(),row1_match?1:row2_match?-1:0}),L.add(i,p),e.isFunction(e(t).data("settings").onResult)&&(p=e(t).data("settings").onResult.call(z,p)),C(n,p)}}function D(){var n=e(t).data("settings").url;return"function"==typeof e(t).data("settings").url&&(n=e(t).data("settings").url.call(e(t).data("settings"))),n}function F(e){setTimeout(function(){e.focus()},50)}if("string"===e.type(i)||"function"===e.type(i)){e(t).data("settings").url=i;var R=D();void 0===e(t).data("settings").crossDomain&&"string"==typeof R&&(-1===R.indexOf("://")?e(t).data("settings").crossDomain=!1:e(t).data("settings").crossDomain=location.href.split(/\/+/g)[1]!==R.split(/\/+/g)[1])}else"object"==typeof i&&(e(t).data("settings").local_data=i);e(t).data("settings").classes?e(t).data("settings").classes=e.extend({},s,e(t).data("settings").classes):e(t).data("settings").theme?(e(t).data("settings").classes={},e.each(s,function(n,i){e(t).data("settings").classes[n]=i+"-"+e(t).data("settings").theme})):e(t).data("settings").classes=s;var M,O,P=[],I=0,L=new e.TokenList.Cache,q=e('<input type="text" autocomplete="off">').css({outline:"none"}).attr("id",e(t).data("settings").idPrefix+t.id).focus(function(){return e(t).data("settings").disabled?!1:((null===e(t).data("settings").tokenLimit||e(t).data("settings").tokenLimit!==I)&&x(),void H.addClass(e(t).data("settings").classes.focused))}).blur(function(){y(),e(t).data("settings").allowFreeTagging&&d(),H.removeClass(e(t).data("settings").classes.focused)}).bind("keyup keydown blur update",u).keydown(function(n){var i,s;switch(n.keyCode){case r.LEFT:case r.RIGHT:case r.UP:case r.DOWN:if(e(this).val()){var o=null;o=n.keyCode===r.DOWN||n.keyCode===r.RIGHT?e(U).next():e(U).prev(),o.length&&$(o)}else i=J.prev(),s=J.next(),i.length&&i.get(0)===B||s.length&&s.get(0)===B?n.keyCode===r.LEFT||n.keyCode===r.UP?g(e(B),a.BEFORE):g(e(B),a.AFTER):n.keyCode!==r.LEFT&&n.keyCode!==r.UP||!i.length?n.keyCode!==r.RIGHT&&n.keyCode!==r.DOWN||!s.length||m(e(s.get(0))):m(e(i.get(0)));return!1;case r.BACKSPACE:if(i=J.prev(),!e(this).val().length)return B?(b(e(B)),z.change()):i.length&&m(e(i.get(0))),!1;1===e(this).val().length?y():setTimeout(function(){N()},5);break;case r.TAB:case r.ENTER:case r.NUMPAD_ENTER:case r.COMMA:if(U)f(e(U).data("tokeninput")),z.change();else{if(e(t).data("settings").allowFreeTagging){if(e(t).data("settings").allowTabOut&&""===e(this).val())return!0;d()}else if(e(this).val(""),e(t).data("settings").allowTabOut)return!0;n.stopPropagation(),n.preventDefault()}return!1;case r.ESCAPE:return y(),!0;default:String.fromCharCode(n.which)&&setTimeout(function(){N()},5)}});o.placeholder&&q.attr("placeholder",o.placeholder);var z=e(t).hide().val("").focus(function(){F(q)}).blur(function(){q.blur()}),B=null,W=0,U=null,H=e("<ul />").addClass(e(t).data("settings").classes.tokenList).click(function(t){var n=e(t.target).closest("li");n&&n.get(0)&&e.data(n.get(0),"tokeninput")?_(n):(B&&g(e(B),a.END),F(q))}).mouseover(function(n){var i=e(n.target).closest("li");i&&B!==this&&i.addClass(e(t).data("settings").classes.highlightedToken)}).mouseout(function(n){var i=e(n.target).closest("li");i&&B!==this&&i.removeClass(e(t).data("settings").classes.highlightedToken)}).insertBefore(z),J=e("<li />").addClass(e(t).data("settings").classes.inputToken).appendTo(H).append(q),V=e("<div>").addClass(e(t).data("settings").classes.dropdown).appendTo("body").hide(),G=e("<tester/>").insertAfter(q).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:q.css("fontSize"),fontFamily:q.css("fontFamily"),fontWeight:q.css("fontWeight"),letterSpacing:q.css("letterSpacing"),whiteSpace:"nowrap"});z.val("");var Y=e(t).data("settings").prePopulate||z.data("pre");e(t).data("settings").processPrePopulate&&e.isFunction(e(t).data("settings").onResult)&&(Y=e(t).data("settings").onResult.call(z,Y)),Y&&Y.length&&e.each(Y,function(e,t){h(t),o.alwaysShowPlaceholder||q.attr("placeholder",null),c()}),e(t).data("settings").disabled&&p(!0),e.isFunction(e(t).data("settings").onReady)&&e(t).data("settings").onReady.call(),this.clear=function(){H.children("li").each(function(){0===e(this).children("input").length&&b(e(this))})},this.add=function(e){f(e)},this.remove=function(t){H.children("li").each(function(){if(0===e(this).children("input").length){var n=e(this).data("tokeninput"),i=!0;for(var s in t)if(t[s]!==n[s]){i=!1;break}i&&b(e(this))}})},this.getTokens=function(){return P},this.toggleDisabled=function(e){p(e)},u();var X=new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g")},e.TokenList.Cache=function(t){var n=e.extend({max_size:500},t),i={},s=0,a=function(){i={},s=0};this.add=function(e,t){s>n.max_size&&a(),i[e]||(s+=1),i[e]=t},this.get=function(e){return i[e]}}}(jQuery),function(){}.call(this),function(){function e(t,n,i){var s=e.resolve(t);if(null==s){i=i||t,n=n||"root";var a=new Error('Failed to require "'+i+'" from "'+n+'"');throw a.path=i,a.parent=n,a.require=!0,a}var r=e.modules[s];if(!r._resolving&&!r.exports){var o={};o.exports={},o.client=o.component=!0,r._resolving=!0,r.call(this,o.exports,e.relative(s),o),delete r._resolving,r.exports=o.exports}return r.exports}e.modules={},e.aliases={},e.resolve=function(t){"/"===t.charAt(0)&&(t=t.slice(1));for(var n=[t,t+".js",t+".json",t+"/index.js",t+"/index.json"],i=0;i<n.length;i++){var t=n[i];if(e.modules.hasOwnProperty(t))return t;if(e.aliases.hasOwnProperty(t))return e.aliases[t]}},e.normalize=function(e,t){var n=[];if("."!=t.charAt(0))return t;e=e.split("/"),t=t.split("/");for(var i=0;i<t.length;++i)".."==t[i]?e.pop():"."!=t[i]&&""!=t[i]&&n.push(t[i]);return e.concat(n).join("/")},e.register=function(t,n){e.modules[t]=n},e.alias=function(t,n){if(!e.modules.hasOwnProperty(t))throw new Error('Failed to alias "'+t+'", it does not exist');e.aliases[n]=t},e.relative=function(t){function n(e,t){for(var n=e.length;n--;)if(e[n]===t)return n;return-1}function i(n){var s=i.resolve(n);return e(s,t,n)}var s=e.normalize(t,"..");return i.resolve=function(i){var a=i.charAt(0);if("/"==a)return i.slice(1);if("."==a)return e.normalize(s,i);var r=t.split("/"),o=n(r,"deps")+1;return o||(o=0),i=r.slice(0,o+1).join("/")+"/deps/"+i},i.exists=function(t){return e.modules.hasOwnProperty(i.resolve(t))},i},e.register("abpetkov-transitionize/transitionize.js",function(e,t,n){function i(e,t){return this instanceof i?(this.element=e,this.props=t||{},void this.init()):new i(e,t)}n.exports=i,i.prototype.isSafari=function(){return/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)},i.prototype.init=function(){var e=[];for(var t in this.props)e.push(t+" "+this.props[t]);this.element.style.transition=e.join(", "),this.isSafari()&&(this.element.style.webkitTransition=e.join(", "))}}),e.register("ftlabs-fastclick/lib/fastclick.js",function(e,t,n){function i(e){"use strict";var t,n=this;if(this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=10,this.layer=e,!e||!e.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){return i.prototype.onClick.apply(n,arguments)},this.onMouse=function(){return i.prototype.onMouse.apply(n,arguments)},this.onTouchStart=function(){return i.prototype.onTouchStart.apply(n,arguments)},this.onTouchMove=function(){return i.prototype.onTouchMove.apply(n,arguments)},this.onTouchEnd=function(){return i.prototype.onTouchEnd.apply(n,arguments)},this.onTouchCancel=function(){return i.prototype.onTouchCancel.apply(n,arguments)},i.notNeeded(e)||(this.deviceIsAndroid&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,i){var s=Node.prototype.removeEventListener;"click"===t?s.call(e,t,n.hijacked||n,i):s.call(e,t,n,i)},e.addEventListener=function(t,n,i){var s=Node.prototype.addEventListener;"click"===t?s.call(e,t,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),i):s.call(e,t,n,i)}),"function"==typeof e.onclick&&(t=e.onclick,e.addEventListener("click",function(e){t(e)},!1),e.onclick=null))}i.prototype.deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,i.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),i.prototype.deviceIsIOS4=i.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),i.prototype.deviceIsIOSWithBadTarget=i.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent),i.prototype.needsClick=function(e){"use strict";switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(this.deviceIsIOS&&"file"===e.type||e.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(e.className)},i.prototype.needsFocus=function(e){"use strict";switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!this.deviceIsAndroid;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},i.prototype.sendClick=function(e,t){"use strict";var n,i;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),i=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(e),!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},i.prototype.determineEventType=function(e){"use strict";return this.deviceIsAndroid&&"select"===e.tagName.toLowerCase()?"mousedown":"click"},i.prototype.focus=function(e){"use strict";var t;this.deviceIsIOS&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type?(t=e.value.length,
e.setSelectionRange(t,t)):e.focus()},i.prototype.updateScrollParent=function(e){"use strict";var t,n;if(t=e.fastClickScrollParent,!t||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},i.prototype.getTargetElementFromEventTarget=function(e){"use strict";return e.nodeType===Node.TEXT_NODE?e.parentNode:e},i.prototype.onTouchStart=function(e){"use strict";var t,n,i;if(e.targetTouches.length>1)return!0;if(t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0],this.deviceIsIOS){if(i=window.getSelection(),i.rangeCount&&!i.isCollapsed)return!0;if(!this.deviceIsIOS4){if(n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<200&&e.preventDefault(),!0},i.prototype.touchHasMoved=function(e){"use strict";var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n?!0:!1},i.prototype.onTouchMove=function(e){"use strict";return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},i.prototype.findControl=function(e){"use strict";return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},i.prototype.onTouchEnd=function(e){"use strict";var t,n,i,s,a,r=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<200)return this.cancelNextClick=!0,!0;if(this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,this.deviceIsIOSWithBadTarget&&(a=e.changedTouches[0],r=document.elementFromPoint(a.pageX-window.pageXOffset,a.pageY-window.pageYOffset)||r,r.fastClickScrollParent=this.targetElement.fastClickScrollParent),i=r.tagName.toLowerCase(),"label"===i){if(t=this.findControl(r)){if(this.focus(r),this.deviceIsAndroid)return!1;r=t}}else if(this.needsFocus(r))return e.timeStamp-n>100||this.deviceIsIOS&&window.top!==window&&"input"===i?(this.targetElement=null,!1):(this.focus(r),this.deviceIsIOS4&&"select"===i||(this.targetElement=null,e.preventDefault()),!1);return this.deviceIsIOS&&!this.deviceIsIOS4&&(s=r.fastClickScrollParent,s&&s.fastClickLastScrollTop!==s.scrollTop)?!0:(this.needsClick(r)||(e.preventDefault(),this.sendClick(r,e)),!1)},i.prototype.onTouchCancel=function(){"use strict";this.trackingClick=!1,this.targetElement=null},i.prototype.onMouse=function(e){"use strict";return this.targetElement?e.forwardedTouchEvent?!0:e.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1):!0:!0},i.prototype.onClick=function(e){"use strict";var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===e.target.type&&0===e.detail?!0:(t=this.onMouse(e),t||(this.targetElement=null),t)},i.prototype.destroy=function(){"use strict";var e=this.layer;this.deviceIsAndroid&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},i.notNeeded=function(e){"use strict";var t,n;if("undefined"==typeof window.ontouchstart)return!0;if(n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!i.prototype.deviceIsAndroid)return!0;if(t=document.querySelector("meta[name=viewport]")){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(n>31&&window.innerWidth<=window.screen.width)return!0}}return"none"===e.style.msTouchAction?!0:!1},i.attach=function(e){"use strict";return new i(e)},"undefined"!=typeof define&&define.amd?define(function(){"use strict";return i}):"undefined"!=typeof n&&n.exports?(n.exports=i.attach,n.exports.FastClick=i):window.FastClick=i}),e.register("switchery/switchery.js",function(e,t,n){function i(e,t){if(!(this instanceof i))return new i(e,t);this.element=e,this.options=t||{};for(var n in r)null==this.options[n]&&(this.options[n]=r[n]);null!=this.element&&"checkbox"==this.element.type&&this.init()}var s=t("transitionize"),a=t("fastclick");n.exports=i;var r={color:"#64bd63",secondaryColor:"#dfdfdf",className:"switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"};i.prototype.hide=function(){this.element.style.display="none"},i.prototype.show=function(){var e=this.create();this.insertAfter(this.element,e)},i.prototype.create=function(){return this.switcher=document.createElement("span"),this.jack=document.createElement("small"),this.switcher.appendChild(this.jack),this.switcher.className=this.options.className,this.switcher},i.prototype.insertAfter=function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},i.prototype.isChecked=function(){return this.element.checked},i.prototype.isDisabled=function(){return this.options.disabled||this.element.disabled},i.prototype.setPosition=function(e){var t=this.isChecked(),n=this.switcher,i=this.jack;e&&t?t=!1:e&&!t&&(t=!0),t===!0?(this.element.checked=!0,window.getComputedStyle?i.style.left=parseInt(window.getComputedStyle(n).width)-parseInt(window.getComputedStyle(i).width)+"px":i.style.left=parseInt(n.currentStyle.width)-parseInt(i.currentStyle.width)+"px",this.options.color&&this.colorize(),this.setSpeed()):(i.style.left=0,this.element.checked=!1,this.switcher.style.boxShadow="inset 0 0 0 0 "+this.options.secondaryColor,this.switcher.style.borderColor=this.options.secondaryColor,this.switcher.style.backgroundColor="",this.setSpeed())},i.prototype.setSpeed=function(){var e={},t={left:this.options.speed.replace(/[a-z]/,"")/2+"s"};e=this.isChecked()?{border:this.options.speed,"box-shadow":this.options.speed,"background-color":3*this.options.speed.replace(/[a-z]/,"")+"s"}:{border:this.options.speed,"box-shadow":this.options.speed},s(this.switcher,e),s(this.jack,t)},i.prototype.setAttributes=function(){var e=this.element.getAttribute("id"),t=this.element.getAttribute("name");e&&this.switcher.setAttribute("id",e),t&&this.switcher.setAttribute("name",t)},i.prototype.colorize=function(){this.switcher.style.backgroundColor=this.options.color,this.switcher.style.borderColor=this.options.color,this.switcher.style.boxShadow="inset 0 0 0 16px "+this.options.color},i.prototype.handleOnchange=function(e){if("function"!=typeof Event&&document.fireEvent)this.element.fireEvent("onchange");else{var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!0),this.element.dispatchEvent(t)}},i.prototype.handleChange=function(){var e=this,t=this.element;t.addEventListener?t.addEventListener("change",function(){e.setPosition()}):t.attachEvent("onchange",function(){e.setPosition()})},i.prototype.handleClick=function(){var e=this,t=this.switcher;this.isDisabled()===!1?(a(t),t.addEventListener?t.addEventListener("click",function(){e.setPosition(!0),e.handleOnchange(e.element.checked)}):t.attachEvent("onclick",function(){e.setPosition(!0),e.handleOnchange(e.element.checked)})):(this.element.disabled=!0,this.switcher.style.opacity=this.options.disabledOpacity)},i.prototype.disableLabel=function(){for(var e=this.element.parentNode,t=document.getElementsByTagName("label"),n=null,i=0;i<t.length;i++)t[i].getAttribute("for")===this.element.id&&(n=!0);(n===!0||"label"===e.tagName.toLowerCase())&&(e.addEventListener?e.addEventListener("click",function(e){e.preventDefault()}):e.attachEvent("onclick",function(e){e.returnValue=!1}))},i.prototype.markAsSwitched=function(){this.element.setAttribute("data-switchery",!0)},i.prototype.markedAsSwitched=function(){return this.element.getAttribute("data-switchery")},i.prototype.init=function(){this.hide(),this.show(),this.setPosition(),this.setAttributes(),this.markAsSwitched(),this.disableLabel(),this.handleChange(),this.handleClick()}}),e.alias("abpetkov-transitionize/transitionize.js","switchery/deps/transitionize/transitionize.js"),e.alias("abpetkov-transitionize/transitionize.js","switchery/deps/transitionize/index.js"),e.alias("abpetkov-transitionize/transitionize.js","transitionize/index.js"),e.alias("abpetkov-transitionize/transitionize.js","abpetkov-transitionize/index.js"),e.alias("ftlabs-fastclick/lib/fastclick.js","switchery/deps/fastclick/lib/fastclick.js"),e.alias("ftlabs-fastclick/lib/fastclick.js","switchery/deps/fastclick/index.js"),e.alias("ftlabs-fastclick/lib/fastclick.js","fastclick/index.js"),e.alias("ftlabs-fastclick/lib/fastclick.js","ftlabs-fastclick/index.js"),e.alias("switchery/switchery.js","switchery/index.js"),"object"==typeof exports?module.exports=e("switchery"):"function"==typeof define&&define.amd?define(function(){return e("switchery")}):this.Switchery=e("switchery")}(),function(){var e,t,n,i=function(e,t){function n(){this.constructor=e}for(var i in t)s.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},s={}.hasOwnProperty,a=function(e,t){return function(){return e.apply(t,arguments)}};this.App=this.App||{},e=13,n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.parse=function(e){var t;return null!=(t=e.email_identity)?t:e},t.prototype.isConfirmed=function(){return null!=this.get("confirmed_at")},t.prototype.confirmationState=function(){return this.isConfirmed()?"confirmed":"unconfirmed"},t.prototype.isPrimary=function(){return-1!==_.indexOf(this.get("flags"),"primary")},t.prototype.resendConfirmation=function(e){return null==e&&(e={}),(this.sync||Backbone.sync)("update",this,_.extend(e,{url:this.url()+"/resend_confirmation"}))},t}(Backbone.Model),t=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.url="/identities",t.prototype.model=n,t.prototype.findForEmail=function(e){return this.find(function(t){return t.get("raw_string")===e})},t}(Backbone.Collection),App.IdentitiesView=function(s){function r(){return this.render=a(this.render,this),r.__super__.constructor.apply(this,arguments)}return i(r,s),r.prototype.el=".identities",r.prototype.template=JST["backbone/templates/identities"],r.prototype.events={"click .add-identity":"addIdentity","keyup #raw-string":"updateIdentity","change #raw-string":"updateIdentity","keydown #raw-string":"submitOnEnter","keydown #identity-current-password":"submitOnEnter","click #submit-identity":"submitIdentity","click .btn-cancel":"cancelIdentity","click .delete":"confirmRemoveIdentity","keydown .remove-current-password":"removeIdentity","click .remove-password-confirm":"removeIdentity","change .primary-radio":"updatePrimaryIdentity","click .resend-confirmation":"resendConfirmation"},r.prototype.initialize=function(e){return this.collection=new t(e),this.collection.on("add reset remove",this.render),this.render()},r.prototype.render=function(){var e;return this.$el.html(this.template({identities:this.collection})),"function"==typeof(e=this.$("a[rel=tooltip]")).tooltip?e.tooltip({placement:"bottom"}):void 0},r.prototype.addIdentity=function(e){return e.preventDefault(),null==this.newIdentity?(this.newIdentity=new n,this.collection.add(this.newIdentity)):void 0},r.prototype.submitOnEnter=function(t){return t.keyCode===e?(t.preventDefault(),this.submitIdentity()):void 0},r.prototype.updateIdentity=function(e){return this.newIdentity.set("raw_string",this.$("#raw-string").val())},r.prototype.submitIdentity=function(e){return null!=e&&e.preventDefault(),""!==$.trim(this.newIdentity.get("raw_string"))?(this.$(".disable-on-save").attr({disabled:!0}),this.newIdentity.save({current_password:this.$("#identity-current-password").val(),token:$("#token").val()},{success:function(e){return function(t,n,i){return FlashMessage.add({type:"notice",message:n.message}),e.newIdentity=null,e.collection.fetch({data:{token:$("#token").val()}})}}(this),error:function(e){return function(t,n,i){var s;return s=n.responseText,FlashMessage.displayJSONErrors(s),e.$(".disable-on-save").attr({disabled:!1})}}(this)})):void 0},r.prototype.cancelIdentity=function(e){return null!=e&&e.preventDefault(),this.collection.remove(this.newIdentity),this.render(),this.newIdentity=null},r.prototype.confirmRemoveIdentity=function(e){var t;return e.preventDefault(),t=$(e.target),this.emailToRemove=t.data("email"),this.$(".confirm-remove").remove(),this._removeCurrentPassword$El().insertAfter(t.closest("tr"))},r.prototype.removeIdentity=function(t){var n;if(null==t.keyCode||t.keyCode===e)return null!=t&&t.preventDefault(),null!=(n=this.collection.findForEmail(this.emailToRemove))?n.destroy({data:{current_password:this.$(".remove-current-password").val(),token:$("#token").val()},processData:!0,wait:!0,success:function(e){return function(t,n,i){return FlashMessage.add({type:"notice",message:n.message}),e.collection.trigger("reset")}}(this),error:function(e,t,n){var i;return i=t.responseText,FlashMessage.displayJSONErrors(i)}}):void 0},r.prototype.updatePrimaryIdentity=function(e){var t,n;return t=this.$(e.target).val(),n=this.collection.findForEmail(t),n.save({flags:n.get("flags").concat("primary"),token:$("#token").val()},{error:function(e,t,n){var i;return i=t.responseText,FlashMessage.displayJSONErrors(i)},success:function(e){return function(){return e.collection.fetch({data:{token:$("#token").val()}}),FlashMessage.add({type:"notice",message:App.t("EMAIL_was_made_your_primary_address",t)})}}(this)})},r.prototype.resendConfirmation=function(e){return e.preventDefault(),this.collection.findForEmail(this.$(e.target).data("email")).resendConfirmation({data:{token:$("#token").val()},processData:!0,success:function(e,t,n){var i;return i=e.message,FlashMessage.add({type:"notice",message:i})},error:function(e,t,n){var i;return i=t.responseText,FlashMessage.displayJSONErrors(i)}})},r.prototype._removeCurrentPassword$El=function(){var e,t;return e=_.templateSettings.interpolate,_.templateSettings.interpolate=/\<\@\=(.+?)\@\>/g,t=$(_.template("<tr class='confirm-remove'>\n  <td colspan=\"3\">\n    <div><@= App.t('enter_password_to_remove_email') @></div>\n    <input type='password' class='remove-current-password' />\n    <br />\n    <a href='#' class='btn btn-cancel'><@= App.t('cancel') @></a>\n    <a href='#' class='btn btn-red remove-password-confirm'><@= App.t('confirm__removal') @></a>\n  </td>\n</tr>")()),_.templateSettings.interpolate=e,t},r}(Backbone.View)}.call(this),jQuery.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},$(document).ready(function(){var e=window.ActiveXObject||"ActiveXObject"in window;navigator.userAgent&&navigator.appName&&("Opera"==navigator.appName&&navigator.userAgent.match(/Version\/12\./)||-1!=navigator.userAgent.indexOf("MSIE 10.")||e)&&$(".modal").removeClass("fade")}),FlashMessage={flashContainerId:"flash-container",flashEntryPoint:".header .flex_container",add:function(e){_.isEmpty(e)||(this._ensureContainer(),this._el.children().slideUp(250,function(){$(this).remove()}),this._el.prepend(JST["backbone/templates/flash-message"]({type:e.type,message:e.message})),this._el.children().slideDown(250))},displayJSONErrors:function(e){var t=JSON.parse(e);_.each(t,function(e){FlashMessage.add({type:"error",message:e})})},_ensureContainer:function(){this._el||(this._el=$("<div id='"+this.flashContainerId+"'></div>"),$(this.flashEntryPoint).append(this._el))}},function(){location.hostname.match(/\.splitwise\.com$/)&&(document.domain="splitwise.com")}(),jQuery.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),window.console||(window.console={}),window.console.log||(window.console.log=function(){}),window.alert||(window.alert=function(){}),window.confirm||(window.confirm=function(){}),window.prompt||(window.prompt=function(){}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){for(var n=t||0,i=this.length;i>n;n++)if(this[n]===e)return n;return-1}),function(){var e=new Date("2011-06-02T09:34:29+02:00");e&&1307000069e3===+e?Date.fromISO=function(e){return new Date(e)}:Date.fromISO=function(e){if(e.getMonth)return e;var t,n,i=/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/,s=i.exec(e)||[];if(s[1]){t=s[1].split(/\D/);for(var a=0,r=t.length;r>a;a++)t[a]=parseInt(t[a],10)||0;return t[1]-=1,t=new Date(Date.UTC.apply(Date,t)),t.getDate()?(s[5]&&(n=60*parseInt(s[5],10),s[6]&&(n+=parseInt(s[6],10)),"+"==s[4]&&(n*=-1),n&&t.setUTCMinutes(t.getUTCMinutes()+n)),t):NaN}return NaN}}();