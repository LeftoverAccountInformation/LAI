function __formatDateTime(e,t,n){var o=n.DateTimeService.getMomentFromBackendDate(e);return o?n.StringService.capitalizedFirst(o.format(t)):""}window.coreConfigModule=angular.module("CoreConfigModule",[]).constant("EMAIL_REGEX",/^\S+@\S+\.\S+$/).constant("PASSWORD_REGEX",/^(?=.*[0-9])(?=.*[a-zA-Z])(.{7,15})$/).constant("NAME_REGEX",/^([a-zA-Z ]){2,25}$/).constant("PNR_REGEX",/^([A-Za-z0-9]{6,10})$/).constant("FLIGHT_NUMBER_REGEX",/^([^\W_]{2}[a-zA-Z]?)?(\d{1,4})[a-zA-Z]?$/).constant("CONFIRMATION_NUMBER_REGEX",/^([A-Za-z0-9]{0,20})$/).constant("DATE_PATTERN",/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/).constant("TIME_PATTERN",/^([0-9]{2}):([0-9]{2})$/),window.coreModule=angular.module("CoreModule",["CoreConfigModule","ionic","ipCookie","pascalprecht.translate"]),window.coreModule.config(["$translatePartialLoaderProvider","$translateProvider","$provide","$qProvider",function(e,t,n,o){function i(e,t,n,o){var i={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return t?i[n][0]:i[n][1]}e.addPart("core"),o.errorOnUnhandledRejections(!1),t.useMissingTranslationHandler("MissingTranslationHandler"),n.decorator("$exceptionHandler",["$log","$delegate",function(e,t){return function(n,o){isDefined(e.getInstance)&&(e=e.getInstance("Core"));var i=safeAccess(n,"message","No message in exception"),r=safeAccess(n,"stack","at No stack in exception"),a=r.split("at ")[1];e.error(i,a),t(n,o)}}]),moment.updateLocale("en",{relativeTime:{future:"Starts in %s",past:"Ended %s ago",s:"seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"}}),moment.updateLocale("fr",{relativeTime:{future:"Commence dans %s",past:"Terminé il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"}}),moment.updateLocale("de",{relativeTime:{future:"Beginnt in %s",past:"Endete vor %s",s:"ein paar Sekunden",m:i,mm:"%d Minuten",h:i,hh:"%d Stunden",d:i,dd:i,M:i,MM:i,y:i,yy:i}}),moment.updateLocale("it",{relativeTime:{future:"Comincia tra %s",past:"Concluso %s fa",s:"alcuni secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"}}),moment.updateLocale("es",{relativeTime:{future:"Empieza en %s",past:"Terminó hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:function(e){return e.toString()}}),moment.updateLocale("pt",{relativeTime:{future:"Começa em %s",past:"Acabado há %s",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"}}),moment.updateLocale("zh",{relativeTime:{future:"还有%s 开始",past:"%s 前结束",s:"秒",m:"一分钟",mm:"%d 分钟",h:"一小时",hh:"%d 小时",d:"一天",dd:"%d 天",M:"一个月",MM:"%d 月",y:"一年",yy:"%d 年"}}),moment.updateLocale("ru",{relativeTime:{future:"Начинается через %s",past:"Закончилось %s назад",s:"сек.",m:"минута",mm:"%d мин.",h:"час",hh:"%d ч.",d:"день",dd:"%d дн.",M:"месяц",MM:"%d мес.",y:"год",yy:"%d года"}}),moment.updateLocale("sv",{relativeTime:{future:"Startar om %s",past:"Slutade för %s sedan",s:"sekunder",m:"en minut",mm:"%d minuter",h:"en timma",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en månad",MM:"%d månader",y:"ett år",yy:"%d år"}}),window.cmtSpecificMomentDateFormatters={dayAndMonth:{"default":"Do MMM",ja:"M月D日"},tripdate:{"default":"DD MMM YYYY",ja:"YYYY年M月D日"},tripstart:{"default":"DD[<span>]MMM[</span>]",ja:"M月[<span>]D日[</span>]"},segmentDayLong:{"default":"dddd Do MMMM",ja:"dddd M月D日"},segmentDayLongTwoLines:{"default":"dddd[<br/>]Do MMMM",ja:"dddd[<br/>]M月D日"},segmentDayShort:{"default":"ddd Do MMMM YYYY",ja:"dddd YYYY年M月D日"},segmentDayTimeLong:{"default":"dddd Do MMMM, HH:mm",ja:"dddd YYYY年M月D日, HH:mm"},fullDateTimeTZNoTime:{"default":"dddd Do MMMM YYYY",ja:"dddd YYYY年M月D日"},fullDateTimeTZWithTime:{"default":"dddd Do MMMM YYYY, HH:mm zZ",ja:"dddd YYYY年M月D日, HH:mm zZ"}}}]),window.coreModule.run(["$log","LoggingService","$rootScope","PostMessageService","DataManagerService","NetworkService",function(e,t,n,o,i,r){e=e.getInstance("Core"),e.info("Module started"),i.init(),o.init(),r.init(),n.isDataTapDisabled=!getContext("isWebDesktop",!1)}]),function(e){"use strict";if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(t){}var n=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},o=function(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n},i=n.prototype,r=o.prototype,a=e.FileReaderSync,s=function(e){this.code=this[this.name=e]},c="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),l=c.length,u=e.URL||e.webkitURL||e,d=u.createObjectURL,f=u.revokeObjectURL,g=u,p=e.btoa,m=e.atob,v=e.ArrayBuffer,h=e.Uint8Array,C=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(o.fake=r.fake=!0;l--;)s.prototype[c[l]]=l+1;return u.createObjectURL||(g=e.URL=function(e){var t,n=document.createElementNS("http://www.w3.org/1999/xhtml","a");return n.href=e,"origin"in n||("data:"===n.protocol.toLowerCase()?n.origin=null:(t=e.match(C),n.origin=t&&t[1])),n}),g.createObjectURL=function(e){var t,n=e.type;return null===n&&(n="application/octet-stream"),e instanceof o?(t="data:"+n,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):p?t+";base64,"+p(e.data):t+","+encodeURIComponent(e.data)):d?d.call(u,e):void 0},g.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&f&&f.call(u,e)},i.append=function(e){var n=this.data;if(h&&(e instanceof v||e instanceof h)){for(var i="",r=new h(e),c=0,l=r.length;l>c;c++)i+=String.fromCharCode(r[c]);n.push(i)}else if("Blob"===t(e)||"File"===t(e)){if(!a)throw new s("NOT_READABLE_ERR");var u=new a;n.push(u.readAsBinaryString(e))}else e instanceof o?"base64"===e.encoding&&m?n.push(m(e.data)):"URI"===e.encoding?n.push(decodeURIComponent(e.data)):"raw"===e.encoding&&n.push(e.data):("string"!=typeof e&&(e+=""),n.push(unescape(encodeURIComponent(e))))},i.getBlob=function(e){return arguments.length||(e=null),new o(this.data.join(""),e,"raw")},i.toString=function(){return"[object BlobBuilder]"},r.slice=function(e,t,n){var i=arguments.length;return 3>i&&(n=null),new o(this.data.slice(e,i>1?t:this.data.length),n,this.encoding)},r.toString=function(){return"[object Blob]"},r.close=function(){this.size=0,delete this.data},n}(e);e.Blob=function(e,t){var o=t?t.type||"":"",i=new n;if(e)for(var r=0,a=e.length;a>r;r++)Uint8Array&&e[r]instanceof Uint8Array?i.append(e[r].buffer):i.append(e[r]);var s=i.getBlob(o);return!s.slice&&s.webkitSlice&&(s.slice=s.webkitSlice),s};var o=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=o(new e.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var o=n.indexOf(e,t);return-1!==o&&o===t}),Object.values||(Object.values=function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty(e,n)||t.push(e[n]);return t}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var o=arguments[1],i=0;n>i;){var r=t[i];if(e.call(o,r,i,t))return r;i++}}}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=0,o=this.length;o>n;++n)e.call(t,this[n],n,this)}),function(){function e(e){var t="";for(var n in e){t+=n,t+="{";for(var o in e[n])t+=o+":"+e[n][o]+";";t+="}"}return t}function t(e){window.ApplicationContext=window.ApplicationContext||{};for(var t=window.ApplicationContext,n=e.split("."),o=0;o<n.length-1;o++){var i=n[o];if(t[i]||(t[i]={}),!angular.isObject(t[i])||Array.isArray(t[i]))throw new Error("Unable to extract the path '"+e+"' from ApplicationContext; non-object encountered along the path");t=t[i]}return{obj:t,key:n[o]}}window.handleUnexpectedError=function(e){console.warn("Unexpected error inside promise chain:"),console.error(e);var t=angular.element(document.body).injector().get("LayoutService");t&&t.loading(!1)},window.definedOrThrow=function(e,t){if(isUndefined(e)||window.hasUndefined(e))throw new Error(t)},window.hasUndefined=function(e){if(Array.isArray(e)){for(var t=e,n=0,o=t.length;o>n;n++)if("undefined"==typeof t[n])return!0}else if(angular.isObject(e)){for(var i in e)if("undefined"==typeof e[i])return!0}else console.error("hasUndefined: passed param is neither an array nor an object!");return!1},window.isDefined=function(e){return null!==e&&void 0!==e},window.isUndefined=function(e){return!isDefined(e)},window.safeAccess=function(e,t,n){if(window.isUndefined(e))return n;for(var o=t.split("."),i=0,r=o,a=r.length,s=e;a>i;i++){var c=r[i];if(c.indexOf("[")>-1){var l=/(\w*)\[(\d*)\]/.exec(c);c=l[1];var u=""!==c?s[c]:s;if(!isDefined(u)||!isDefined(u[l[2]]))return angular.isFunction(n)?n():n;s=u[l[2]]}else{if(!isDefined(s[c]))return angular.isFunction(n)?n():n;s=s[c]}}return s},window.injectCSSInHead=function(t,n,o){var i=document.getElementsByTagName("head")[0],r=null;if(o=o?o:"screen","string"==typeof t){var a=t;if(a&&a.indexOf(".css")>-1){for(var s=document.getElementsByTagName("link"),c=0;c<s.length;c++)if(s[c].href&&s[c].href===a)return;r=document.createElement("link"),n&&(r.id=n),r.rel="stylesheet",r.type="text/css",r.href=a,r.media=o}}else{var l=e(t);r=document.createElement("style"),n&&(r.id=n),r.styleSheet?r.styleSheet.cssText=l:r.appendChild(document.createTextNode(l)),r.media=o}i.appendChild(r)},window.getContext=function(e,n){var o=t(e),i=o.obj,r=o.key;return isDefined(i[r])?i[r]:n},window.isFeatureEnabled=function(e){return getContext("featureConfig."+e+".enabled",!1)},window.setContext=function(e,n){var o=t(e),i=o.obj,r=o.key;i[r]=n},window.convertCelsiusToFahrenheit=function(e){var t=0;return"string"==typeof e&&(e=parseFloat(e)),isNaN(e)||(t=9*e/5+32,t=parseFloat(t.toFixed(1))),t},window.convertFahrenheitToCelsius=function(e){var t=0;return"string"==typeof e&&(e=parseFloat(e)),isNaN(e)||(t=5*(e-32)/9,t=parseFloat(t.toFixed(1))),t},window.camelCaseToUpperCaseWithUnderscore=function(e){return e.replace(/([A-Z])/g,"_$1").toUpperCase()},window.adjustIonicFunctionalitiesForIE=function(e){if(!getContext("isMobileApp",!1)){var t=window.navigator.userAgent;(t.indexOf("MSIE ")>-1||t.indexOf("Trident/")>-1||t.indexOf("Edge/")>-1)&&window.addEventListener("click",function(e){"[object PointerEvent]"===Object.prototype.toString.call(e)&&"[object HTMLButtonElement]"===Object.prototype.toString.call(e.target)&&e.stopPropagation()},!0)}},window.isAndroid=function(){return navigator.userAgent.match(/Android/i)},window.isIOS=function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},window.isDesktop=function(){var e={Android:window.isAndroid,BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:window.isIOS,Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return e.Android()||e.BlackBerry()||e.iOS()||e.Opera()||e.Windows()}};return!e.any()},window.isIE=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("msie")>-1||e.indexOf("trident")>-1},window.isEdge=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("edge")>-1},window.isFF=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},window.isChrome=function(){return navigator.userAgent.toLowerCase().indexOf("chrome")>-1},window.isSafari=function(){return!window.isChrome()&&navigator.userAgent.toLowerCase().indexOf("safari")>-1},window.getBrowserVersion=function(){var e,t=-1,n=navigator.userAgent;return window.isChrome()&&(e=n.match(/Chrome\/(\d*.\d*)/)),window.isSafari()&&(e=n.match(/Version\/(\d*.\d*)/)),window.isIE()&&(e=n.match(/rv:(\d*.\d*)/)),isDefined(e)&&e.length>1&&(t=parseFloat(e[1])),t}}(),coreModule.service("RequestUtil",function(){function e(e){if(!angular.isObject(e))return null===e||angular.isUndefined(e)?"":e.toString();var t=[];for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];o=null===o?"":o,t.push(n+"="+encodeURIComponent(o))}var i=t.join("&").replace(/%20/g,"+");return i}return{isRequestManagedExtension:function(e){return null!==e?-1===e.indexOf(".html")&&-1===e.indexOf(".js")&&-1===e.indexOf(".xml"):!1},isResponseManagedExtension:function(e){return null!==e?-1===e.indexOf(".html")&&-1===e.indexOf(".js"):!1},isRequestUrlMatch:function(e,t){if(t)for(var n=0;n<t.length;n++){var o=!0,i=t[n];if("!"===i[0]&&(o=!1,i=i.substr(1)),e.match(i))return o}return!1},getRequestTransform:function(){function t(t,n){return e(t)}return t}}}),function(){function e(){var e=l.__getUserAgent().toLowerCase();return e.indexOf("edge")>-1}function t(){var e=l.__getUserAgent().toLowerCase();return e.indexOf("msie")>-1||e.indexOf("trident")>-1}function n(){var e=l.__getUserAgent().toLowerCase();return e.indexOf("firefox")>-1}function o(){var e=l.__getUserAgent().toLowerCase();return e.indexOf("safari")>-1&&-1===e.indexOf("chrome")&&-1===e.indexOf("chromium")}function i(){return!!window.chrome}function r(e){e=e.toLowerCase();var t=e.match(/firefox\/(\d+.\d+)/);return parseFloat(t[1])}function a(e){e=e.toLowerCase();var t=e.match(/version\/(\d+.\d+)/);return parseFloat(t[1])}function s(e){e=e.toLowerCase();var t=e.match(/chrome\/(\d+.\d+)/);return parseFloat(t[1])}function c(){return document.documentMode}var l={};l.__getUserAgent=function(){return navigator.userAgent},l.isSupportedIEVersion=function(){return c()>=11},l.isBrokenIEVersion=function(){return c()<11},l.isSupportedFirefoxVersion=function(e){return r(e)>=30},l.isBrokenFirefoxVersion=function(e){return r(e)<22},l.isSupportedSafariVersion=function(e){return a(e)>=9},l.isBrokenSafariVersion=function(e){return a(e)<6.2},l.isSupportedChromeLikeVersion=function(e){return s(e)>=26},l.isBrokenChromeLikeVersion=function(e){return s(e)<26},l.isBrowserOfficiallySupported=function(){var r=l.__getUserAgent(),a=i()&&l.isSupportedChromeLikeVersion(r),s=t()&&l.isSupportedIEVersion(r),c=o()&&l.isSupportedSafariVersion(r),u=n()&&l.isSupportedFirefoxVersion(r);return e()||a||s||c||u},l.isBrowserExtremelyOutdated=function(){var e=l.__getUserAgent(),r=i()&&l.isBrokenChromeLikeVersion(e),a=t()&&l.isBrokenIEVersion(e),s=o()&&l.isBrokenSafariVersion(e),c=n()&&l.isBrokenFirefoxVersion(e);return r||a||s||c},window.BrowserUtil=l}(),coreModule.filter("nonBreaking",["$sce",function(e){return function(t){if(isUndefined(t))return"";var n=t.replace(/\s/g,"&nbsp;");return e.trustAsHtml(n)}}]),coreModule.filter("trustAsHtml",["$sce",function(e){return e.trustAsHtml}]),coreModule.filter("dayOfWeek",["DateTimeService","StringService",function(e,t){return function(n){return __formatDateTime(n,"dddd",{DateTimeService:e,StringService:t})}}]),coreModule.filter("dayAndMonth",["DateTimeService","StringService","I18nService",function(e,t,n){return function(o){return __formatDateTime(o,n.getLocalizedDateFormat("dayAndMonth"),{DateTimeService:e,StringService:t})}}]),coreModule.filter("time24h",["$log","DateTimeService","StringService",function(e,t,n){return function(e){return safeAccess(e,"hasTime")?__formatDateTime(e,"HH:mm",{DateTimeService:t,StringService:n}):""}}]),coreModule.filter("cmtTranslate",["$translate",function(e){function t(t,n){return n=n||{},n=angular.extend(n,ApplicationContext),e.instant(t,n)}return t.$stateFul=!0,t}]),coreModule.filter("price",["I18nConfig",function(e){return function(t){var n=1*t.amount,o=n.toLocaleString(e.getCurrentDeviceLanguage()+"-"+e.getCountryCodeFromDeviceLocale(),{style:"currency",currency:t.currencyCode,currencyDisplay:"symbol",minimumFractionDigits:0});return o.replace(new RegExp(String.fromCharCode(160),"g")," ")}}]),coreModule.factory("FileSystemFactory",["$log","$q","$timeout","AppLifeCycleService",function(e,t,n,o){function i(e,t){n(function(){e.resolve(t)})}function r(e,t){n(function(){e.reject(t)})}function a(){o.onAppReady(function(){getContext("isMobileApp")&&isDefined(navigator.persistentStorage)?navigator.persistentStorage.requestQuota(1024*c*1024,function(e){window.cordova?document.addEventListener("deviceready",function(){u(e)},!1):u(e)},function(e){r(s,{text:"Error requesting Quota",obj:e})}):r(s,{text:"Error getting the file system",obj:null})})}e=e.getInstance("FileSystemFactory"),e.info("Factory Started...");var s=t.defer(),c=20,l=0;window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.resolveLocalFileSystemURL=window.resolveLocalFileSystemURL||window.webkitResolveLocalFileSystemURL,navigator.persistentStorage=navigator.persistentStorage||navigator.webkitPersistentStorage,window.webkitStorageInfo=window.webkitStorageInfo||{requestQuota:function(e,t,n,o){o(new Error("Not implemented"))}};var u=function(e){window.requestFileSystem(window.PERSISTENT,e,function(t){l=e,i(s,t)},function(e){r(s,{text:"Error requesting File System access",obj:e})})},d={init:a,isSupported:function(){return isDefined(window.webkitStorageInfo)},grantedBytes:function(){return l},getCurrentUsage:function(){var e=t.defer();return webkitStorageInfo.queryUsageAndQuota(window.PERSISTENT,function(t,n){i(e,{used:t,quota:n})},function(t){r(e,{text:"Error getting quota information",obj:t})}),e.promise},requestQuota:function(e){var n=t.defer();return navigator.persistentStorage.requestQuota(window.PERSISTENT,1024*e*1024,function(e){i(n,e)},function(e){r(n,{text:"Error requesting quota increase",obj:e})}),n.promise},getFolderContents:function(e){function n(e,t){e.getDirectory(t[0],{},function(e){var a=e.createReader();t.length>1?n(e,t.slice(1)):a.readEntries(function(e){i(o,e)},function(e){r(o,{text:"Error reading entries",obj:e})})},function(e){r(o,{text:"Error getting directory",obj:e})})}e=e.replace(/^\//,"");var o=t.defer();return s.promise.then(function(t){n(t.root,e.split("/"))},function(e){o.reject(e)}),o.promise},createFolder:function(e){function n(e,t){e.getDirectory(t[0],{create:!0},function(e){t.length>1?n(e,t.slice(1)):i(o,e)},function(e){r(o,{text:"Error creating directory",obj:e})})}e=e.replace(/^\//,"");var o=t.defer();return s.promise.then(function(t){n(t.root,e.split("/"))},function(e){o.reject(e)}),o.promise},deleteFolder:function(e,n){n="undefined"==typeof n?!1:n;var o=t.defer();return s.promise.then(function(t){t.root.getDirectory(e,{},function(e){var t=function(){i(o,"")},a=function(e){r(o,{text:"Error removing directory",obj:e})};n?e.removeRecursively(t,a):e.remove(t,a)},function(e){r(o,{text:"Error getting directory",obj:e})})},function(e){o.reject(e)}),o.promise},writeFileInput:function(e,o,a){var s=t.defer(),c=new FileReader;return c.onload=function(t){var o=t.target.result;n(function(){d.writeArrayBuffer(e,o,a).then(function(){i(s,"")},function(e){r(s,e)})})},c.readAsArrayBuffer(o),s.promise},writeText:function(e,t,n){n="undefined"==typeof n?!1:n;var o=new Blob([t],{type:"text/plain"});return d.writeBlob(e,o,n)},writeArrayBuffer:function(e,t,n,o){o="undefined"==typeof o?!1:o;var i=new Blob([new Uint8Array(t)],{type:n});return d.writeBlob(e,i,o)},writeBlob:function(e,n,o){o="undefined"==typeof o?!1:o;var a=t.defer();return s.promise.then(function(t){t.root.getFile(e,{create:!0},function(e){e.createWriter(function(e){o&&e.seek(e.length);var t=!1;e.onwriteend=function(e){return t?void i(a,""):(t=!0,void this.truncate(this.position))},e.onerror=function(e){r(a,{text:"Write failed",obj:e})},e.write(n)},function(e){r(a,{text:"Error creating file",obj:e})})},function(e){r(a,{text:"Error getting file",obj:e})})},function(e){a.reject(e)}),a.promise},getFile:function(e){var n=t.defer();return this.getFileEntry(e).then(function(e){e.file(function(e){i(n,e)},function(e){r(n,{text:"Error getting file object",obj:e})})},function(e){n.reject(e)}),n.promise},getFileEntry:function(e){var n=t.defer();return s.promise.then(function(t){t.root.getFile(e,{},function(e){i(n,e)},function(e){r(n,{text:"Error getting file",obj:e})})},function(e){n.reject(e)}),n.promise},getFileFromLocalFileSystemURL:function(e){var n=t.defer();return window.resolveLocalFileSystemURL(e,function(e){e.file(function(e){i(n,e)},function(e){r(n,{text:"Error getting file object",obj:e})})},function(e){r(n,{text:"Error resolving FileSystem URL",obj:e})}),n.promise},readFile:function(e,n){var o=t.defer();return n=n||"text",s.promise.then(function(t){t.root.getFile(e,{},function(e){e.file(function(e){var t=new FileReader;switch(t.onloadend=function(){i(o,this.result)},t.onerror=function(e){r(o,{text:"Error reading file",obj:e})},n){case"arraybuffer":t.readAsArrayBuffer(e);break;case"binarystring":t.readAsBinaryString(e);break;case"dataurl":t.readAsDataURL(e);break;default:t.readAsText(e)}},function(e){r(o,{text:"Error getting file",obj:e})})},function(e){r(o,{text:"Error getting file",obj:e})})},function(e){o.reject(e)}),o.promise},deleteFile:function(e){var n=t.defer();return s.promise.then(function(t){t.root.getFile(e,{create:!1},function(e){e.remove(function(){i(n,"")},function(e){r(n,{text:"Error deleting file",obj:e})})})},function(e){n.reject(e)}),n.promise},downloadRemoteFileToFileSystem:function(n,o){var i=t.defer();return s.promise.then(function(t){try{var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="arraybuffer",r.addEventListener("load",function(){if(4===r.readyState&&200===r.status){var e=d.getMimeTypeFromExtension(d.getFileExtension(n)),a=o.split("/");a[a.length-1].indexOf(".")>-1&&delete a[a.length-1],d.createFolder(a.join("/")).then(function(){d.writeArrayBuffer(o,r.response,e,!1).then(function(){i.resolve(d.pathToFilesystemURLSync(o,t))},function(e){i.reject(e)})},function(e){i.reject(e)})}else i.reject("Request failure: "+r.status+" "+r.statusText)}),r.addEventListener("error",function(t){e.error("downloadRemoteFileToFileSystem xhr error ",t),i.reject(t)}),r.send()}catch(a){i.reject(a)}},function(e){i.reject(e)}),i.promise},getFileExtension:function(e){var t=e.lastIndexOf(".");return-1!==t?e.substring(t+1):""},getMimeTypeFromExtension:function(e){var t={jpg:"image/jpg",gif:"image/gif",png:"image/png"},n=t[e];if(isDefined(n))return t[e];throw"Mime type is not defined, please add it to getMimeTypeFromExtension"},pathToFilesystemURLSync:function(e,t){if(isDefined(t))return 0!==e.indexOf("filesystem:")&&(e="/"===e[0]?t.root.toURL()+e.substring(1):t.root.toURL()+e),e;throw"fileSystem is not defined"},pathToFilesystemURL:function(e){var n=t.defer();return s.promise.then(function(t){n.resolve(d.pathToFilesystemURLSync(e,t))},function(e){n.reject(e)}),n.promise}};return d}]),window.coreModule.factory("MissingTranslationHandler",["$log","I18nService",function(e,t){return function(n,o){if(t.isStringLocalized(n))return n;e.warn("Missing localization for the following key ("+o+"):",n);var i=n.split("."),r=i[i.length-1];return"@"+r+"@"}}]),coreModule.factory("debounce",["$timeout","$q",function(e,t){return function(n,o,i){var r,a=t.defer();return function(){var s=this,c=arguments,l=function(){r=null,i||(a.resolve(n.apply(s,c)),a=t.defer())},u=i&&!r;return r&&e.cancel(r),r=e(l,o),u&&(a.resolve(n.apply(s,c)),a=t.defer()),a.promise}}}]),coreModule.service("LoggingService",["$log",function(e){function t(e){return function(t){var o=n(t);isDefined(o)&&e("Profiling:"+t+"["+o+" seconds]")}}function n(e){if(isDefined(A[e])){var t=new Date,n=(t.getTime()-A[e])/1e3;return delete A[e],y.push({time:n,id:e}),n}A[e]=(new Date).getTime()}function o(t){return getContext("applicationConfig.logLevel",6)>=t?t===h?function(){e[_[t]].apply(null,arguments),isDefined(window._LTracker)&&getContext("applicationConfig.remoteLogEnabled",!1)&&window._LTracker.push({text:"["+arguments[0].split("][")[1],stack:w,version:getContext("versions.app")})}:function(){e[_[t]].apply(this,arguments),w.push(arguments[0]),w.shift()}:function(){w.push(arguments[0]),w.shift()}}function i(e,t){return function(){var o=[].slice.call(arguments),i=o[0]||"",a="_"===i[0],s=getContext("applicationConfig.showPrivateMethodCalls",!1);if(s||!a){p&&console.group&&console.group(i),n(i),T.push(i);var u=c(t)+"Starting function "+i;m&&(u+=" with arguments:"+l(r(arguments.callee.caller.arguments))),o[0]=u,e.apply(null,o)}}}function r(e){for(var t="[\n",n=0,o=e.length;o>n;n++){var i=e[n];if(angular.isObject(i)&&v){try{i=JSON.stringify(i)}catch(r){i=i.toString()}i.length>400&&(i=i.slice(0,400)+"...}")}else angular.isString(i)&&(i.length>200&&(i=i.slice(0,200)+"..."),i="'"+i+"'");t+=i,t+=o>n+1?",\n":""}return t+="\n]"}function a(e,t){return function(){var o=T.pop();if(isDefined(o))var i="_"===o[0],r=c(t)+"Ending function "+o;var a=getContext("applicationConfig.showPrivateMethodCalls",!1),s=function(){if((a||!i)&&(p&&console.groupEnd&&console.groupEnd(),isDefined(r))){var t=n(o);e.apply(null,[r+":"+t])}};return isDefined(arguments[0])&&isDefined(arguments[0].then)?arguments[0].then(s)["catch"](function(e){console.error(r+" Fails with",e)}):!a&&i||s(),arguments[0]}}function s(){return moment().format(getContext("applicationConfig.logDateFormat","HH:mm:ss.SSS"))}function c(e){return"["+s()+"]["+e+"] "}function l(e){return e.replace(/(password.*?)"?:["|'](.*?)["|']/gi,'$1":"*******"')}function u(e,t){return function(){var n=[].slice.call(arguments),o=n[0],i=c(t);angular.isString(o)?i+=o:angular.isObject(o)&&(isDefined(o.status)&&isDefined(o.statusText)&&(i+=" Response status is "+o.status+" "+o.statusText),safeAccess(o,"config.url")&&(i+=" URL was: "+safeAccess(o,"config.url"))),n[0]=l(i),e.apply(null,n)}}function d(e,t){return function(){var n=[].slice.call(arguments),o=n[0];if(angular.isString(o)){var i=c(t)+o;n[0]=l(i),e.apply(null,n)}else angular.isObject(o)&&o.errorCodes&&o.errorCodes.forEach(function(o){var i=c(t)+"BackendError "+o;n[0]=l(i),e.apply(null,n)})}}function f(e){return function(){var t=[].slice.call(arguments);throw t[0]=c(e)+t[0],t[0]=l(t[0]),t[0]}}function g(e,t){return function(){var n=[].slice.call(arguments),o=n[0]||"";angular.isObject(o)&&(o=r([o]));var i=e;n[0]=c(t)+o,n[0]=l(n[0]),i.apply(null,n)}}var p=getContext("applicationConfig.useConsoleGroup",!0),m=!0,v=!0,h=1,C=2,S=3,E=4,b=5,_=["noop","error","warn","info","log","debug"];getContext("applicationConfig.logLevel",6)<E&&(p=!1,m=!1,v=!1),e.getInstance=function(e){return{log:g(o(E),e),info:g(o(S),e),warn:g(o(C),e),debug:g(o(b),e),error:g(o(h),e),profile:t(o(b)),method:i(o(b),e),throwException:f(e),backendError:d(o(h),e),httpError:u(o(h),e),returns:a(o(b),e),toString:function(){return"LoggingService"}}};var A={},y=[];window.displayProfiling=function(){y.sort(function(e,t){return e.time>t.time?-1:e.time<t.time?1:0}),console.table(y)};var w=[];!function(){for(var e=getContext("applicationConfig.logRetention",15),t=0;e>t;t++)w.push("")}();var T=[]}]),coreModule.provider("I18nConfig",["$translateProvider","$windowProvider",function(e,t){function n(e){var t={en:"GB","pt-PT":"PO","pt-BR":"PO","zh-TW":"TW","zh-CN":"CN",da:"DK",ja:"JP",nb:"NO",nn:"NO",sv:"SE",tr:"TK"};return isDefined(e)?isDefined(t[e])?t[e]:e.toUpperCase():(r.error("convertIsoLanguageToAmadeusLanguage: input not defined"),"GB")}function o(e){var t={zh:"CN",fr:"FR",en:"GB"};return t[e]||"GB"}function i(e){var t=e.languages,n=t[0],o=n.split("-"),i=n;if(1===o.length)for(var r=0;r<t.length;r++){var a=t[r],s=a.split("-");if(s.length>1&&s[0]===n){i=a;break}}return i}var r=angular.injector(["ng"]).get("$log"),a=5===getContext("applicationConfig.logLevel",2),s=this,c="You need to call I18nConfigProvider.detectAndConfigureLanguagesAndLocales in module.config() block!";s.$get=function(){var e={getCurrentApplicationLanguage:function(){return s.__currentApplicationLanguage?s.__currentApplicationLanguage:e._logError(c)},getCurrentDeviceLanguage:function(){return s.__deviceLanguage?s.__deviceLanguage:e._logError(c)},getCurrentAmadeusLanguage:function(){return s.__currentAmadeusLanguage?s.__currentAmadeusLanguage:e._logError(c)},getCountryCodeFromDeviceLocale:function(){return s.__deviceCountry?s.__deviceCountry:e._logError(c)},convertIsoLanguageOrLocaleToAmadeusLanguage:n,_logError:function(e){return e}};return e},s.__deviceLocale=null,s.__deviceLanguage=null,s.__deviceCountry=null,s.__currentApplicationLanguage=null,s.__currentAmadeusLanguage=null,s.detectAndConfigureLanguagesAndLocales=function(c){var l=t.$get().navigator,u=c.IONCMT_DEFAULT_LANG,d=c.IONCMT_SUPPORTED_LANGS,f=c.IONCMT_LOCALE_TO_LANG_MAPPING,g=getContext("applicationConfig.dataManagerKeyPrefix","");s.__deviceLocale=function(){var e=localStorage.getItem(g+"USER_PREFERRED_LOCALE_KEY");return isDefined(e)?(angular.isString(e)&&(e=JSON.parse(e).data),e):l.languages&&l.languages[0]?i(l):l.language||l.userLanguage||l.systemLanguage||"en-GB"}(),s.__deviceLanguage=(s.__deviceLocale.split("-")[0]||"en").toLowerCase(),s.__deviceCountry=(s.__deviceLocale.split("-")[1]||l.language.split("-")[1]||o(s.__deviceLanguage)).toUpperCase(),s.__deviceLocale=s.__deviceLanguage+"-"+s.__deviceCountry,s.__currentApplicationLanguage=function(){var e=-1!==d.indexOf(s.__deviceLocale),t=-1!==d.indexOf(s.__deviceLanguage);return e?(a&&r.info("application language: will use "+s.__deviceLocale),s.__deviceLocale):t?(a&&r.info("application language: will use "+s.__deviceLanguage),s.__deviceLanguage):(a&&r.info("application language: will fall back to default language"),u)}(),e.registerAvailableLanguageKeys(d,f),e.addInterpolation("$translateMessageFormatInterpolation");var p=getContext("applicationConfig.useLocalisationBundle",!1);if(p){var m=getContext("versions.jenkinsBuildId","000");e.useStaticFilesLoader({prefix:"i18n/Localization_",suffix:"-"+m+".json"})}else e.useLoader("$translatePartialLoader",{urlTemplate:"js/{part}/resources/i18n/Localization_{lang}.json"});e.useSanitizeValueStrategy("escapeParameters"),e.preferredLanguage(s.__currentApplicationLanguage),moment.locale(u),moment.locale(s.__deviceLocale),a&&r.info("effective momentjs locale: "+moment.locale()),s.__currentAmadeusLanguage=n(s.__currentApplicationLanguage),setContext("LANGUAGE",s.__currentAmadeusLanguage),a&&r.info("effective Amadeus language: "+getContext("LANGUAGE"))}}]),coreModule.service("I18nService",["$translate","$q","$log","I18nConfig",function(e,t,n,o){function i(e,t){var n=e.pop(),o=t[n];return delete t[n],o}n=n.getInstance("I18nService");var r="000000",a="999",s={getPriceFromBackendObject:function(e,t){return e&&isDefined(e.amount)?parseFloat(e.amount).toLocaleString(t,{style:"currency",currency:e.currencyCode,currencyDisplay:"symbol",minimumFractionDigits:2}):null},isStringLocalized:function(e){function t(e){return"@"===e[0]&&"@"===e[e.length-1]?!1:/\s/.test(e)||e.indexOf("..")>-1||e.split(".").length<3}var n=!0;return isDefined(e)&&(angular.isString(e)&&(e=[e]),e.forEach(function(e){n=n&&t(e)})),n},getLocalizedDateFormat:function(e){var t=window.cmtSpecificMomentDateFormatters[e];if(t){var i=o.getCurrentApplicationLanguage(),r=t[i]||t["default"];return r}return n.error('getLocalizedDateFormat: no config for "'+e+'"!'),"__"},translate:function(o,i,r){i=i||{},i=angular.extend(i,ApplicationContext);var a=t.defer();return Array.isArray(o)||"string"==typeof o?e(o,i,r).then(function(e){a.resolve(e)},function(e){a.resolve(e)}):(n.error("translate: parameter should be an array or string!"),a.resolve("")),a.promise},translateHttpStatusCode:function(e){"string"!=typeof e&&"number"!=typeof e&&(n.error("translateHttpStatusCode: status should be a string or number"),
e=a);var o=t.defer();e="core.httpErrorCodes."+e;var c=[e,"core.backendErrorCodes."+r];return s.translate(c).then(function(e){var t=i(c,e),n=c[0],r=e[n];s.isStringLocalized(r)?o.resolve(r):o.resolve(t)}),o.promise},translateBackendErrorCodes:function(e){var o=t.defer();return"string"!=typeof e&&"number"!=typeof e||(e=[e]),Array.isArray(e)||(n.error("translateBackendErrorCodes: codes should be an array, string or number!"),e=[r]),e=e.map(function(e){return"core.backendErrorCodes."+e}),e.push("core.backendErrorCodes."+r),s.translate(e).then(function(t){var n=i(e,t),r=[];e.forEach(function(e){var o=t[e];s.isStringLocalized(o)?r.push(o):r.push(n)}),o.resolve(r)}),o.promise},getDeviceLocaleCountryCodeFromPlugin:function(){var e=t.defer(),n=o.getCountryCodeFromDeviceLocale();return getContext("isMobileApp",!1)&&safeAccess(window,"cordova.plugins.DeviceLocale.getDeviceCountryCode")?window.cordova.plugins.DeviceLocale.getDeviceCountryCode(function(t){isDefined(t)?e.resolve(t):e.resolve(n)},function(){e.resolve(n)}):e.resolve(n),e.promise},replaceSpecialWhitespaces:function(e){return e.replace(new RegExp(String.fromCharCode(8239),"g")," ").replace(new RegExp(String.fromCharCode(160),"g")," ")}};return s}]),coreModule.service("PromiseService",["$log","I18nService","$q",function(e,t,n){function o(n,o){var r,a="http"===o;e.warn(n.method+": rejecting promise due to "+o+" error"),n.payload&&e.warn("The payload was: "+JSON.stringify(n.payload));var s=n.response;a?(e.httpError(s),n.deferred&&(r=safeAccess(s,"status"),t.translateHttpStatusCode(r).then(function(e){n.deferred.reject(e)}))):(e.backendError(s.data),n.deferred&&(s.cmtSwallowError?n.deferred.reject(i.CMT_SILENT_ERROR):(r=safeAccess(s,"data.errorCodes[0]","000000"),t.translateBackendErrorCodes([r]).then(function(e){n.deferred.reject(e[0])}))))}e=e.getInstance("PromiseService"),e.info("Service Started...");var i={CMT_SILENT_ERROR:"CMT_SILENT_ERROR",processMdwSuccessOrError:function(t,o){var r=n.defer();return t.then(function(t){var n=safeAccess(t,"data.success");n?(e.info(o+": resolving with success"),r.resolve(t)):i.rejectDueToBackendError({deferred:r,response:t,method:o})},function(e){i.rejectDueToHttpError({deferred:r,response:e,method:o})})["catch"](handleUnexpectedError),r.promise},rejectDueToBackendError:function(e){o(e,"backend")},rejectDueToHttpError:function(e){o(e,"http")},getDefaultOkHandler:function(e){return function(t){var n=safeAccess(t,"data.success");n||i.rejectDueToBackendError({response:t,method:e})}},getDefaultFailHandler:function(e){return function(t){i.rejectDueToHttpError({response:t,method:e})}}};return i}]),coreModule.service("AppPermissionsService",["$log","$q","AppLifeCycleService",function(e,t,n){e=e.getInstance("AppPermissionsService"),e.info("Service Started...");var o="pluginNotAvailable",i="unableToCheckPermissions",r="unableToRequestPermissions",a={permissionReadCalendar:"READ_CALENDAR",permissionWriteCalendar:"WRITE_CALENDAR",permissionFineLocation:"ACCESS_FINE_LOCATION",permissionCoarseLocation:"ACCESS_COARSE_LOCATION",_getPermissionsKey:function(e){var t=safeAccess(window,"cordova.plugins.permissions");if(t){if(angular.isString(e))return t[e];if(angular.isArray(e))return e.map(function(e){return t[e]}).filter(function(e){return void 0!==e})}return null},checkPermission:function(n){var r=t.defer(),s=safeAccess(window,"cordova.plugins.permissions");return s?(n=a._getPermissionsKey(n),s.checkPermission(n,function(t){e.info("checkPermission:",t.hasPermission),r.resolve(t.hasPermission)},function(t){e.error("cordova.plugins.permissions.checkPermission error: ",t),r.reject(i,t)})):(e.error("cordova.plugins.permissions error: plugin not available"),r.reject(o)),r.promise},checkAndProvidePermission:function(i){var s=t.defer(),c=safeAccess(window,"cordova.plugins.permissions");return c?(n.preventSystemPause(),i=a._getPermissionsKey(i),c.requestPermissions(i,function(t){e.info("requestPermission:",t.hasPermission),s.resolve(t.hasPermission)},function(t){e.error("cordova.plugins.permissions.requestPermissions error: ",t),s.reject(r)})):(getContext("isMobileApp",!1)&&e.error("cordova.plugins.permissions error: plugin not available"),s.reject(o)),s.promise},toString:function(){return"AppPermissionsService"}};return a}]),coreModule.service("AppLifeCycleService",["$log","$ionicPlatform","DataManagerService",function(e,t,n){e=e.getInstance("AppLifeCycleService"),e.info("Service Started...");var o="isSystemPause",i={_pauseCallbacks:[],_resumeCallbacks:[],onAppReady:function(e){t.ready(function(){e()})},onAppPause:function(e){i._pauseCallbacks.push(e)},onAppResume:function(e){i._resumeCallbacks.push(e)},preventSystemPause:function(){n.set(!0,o,{storage:n.CACHE,ttl:"30s"})},_init:function(){t.on("pause",function(){if(e.info("onAppPause"),n.get(o,n.CACHE))e.info("onAppPause skipped because system pause");else for(var t=0;t<i._pauseCallbacks.length;t++)i._pauseCallbacks[t]()}),t.on("resume",function(){if(e.info("onAppResume"),n.get(o,n.CACHE))e.info("onAppResume skipped because system resume"),n.remove(o,n.CACHE);else for(var t=0;t<i._resumeCallbacks.length;t++)i._resumeCallbacks[t]()})},toString:function(){return"AppLifeCycleService"}};return i._init(),i}]),coreModule.service("DateTimeService",["$log",function(e){e=e.getInstance("DateTimeService"),e.info("Service Started...");var t={decodeTTL:function(e){for(var t=/(([0-9]{1,2})([y|M|d|h|m|s]))/g,n=t.exec(e),o={};n;)o[n[3]]=n[2],n=t.exec(e);var i=o.y?31536e6*o.y:0,r=o.M?2592e6*o.M:0,a=o.d?864e5*o.d:0,s=o.h?36e5*o.h:0,c=o.m?6e4*o.m:0,l=o.s?1e3*o.s:0;return i+r+a+s+c+l},getMomentFromBackendDate:function(e){var t;return isDefined(e)&&(t=moment(e.utcTimestampMillis),t.utcOffset(e.offsetMinutes||0)),t},getDurationFromBackendDates:function(e,n){var o,i,r=!1;if(e=t.getMomentFromBackendDate(e),n=t.getMomentFromBackendDate(n),isDefined(e)&&isDefined(n)){var a=n.diff(e);0>a&&(r=!0);var s=moment.duration(a);i=s.minutes().toString(),"0"!==i&&i.length<2&&(i="0"+i),o={hours:(24*s.days()+s.hours()).toString(),minutes:i,isNegative:r}}return o},isSameBackendDate:function(e,n){return e=t.getMomentFromBackendDate(e),n=t.getMomentFromBackendDate(n),isDefined(e)&&isDefined(n)&&0===e.diff(n)},isPastDate:function(n){if(!n)return e.warn("isPastDate: null or undefined passed"),!1;var o=moment();return n=n.utcTimestampMillis?t.getMomentFromBackendDate(n):moment(n),o.diff(n)>0},createMdwDateTimeObject:function(e){var n=t.combineDateTimeObject(e),o=n.valueOf();return{utcTimestampMillis:o,offsetMinutes:isDefined(e.offsetMinutes)?e.offsetMinutes:null,hasTime:isDefined(e.timePart)}},combineDateTimeObject:function(e){var t=moment.utc();return isDefined(e.offsetMinutes)&&t.utcOffset(e.offsetMinutes),isDefined(e.datePart)&&(t.year(e.datePart.getFullYear()),t.month(e.datePart.getMonth()),t.date(e.datePart.getDate())),isDefined(e.timePart)&&(t.hours(e.timePart.getHours()),t.minutes(e.timePart.getMinutes()),t.seconds(0),t.milliseconds(0)),t},convertBackendDateToInputDate:function(e){var n=t.getMomentFromBackendDate(e),o=n.toDate().getTimezoneOffset();return n.add(e.offsetMinutes+o,"minutes"),n.toDate()},isValidDate:function(e){return isDefined(e)&&isDefined(e.date)&&isDefined(e.time)&&isDefined(e.timezoneOffset)},isValidDatesRange:function(e,n){var o=!1;if(t.isValidDate(e)&&t.isValidDate(n)){var i=t.createMdwDateTimeObject({datePart:e.date,timePart:e.time,offsetMinutes:parseInt(e.timezoneOffset,10)}),r=t.createMdwDateTimeObject({datePart:n.date,timePart:n.time,offsetMinutes:parseInt(n.timezoneOffset,10)});o=r.utcTimestampMillis>i.utcTimestampMillis}return o},parseETRSegmentDate:function(e){switch(e.type){case"Train":case"Meeting":case"Excursion":case"Parking":case"ShowAndEvent":case"Activity":case"Cruise":case"Taxi":case"Transfer":case"Urban":case"MoveMisc":case"Air":e.sDate=e.startDate,e.eDate=e.endDate;break;case"Car":e.sDate=e.pickupDateTime,e.eDate=e.dropoffDateTime;break;case"Hotel":e.sDate=e.checkin,e.eDate=e.checkout}return e},toString:function(){return"DateTimeService"}};return t}]),coreModule.service("DataManagerService",["ipCookie","I18nConfig","$log","$window","$q","$ionicPlatform","DateTimeService",function(e,t,n,o,i,r,a){function s(e){n.info("Initializing DataManager storage from "+e+" entry in localStorage...");var t=localStorage.getItem(f+e);if(t){n.info("Found data in storage: "+t.length+" bytes; trying to parse from JSON...");try{t=JSON.parse(t),n.info("JSON parse success")}catch(o){n.error("Unable to parse JSON, storage corrupted?")}}else n.info("No data found under given key. Initializing "+e+" to empty object"),t={};return t}n=n.getInstance("DataManagerService"),n.info("Service Started...");var c="USERDATA_KEYS",l="MEMORY_STATE",u="SECURED_USERDATA_KEYS_STORAGE_KEY",d="Secure Storage not available fallback in LocalStorage",f=getContext("applicationConfig.dataManagerKeyPrefix",""),g=s(c),p=s(u),m=s(l);m=m&&m.data?m.data:{};var v={},h={__userDataKeys:g,__securedUserDataKeys:p,__memory:m,__cache:v,cacheLocalStorage:!0,dataManagerKeyPrefix:f,MEMORY:0,CACHE:1,COOKIES:2,LOCALSTORAGE:3,INFINITE:-1,ONE_TIME:-2,TEXT:20,BINARY:21,ERR_SECURE_STORAGE_NOT_AVAILABLE:-1,ERR_SECURE_STORAGE_FAIL:0,_secureStoragePlugin:void 0,secureStorageDeferred:void 0,init:function(){window.DataManager=h,h._initSecureStorage().then(function(){n.info("SecureStorage plugin initialized")},function(e){n.warn("Cannot initialized SecureStorage plugin: "+e.message)}),o.addEventListener("beforeunload",function(){h.__onBeforeUnload()})},__onBeforeUnload:function(){var e=getContext("applicationConfig.dumpMemoryToStorageOnExit");e?(n.info("__onBeforeUnload: storing memory contents to localStorage..."),h.set(h.__memory,l,{storage:h.LOCALSTORAGE,ttl:"10m"})):n.info("__onBeforeUnload: Nothing to do (dumpMemoryToStorageOnExit == false)")},set:function(t,o,i){i=i||{};var r=i.storage,a=i.ttl,s=i.languageDependent||!1,l=i.belongsToUser||!1;void 0===t&&void 0===o&&n.throwException("Missing mandatory parameter data or key");var u=h._getEntry(t,a,s,l);switch(u.belongsToUser&&(h.__userDataKeys[o]=o,h._localStorageSet(c,h.__userDataKeys)),r){case h.LOCALSTORAGE:h._localStorageSet(o,u);break;case h.COOKIES:e(h.dataManagerKeyPrefix+o,JSON.stringify(u));break;case h.CACHE:h.__cache[o]=u;break;default:h.__memory[o]=u}},setSecureAsync:function(e,t){var o=i.defer();return h.secureStorageDeferred.promise.then(function(i){i.set(function(){h.__securedUserDataKeys[t]=t,o.resolve()},function(e){n.error("fail to set secured data with:"+e),o.reject(e)},t,e)},function(i){n.warn(d),n.warn(i.message),h.set(e,t,{storage:i.code===h.ERR_SECURE_STORAGE_NOT_AVAILABLE?h.MEMORY:h.LOCALSTORAGE,ttl:h.INFINITE,belongsToUser:!0}),o.resolve()}),o.promise},removeSecureAsync:function(e){var t=i.defer();return h.secureStorageDeferred.promise.then(function(o){o.remove(function(e){delete h.__securedUserDataKeys[e],t.resolve()},function(e){n.error(e),t.reject(e)},e)},function(o){n.warn(d),n.warn(o.message),h.remove(e,{storage:o.code===h.ERR_SECURE_STORAGE_NOT_AVAILABLE?h.MEMORY:h.LOCALSTORAGE,ttl:h.INFINITE,belongsToUser:!0}),t.resolve()}),t.promise},_localStorageSet:function(e,t){try{localStorage.setItem(h.dataManagerKeyPrefix+e,JSON.stringify(t)),h.cacheLocalStorage&&(h.__cache[e]=t)}catch(o){h.__memory[e]=t,n.warn("Error writing to the local storage for key = "+e+" fallback to memory"),n.error("Storage error",o)}},_localStorageGet:function(e){var t;try{t=h.__cache[e],t||(t=localStorage.getItem(h.dataManagerKeyPrefix+e),t&&h.cacheLocalStorage&&(t=JSON.parse(t),h.__cache[e]=t))}catch(o){t=h.__memory[e],n.warn("Error reading to the storage for key = "+e+" fallback from memory")}return isUndefined(t)&&(t=h.__memory[e]),t},get:function(e,t){var n=h._getStock(e,t);return isDefined(n)&&(angular.isString(n)&&(n=JSON.parse(n)),n=h._getValidatedStock(n,e,t)),null===n?void 0:n},getStoredDate:function(e,t){var n=h._getStock(e,t),o=null;return isDefined(n)&&(angular.isString(n)&&(n=JSON.parse(n)),isDefined(n.timestamp)&&(o=moment(n.timestamp))),o},_getStock:function(t,n){var o;switch(n){case h.LOCALSTORAGE:o=h._localStorageGet(t);break;case h.COOKIES:o=e(h.dataManagerKeyPrefix+t);break;case h.CACHE:o=h.__cache[t];break;default:o=h.__memory[t]}return o},getSecureAsync:function(e){var t=i.defer();return h.secureStorageDeferred.promise.then(function(o){o.get(function(e){t.resolve(e)},function(e){n.error("fail to get secured data with:"+e),t.reject(e)},e)},function(o){n.warn(d),n.warn(o.message),t.resolve(h.get(e,o.code===h.ERR_SECURE_STORAGE_NOT_AVAILABLE?h.MEMORY:h.LOCALSTORAGE))}),t.promise},_initSecureStorage:function(){return isUndefined(h.secureStorageDeferred)&&(h.secureStorageDeferred=i.defer(),r.ready(function(){safeAccess(window,"cordova.plugins.SecureStorage",!1)?h._secureStoragePlugin=new cordova.plugins.SecureStorage(function(){h.secureStorageDeferred.resolve(h._secureStoragePlugin)},function(e){h.secureStorageDeferred.reject({message:e,code:h.ERR_SECURE_STORAGE_FAIL})},getContext("appName","my_app")):h.secureStorageDeferred.reject({message:"Plugin not available",code:h.ERR_SECURE_STORAGE_NOT_AVAILABLE})})),h.secureStorageDeferred.promise},_getValidatedStock:function(e,n,o){return(e.TTL<0||!h._isTimeout(e.TTL,e.timestamp))&&("ZZ"===e.language||e.language===t.getCurrentApplicationLanguage())?(e.TTL===h.ONE_TIME&&h.remove(n,o),e=e.data):e=void 0,isUndefined(e)&&h.remove(n,o),e},remove:function(t,n){switch(n){case h.LOCALSTORAGE:localStorage.removeItem(h.dataManagerKeyPrefix+t),delete h.__cache[t];break;case h.COOKIES:e.remove(h.dataManagerKeyPrefix+t);break;case h.CACHE:delete h.__cache[t];break;default:delete h.__memory[t]}},clearUserData:function(){for(var t in h.__userDataKeys)localStorage.removeItem(h.dataManagerKeyPrefix+t),e.remove(h.dataManagerKeyPrefix+t),delete h.__memory[t],delete h.__cache[t];for(var n in h.__securedUserDataKeys)h.removeSecureAsync(n);localStorage.removeItem(h.dataManagerKeyPrefix+c),localStorage.removeItem(h.dataManagerKeyPrefix+u)},_isTimeout:function(e,t){var n=(new Date).getTime();return n>e+t},_getEntry:function(e,o,i,r){o=angular.isString(o)?a.decodeTTL(o):angular.isNumber(o)?o:h.INFINITE;var s=i?t.getCurrentApplicationLanguage():"ZZ";return r=!!r,n.returns({data:e,TTL:o,language:s,belongsToUser:r,timestamp:(new Date).getTime()})},toString:function(){return"DataManagerService"}};return h}]),window.UrlService=function(){var e={parseUrl:function(t){var n=new window.URL(t);return{search:n.search,parsedParameters:e.parseQueryString(n.search),parsedHash:e.parseHash(n.hash),pathname:n.pathname,origin:n.origin,hash:n.hash}},parseHash:function(e){var t={};if(isDefined(e)&&""!==e){e=e.replace("#/","");var n=e.split("?");if(n.length<=1&&(n=e.split("/")),t.route=n[0],n.length>1){var o=n[1].split("&");o.length<=1?(n.splice(0,1),o=n.map(function(e,t){return{key:t,value:e}})):o=o.map(function(e){var t=e.split("=");return{key:t[0],value:t[1]}}).filter(function(e){return""!==e.key}),t.params={};for(var i=0;i<o.length;i++)t.params[o[i].key]=o[i].value}}return t},parseQueryString:function(e){var t={};if(isDefined(e)&&""!==e){"?"===e[0]&&(e=e.slice(1));for(var n=e.split("&"),o=0,i=n.length;i>o;o++){var r=n[o].split("=");r[0]&&r[1]&&(t[r[0]]=decodeURIComponent(r[1]))}}return t},addParameterToQueryString:function(t,n,o){var i=e.parseUrl(t);i.parsedParameters[n]=o;var r=[];for(var a in i.parsedParameters)i.parsedParameters.hasOwnProperty(a)&&r.push(a+"="+i.parsedParameters[a]);var s=i.origin+i.pathname;return r.length>0&&(s+="?"+r.join("&")),i.hash&&""!==i.hash&&(s+=i.hash),s},toString:function(){return"UrlService"}};return e},coreModule.service("UrlService",window.UrlService),coreModule.service("ParameterService",["DataManagerService","UrlService","$log","$location","$stateParams",function(e,t,n,o,i){n=n.getInstance("ParameterService"),n.info("Service Started...");var r={parse:function(e){var n={};if(e=!!e,e||!safeAccess(ionic,"Platform.device",!1)||0===Object.keys(ionic.Platform.device).length){var i=this._getSearch(),r=t.parseQueryString(i),a=o.search();n=angular.extend({},r,a)}return n},safeGetStateParam:function(e){return isDefined(i[e])&&""!==i[e]?i[e]:null},_getSearch:function(){return window.location.search.substring(1)},toString:function(){return"ParameterService"}};return r}]),coreModule.service("PostMessageService",["$log","$window","$q",function(e,t,n){e=e.getInstance("PostMessageService"),e.info("Service Started...");var o={_isNativeAndroid:!1,cmtWindow:null,init:function(){"webkit"in t&&t.webkit.messageHandlers.integrationHandler?o.cmtWindow=t.webkit.messageHandlers.integrationHandler:"android"in window?(o.cmtWindow=window.android,o._isNativeAndroid=!0):o.cmtWindow=t.parent,t.addEventListener("message",function(e){o._handleEvent(e)},!1)},_handleEvent:function(e){var t=!0,n=e.data;if(angular.isString(n))try{n=JSON.parse(n)}catch(i){t=!1}t&&isDefined(n.type)&&o._eventHandler[n.type]&&o._eventHandler[n.type].forEach(function(e){e.notify(n.payload||n)})},send:function(t){if(isUndefined(o.cmtWindow))return void e.error("You must call init before calling this method!");try{o.cmtWindow.postMessage(o._isNativeAndroid?JSON.stringify(t):t,"*")}catch(n){e.error("Could not send message!",n)}},_eventHandler:{},when:function(e){var t=n.defer();isUndefined(o._eventHandler[e])&&(o._eventHandler[e]=[]);var i=(new Date).getTime()+o._eventHandler[e].length;return t.promise.revocationId=i,t.revovationId=i,o._eventHandler[e].push(t),t.promise._then=t.promise.then,t.promise.then=function(e){return this._then(null,null,e)},t.promise},cancelReceive:function(e,t){isDefined(o._eventHandler[e])&&(o._eventHandler[e]=o._eventHandler[e].filter(function(e){return e.revovationId!==t}))},toString:function(){return"PostMessageService"}};return o}]),coreModule.service("RequestService",["$q","$timeout","$http","$log",function(e,t,n,o){function i(e,n,o){t(function(){for(var t=a[e]?a[e]:[];t.length>0;)t.shift()(n,o);delete a[e]},1)}function r(e){return e.params[0]+JSON.stringify(e.params[1])}o=o.getInstance("RequestService"),o.info("Service Started...");var a={},s={post:function(e,t,n){return s._request({params:[e,t,{module:n}],method:"post"})},get:function(e,t,n){return s._request({params:[e,angular.merge({module:t},n)],method:"get"})},put:function(e,t,n){return s._request({params:[e,t,{module:n}],method:"put"})},"delete":function(e,t){return s._request({params:[e,{module:t}],method:"delete"})},_request:function(t){var s=e.defer(),c=r(t);return t.requestKey=c,isUndefined(a[c])?(a[c]=[],n[t.method].apply(n,t.params).then(function(e){i(c,e,!0),s.resolve(e)},function(e){i(c,e,!1),s.reject(e)})):(o.warn("The request with same config is already in progress! Enqueueing a callback..."),a[c].push(function(e,t){t?s.resolve(e,!0):s.reject(e)})),s.promise}};return s}]),coreModule.service("RequestInterceptor",["$q","RequestUtil","$log","$rootScope",function(e,t,n,o){function i(e){try{return JSON.parse(e)}catch(t){return{rawData:e}}}var r,a={APF:function(e){var t=e.data.replace(/\t|\n|\r/g,""),n=/<!\[CDATA\[(.*?)\]\]>/g,o=n.exec(t)[1];o=i(o),r=o.session.id;var a=n.exec(t)[1];e.data=i(a),isDefined(e.data)&&isDefined(e.data.model)&&(e.data=e.data.model)},HOTEL:function(e){var t,n=e.data.replace(/\t|\n|\r/g,""),o=/<!\[CDATA\[(.*?)\]\]>/g;t=-1===n.indexOf("model")?o.exec(n)[1]:o.exec(n)[1],e.data=i(t)},JSON:function(e){angular.isString(e.data)&&(e.data=i(e.data)),safeAccess(e,"data.model",!1)&&(e.data=e.data.model)}},s=function(e,t){t=isDefined(t)?t:c(e);var n=getContext("moduleConfig."+t+".type","JSON");return a[n]?a[n]:a.JSON},c=function(e){var t=e.split("/");return t.length>1?t[t.length-2]:""},l=function(e){if(getContext("applicationConfig.useMocks")){var t=e,n=e.split("/");n.length>1&&(t=n[1]);var o=getContext("applicationConfig.mockedUrls")||[],i=getContext("applicationConfig.ignoreMockedUrls")||[];return o.length>0?o.indexOf(t)>-1:i.length>0?-1===i.indexOf(t):!0}return!1},u=function(e,t){t=isDefined(t)?t:c(e);var n=getContext("backend",""),o=getContext("moduleConfig."+t+".backend");o=isDefined(o)?o:n;var i=getContext("server","/")+o;return i.endsWith("/")&&"/"===e[0]&&(i=i.substr(0,i.length-1)),i.endsWith("/")||"/"===e[0]||(i+="/"),i+e},d=function(e,t){var n=getContext("moduleConfig."+t+".overrides",{});return e=isDefined(n[e])?n[e]:e},f=function(e,t){e=d(e,t);var n=r?";jsessionid="+r:"",o=[];o.push("LANGUAGE="+getContext("LANGUAGE","GB")),o.push("SITE="+getContext("SITECODE","NCMTNCMT"));var i=getContext("OCTX");isDefined(i)&&o.push("OCTX="+i);var a=u(e,t)+n;return a+=-1!==a.indexOf("?")?"&":"?",a+=o.join("&")},g=function(e){return e.status>300},p={},m=function(e){if(g(e)&&v(e.config.url)){var t=getContext("applicationConfig.banFailureRequest",!0);if(t){var n=e.status;isUndefined(p[n])&&(p[n]=[]),p[n].push(e.config.url)}}return e},v=function(e){var t=getContext("applicationConfig.banFailureRequest",!0);if(t)for(var o in p)if(p[o].indexOf(e)>-1)return n.warn(e+" was banned because of bad request answer"),!1;return!0},h=function(e){var t="666";for(var n in p)p[n].indexOf(e.url)>-1&&(t=n);return{config:e,statusText:"Multiple failure, request stopped",status:t}},C=function(e){return e.startsWith("https://")||e.startsWith("http://")};return{request:function(n){if(isDefined(n)){if(t.isRequestManagedExtension(n.url)){if(C(n.url))return n;if(l(n.url))n.url.startsWith("mocks/mobile")||(n.url="mocks/mobile/"+n.url),n.method="GET";else{n.url=f(n.url,n.module);var o=getContext("moduleConfig."+n.module+".contentType");if(isDefined(o)&&(n.headers["Content-Type"]=o),!v(n.url))return e.reject(h(n));"POST"===n.method&&isDefined(n.data)&&(getContext("isMobileApp")&&(n.headers.x_weblogic_msession="SEREiT7GHDYzo8A"),getContext("moduleConfig."+n.module+".useData",!0)&&(n.data={data:JSON.stringify(n.data)}))}}getContext("moduleConfig."+n.module+".transform",!0)&&(n.transformRequest=t.getRequestTransform())}return n},response:function(e){if(t.isResponseManagedExtension(e.config.url)){var n=s(e.config.url,e.config.module);n(e)}return e},responseError:function(n){return isDefined(n)&&isDefined(n.config)&&t.isRequestManagedExtension(n.config.url)&&(m(n),o.$emit("error_message",{func:"Failed to contact the server, please try again later",tech:"Failure to request:"+n.config.url+" status:"+n.status})),e.reject(n)}}}]),coreModule.service("TimeoutRequestInterceptor",["$log",function(e){var t=6e4;return{request:function(n){if(isUndefined(n.timeout)){var o=getContext("applicationConfig.httpTimeoutMilliseconds.default",t);if("POST"===n.method){var i=getContext("applicationConfig.httpTimeoutMilliseconds.perAction."+n.url);isDefined(i)&&(e.info("TimeoutRequestInterceptor overriding "+n.url+" timeout to "+i),o=i)}n.timeout=o}return n}}}]),coreModule.service("LayoutService",["$ionicLoading","$log","$rootScope","$timeout","$q","$templateCache","I18nService","$ionicPopup","PromiseService","$window","PostMessageService",function(e,t,n,o,i,r,a,s,c,l,u){t=t.getInstance("LayoutService"),t.info("Service Started...");var d={isLoading:!1,keyboardClosingDuration:500,messageTimeoutPromise:null,_currentModals:[],MESSAGE_TYPE:{error:"error",warn:"warn",info:"info",debug:"debug"},isKeyboardOpened:function(){var e=document.activeElement;if(isDefined(e)){var t=e.tagName;if("INPUT"===t||"TEXTAREA"===t)return!0}return!1},unFocusActiveElement:function(){var e=i.defer(),t=document.activeElement;return isDefined(t)&&t.blur(),o(function(){e.resolve()},200),e.promise},startLoading:function(e,t){e!==!0&&d.loading(!0,t)},stopLoading:function(e,t){if(e===!0){if(!isDefined(t))throw"stopLoading scope is not defined";t.$broadcast("scroll.refreshComplete")}else d.loading(!1)},loading:function(e,t,n){var o=i.when().promise;return a.isStringLocalized(t)?d._loading(e,t,n):o=a.translate(t).then(function(t){d._loading(e,t,n)}),o},_loading:function(t,n,i){t?(d.unFocusActiveElement(),l.parentLoading&&angular.isFunction(l.parentLoading)?l.parentLoading(!0,n):d._ionicLoadingProvider(n,i)):(isDefined(d.messageTimeoutPromise)&&o.cancel(d.messageTimeoutPromise),l.parentLoading&&angular.isFunction(l.parentLoading)?l.parentLoading(!1):e.hide()),u.send({type:t?"spinnerDisplayedEvent":"spinnerRemovedEvent"}),this.isLoading=t},_ionicLoadingProvider:function(t,n){var i='<ion-spinner class="spinner-positive"></ion-spinner>';if(isDefined(t)){var r=isDefined(n)?"display: none;":"";i+='<div id="spinner_message" class="spinner_message" style="'+r+'">'+t+"</div>",isDefined(n)&&(d.messageTimeoutPromise=o(function(){var e=document.getElementById("spinner_message");isDefined(e)&&(e.style.display="block")},n))}e.show({template:i,delay:100})},toast:function(e){return a.isStringLocalized(e)?d._toast(e):a.translate(e).then(d._toast)},toastWithBackdrop:function(e,t){var n;n=a.isStringLocalized(e)?d._toastWithBackdrop(e,t):a.translate(e).then(function(e){return d._toastWithBackdrop(e,t)})},_toast:function(t){var n=i.defer();return d.unFocusActiveElement(),d.loading(!1),e.show({noBackdrop:!0,template:t}),o(function(){e.hide(),n.resolve()},2500),n.promise},_toastWithBackdrop:function(t,n){var r=i.defer();return d.unFocusActiveElement(),e.show({template:t}),d.isLoading=!0,o(function(){n?d.loading(!1):d.isLoading&&d.loading(!0),r.resolve()},2500),r.promise},toastError:function(e,t){var n,o=isDefined(t)?t:"core.title.errorPopup",i="core.button.ok";if(a.isStringLocalized(e)&&a.isStringLocalized(o))n=a.translate(i).then(function(t){return d._toastError(e,t,o)});else{var r=[];angular.isArray(e)?r=r.concat(e):r.push(e),r.push(o),r.push(i),n=a.translate(r).then(function(e){var t=e[o],n=e[i];delete e[o],delete e[i];var r=Object.values(e);return d._toastError(r,n,t)})}return n},_toastError:function(e,n,o){var r=i.defer(),a=this.isLoading;if(this.isLoading&&this.loading(!1),"string"==typeof e&&(e=[e]),e=e||[],e.indexOf(c.CMT_SILENT_ERROR)>-1)return t.warn("Received CMT_SILENT_ERROR, not displaying a popup!"),r.resolve(),r.promise;d.unFocusActiveElement();var l="<ul><li>"+e.join("</li><li>")+"</li></ul>",u=s.alert({title:o,template:l,okText:n});return u.then(function(){a&&d.loading(!0),r.resolve()}),r.promise},showConfirmPopup:function(e,t,n,o){d.unFocusActiveElement(),n=n||"core.button.ok",o=o||"core.button.cancel";var i=[];a.isStringLocalized(e)?"":i.push(e),a.isStringLocalized(t)?"":i.push(t),a.isStringLocalized(n)?"":i.push(n),a.isStringLocalized(o)?"":i.push(o);var r;return r=i.length>0?a.translate(i).then(function(i){var r=i[e]||e,a=i[t]||t,s=i[n]||n,c=i[o]||o;return d._showConfirmPopup(r,a,s,c)}):d._showConfirmPopup(e,t,n,o)},_showConfirmPopup:function(e,t,o,r){var a=s.confirm({title:e,template:t,cancelText:r,okText:o});f(a);var c=i.defer();return a.then(function(e){n.stateChangePopupListener(),e?c.resolve():c.reject()}),c.promise},showAlertPopup:function(e,t){var o=i.defer();angular.isArray(t)&&(t="<ul><li>- "+t.join("</li><li>- ")+"</li></ul>");var r=s.alert({title:e,template:t});return f(r),r.then(function(){n.stateChangePopupListener(),o.resolve()}),o.promise},showCustomPopup:function(e){d.unFocusActiveElement(),e.template=r.get(e.templateUrl);var t=s.show(e);f(t);var o=i.defer();return t.then(function(e){n.stateChangePopupListener(),e?o.resolve():o.reject()}),o.promise},hidetabs:function(){n.hidetabs=!0},showModal:function(e,t){t=t||"closeModal";var n=safeAccess(e,"scope.$parent."+t);isDefined(n)&&(window.closeModal=n),u.send({type:"modalDisplayedEvent",closeButtonEnabled:isDefined(n),closeModalAction:isDefined(n)?"closeModal":null}),e.modal_id=(new Date).getTime(),d._currentModals.push(e);var o=d._manageModal(e,"show");return o},hideModal:function(e){e=isDefined(e)?e:d._currentModals[d._currentModals.length-1],u.send({type:"modalRemovedEvent"});var t=d._manageModal(e,"hide");return t},removeModal:function(e){e=isDefined(e)?e:d._currentModals[d._currentModals.length-1],u.send({type:"modalRemovedEvent"});var t=d._manageModal(e,"remove").then(function(){d.cleanModal(e)});return t},cleanModal:function(e){d._currentModals=d._currentModals.filter(function(t){return t.modal_id!==e.modal_id})},_manageModal:function(e,t){var n=i.defer();return d.closeKeyboard().then(function(){e[t]().then(function(){n.resolve(!0)})}),n.promise},closeKeyboard:function(){var e=i.defer(),t=function(){e.resolve()};return d.isKeyboardOpened()?(d.unFocusActiveElement(),o(t,d.keyboardClosingDuration)):t(),e.promise},addFormErrors:function(e){for(var n in e)for(var o=e[n],i=0;i<o.length;i++){var r=o[i].$name+" : "+n;this.addMessage(r,this.MESSAGE_TYPE.warn),t.warn(r)}},addErrors:function(e){e=e||[];for(var t=0;t<e.length;t++)this._addError(e[t])},_addError:function(e){this.addMessage(e,this.MESSAGE_TYPE.error),t.error(e)},addMessage:function(e,t){t+="s",isUndefined(n[t])&&(n[t]=[]),n[t].push(e)},removeMessages:function(e){n[e+"s"]=[]},hasCssClass:function(e,t){var n=!1;return angular.isElement(e)&&(e=angular.element(e),n=e.hasClass(t)),n},addCssClass:function(e,t){angular.isElement(e)&&(e=angular.element(e),e.addClass(t))},removeCssClass:function(e,t){angular.isElement(e)&&(e=angular.element(e),e.removeClass(t))},showDomElement:function(e){this.removeCssClass(e,"hide")},hideDomElement:function(e){this.addCssClass(e,"hide")},getActiveView:function(){var e=document.querySelectorAll("ion-view");for(var t in e){var n=e[t];if("entering"===n["$attr-nav-view"]||"active"===n["$attr-nav-view"])return n}},openInExternalBrowser:function(e,t,n){var o=e;t=isDefined(t)?t:e,n=isDefined(n)?n:t,getContext("isMobileApp")&&(ionic.Platform.isAndroid()?o=t:ionic.Platform.isIOS()&&(o=n)),window.open(o,"_system")},getMainMenuStyle:function(){return getContext("applicationConfig.menu.mainMenuStyle","action-sheet")},getCardMenuStyle:function(){return getContext("applicationConfig.menu.cardMenuStyle","action-sheet")},showBackButton:function(e){var t=e?"hide":"showBackButton",n=e?"showBackButton":"hide";o(function(){for(var e=document.querySelectorAll("button[default-nav-back-button]")||{},o=0;o<e.length;o++)e[o].classList.remove(t),e[o].classList.add(n)},100)},toString:function(){return"LayoutService"}};n.$on("error_message",function(e,n){d.addErrors[n.func],t.error(n.tech)});var f=function(e){n.stateChangePopupListener=n.$on("$stateChangeStart",function(){e.close()})};return d}]),coreModule.service("GloballistService",["DataManagerService","RequestService","$log","$q",function(e,t,n,o){n=n.getInstance("GloballistService"),n.info("Service Started...");var i={GLOBAL_LIST_URL:"mcmtng/globals",getGl:function(n){var r=e.get(i.getGLKey(n),e.MEMORY),a=o.defer();if(isUndefined(r)){var s=i._getResourcePath(n)+"/"+n+".json",c=t.get(s);c.then(function(e){i._successStaticGLCallback(e,n,a)},function(e){i._failureStaticGLCallback(e,n,a)})}else a.resolve(r);return a.promise},_successStaticGLCallback:function(t,n,o){e.set(t.data,i.getGLKey(n),{storage:e.MEMORY,ttl:"7d",languageDependent:i._isLanguageDependent(n),belongsToUser:!1}),o.resolve(t.data)},_failureStaticGLCallback:function(e,t,o){n.warn("The Globallist ["+t+"] is not present we need to request it, please add it to your bower.json configuration");var r=i.reloadGl(t);r.then(function(e){o.resolve(e)},function(e){o.reject(e)})},getGLKey:function(e){return"Gl_"+e},reloadGl:function(e){var n=o.defer(),r=this,a=t.get(i.GLOBAL_LIST_URL+"?RES="+e);return a.then(function(t){r._successGLCallback(t,e,n)},function(t){r._failureGLCallback(t,e,n)}),n.promise},_successGLCallback:function(t,n,o){e.set(t.data[n],i.getGLKey(n),{storage:e.LOCALSTORAGE,ttl:"7d",languageDependent:i._isLanguageDependent(n)}),o.resolve(t.data[n])},_failureGLCallback:function(e,t,n){n.reject(e.statusText)},_isLanguageDependent:function(e){return 0===e.indexOf("LANG_")||0===e.indexOf("SL_")},_isSiteDependent:function(e){return 0===e.indexOf("SITE_")||0===e.indexOf("SL_")},_getResourcePath:function(e){var t=["resources",getContext("SITECODE"),getContext("LANGUAGE")];return e&&(i._isSiteDependent(e)||t.splice(1,1),i._isLanguageDependent(e)||t.pop()),getContext("applicationConfig.useMocks",!1)&&t.unshift("mocks"),t.join("/")},toString:function(){return"GloballistService"}};return i}]),coreModule.factory("GloballistProcessor",["GloballistService","$log","$q",function(e,t,n){
t=t.getInstance("GloballistProcessor"),t.info("Service Started...");var o={getCallingCountryCodeByCountry:function(){var t=n.defer(),o=e.getGl("SL_GET_COUNTRY_CALLING_CODE");return o.then(function(e){var n=e.map(function(e){return{countryCode:e[0],country:e[1],phoneCode:"+"+e[2]}});t.resolve(n)},function(e){t.reject("SL_GET_COUNTRY_CALLING_CODE",e)}),t.promise},getCountryCodeByCountry:function(){var t=e.getGl("LANG_COUNTRY_REGION_LIST").then(o.cleanZZLanguage).then(o.matrixToObjectArray);return t},matrixToObjectArray:function(e){var t=e.map(function(e){return{value:e[0],text:e[1]}});return t},cleanZZLanguage:function(e){for(var t=e.length-1;t>=0;t--)"ZZ"===e[t][0]&&e.splice(t,1);return e},toString:function(){return"GloballistProcessor"}};return o}]),coreModule.service("OrchestratorChiefService",["$state","$log","$ionicViewSwitcher","$rootScope","$ionicHistory","$q","LayoutService",function(e,t,n,o,i,r,a){function s(t,n){var o=["landing","login"],i=n.isFromFooterTabs||!1;return i||-1===e.current.name.indexOf("more")||-1!==o.indexOf(t)||-1===t.indexOf("more")&&(t="more-"+t),t}t=t.getInstance("OrchestratorChiefService"),t.info("Service Started...");var c={page:e.current.name},l={_orchestrators:[],_index:0,getUserContext:function(){return c},canNavigateBack:function(){return isDefined(i.backView())||(e.current||{}).defaultBackState},registerCustomBackAction:function(e){l.customBackButtonFunction=e},deregisterCustomBackAction:function(){l.customBackButtonFunction=void 0},navigateTo:function(t,i,c){var l=r.defer();return i=i||{},c=c||{},t&&getContext("isB2b",!1)&&(t=s(t,i)),c.reload!==!1&&isDefined(e.current)&&e.current.name===t&&(c.reload=!0),a.closeKeyboard().then(function(){getContext("isWebDesktop")?n.nextTransition("none"):n.nextTransition(ionic.Platform.isAndroid()?"android":"ios"),e.go(t,i,c)["finally"](function(){l.resolve(!0)})}),o.hidetabs&&(o.hidetabs=!1),l.promise},navigateToPage:function(e){return l.navigateTo(e.state.name,e.params)},navigateToLandingPage:function(){return l.navigateTo(getContext("applicationConfig.landingPage","landing"))},navigateToLoginPage:function(){return l.navigateTo("login")},navigateBack:function(){a.closeKeyboard().then(function(){if(isDefined(l.customBackButtonFunction))l.customBackButtonFunction();else{var t=(e.current||{}).defaultBackState;i.backView()?o.$ionicGoBack():t?(n.nextDirection("back"),i.nextViewOptions({disableBack:!0,historyRoot:!0}),l.navigateTo(t)):isDefined(navigator.app)&&navigator.app.exitApp()}})},getPreviousView:function(){return i.backView()},register:function(e){if(!e.next)throw e+"is not a valid orchestrator";l._orchestrators.push(e)},check:function(e,t){var n=null;return l._index>-1&&(n=l._orchestrators[l._index--].next(e,t)),n},next:function(t){l._index=l._orchestrators.length-1;var n=angular.copy(c),o=angular.extend({},c,t);return o.page=e.current.name,l.check(o,n)},toString:function(){return"OrchestratorChiefService"},onBackButtonModalEvent:function(){a.removeModal().then(function(){l.unregisterNavigateBackFromModal()})},registerNavigateBackFromModal:function(){var e=o.$on("$stateChangeStart",function(t){window.onpopstate&&(t.preventDefault(),history.pushState(null,null,window.location.href)),e()});window.onpopstate=l.onBackButtonModalEvent},unregisterNavigateBackFromModal:function(){window.onpopstate=null}};return l}]),coreModule.service("EasterEggService",["$log","$timeout","$rootScope","$ionicModal","LayoutService","RequestService",function(e,t,n,o,i,r){function a(){s=null,l=0}e=e.getInstance("EasterEggService"),window.isEasterEggEnabled=!1;var s=null,c=3e3,l=0,u=5,d={displayEasterEgg:function(){function e(){var e=JSON.stringify(a,null,2);e=e.substring(1).slice(0,-1).replace(/[",]/g,""),s.debugInfo=e,o.fromTemplateUrl("core/templates/partial/EasterEggModal.html",{scope:s,animation:"slide-in-up",focusFirstInput:!1}).then(function(e){t=e,i.showModal(t)})}if(window.cmt&&window.cmt.getDebugInfo){var t,a=window.cmt.getDebugInfo(),s=n.$new();if(s.closeModal=function(e){if(e=e||{localStorageOverridesCleared:!1},e.localStorageOverridesCleared)window.localStorage.removeItem("__EASTER_EGG_OCTX"),window.localStorage.removeItem("__EASTER_EGG_SERVER"),setContext("server",getContext("buildTimeImmutableConfig.server"));else{var n=getContext("OCTX")!==s.octx.current||getContext("server")!==s.server.current;if(n){var o=a.isReleaseBuild;!o&&getContext("isMobileApp")&&(window.localStorage.setItem("__EASTER_EGG_OCTX",s.octx.current),window.localStorage.setItem("__EASTER_EGG_SERVER",s.server.current)),setContext("OCTX",s.octx.current),setContext("server",s.server.current)}}setContext("applicationConfig.useMocks",s.useMocks.activated),s.featuresActivation.forEach(function(e){setContext(e.ApplicationContextKey,e.isEnabled)}),i.removeModal(t)},s.clearLocalStorageOverride=function(){s.closeModal({localStorageOverridesCleared:!0})},s.testConnection=function(e){var t;t="http"===e?"http://cors-test.appspot.com/test":"https://cors-test.appspot.com/test",r.get(t,{timeout:15e3}).then(function(e){window.alert("it works :)")},function(e){window.alert("it failed :(")})},s.isReleaseBuild=a.isReleaseBuild,s.isUserLogged=isDefined(a.userId),a.isReleaseBuild||(window.isEasterEggEnabled=!0),s.featuresActivation=[],!a.isReleaseBuild){var c=getContext("featureConfig",{});for(var l in c){var u=l+".enabled",d=safeAccess(c,u,void 0);if(void 0!==d){var f={label:l,isEnabled:d,ApplicationContextKey:"featureConfig."+u};s.featuresActivation.push(f)}}}if(s.useMocks={},s.useMocks.showToggle=!getContext("isMobileApp"),s.useMocks.activated=getContext("applicationConfig.useMocks"),s.octx={},s.octx.current=getContext("OCTX"),s.octx.list=a.octxList||[],s.server={},s.server.current=getContext("server"),s.server.list=a.serverList||[],s.isLocalStorageOverrideActive=!1,getContext("isMobileApp")){var g=window.localStorage.getItem("__EASTER_EGG_OCTX"),p=window.localStorage.getItem("__EASTER_EGG_SERVER");(g||p)&&(s.isLocalStorageOverrideActive=!0)}a.octxList=void 0,a.serverList=void 0;var m=+new Date;r.get("dependencies.js?ts="+m,{timeout:5e3}).then(function(t){var n=t.data;n=n.replace("window.dependencyCallback(","").replace(");","").replace(/\r\n/g,""),n=JSON.parse(n),a.cmtwebapp={buildTimestamp:n.timestamp,buildArtifact:n.webapp,ioncmtArtifact:"ioncmt-"+n["amadeus-mobile.version"]},e()})["catch"](function(){e()})}},handleEasterEgg:function(){s||(s=t(c).then(a)),l++,l===u&&(d.displayEasterEgg(),a())}};return d}]),coreModule.service("NetworkService",["$log","$q","$window","$rootScope",function(e,t,n,o){e=e.getInstance("NetworkService"),e.info("Service Started...");var i={isOnline:!0},r={Connection:{UNKNOWN:"unknown"},init:function(){n.addEventListener("offline",function(){o.$apply(function(){r.updateNetworkStatus({isOnline:!1})})},!1),n.addEventListener("online",function(){o.$apply(function(){r.updateNetworkStatus({isOnline:!0})})},!1)},hasConnectivity:function(e){var n=t.defer();return n.resolve(i.isOnline),n.promise.isOnline=i.isOnline,n.promise},hasHighProfile:function(){return!0},getRequestTimeout:function(){return this.hasHighProfile()?1e4:6e4},updateNetworkStatus:function(e){i=e},getNetworkType:function(){return this.Connection.UNKNOWN.toUpperCase()},toString:function(){return"NetworkService"}};return r}]),coreModule.service("StringService",["$log",function(e){e=e.getInstance("StringService"),e.info("Service Started...");var t={capitalizedFirst:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},removeAtTheEnd:function(e,t){var n=e.lastIndexOf(t);return n>=0&&n+t.length===e.length&&(e=e.slice(0,n)),e},isValidJsonString:function(e){if("string"!=typeof e)return!1;try{JSON.parse(e)}catch(t){return!1}return!0},toString:function(){return"StringService"}};return t}]),coreModule.service("ClipboardService",["$log","$q","$window","LayoutService",function(e,t,n,o){function i(t,o,i){var r=n.document.querySelector(t);if(!r)return e.error("Oops, unable to find selector!"),void i.reject();var a=r.textContent;try{n.cordova.plugins.clipboard.copy(a,function(){e.info("Copy to clipboard ok"),i.resolve()},function(){e.error("Oops, unable to copy text!"),i.reject()}),o.preventDefault()}catch(s){return e.error("Oops, unable to copy text!"),void i.reject()}}function r(t,i,r){if(!isDefined(n.document.queryCommandEnabled)||!n.document.queryCommandSupported("copy"))return e.error("Oops, the browser does not support copying to clipboard!"),void r.reject();var a=n.document.querySelector(t);if(!a)return e.error("Oops, unable to find selector!"),void r.reject();o.addCssClass(a,"copyToClipboard");var s=n.document.createRange();s.selectNode(a),n.getSelection().addRange(s);try{var c=n.document.execCommand("copy");n.getSelection().removeAllRanges(),c?(e.info("Copy to clipboard ok"),i.preventDefault(),r.resolve()):(e.error("Oops, unable to copy text!"),r.reject())}catch(l){e.error("Oops, unable to copy text!"),r.reject()}o.removeCssClass(a,"copyToClipboard")}e=e.getInstance("ClipboardService"),e.info("Service Started...");var a={copyToClipboard:function(e,n){var o=t.defer();return getContext("isMobileApp")&&isDefined(safeAccess(window,"cordova.plugins.clipboard"))?i(e,n,o):r(e,n,o),o.promise},toString:function(){return"ClipboardService"}};return a}]),coreModule.service("MenuService",["$log","OrchestratorChiefService","I18nService","$q",function(e,t,n,o){e=e.getInstance("MenuService"),e.info("Service Started...");var i={menuItems:[],ids:0,addItem:function(e){var t,r=i.getItem(e.name);if(isUndefined(r))if(r=e,r.id=i.ids++,n.isStringLocalized(e.label))r.label=e.label,i._addItem(r),t=o.when({onClick:function(e){return r.onClick=e,this},id:r.id});else{var a=i._addItem(r);t=n.translate(e.label).then(function(e){return i.menuItems[a].label=e,{onClick:function(e){return r.onClick=e,this},id:r.id}})}else t=o.when({onClick:function(e){return r.onClick=e,this},id:r.id});return t},_addItem:function(e){return e.icon=isDefined(e.icon)?e.icon:"",i.menuItems.push(e),i.menuItems.length-1},addDestructiveItem:function(e){return e.isDestructive=!0,i.addItem(e)},getDestructiveItem:function(e,t){var n=i.menuItems.filter(function(e,n,o){return t.indexOf(e.name)>-1}).filter(function(t,n,o){return i.isVisibleInThisContext(t,e,!0)}).filter(function(e,t,n){return e.isDestructive}).map(function(t,n,o){return i._prepareItem(t,e)});return n.length>0?n[n.length-1]:null},isVisibleInThisContext:function(e,t,n){return(isUndefined(e.isDestructive)||e.isDestructive===n)&&(isUndefined(e.condition)||i.safeCall(e.condition,t))},safeCall:function(n,o){try{return n(o,t.getUserContext())}catch(i){return e.error("Fail during menu item condition evaluation",i),!1}},removeAll:function(){i.menuItems=[],i.ids=0},getItem:function(e){var t=i.menuItems.filter(function(t,n,o){return t.name===e});return t.length>0?t[0]:null},removeItem:function(e){for(var t=0;t<i.menuItems.length;t++)if(i.menuItems[t].id===e)return i.menuItems.splice(t,1)[0];return null},_prepareItem:function(n,o){var i=angular.copy(o),r=angular.copy(n);return r.action=function(n){isDefined(r.onClick)?r.onClick.apply(n,[i,t.getUserContext()]):e.warn("There is no action associated to ",r)},r},listItem:function(e,t,n){var o=i.menuItems.filter(function(e,n,o){return t.indexOf(e.name)>-1}).filter(function(t,o,r){return i.isVisibleInThisContext(t,e,n)}).map(function(t,n,o){return i._prepareItem(t,e)}).sort(function(e,n){if(t){var o=t.indexOf(e.name),i=t.indexOf(n.name);return o-i}return 0});return o},toString:function(){return"MenuService"}};return i}]),coreModule.service("MapService",["RequestService","$log",function(e,t){return t=t.getInstance("MapService"),t.info("Service Started..."),{createLeafLetMap:function(e,t,n,o){var i=L.map(e).setView([t,n],13);return L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(i),i},plotSourceInformation:function(e,t,n,o){var i="Source Information";L.marker([t,n]).addTo(e).bindPopup(i)},plotDestinationInformation:function(e,t,n){var o="Destination Information";if(null!=t&&t.length>0)for(var i=0;i<t.length;i++)L.marker([t[i].lat,t[i].lng]).addTo(e).bindPopup(o)}}}]),coreModule.service("GpsCheckinService",["$log","RequestService","$q",function(e,t,n){e=e.getInstance("GpsCheckinService"),e.info("Service Started...");var o="v1/account/secureCheckIn",i={secureCheckinActionCall:function(i){var r=n.defer(),a={};return a.latitude=i.coords.latitude,a.longitude=i.coords.longitude,t.post(o,a).then(function(t){safeAccess(t,"data")&&t.data.success?(e.info("Location details sent successfully to server"),r.resolve(i)):(e.error("Location details update failed in server"),r.reject(t.data.errors[0]))},function(t){e.error("Location details action call failed from server"),r.reject(t)}),r.promise},getGeolocationData:function(){var t=n.defer();return safeAccess(navigator,"geolocation")?navigator.geolocation.getCurrentPosition(function(e){t.resolve(e)},function(n){e.error(n),t.reject(n)},{timeout:15e3,maximumAge:1e4}):t.reject("No plugin available"),t.promise},toString:function(){return"GpsCheckinService"}};return i}]),coreModule.service("GooglePlaceService",["$log","$q","$timeout","StringService","$window",function(e,t,n,o,i){e=e.getInstance("GooglePlaceService");var r="__onGooglePlacesJsApiLoad",a={GOOGLE_PLACES_LOAD_TIMEOUT_MS:15e3,__pendingGooglePlacesPromise:null,__googlePlacesLoadTimeout:null,_getGooglePlacesJsApiUrl:function(){var t=getContext("featureConfig.googlePlaces.apiKey");return t||e.error("You need to define Google Places API key in ApplicationContext."),"https://maps.googleapis.com/maps/api/js?libraries=places&key="+t+"&callback="+r},loadGooglePlacesJsApi:function(){if(isDefined(a.__pendingGooglePlacesPromise))e.info("Already pending the load of Google Places API, reusing the pending promise");else{var o=t.defer();if(safeAccess(window,"google.maps.places"))e.info("Google Places API already loaded"),o.resolve();else{window[r]=function(){n.cancel(a.__googlePlacesLoadTimeout),e.info("Google Places API loaded"),o.resolve(),window[r]=null},a.__googlePlacesLoadTimeout=n(function(){e.error("Failed to load Google Places API, timeout"),window[r]=function(){},o.reject(),a.__pendingGooglePlacesPromise=null},a.GOOGLE_PLACES_LOAD_TIMEOUT_MS);var s=i.document.createElement("script");s.src=a._getGooglePlacesJsApiUrl(),a._appendChildToHead(s)}a.__pendingGooglePlacesPromise=o.promise}return a.__pendingGooglePlacesPromise},_appendChildToHead:function(e){i.document.getElementsByTagName("head")[0].appendChild(e)},convertGooglePlacesDataModelToAmadeusMdwLocationObject:function(e){var t=a._jsonifyAddress(e.address_components),n=a._jsonifyGeometry(e.geometry),i=safeAccess(t,"locality.long_name");isUndefined(i)&&(i=safeAccess(t,"administrative_area_level_1.long_name",""));var r=safeAccess(t,"street_number.long_name"),s=safeAccess(t,"route.long_name"),c=[r,s].filter(function(e){return void 0!==e}).join(" ");c=""==c?null:c;var l=safeAccess(t,"neighborhood.long_name"),u=safeAccess(t,"colloquial_area.long_name"),d=safeAccess(e,"vicinity","");d=o.removeAtTheEnd(d,", "+i),d===i&&(d=null);var f={addressLine1:c||l||u||d||null,addressLine2:null,cityCode:null,cityName:i,code:null,countryCode:safeAccess(t,"country.short_name",null),countryName:safeAccess(t,"country.long_name",null),latitude:String(n.latitude),longitude:String(n.longitude),name:safeAccess(e,"name",null),stateCode:null,zip:safeAccess(t,"postal_code.long_name",null)};return f},_jsonifyGeometry:function(e){var t={},n=safeAccess(e,"location.lat"),o=safeAccess(e,"location.lng");return isDefined(n)&&angular.isFunction(n)&&(n=n()),isDefined(o)&&angular.isFunction(o)&&(o=o()),t.latitude=n,t.longitude=o,t},_jsonifyAddress:function(e){var t={};if(isDefined(e)&&angular.isArray(e))for(var n=0;n<e.length;n++){var o=e[n];t[o.types[0]]={long_name:o.long_name,short_name:o.short_name}}return t},toString:function(){return"GooglePlaceService"}};return a}]),coreModule.service("CurrencyService",["$log","$q","DataManagerService","I18nConfig","GloballistService","GloballistProcessor",function(e,t,n,o,i,r){e=e.getInstance("CurrencyService"),e.info("Service Started...");var a={CURRENCY_LIST_GLOBAL:"LANG_CURRENCY_DESCRIPTION",CURRENCY_COUNTRY_MAPPING_GLOBAL_LIST:"NO_SL_COUNTRY",LOCALE_CURRENCY_MAP_KEY:"localeCurrencyMap",getCurrencyList:function(){var o=t.defer(),s=n.get(a.CURRENCY_LIST_KEY,n.MEMORY);return isDefined(s)?o.resolve(s):i.getGl(a.CURRENCY_LIST_GLOBAL).then(function(e){var t=r.matrixToObjectArray(e);t=a._sortCurrencyByCode(t),n.set(t,a.CURRENCY_LIST_KEY,{storage:n.MEMORY}),o.resolve(t)},function(t){e.error("getCurrencyList: rejecting promise due to backend error",t),o.reject(t)}),o.promise},_sortCurrencyByCode:function(e){var t=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};return e.sort(t)},getCurrencyCountryMappingList:function(){var o=t.defer(),r=n.get(a.LOCALE_CURRENCY_MAP_KEY,n.MEMORY);return r?o.resolve(r):i.getGl(a.CURRENCY_COUNTRY_MAPPING_GLOBAL_LIST).then(function(e){for(var t=e,i={},r=0;r<t.length;r++)i[t[r][0]]=t[r][1];n.set(i,a.LOCALE_CURRENCY_MAP_KEY,{storage:n.MEMORY}),o.resolve(i)},function(t){e.error("getCurrencyCountryMappingList: rejecting promise due to backend error",t),o.reject(t)}),o.promise},getDeviceLocaleCurrency:function(){var e=t.defer();return getContext("isMobileApp",!1)&&safeAccess(window,"cordova.plugins.DeviceLocale.getDeviceLocale")?window.cordova.plugins.DeviceLocale.getDeviceLocale(function(t){isDefined(t)?e.resolve(t):e.reject()},function(){e.reject()}):e.reject(),e.promise},getCurrencyCodesforLocales:function(n){var i=t.defer();return a.getCurrencyCountryMappingList().then(function(e){var t=e;a.getDeviceLocaleCurrency(t).then(function(e){i.resolve(a._processCountryCodeList(n,t,e))},function(e){var r=o.getCountryCodeFromDeviceLocale().toUpperCase();i.resolve(a._processCountryCodeList(n,t,t[r]))})},function(t){e.error("getCurrencyCodesforLocales: rejecting promise due to backend error",t),i.reject(t)}),i.promise},_processCountryCodeList:function(e,t,n){for(var o=[],i=0;i<e.length;i++)isDefined(e[i])&&""!==e[i]?o.push(t[e[i]]):o.push(n);return o},getDeviceCurrency:function(){var e=t.defer();return a.getDeviceLocaleCurrency().then(function(t){e.resolve(t)},function(){a._getCurrencyFromLocale().then(function(t){e.resolve(t)})}),e.promise},_getCurrencyFromLocale:function(){var e="EUR",n=t.defer(),i=o.getCountryCodeFromDeviceLocale().toUpperCase();return a.getCurrencyCountryMappingList().then(function(t){n.resolve(t[i]||e)},function(){n.resolve(e)}),n.promise},toString:function(){return"CurrencyService"}};return a}]),coreModule.directive("defaultNavBackButton",["$ionicHistory","$ionicConfig","$ionicPlatform","OrchestratorChiefService","$state",function(e,t,n,o,i){function r(i,r,s){i.backTitle=function(){return t.backButton.previousTitleText()&&a()?e.backTitle()||"back":void 0},i.goBack=function(){o.navigateBack()},i.$on("$stateChangeSuccess",function(){var e=a();r.toggleClass("hide",!e),r.toggleClass("showBackButton",e)}),n.registerBackButtonAction(function(){o.navigateBack()},100)}function a(){var e=(i.current||{}).defaultBackState;return isDefined(e)}var s={link:r,restrict:"EA"};return s}]),coreModule.directive("navigateTo",["OrchestratorChiefService",function(e){return{restrict:"A",compile:function(t,n){var o=n.navigateTo;return function(t,n){n.on("click",function(t){e.navigateTo(o)})}}}}]),coreModule.directive("stopPropagation",function(){return{restrict:"A",compile:function(e,t){return function(e,t){t.on("click",function(e){e.stopPropagation()})}}}}),coreModule.run(["$templateCache",function(e){e.put("core/templates/partial/EasterEggModal.html",'<ion-modal-view debug-file-path="EasterEggModal.html"><ion-header-bar class="bar-stable"><h1 class="title">You&apos;re a developer now!</h1><span class="button button-clear icon {{::closeicon}}" ng-click="closeModal()"></span></ion-header-bar><ion-content><div class="list" ng-if="!isReleaseBuild"><div class="spaced-element" ng-if="isUserLogged"><p><b>Log out to be able to change OCTX and Server</b></p></div><div ng-if="!isUserLogged"><div ng-if="server.list.length"><div class="item item-divider settings-header spaced-element">Server</div><div><ion-radio name="server" ng-model="server.current" ng-repeat="_server in server.list" ng-value="_server.value">{{_server.label}}</ion-radio></div></div><div ng-if="octx.list.length"><div class="item item-divider settings-header spaced-element">OCTX</div><div><ion-radio name="octx" ng-model="octx.current" ng-repeat="_octx in octx.list" ng-value="_octx.value">{{_octx.label}}</ion-radio></div></div><div ng-if="useMocks.showToggle"><div class="item item-divider settings-header spaced-element">Use mocks</div><div><ion-toggle ng-model="useMocks.activated" toggle-class="toggle-balanced">Activated</ion-toggle></div></div></div></div><div class="list" ng-if="!isReleaseBuild"><div ng-if="featuresActivation.length"><div class="item item-divider settings-header">Features activation</div><div ng-repeat="feature in featuresActivation"><ion-toggle ng-model="feature.isEnabled" toggle-class="toggle-balanced" ng-change="feature.onActivationChange()">{{feature.label}}</ion-toggle></div></div></div><div class="list"><div class="item item-divider settings-header">Connection test</div><div class="debugInfoButtonContainer"><button ng-click="testConnection(&apos;http&apos;)">http</button> <button ng-click="testConnection(&apos;https&apos;)">https</button></div></div><div class="list" ng-if="isLocalStorageOverrideActive"><div class="item item-divider settings-header">Local storage override is active</div><div class="debugInfoButtonContainer"><button ng-click="clearLocalStorageOverride()">Clear localstorage override</button></div></div><div class="list"><div class="item item-divider settings-header">Build info</div><pre><code class="debugInfoContainer" ng-bind-html="debugInfo"></code></pre></div></ion-content></ion-modal-view>')}]),window.CONSTANTS={FEATURE_CONFIG_GUEST_MODE_ENABLED:"featureConfig.guestMode.enabled",FEATURE_CONFIG_SHARE_CMT_URL_ENABLED:"featureConfig.share.cmtUrlEnabled",ITMNGT_SHARE_ERROR:"itmngt.share.error",CLICKED_BRANCH_LINK:"+clicked_branch_link",NON_BRANCH_LINK:"+non_branch_link",FEATURE_CONFIG_EXPLORE_ENABLED:"featureConfig.explore.enabled",HIDE_TABS_ON_KEYBOARD_OPEN:"hide-tabs-on-keyboard-open",APPLICATION_CONFIG_MENU_TRIPLIST_MAIN_ITEMS:"applicationConfig.menu.tripListMainItems",FORGOT_PASSWORD_ACTIVATION:"forgotpassword-activation",ACCOUNT_RECOVERY:"account-recovery",TAB_SETTINGS:"tab-settings",TAB_PROFILE:"tab-profile",NOTIFICATION_SETTINGS:"notifications-settings",EDIT_PROFILE:"edit-profile",TAB_BOOKING:"tab-booking",TAB_TRIPLIST:"tab-triplist",TAB_PAST_TRIPS:"tab-pastTrips",TRIP_EXPANDED:"trip-expanded",SEGMENT_EXPANDED:"segment-expanded",TAB_DISCOVER:"tab-discover",EPOWER_SEARCH:"epower-search",WEATHER_DETAILS:"weather-details",PROFILE_NOTIFICATIONS_SETTINGS:"profile-notifications-settings",PROFILE_EDIT_PROFILE:"profile-edit-profile",PROFILE_ADDRESS:"profile-address",PROFILE_LOYALTY_CARD_LIST:"profile-loyaltycardlist",PROFILE_LOYALTY_CARD_ADD:"profile-loyaltycardadd",PROFILE_LOYALTY_CARD_UPDATE:"profile-loyaltycardupdate",PROFILE_CREDIT_CARD_LIST:"profile-creditcardlist",PROFILE_CREDIT_CARD_ADD:"profile-creditcardadd",PROFILE_CREDIT_CARD_UPDATE:"profile-creditcardupdate",PROFILE_MARKET:"profile-market",PROFILE_GPS_CHECKIN:"profile-gpsCheckin",HELP_CONTACT:"help-contact",HELP_TERMS_AND_CONDITIONS:"help-termsandconditions",HELP_COOKIE_POLICY:"help-cookiepolicy",HELP_LICENSE:"help-license",HELP_PRIVACY_POLICY:"help-privacypolicy",PAST_TRIP_EXPANDED:"past-trip-expanded",PAST_SEGMENT_EXPANDED:"past-segment-expanded",PAST_WEATHER_DETAILS:"past-weather-details",GUEST_HOME:"guest-home",GUEST_HOTEL_BOOKING:"guest-hotelBooking",GUEST_CONTACT_US:"guest-contactUs",GUEST_FLIGHT_BOOKING:"guest-flightBooking",GUEST_EPOWER:"guest-epower",GUEST_EPOWER_SEARCH:"guest-epower-search",GUEST_EZEEGO1:"guest-ezeego1",GUEST_EZEEGO1_HOTELS:"guest-ezeego1Hotels",GUEST_DISCOVER_LIST:"guest-discoverList",GUEST_TAB_DISCOVER:"guest-tab-discover",GUEST_DISCOVER_RESULTS:"guest-discoverResults",GUEST_SEGMENT_RESULTS:"guest-segmentResults",GUEST_DISCOVER_LIST_BKNG:"guest-discoverListBkng",GUEST_GENERIC_SEARCH:"guest-genericSearch",GUEST_DISCOVER_RESULTS_BKNG:"guest-discoverResultsBkng",GUEST_SEGMENT_RESULTS_BKNG:"guest-segmentResultsBkng",GUEST_EXPLORE_MAP:"guest-exploreMap",GUEST_EXPLORE_DETAILS:"guest-exploreDetails",GUEST_TRIP_ADVISOR_MAP:"guest-tripAdvisorMap",GUEST_TRIP_ADVISOR_DETAILS:"guest-tripAdvisorDetails",GUEST_ACTIVITIES:"guest-activities",GUEST_LOUNGE:"guest-lounge",GUEST_STATIC_CONTENT:"guest-staticContent",GUEST_PARKING:"guest-parking",GUEST_HELP:"guest-help",GUEST_TAB_HELP:"guest-tab-help",GUEST_HELP_TERMS_AND_CONDITIONS:"guest-help-termsandconditions",GUEST_HELP_PRIVACY_POLICY:"guest-help-privacypolicy",GUEST_HELP_COOKIE_POLICY:"guest-help-cookiepolicy",GUEST_HELP_FAQ:"guest-help-faq",GUEST_HELP_LICENSE:"guest-help-license",ONETRUST_COOKIE_POLICY:"onetrust-cookiepolicy",AIR_SEARCH_MIN_DURATION_PARAMETER:"featureConfig.airSearchParams.minDuration",PASSANGER_FARE_AMOUNT_WITHOUT_TAX:"passengerFare.amountWithoutTax",PASSANGER_FARE_WITH_TAX:"passengerFare.tax",PASSANGER_FARE_PRICE:"passengerFare.price",CORE_TITLE_ERROR_POPUP:"core.title.errorPopup",AIR_FLIGHT_CONFIRM_SESSION_EXPIRED:"air.flightConfirm.sessionExpired",CORE_BACKEND_ERROR_CODES:"core.backendErrorCodes.000000",TYPE_QUANTITY:"type.quantity",AIR_LABEL_OPTIONS:"air.label.nextOptions",SSR_PAYMENT:"SSR Payment",SSR_ERROR_GENRIC_ERROR:"ssr.error.genericError",SSR_SEAT_TEXT_CONTACT_AGENCY_CHANGE_SEAT:"ssr.seat.text.contactAgencyChangeSeat",SSR_SEAT_LABEL_NAME:"ssr.seat.label.name",SSR_LUGGAGE_LABEL_NAME:"ssr.luggage.label.name",DATA_SUCCESS:"data.success",SSR_BOOKING_ERROR_OCCURED:"SSR booking : error occured",SSR_BOOKING_EXCEPTION_OCCURED:"SSR booking : exception occured",NO_DATA_RECIEVED:"No data received",LOADING_CONTAINER_LOADING:".loading-container .loading",LOCATION_YES:"location:yes",FEATURE_CONFIG_CORPORATE_CLIENTID:"featureConfig.corporate.clientId",FEATURE_CONFIG_CORPORATE_REDIRECTURI:"featureConfig.corporate.redirectURI",FEATURE_CONFIG_CORPORATE_AUTHURL:"featureConfig.corporate.authURL",ERROR_ADDING_NEW_CARD:"Add Card: Error adding new card",CREDITCARD:"Credit Card",CURRENCYCONVERTER_ERROR_CURRENCYINFO_NOT_AVAILABLE:"currencyConverter.error.currencyInfoNotAvailable",CYTRIC_VIEW:"cytric/templates/pages/CytricView.html",DISCOVER_CURRENTLOCATION:"discover.currentlocation",GUEST_DISCOVERLIST:"guest-discoverList",GUEST_DISCOVER_LIST_BKG:"guest-discoverListBkng",TRIP_DETAILS:"From - Trip-Details",FEATURE_CONFIG_MANUAL_ETR_MANAGEMENT_ENABLED:"featureConfig.manualEtrManagement.enabled",FEATURE_CONFIG_MANUAL_ETR_MANAGEMENT_ACTIVITY_ENABLED:"featureConfig.manualEtrManagement.segments.activityEnabled",FROM_EXPLORE_DETAILS:"From Explore details - ",FEATURE_CONFIG_EZEEGO1_URL:"featureConfig.ezeego1.url",EXTENSION_TYPE:"extension-type",FEATURE_CONFIG_HOTEL_CONFIG_MAX_AVL:"featureConfig.hotelConfig.maxAvl",FEATURE_CONFIG_HOTEL_CONFIG_MIN_AVL:"featureConfig.hotelConfig.minAvl",HOTEL_BOOKING:"Hotel Booking",RATE_PAYMENT_TYPE_GUARANTEE:"rate.paymentType.guarantee",RATE_PAYMENT_TYPE_DEPOSIT:"rate.paymentType.deposit",MODEL_JSON:"model.json",HOTEL_PURCHASE_COND_BOOKING_DAY:"hotel.purchaseCond.bookingDay",HOTEL_PURCHASE_COND_BOOKING_DAYS:"hotel.purchaseCond.bookingDays",HOTEL_BOOKING_ERROR_WHILE_CONFIRMATION:"Hotel Booking-Error while hotel confirmation",MESSENGER_RESET_ERROR_POPUP:"messenger.reset.errorPopup",SLIDE_IN_UP:"slide-in-up",MESSENGER_ERROR:"messenger.error.",FEATURE_CONFIG_MAIN_FEATURES_PROFILE_MENU_ENABLED:"featureConfig.mainFeatures.isProfileMenuEnabled",MARKET_DATA_IS_GROUP_ENABLED:"marketData.isGroupEnabled",MARKET_DATA_COUNTRY_LIST_OPTIONS:"marketData.countryListOptions",MARKET_DATA_MARKETS_WITH_COUNTRY:"marketData.marketsWithCountry",MARKET_DATA_MARKET_LIST_OPTIONS:"marketData.marketListOptions",DATA_ERROR_CODES:"data.errorCodes",CARD_ERRORS:"card-errors",FAILED_TO_GET_MESSAGES:"Failed to get messages",DD_MM_YYYY:"DD/MM/YYYY",ACTIVE_ION_POPOVER_VIEW:".active ion-popover-view",SHARED_LABEL_DONE:"shared.label.done",TAB_ITEM_ACTIVE:"tab-item-active",EXTERNAL_CONTENT:"External Content",STATIC_CONTENT:"Static Content",FEATURE_CONFIG_CYTRIC_ENABLED:"featureConfig.cytric.enabled",ICON_MORE_DOTS:"icon-more-dots",TRAVELDOC_BUTTON_OK_BUTTON:"travelDoc.button.okBtn",TRAVELDOC_ERROR_DOC_DUPLICATE_FILE:"travelDoc.error.docDuplicateFile",ERROR_AFTER_CREATING_DIRECTORY:"Error : Unkonwn error after creating directory",FAILED_TO_RESOLVE_SOURCE_FILE:"Failed to Resolve source file path"},window.coreUiModule=angular.module("CoreUiModule",["ionic","CoreModule","$actionButton","ionic-datepicker","ionic-timepicker"]),window.coreUiModule.config(["$translatePartialLoaderProvider","$translateProvider",function(e,t){e.addPart("core-ui")}]),window.coreUiModule.run(["$log","LoggingService",function(e,t){e=e.getInstance("CoreUi"),e.info("Module started")}]),coreUiModule.directive("focusMe",["$timeout","$parse",function(e,t){return{link:function(n,o,i){var r=t(i.focusMe);n.$watch(r,function(t){t===!0&&e(function(){o[0].focus()})})}}}]),coreUiModule.directive("enabledIf",["$animate","$compile","$rootScope",function(e,t,n){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(o,i,r,a,s){function c(n){isDefined(n)&&isFeatureEnabled(n)?u||s(function(n,o){u=o,n[n.length++]=t.$$createComment("end ngIf",r.ngIf),l={clone:n},e.enter(n,i.parent(),i)}):(d&&(d.remove(),d=null),u&&(u.$destroy(),u=null),l&&(d=getBlockNodes(l.clone),e.leave(d).done(function(e){e!==!1&&(d=null)}),l=null))}var l,u,d;o.$watch(r.enabledIf,c),n.$on("paramsUpdates",function(e,t){c(r.enabledIf)})}}}]),coreUiModule.directive("cmtTextArea",["I18nService",function(e){return{restrict:"E",templateUrl:"core-ui/directives/CmtTextAreaDirective.html",require:["^form"],controller:["$scope",function(e){}],scope:{"class":"@",label:"@",placeholder:"@",name:"@",readonly:"=",minlength:"@",maxlength:"@",rows:"@",charsCounter:"=",requiredTranslation:"@",minLengthTranslation:"@",maxLengthTranslation:"@",data:"=",onBlur:"&",onFocus:"&"},compile:function(e,t){var n=e.find("textarea")[0],o=e.find("label")[0],i=(new Date).getTime()+"_"+Math.floor(1e3*Math.random());return n.id=i,o.htmlFor=i,this.link},link:function(t,n,o,i){t.form=i[0],void 0===t.requiredTranslation&&e.translate("coreUi.error.mandatory").then(function(e){t.requiredTranslation=e}),void 0===t.minLengthTranslation&&e.translate("coreUi.error.minLength").then(function(e){t.minLengthTranslation=e}),void 0===t.maxLengthTranslation&&e.translate("coreUi.error.maxLength").then(function(e){t.maxLengthTranslation=e}),t.validateMaxLength=function(){isDefined(t.maxlength)&&t.data&&t.data.length>t.maxlength&&(t.data=t.data.substr(0,t.maxlength))},t.required=isDefined(o.required)},toString:function(){return"cmtTextArea"}}}]),coreUiModule.directive("cmtInputText",["I18nService","I18nConfig","NAME_REGEX","PNR_REGEX","FLIGHT_NUMBER_REGEX","CONFIRMATION_NUMBER_REGEX",function(e,t,n,o,i,r){return{restrict:"E",templateUrl:"core-ui/directives/CmtInputTextDirective.html",require:["^form"],scope:{"class":"@",label:"@",placeholder:"@",name:"@",type:"@",readonly:"=",minlength:"@",maxlength:"@",usePattern:"@",requiredTranslation:"@",minLengthTranslation:"@",maxLengthTranslation:"@",usePatternTranslation:"@",data:"=",onBlur:"&",onFocus:"&",autoComplete:"@",allowMaskedValues:"="},compile:function(e,t){var n=e.find("input")[0],o=e.find("label")[0],i=(new Date).getTime()+"_"+Math.floor(1e3*Math.random());return n.id=i,o.htmlFor=i,this.link},link:function(t,a,s,c){if(t.form=c[0],t.type=isDefined(t.type)?t.type:"text",t.autoComplete=isDefined(t.autoComplete)?t.autoComplete:"on",void 0===t.requiredTranslation&&e.translate("coreUi.error.mandatory").then(function(e){t.requiredTranslation=e}),void 0===t.minLengthTranslation&&e.translate("coreUi.error.minLength").then(function(e){
t.minLengthTranslation=e}),void 0===t.maxLengthTranslation&&e.translate("coreUi.error.maxLength").then(function(e){t.maxLengthTranslation=e}),void 0!==t.usePattern){var l="coreUi.error.pattern";switch(t.usePattern){case"firstName":case"lastName":t.pattern=n,l="coreUi.error.invalidName";break;case"PNR":t.pattern=o,l="coreUi.error.invalidPNR",t.autoComplete="off";break;case"flightNumber":t.pattern=i,l="coreUi.error.invalidFlightNumber";break;case"confirmationNumber":t.pattern=r,l="coreUi.error.invalidConfirmationNumber";break;default:t.pattern=void 0}void 0!==t.pattern&&void 0===t.usePatternTranslation&&e.translate(l).then(function(e){t.usePatternTranslation=e})}t.required=isDefined(s.required),t.allowMaskedValues&&(t.pattern="")},toString:function(){return"cmtInputText"}}}]),coreUiModule.directive("cmtInputDate",["I18nService","ionicDatePicker","$filter",function(e,t,n){return{restrict:"E",templateUrl:"core-ui/directives/CmtInputDateDirective.html",require:["^form"],scope:{"class":"@",label:"@",name:"@",requiredTranslation:"@",from:"=",to:"=",data:"="},compile:function(e,t){var n=e.find("input")[0],o=e.find("label")[0],i=(new Date).getTime()+"_"+Math.floor(1e3*Math.random());return n.id=i,o.htmlFor=i,this.link},link:function(o,i,r,a){o.form=a[0],o.readonly=getContext("isWebDesktop",!1),o.openPicker=function(){if(getContext("isWebDesktop")){var e=moment.localeData(),i=e.months(),r=e.weekdaysMin(),a=moment(o.data),s={callback:function(e){o.data=new Date(e)},titleLabel:a.format("DD MMM YYYY"),weeksList:r,monthsList:i,setLabel:n("translate")("core.button.ok"),closeLabel:n("translate")("core.button.cancel"),from:isDefined(o.from)?o.from:null,to:isDefined(o.to)?o.to:null,inputDate:o.data,mondayFirst:!0};t.openDatePicker(s)}},void 0===o.requiredTranslation&&e.translate("coreUi.error.mandatory").then(function(e){o.requiredTranslation=e}),o.required=isDefined(r.required)},toString:function(){return"cmtInputDate"}}}]),coreUiModule.directive("cmtInputTime",["I18nService","ionicTimePicker","$filter",function(e,t,n){return{restrict:"E",templateUrl:"core-ui/directives/CmtInputTimeDirective.html",require:["^form"],scope:{"class":"@",label:"@",name:"@",requiredTranslation:"@",data:"="},compile:function(e,t){var n=e.find("input")[0],o=e.find("label")[0],i=(new Date).getTime()+"_"+Math.floor(1e3*Math.random());return n.id=i,o.htmlFor=i,this.link},link:function(o,i,r,a){o.form=a[0],o.readonly=getContext("isWebDesktop",!1),o._convertDateToEpochTime=function(e){return 60*e.getHours()*60+60*e.getMinutes()},o._convertEpochTimeToDate=function(e){var t=new Date(1e3*e),n=60*t.getUTCHours()*60+60*t.getUTCMinutes()+60*t.getTimezoneOffset();return new Date(1e3*n+864e5)},o.openPicker=function(){if(getContext("isWebDesktop")){var e=moment(o.data),i={callback:function(e){o.data=o._convertEpochTimeToDate(e)},titleLabel:e.format("HH:mm"),setLabel:n("translate")("core.button.ok"),closeLabel:n("translate")("core.button.cancel"),inputTime:o._convertDateToEpochTime(o.data),format:24,step:5};t.openTimePicker(i)}},void 0===o.requiredTranslation&&e.translate("coreUi.error.mandatory").then(function(e){o.requiredTranslation=e}),o.required=isDefined(r.required)},toString:function(){return"cmtInputTime"}}}]),coreUiModule.directive("inputTimeFormat",["$filter",function(e){return{restrict:"A",require:"ngModel",link:function(e,t,n,o){getContext("isWebDesktop")&&o.$formatters.unshift(function(e){return e.replace(":00.000","")})}}}]),coreUiModule.directive("cmtInputEmail",["I18nService","EMAIL_REGEX",function(e,t){return{restrict:"E",templateUrl:"core-ui/directives/CmtInputEmailDirective.html",require:["^form"],controller:["$scope",function(e){}],scope:{"class":"@",label:"@",placeholder:"@",name:"@",requiredTranslation:"@",invalidEmailTranslation:"@",modelContainer:"=",modelKey:"=",allowMaskedValues:"="},compile:function(e,t){var n=e.find("input")[0],o=e.find("label")[0],i=(new Date).getTime()+"_"+Math.floor(1e3*Math.random());return n.id=i,o.htmlFor=i,this.link},link:function(n,o,i,r){n.form=r[0],n.allowMaskedValues?n.emailRegex="":n.emailRegex=t,isDefined(r[0].emailInput)&&isDefined(r[0].emailInput.$validators)&&(r[0].emailInput.$validators.email=function(){return!0}),void 0===n.requiredTranslation&&e.translate("coreUi.error.mandatory").then(function(e){n.requiredTranslation=e}),void 0===n.invalidEmailTranslation&&e.translate("coreUi.error.invalidEmail").then(function(e){n.invalidEmailTranslation=e}),n.required=void 0!==i.required,n.readonly=n.$eval(i.readonly)||n.allowMaskedValues},toString:function(){return"cmtInputEmail"}}}]),coreUiModule.directive("cmtInputPhone",["$rootScope","$log","GloballistProcessor","$ionicModal","LayoutService","I18nService","I18nConfig",function(e,t,n,o,i,r,a){return t=t.getInstance("cmtInputPhone"),{restrict:"E",templateUrl:"core-ui/directives/CmtInputPhoneDirective.html",require:["^form"],controller:["$scope",function(e){}],scope:{"class":"@",label:"@",placeholder:"@",name:"@",readonly:"=",requiredTranslation:"@",invalidPhoneTranslation:"@",phoneNumberModel:"=",phoneCodeModel:"="},compile:function(e,t){var n=e.find("input")[0],o=e.find("label")[0],i=(new Date).getTime()+"_"+Math.floor(1e3*Math.random());return n.id=i,o.htmlFor=i,this.link},link:function(a,s,c,l){a.phoneData={_phoneCountryCodesList:[]},a._reloadFlagDependingOnPhoneCode=function(){};var u=n.getCallingCountryCodeByCountry();u.then(function(e){a.phoneData._phoneCountryCodesList=e,isDefined(a.phoneCodeModel)&&""!==a.phoneCodeModel?a._reloadFlagDependingOnPhoneCode():r.getDeviceLocaleCountryCodeFromPlugin().then(function(t){for(var n=0;n<e.length;n++)if(e[n].countryCode===t){a.phoneCodeModel=e[n].phoneCode;break}}),a.$watch("phoneCodeModel",function(e,t){a._reloadFlagDependingOnPhoneCode()})},function(e,n){t.error("Can't get the GlobalList:"+e+" Reason:"+JSON.stringify(n))}),a.form=l[0],void 0===a.requiredTranslation&&r.translate("coreUi.error.mandatory").then(function(e){a.requiredTranslation=e}),void 0===a.invalidPhoneTranslation&&r.translate("coreUi.error.invalidPhoneNumber").then(function(e){a.invalidPhoneTranslation=e}),a.chooseCountry=function(){a.readonly||o.fromTemplateUrl("selectcountry-modal.html",{scope:a,animation:"slide-in-up",focusFirstInput:!1}).then(function(e){a.modal=e,i.showModal(a.modal)})},a.closeModal=function(e){e&&(a.phoneCodeModel=e.phoneCode),i.removeModal(a.modal)},a.allowOnlyNumbers=function(e){isDefined(e)&&(a.phoneNumberModel=e.replace(/\D/g,""))},a.closeicon=e.closeicon,a.required=/^true$/i.test(c.required)},toString:function(){return"cmtInputPhone"}}}]),coreUiModule.directive("cmtInputPassword",["I18nService","PASSWORD_REGEX","LayoutService","$timeout",function(e,t,n,o){return{restrict:"E",templateUrl:"core-ui/directives/CmtInputPasswordDirective.html",require:["^form"],controller:["$scope",function(e){}],scope:{"class":"@",label:"@",name:"@",requiredTranslation:"@",invalidPasswordTranslation:"@",data:"="},compile:function(e,t){var n=e.find("input")[0],o=e.find("label")[0],i=(new Date).getTime()+"_"+Math.floor(1e3*Math.random());return n.id=i,o.htmlFor=i,this.link},link:function(i,r,a,s){i.form=s[0],i.keepFocusOnInput=!1,void 0===i.requiredTranslation&&e.translate("coreUi.error.mandatory").then(function(e){i.requiredTranslation=e}),void 0===a.novalidate&&void 0===i.invalidPasswordTranslation&&e.translate("coreUi.error.invalidPassword").then(function(e){i.invalidPasswordTranslation=e}),void 0!==a.required?i.required=!0:i.required=!1;var c=getContext("featureConfig.registration.passwordRegExpression","");void 0!==a.novalidate?i.pattern=void 0:null!==c&&""!==c?i.pattern=c:i.pattern=t,i.toggle=function(){var e=r.find("input")[0],t=r.find("i")[0];document.activeElement===e&&(i.keepFocusOnInput=!0),"password"===e.type?(e.type="text",n.addCssClass(t,"show-password")):(e.type="password",n.removeCssClass(t,"show-password"))},i.onInputBlur=function(e){isDefined(e.srcElement)&&i.keepFocusOnInput&&(e.srcElement.focus(),o(function(){e.srcElement.focus()})),i.keepFocusOnInput=!1}},toString:function(){return"cmtInputPassword"}}}]),coreUiModule.directive("cmtSelect",["I18nService",function(e){return{restrict:"E",templateUrl:"core-ui/directives/CmtSelectDirective.html",require:["^form"],controller:["$scope",function(e){}],scope:{"class":"@",wrapClass:"@",label:"@",name:"@",requiredTranslation:"@",placeholder:"@",options:"&",data:"="},compile:function(e,t){var n=e.find("select")[0],o=e.find("label")[0],i=(new Date).getTime()+"_"+Math.floor(1e3*Math.random());return n.id=i,o.htmlFor=i,t.wrapClass=t.wrapClass||"input-wrap",this.link},link:function(t,n,o,i){t.form=i[0],void 0===t.requiredTranslation&&e.translate("coreUi.error.mandatory").then(function(e){t.requiredTranslation=e}),void 0!==o.required?t.required=!0:t.required=!1},toString:function(){return"cmtSelect"}}}]),coreUiModule.directive("cmtMenu",["$rootScope","$log","MenuService","$ionicActionSheet","$timeout","$ionicTabsDelegate","$actionButton","$ionicPopover","I18nService","$window","PostMessageService",function(e,t,n,o,i,r,a,s,c,l,u){t=t.getInstance("cmtMenu");var d={restrict:"E",templateUrl:"core-ui/directives/CmtMenuDirective.html",scope:{list:"=",context:"=",isHeaderMenu:"<",menuStyle:"<",showLabel:"<"},MATERIAL_DESIGN:"material-design",ACTION_SHEET:"action-sheet",destructiveItem:void 0,hideSheet:null,_popover:void 0,actionSheet:function(t,n,i,r){isUndefined(d.hideSheet)&&c.translate("coreUi.button.cancel").then(function(t){var a={name:"cancel",label:t,action:function(){d.hideSheet=null,e.$emit("MultiMenuCancelEvent")}};d.destructiveItem=r,i=i.map(function(e){return e.text='<i id="menu-'+e.name+'" class="space-rt icon '+e.icon+'"></i> '+e.label,e}),isDefined(d.destructiveItem)&&(d.destructiveItem.text='<i id="menu-'+r.name+'" class="space-rt icon '+r.icon+'"></i> '+r.label),d.hideSheet=o.show({destructiveText:isDefined(d.destructiveItem)?d.destructiveItem.text:null,destructiveButtonClicked:isDefined(d.destructiveItem)?d.callDestructive:null,cancelText:isDefined(a)?a.label:null,cancel:isDefined(a)?a.action:null,buttons:i,buttonClicked:function(e){return d.hideSheet(),d.hideSheet=null,isDefined(i[e].action)&&i[e].action(n),!0}})})},callDestructive:function(){isDefined(d.hideSheet)&&(d.hideSheet(),d.hideSheet=null),d.destructiveItem.action()},openPopOver:function(t,n,o,i){isDefined(i)&&o.push(i);var r=e.$new();r.listItem=o;var a=57;r.contentStyle={height:o.length*a+"px"},s.fromTemplateUrl("menuPopOver.html",{scope:r}).then(function(e){d._popover=e,r.popoverItemClicked=function(e,n){n.isIonicTap&&d.popoverItemClickedHandler(e,n,t.context)},r.$on("popover.shown",function(e,t){t.el.classList.add("menu")}),r.$on("popover.hidden",function(){d._popover.remove()}),d._popover.show(d.getCompliantTarget(n))})},getCompliantTarget:function(e){var t=e.currentTarget||e.target,n=16;return t.getBoundingClientRect=function(){return{width:t.offsetWidth,height:t.offsetHeight,top:t.offsetTop+n+document.getElementById("mainContainer").offsetTop-(isDefined(l.scrollY)?l.scrollY:l.pageYOffset),left:document.body.clientWidth/2-document.getElementById("mainContainer").offsetWidth/2+t.offsetLeft+t.offsetWidth/2-document.getElementsByTagName("ion-popover-view")[0].offsetWidth/2}},t},popoverItemClickedHandler:function(e,t,n){d._popover.hide().then(function(){isDefined(e.action)&&e.action(t)})},handleClick:function(t){var n=d.getItems(t.scope),o=n.listItem,i=n.destructiveItem;if(o.length>1||o.length>0&&isDefined(i)){e.$emit("MultiMenuOpenEvent");var r=d.determineMenuStyle(t.scope);r===d.ACTION_SHEET?d.actionSheet(t.scope,t.event,o,i):d.openPopOver(t.scope,t.event,o,i)}else{var a=isDefined(o[0])?o[0]:i;isDefined(a.action)&&a.action(t.event)}},getItems:function(e){var t=isDefined(e.list)?e.list:[];return{destructiveItem:n.getDestructiveItem(e.context,t),listItem:n.listItem(e.context,t,!1)}},displayMainButton:function(e){var t=d.getItems(e),n=t.listItem.length;isDefined(t.destructiveItem)&&n++;var o=n>1;if(e.show=!1,n>0){var i=d.determineMenuStyle(e);i===d.MATERIAL_DESIGN?d.showAsFloatingButton(e,o,t.listItem,t.destructiveItem,i):d.showAsStaticButton(e,o,t.listItem,t.destructiveItem,i)}},isMaterialDesignSupported:function(){return ionic.Platform.isAndroid()&&ionic.Platform.version()>4.4||isDesktop()},showAsStaticButton:function(e,t,n,o,r){e.show=!0,e.handleClick=function(t){i(function(){d.handleClick({scope:e,event:t})},300),t.stopPropagation()};var a=d.getMainItem(n,o,r);e.icon=a.icon,e.label=a.label,u.send({type:"navBarButtonChangeEvent",buttonType:e.icon.replace("icon-",""),buttonID:0}),u.when("navBarButtonTapEvent").then(function(t){!isDefined(t)||0!==t&&0!==t.buttonID||d.handleClick({scope:e,event:null})})},showAsFloatingButton:function(e,t,n,o,i){e.show=!1;var s=d.getMainItem(n,o,i),c={hasTab:r.showBar(),removeOnStateChange:!0,mainAction:{icon:s.icon,label:s.label,id:"menu-main",closeIcon:"ion-android-close",onClick:void 0},buttons:void 0};if(t){c.buttons=[],o&&n.push(o);for(var l=0;l<n.length;l++){var u=n[l];c.buttons.push({icon:u.icon,label:u.label,id:"menu-"+u.name,destructive:u.isDestructive,onClick:function(e,t){isDefined(n[t])&&isDefined(n[t].action)&&e.isIonicTap&&n[t].action(e)}})}}else c.mainAction.onClick=function(e){e.isIonicTap&&s.action(e)};d.$actionButton&&d.$actionButton.hide(),d.$actionButton=a.create(c)},getMainItem:function(e,t,n){return e.length>1||1===e.length&&isDefined(t)?n===d.MATERIAL_DESIGN?{icon:"ion-plus"}:{icon:"icon-plus"}:isDefined(t)?t:e[0]},determineMenuStyle:function(e){return isUndefined(e.menuStyle)||e.menuStyle===d.MATERIAL_DESIGN&&!d.isMaterialDesignSupported()?d.ACTION_SHEET:e.menuStyle},link:function(e,t,n){e.$watch("context",function(t,n){d.displayMainButton(e)});var o=e.$on("$stateChangeStart",function(){var t=d.determineMenuStyle(e);t===d.ACTION_SHEET&&u.send({type:"navBarButtonChangeEvent",buttonType:null,buttonID:0}),o()})}};return d}]),coreUiModule.directive("dateRange",["$timeout","DateTimeService",function(e,t){return{restrict:"AE",scope:{dateRangeStart:"=",dateRangeEnd:"="},require:"ngModel",link:function(n,o,i,r){var a=n.$eval(i.defaultStartDate),s=n.$eval(i.defaultEndDate),c=i.validityKey,l=i.datesOffsetUnit,u=parseInt(i.datesOffsetValue,10);n._calculateNewValidDateAndTime=function(e,t,o){var i=n._createTimeFromDate(e.date,e.time);switch(o){case"h":i.setHours(i.getHours()+t);break;case"d":i.setDate(i.getDate()+t)}return i},n._createTimeFromDate=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes(),t.getSeconds())};var d,f=isDesktop()?100:700;n.$watch("dateRangeStart",function(o,i){e.cancel(d),e.cancel(g),d=e(function(){n.dateRangeStart.date=n.dateRangeStart.date||a,n.dateRangeStart.time=n.dateRangeStart.time||a;var e=t.isValidDatesRange(n.dateRangeStart,n.dateRangeEnd);if(r.$setValidity(c,e),!e){var o=n._calculateNewValidDateAndTime(n.dateRangeStart,u,l);n.dateRangeEnd.date=o,n.dateRangeEnd.time=o}},f)},!0);var g;n.$watch("dateRangeEnd",function(o,i){e.cancel(d),e.cancel(g),g=e(function(){n.dateRangeEnd.date=n.dateRangeEnd.date||s,n.dateRangeEnd.time=n.dateRangeEnd.time||s;var e=t.isValidDatesRange(n.dateRangeStart,n.dateRangeEnd);if(r.$setValidity(c,e),!e){var o=n._calculateNewValidDateAndTime(n.dateRangeEnd,-u,l);n.dateRangeStart.date=o,n.dateRangeStart.time=o}},f)},!0)}}}]),coreUiModule.directive("googlePlace",["GooglePlaceService","$log","LayoutService","$ionicModal","$rootScope","OrchestratorChiefService",function(e,t,n,o,i,r){t=t.getInstance("googlePlace"),t.info("Directive Started...");var a={restrict:"E",templateUrl:"core-ui/directives/GooglePlaceDirective.html",require:["^form"],scope:{"class":"@",label:"@",id:"@",title:"@",name:"@",required:"@",readonly:"@",location:"="},updateLocation:function(e){if(isDefined(e.location)&&isDefined(e.location.amadeusLocation)){var t=e.location.amadeusLocation,n=[e.location.Name,t.addressLine1,t.cityName,t.countryName];n=n.filter(function(e){return isDefined(e)&&""!==e.trim()}),e.googlePlacesAutocompleteSelectedName=e.location.Name,e.googlePlacesAutocompleteSelectedDescription=n.join(", "),e.amadeusLocation=e.location.amadeusLocation}},controller:["$scope",function(s){s.closeicon=i.closeicon,s.forms={},a.updateLocation(s),s.showModalPlace=function(){n.startLoading(),e.loadGooglePlacesJsApi().then(function(){o.fromTemplateUrl("GooglePlacesModalView.html",{scope:s,animation:"slide-in-up",focusFirstInput:!0}).then(function(e){n.stopLoading(),s.googlePlacesModal=e,n.showModal(s.googlePlacesModal).then(function(){t.info("modal displayed")}),r.registerNavigateBackFromModal()})},function(e){n.stopLoading(),t.error(e),n.toastError("core.backendErrorCodes.000000")})},s.closeGooglePlacesModal=function(){safeAccess(s,"googlePlacesModal")&&(n.removeModal(s.googlePlacesModal),s.googlePlacesModal=null,r.unregisterNavigateBackFromModal())},s.onSelectionChanged=function(t){s.location={name:t.name,utc_offset:t.details.utc_offset,amadeusLocation:e.convertGooglePlacesDataModelToAmadeusMdwLocationObject(t.details)},s.googlePlacesAutocompleteSelectedDescription=t.description,s.closeGooglePlacesModal()},s.$watch("location",function(e,t){e!==t&&a.updateLocation(s)})}],link:function(e,t,n,o){e.form=o[0]},toString:function(){return"googlePlace"}};return a}]),coreUiModule.directive("lazyScroll",["$rootScope",function(e){return{restrict:"A",link:function(t,n){var o=t.$onScroll;t.$onScroll=function(){e.$broadcast("lazyScrollEvent"),"function"==typeof o&&o()}}}}]).directive("imageLazySrc",["$document","$timeout","$ionicScrollDelegate","$compile",function(e,t,n,o){return{restrict:"A",scope:{lazyScrollResize:"@lazyScrollResize",imageLazyBackgroundImage:"@imageLazyBackgroundImage",imageLazySrc:"@",imageLazyLoadIfHidden:"="},link:function(i,r,a){function s(){"true"!==i.imageLazyBackgroundImage&&r.addClass("ng-hide"),u(),a.imageLazyLoader&&(d=o('<div class="image-loader-container"><ion-spinner class="image-loader" icon="'+a.imageLazyLoader+'"></ion-spinner></div>')(i),r.after(d));var e=i.$on("lazyScrollEvent",function(){l()&&(c(),e())});t(function(){l()&&(c(),e())},300)}function c(){if(r.on("load",function(e){"true"!==i.imageLazyBackgroundImage&&r.removeClass("ng-hide"),u(),"true"===i.lazyScrollResize&&n.resize(),r.off("load")}),r.on("error",function(e){if(u(),a.imageLazyErrorText&&!i.hasDisplayedError){i.hasDisplayedError=!0;var t=o("<p>"+a.imageLazyErrorText+"</p>")(i);r.after(t)}r.off("error")}),"true"===i.imageLazyBackgroundImage){var e=new Image;e.onload=function(){a.imageLazyLoader&&d.remove(),r[0].style.backgroundImage="url("+a.imageLazySrc+")","true"===i.lazyScrollResize&&n.resize()},e.src=a.imageLazySrc}else r[0].src=a.imageLazySrc}function l(){if(i.imageLazyLoadIfHidden)return!0;var t=e[0].documentElement.clientHeight,n=e[0].documentElement.clientWidth,o=r[0].getBoundingClientRect();return o.top>=0&&o.top<=t+parseInt(a.imageLazyDistanceFromBottomToLoad,10)&&o.left>=0&&o.left<=n+parseInt(a.imageLazyDistanceFromRightToLoad,10)}function u(){a.imageLazyLoader&&d&&d.remove()}i.hasDisplayedError=!1;var d;a.imageLazyDistanceFromBottomToLoad||(a.imageLazyDistanceFromBottomToLoad=0),a.imageLazyDistanceFromRightToLoad||(a.imageLazyDistanceFromRightToLoad=0),i.$watch("imageLazySrc",function(e,t){t!==e&&s()}),s()}}}]),coreUiModule.run(["$templateCache",function(e){e.put("core-ui/directives/CmtInputDateDirective.html",'<script debug-file-path="CmtInputDateDirective.html" id="CmtInputDateDirective_Errors.html" type="text/ng-template"><span ng-show="form.$submitted && form.{{name}}Input.$error.required" class="validation ng-hide">{{requiredTranslation}}</span></script><div class="{{class}}"><label for="__generatedid__" ng-bind-html="label | nonBreaking" ng-show="label"></label> <span class="input-wrap"><input id="__generatedid__" name="{{name}}Input" ng-click="openPicker()" ng-model="data" ng-readonly="readonly" ng-required="required" type="date"><ng-include src="&apos;CmtInputDateDirective_Errors.html&apos;"></ng-include></span></div>'),e.put("core-ui/directives/CmtInputEmailDirective.html",'<div class="{{class}}" debug-file-path="CmtInputEmailDirective.html"><label for="__generatedid__" ng-bind-html="label | nonBreaking" ng-show="label"></label> <span class="input-wrap"><input autocomplete="off" id="__generatedid__" name="{{name}}Input" ng-class="{&apos;color-lowContrast&apos;: readonly}" ng-model="modelContainer[modelKey]" ng-pattern="emailRegex" ng-readonly="readonly" ng-required="required" placeholder="{{placeholder}}" type="email"> <span class="ng-hide validation" ng-show="form.$submitted &amp;&amp; form.{{name}}Input.$error.required">{{requiredTranslation}}</span> <span class="ng-hide validation" ng-show="form.$submitted &amp;&amp; form.{{name}}Input.$error.pattern">{{invalidEmailTranslation}}</span></span></div>'),e.put("core-ui/directives/CmtInputPasswordDirective.html",'<div class="{{class}}" debug-file-path="CmtInputPasswordDirective.html"><label for="__generatedid__" ng-bind-html="label | nonBreaking" ng-show="label"></label> <span class="input-wrap input-wrap-with-icon"><input autocomplete="off" id="__generatedid__" name="{{name}}Input" ng-blur="onInputBlur($event)" ng-model="data" ng-pattern="pattern" ng-required="required" type="password"> <i class="icon-password" ng-click="toggle()"></i> <span class="ng-hide validation" ng-show="form.$submitted &amp;&amp; form.{{name}}Input.$error.required">{{requiredTranslation}}</span> <span class="ng-hide validation" ng-show="form.$submitted &amp;&amp; form.{{name}}Input.$error.pattern">{{invalidPasswordTranslation}}</span></span></div>'),e.put("core-ui/directives/CmtInputPhoneDirective.html",'<div class="{{class}}" debug-file-path="CmtInputPhoneDirective.html"><label for="__generatedid__" ng-bind-html="label | nonBreaking" ng-show="label"></label> <span class="input-wrap"><div class="phone-country-and-number"><div class="phone-country-choice-wrapper"><span class="phone-country-choice" id="countryChoice" ng-class="{&apos;color-lowContrast&apos;: readonly}" ng-click="chooseCountry()">{{phoneCodeModel}}</span></div><input class="phone-number-input" id="__generatedid__" name="{{name}}" ng-change="allowOnlyNumbers(phoneNumberModel)" ng-class="{&apos;color-lowContrast&apos;: readonly}" ng-model="phoneNumberModel" ng-readonly="readonly" ng-required="required" placeholder="{{placeholder}}" style="width:calc(100% - 4.5em)" type="tel"></div><span class="ng-hide validation" ng-show="form.$submitted &amp;&amp; form.{{name}}.$error.required">{{requiredTranslation}}</span> <span class="ng-hide validation" ng-show="form.$submitted &amp;&amp; form.{{name}}.$error.phoneNumber">{{invalidPhoneTranslation}}</span></span><script id="selectcountry-modal.html" type="text/ng-template"><ion-modal-view>\n              <ion-header-bar class="bar-stable">\n                  <h1 class="title" translate>coreUi.phoneinput.title.selectphonecountry</h1>\n                  <span class="button icon button-clear {{::closeicon}}" ng-click="closeModal()"></span>\n              </ion-header-bar>\n              <ion-content>\n                  <ul class="list">\n                      <li ng-click="closeModal(phoneCountryCode)" class="item"\n                          ng-repeat="phoneCountryCode in phoneData._phoneCountryCodesList">\n                          {{phoneCountryCode.country}}\n                      </li>\n                  </ul>\n              </ion-content>\n          </ion-modal-view></script></div>'),e.put("core-ui/directives/CmtInputTextDirective.html",'<script debug-file-path="CmtInputTextDirective.html" id="CmtInputTextDirective_Errors.html" type="text/ng-template"><span ng-show="form.$submitted && form.{{name}}Input.$error.required" class="validation ng-hide">{{requiredTranslation}}</span>\n  <span ng-show="form.$submitted && form.{{name}}Input.$error.minlength" class="validation ng-hide">{{minLengthTranslation}}</span>\n  <span ng-show="form.$submitted && form.{{name}}Input.$error.maxlength" class="validation ng-hide">{{maxLengthTranslation}}</span>\n  <span ng-show="form.$submitted && form.{{name}}Input.$error.pattern" class="validation ng-hide">{{usePatternTranslation}}</span></script><div class="{{class}}"><label for="__generatedid__" ng-bind-html="label | nonBreaking" ng-if="label"></label> <span class="input-wrap"><input autocomplete="{{autoComplete}}" id="__generatedid__" name="{{name}}Input" ng-blur="onBlur($event);" ng-class="{&apos;color-lowContrast&apos;: readonly}" ng-focus="onFocus($event);" ng-maxlength="{{maxlength}}" ng-minlength="{{minlength}}" ng-model="data" ng-pattern="pattern" ng-readonly="readonly" ng-required="required" placeholder="{{placeholder}}" type="{{type}}"><ng-include src="&apos;CmtInputTextDirective_Errors.html&apos;"></ng-include></span></div>'),e.put("core-ui/directives/CmtInputTimeDirective.html",'<script debug-file-path="CmtInputTimeDirective.html" id="CmtInputTimeDirective_Errors.html" type="text/ng-template"><span ng-show="form.$submitted && form.{{name}}Input.$error.required" class="validation ng-hide">{{requiredTranslation}}</span></script><div class="{{class}}"><label for="__generatedid__" ng-bind-html="label | nonBreaking" ng-show="label"></label> <span class="input-wrap"><input id="__generatedid__" input-time-format name="{{name}}Input" ng-click="openPicker()" ng-model="data" ng-readonly="readonly" ng-required="required" type="time"><ng-include src="&apos;CmtInputTimeDirective_Errors.html&apos;"></ng-include></span></div>'),e.put("core-ui/directives/CmtMenuDirective.html",'<script debug-file-path="CmtMenuDirective.html" id="menuPopOver.html" type="text/ng-template"><ion-popover-view ng-style="contentStyle">\n    <ion-content>\n      <ion-list show-delete="false"\n                show-reorder="false"\n                can-swipe="false">\n        <ion-item ng-repeat="item in listItem" ng-click="popoverItemClicked(item,$event)">\n          <i ng-attr-id="{{\'menu-\' + item.name}}" class="icon space-rt" ng-class="item.icon"></i> {{item.label|translate}}\n        </ion-item>\n      </ion-list>\n    </ion-content>\n  </ion-popover-view></script><button class="icon {{icon}}" id="menu-main" ng-class="{&apos;btn-inverse&apos;: !isHeaderMenu, &apos;button button-clear&apos;: isHeaderMenu}" ng-click="handleClick($event)" ng-if="show" stop-propagation>{{showLabel?label:&apos;&apos;}}</button>'),e.put("core-ui/directives/CmtSelectDirective.html",'<div class="{{class}}" debug-file-path="CmtSelectDirective.html"><label for="__generatedid__" ng-bind-html="label | nonBreaking" ng-show="label"></label> <span class="{{wrapClass}}"><select id="__generatedid__" name="{{name}}" ng-model="data" ng-required="required"><option value ng-show="placeholder">{{placeholder}}</option><option value="{{option.value}}" ng-repeat="option in options()" ng-selected="option.value == data">{{option.text}}</option></select> <i class="icon-select"></i> <span class="ng-hide validation" ng-show="form.$submitted &amp;&amp; form.{{name}}.$error.required">{{requiredTranslation}}</span></span></div>'),e.put("core-ui/directives/CmtTextAreaDirective.html",'<div class="{{class}}" debug-file-path="CmtTextAreaDirective.html"><label for="__generatedid__" ng-bind-html="label | nonBreaking" ng-show="label"></label> <span class="input-wrap"><textarea id="__generatedid__" name="{{name}}" ng-blur="onBlur($event);" ng-change="validateMaxLength();" ng-class="{&apos;color-lowContrast&apos;: readonly}" ng-focus="onFocus($event);" ng-model="data" ng-readonly="readonly" ng-required="required" placeholder="{{placeholder}}" rows="{{rows}}"></textarea> <span class="ng-hide validation" ng-show="form.$submitted &amp;&amp; form.{{name}}.$error.required">{{requiredTranslation}}</span> <span class="ng-hide validation" ng-show="form.$submitted &amp;&amp; form.{{name}}.$error.minlength">{{minLengthTranslation}}</span> <span class="ng-hide validation" ng-show="form.$submitted &amp;&amp; form.{{name}}.$error.maxlength">{{maxLengthTranslation}}</span> </span><span class="char-counter" ng-if="charsCounter">{{data.length || 0}} / {{maxlength}}</span></div>'),e.put("core-ui/directives/GooglePlaceDirective.html",'<script debug-file-path="GooglePlaceDirective.html" id="GooglePlacesModalView.html" type="text/ng-template"><ion-modal-view>\n    <ion-header-bar class="bar-stable">\n      <h1 class="title">{{title|translate}}</h1>\n      <span class="button icon button-clear {{::closeicon}}" ng-click="closeGooglePlacesModal()"></span>\n    </ion-header-bar>\n    <ion-content has-bouncing="false">\n      <form class="google-places-form etr-search-place" name="forms.googlePlacesForm" novalidate>\n        <ion-google-place-autocomplete placeholder="{{label | translate}}" ng-model="modalScope.googlePlacesAutocompleteUserEntry"\n          name="address" location-changed="onSelectionChanged" search-types="modalScope.googlePlacesSearchTypes" required/>\n      </form>\n    </ion-content>\n  </ion-modal-view></script><div class="etr-input not-really-disabled"><label for="{{id}}">{{label|translate}}</label><div class="etr-search-place" ng-click="showModalPlace(&apos;departure&apos;)"><span class="input-wrap input-wrap-with-icon vanilla"><input class="{{class}}" disabled="disabled" id="{{id}}" name="{{name}}" ng-model="googlePlacesAutocompleteSelectedDescription" readonly="readonly" required type="text"> <i class="icon-search-slim"></i> <span class="ng-hide validation" ng-show="form.$submitted &amp;&amp; form.{{name}}.$error.required" translate>coreUi.error.mandatory</span></span></div></div>')}]),window.analyticsModule=angular.module("AnalyticsModule",["ionic","CoreModule"]),window.analyticsModule.config(function(){}),window.analyticsModule.run(["$log",function(e){e=e.getInstance("Analytics"),e.info("Module started")}]),analyticsModule.service("AnalyticsService",["$exceptionHandler","$q","$log","$injector","DataManagerService","$timeout","$rootScope","AppLifeCycleService",function(e,t,n,o,i,r,a,s){n=n.getInstance("AnalyticsService"),n.info("Service Started...");var c={providers:[],options:{sendTime:!1,registerOnException:!1,pauseResumeEvent:!1},user:null,defaultParameters:[],pauseDuration:0,APPLICATION_PAUSE_DATE_KEY:"ANALYTICS_APPLICATION_PAUSE",FIRST_NAME:"First name",LAST_NAME:"Last name",USER_ID:"Referrer user ID",EMAIL:"Referrer user ID",FULL_NAME:"Full name",init:function(t){c.options=angular.extend(c.options,t),safeAccess(c.options,"registerOnException",!1)&&analyticsModule.factory("$exceptionHandler",function(){return function(t,n){c.runSafe(function(){this.sendException(t)}),e(t,n)}}),a.$on("userLoggedEvent",function(e,t){c.user=t}),a.$on("userLoggedOutEvent",function(){c.user=null}),c.options.pauseResumeEvent&&c.registerEvents()},getPropertiesFactory:function(e){return e=isDefined(e)?e:"",{_data_:[],_current_:{sensitive:!1},build:function(){return this._data_},flagMarketing:function(){return this._current_.isMarketing=!0,this},flagCLV:function(){return this._current_.isCLV=!0,this},flagSensitive:function(){return this._current_.sensitive=!0,this},setDimension:function(e){return this._current_.dimension=e,this},setMetric:function(e){return this._current_.metric=e,this},create:function(t,n){return this._current_=angular.merge({name:e+t,value:n},this._current_),this},push:function(){return this._data_.push(angular.copy(this._current_)),this._current_={sensitive:!1},this}}},runSafe:function(e){r(function(){try{e.apply(c)}catch(t){n.error(t.message,t)}},0)},setDefaultParameters:function(e){e.map(function(e){c.setDefaultParameter(e)})},setDefaultParameter:function(e){c.defaultParameters[e.name]=e},extendDefaultParameterWith:function(){var e=[];for(var t in c.defaultParameters)e.push(c.defaultParameters[t]);for(var n=0;n<arguments.length;n++)if(isDefined(arguments[n])){var o=angular.isArray(arguments[n])?arguments[n]:[arguments[n]];e=e.concat(o)}return function(t){return e.filter(function(e){return t.isTrusted?!0:!e.sensitive})}},registerEvents:function(){s.onAppPause(function(){var e=+moment();n.info("storing application pause date ["+e+"] in localstorage"),i.set(e,c.APPLICATION_PAUSE_DATE_KEY,{storage:i.LOCALSTORAGE
}),c.sendEvent("paused")}),s.onAppResume(function(){var e=i.get(c.APPLICATION_PAUSE_DATE_KEY,i.LOCALSTORAGE);isDefined(e)&&(c.pauseDuration=+moment()-e),c.sendEvent("resumed")})},register:function(e){return c.providers.push(e),this},getUserId:function(e){return isDefined(c.user)&&e?c.user.userId:"Anonymous"},_callAllProviders:function(e,t){c.providers.forEach(function(o){try{var i=[].slice.call(t);i=i.map(function(e){return angular.isFunction(e)?e(o):e}),i.push(c.getUserId(o.isTrusted)),o[e]?o[e].apply(o,i):n.warn(o+" is not implementing "+e)}catch(r){n.error(e+" fails calling on "+o,r)}})},setProperty:function(e,t,n){return c._callAllProviders("setProperty",[function(o){return o.isTrusted||!n?{name:e,value:t,sensitive:n}:{}}]),this},sendEvent:function(e,t,n){return c._callAllProviders("sendEvent",arguments),this},sendException:function(e){return c._callAllProviders("sendException",arguments),this},sendTime:function(e,t){return c._callAllProviders("sendTime",arguments),this},screenView:function(e,t,n){return this.runSafe(function(){var o;isUndefined(n)&&(n="Screen View"),o=[e,c.extendDefaultParameterWith(t),n],c._callAllProviders("screenView",o)}),this},promise:function(){return t.when(!0)},toString:function(){return"AnalyticsService"}};return c}]),analyticsModule.service("GoogleWebAnalyticsService",["$log","AnalyticsService","GAService",function(e,t,n){e=e.getInstance("GoogleWebAnalyticsService"),e.info("Service Started...");var o={SITE_CODE_DIMENSION:6,isTrusted:!1,init:function(){var e=getContext("featureConfig.analytics.googleAPIKeyWeb",getContext("featureConfig.analytics.google.APIKey"));!getContext("isMobileApp",!1)&&window.ga&&isDefined(e)&&(window.ga("create",{trackingId:e,cookieDomain:"auto"}),o.setContext(),t.register(o))},setProperty:function(e,t){if(isDefined(e)){e=angular.isArray(e)?e:[e];for(var n=0;n<e.length;n++)isDefined(e[n])&&window.ga("send",{hitType:"event",eventCategory:"User Property",eventAction:e[n].name,eventLabel:e[n].value})}},setContext:function(){window.ga("set","dimension"+o.SITE_CODE_DIMENSION,getContext("SITECODE","-")),window.ga("set","appVersion",getContext("versions.app")),window.ga("set","appName",getContext("appName"))},screenView:function(e,t,i){var r,a={};isDefined(t)&&(a=n.prepareParameters(t),r=o.getDimensionAndMetric(a)),window.ga("send","pageview",e,r)},sendEvent:function(e,t,i,r){var a,s={};isDefined(t)&&(s=n.prepareParameters(t),a=o.getDimensionAndMetric(s)),isDefined(a)?window.ga("send","event",i,e,a):window.ga("send","event",i,e,s.label,isFinite(s.value)?s.value:void 0)},getDimensionAndMetric:function(e){var t={},n=!1;return e.metrics.forEach(function(e){e.metric&&isFinite(e.value)&&(t["metric"+e.metric]=e.value,n=!0)}),e.dimensions.forEach(function(e){e.dimension&&(t["dimension"+e.dimension]=""+e.value,n=!0)}),n?t:null},sendException:function(e,t){window.ga("send","exception",{exDescription:e.message,exFatal:safeAccess(e,"isFatal",!0)})},sendTime:function(e,t,n){window.ga("send",{hitType:"timing",timingCategory:t,timingVar:"",timingValue:e})},toString:function(){return"GoogleWebAnalyticsService"}};return o}]),window.analyticsModule.service("GAService",["$log",function(e){e=e.getInstance("GAService"),e.info("Service Started...");var t={prepareParameters:function(e){var n={label:null,value:null,dimensions:[],metrics:[]};return e.filter(isDefined).filter(function(e){return t.updateDimension(e),t.updateMetric(e),isDefined(e.dimension)?(n.dimensions.push(e),!1):isDefined(e.metric)?(n.metrics.push(e),!1):!0}).forEach(function(e){t.isLabelParameterAllowed(e)&&(n.label=e.value),t.isValueParameterAllowed(e)&&(n.value=e.value)}),n},isLabelParameterAllowed:function(e){return getContext("featureConfig.analytics.google.allowedParametersLabel",[]).indexOf(e.name)>-1},isValueParameterAllowed:function(e){return getContext("featureConfig.analytics.google.allowedParametersValue",[]).indexOf(e.name)>-1},updateDimension:function(e){var t;switch(e.name){case"Online Status":t=1;break;case"Trips count":t=7;break;case"Past trips count":t=8;break;case"Future and ongoing trips count":t=9;break;case"Closest trip time left minutes":t=10;break;case"AirHelp - Flight status":t=11}e.dimension=t},updateMetric:function(e){var t;switch(e.name){case"Trip - Days until start":t=5;break;case"Segment - Hours until start":t=6;break;case"AirHelp - Compensation":t=7}e.metric=t},toString:function(){return"GAService"}};return t}]),analyticsModule.service("NavigationAnalyticsService",["AnalyticsService","$log",function(e,t){t=t.getInstance("NavigationAnalyticsService"),t.info("Service Started...");var n={CATEGORY:"Navigation",PAST_TRIP_LOADED:"Load past trips button tapped",TRIP_ACTION_SHEET_OPEN:"Opened trip action sheet",tripActionSheetOpen:function(){e.runSafe(function(){this.sendEvent(n.TRIP_ACTION_SHEET_OPEN,e.extendDefaultParameterWith(),n.CATEGORY)})},pastTripLoaded:function(){e.runSafe(function(){this.sendEvent(n.PAST_TRIP_LOADED,e.extendDefaultParameterWith(),n.CATEGORY)})},toString:function(){return"NavigationAnalyticsService"}};return n}]),analyticsModule.service("NativeBridgeAnalyticsService",["$log","AnalyticsService","PostMessageService",function(e,t,n){e=e.getInstance("NativeBridgeAnalyticsService"),e.info("Service Started...");var o={isTrusted:!1,init:function(){t.register(o)},_send:function(e){n.send({type:"analytics",payload:e})},setProperty:function(e,t){o._send({event:"property",properties:e})},screenView:function(e,t,n){o._send({event:"screenView",name:e,parameters:t})},sendEvent:function(e,t,n,i){o._send({event:"behavior",name:e,parameters:t,category:n})},sendException:function(e,t){o._send({event:"exception",value:e})},sendTime:function(e,t,n){o._send({event:"time",value:e})},toString:function(){return"NativeBridgeAnalyticsService"}};return o}]),analyticsModule.service("IframeBridgeAnalyticsService",["$log","AnalyticsService","PostMessageService",function(e,t,n){e=e.getInstance("IframeBridgeAnalyticsService"),e.info("Service Started...");var o={CATEGORY:"Monetization",init:function(){n.when("analytics").then(o._propagate)},_propagate:function(n){var i=n.event;switch(i){case"behavior":t.runSafe(function(){this.sendEvent(n.name,o._buildParameters(n.parameters),n.category||o.CATEGORY)});break;case"screenView":t.runSafe(function(){this.screenView(n.name,isDefined(n.parameters)?o._buildParameters(n.parameters):[])});break;default:e.warn(i+" not implemented yet")}},_buildParameters:function(e){var n=t.getPropertiesFactory("External - ");return Object.keys(e).forEach(function(t){n.create(t,e[t]).flagMarketing().push()}),n.build()},toString:function(){return"IframeBridgeAnalyticsService"}};return o}]),analyticsModule.service("FeedbackAnalyticsService",["AnalyticsService","$log",function(e,t){t=t.getInstance("FeedbackAnalyticsService"),t.info("Service Started...");var n={CATEGORY:"Feedback",rateAppDisplayed:function(){e.runSafe(function(){this.sendEvent("Rate app",e.extendDefaultParameterWith(),n.CATEGORY)})},storeDisplayed:function(){e.runSafe(function(){this.sendEvent("Store prompt displayed",e.extendDefaultParameterWith(),n.CATEGORY)})},onboardingSummary:function(t,o,i){e.runSafe(function(){var r=e.getPropertiesFactory();r.create("Duration Viewed (seconds)",t).flagMarketing().push().create("Screens Viewed",o).flagMarketing().push().create("Completed",i?"Yes":"No").flagMarketing().push(),this.sendEvent("Onboarding Summary",r.build(),n.CATEGORY)})},advertisementPresented:function(t,o){e.runSafe(function(){var i=e.getPropertiesFactory();i.create("Ad Provider",t).flagMarketing().push().create("Ad Type",o).flagMarketing().push(),this.sendEvent("Advertisement Presented",i.build(),n.CATEGORY)})},languageSelected:function(t){e.runSafe(function(){var o=e.getPropertiesFactory();o.create("preferred language",t).flagMarketing().push(),this.sendEvent("Language selected",o.build(),n.CATEGORY)})},smartBannerClosed:function(){e.runSafe(function(){this.sendEvent("Smart banner closed",e.extendDefaultParameterWith(),n.CATEGORY)})},smartBannerViewed:function(){e.runSafe(function(){this.sendEvent("Smart banner viewed",e.extendDefaultParameterWith(),n.CATEGORY)})},toString:function(){return"FeedbackAnalyticsService"}};return n}]),window.analyticsModule.service("LocalyticsService",["$log",function(e){e=e.getInstance("LocalyticsService"),e.info("Service Started...");var t={prepareParameters:function(e){var n={data:{},dimensions:[],customerLifetimeValue:void 0};return isDefined(e)?(e.filter(function(e){return isDefined(e)}).filter(function(e){return e.isCLV&&(n.customerLifetimeValue=e.value),!e.isCLV}).filter(function(e){return t.updateDimension(e),isDefined(e.dimension)?(n.dimensions.push(e),!1):!0}).map(function(e){return n.data[e.name]=e.value,e}),n):void 0},updateDimension:function(e){var t;switch(e.name){case"Logged in channel":t=1;break;case"Total trips":t=2;break;case"Future and ongoing trips count":t=3;break;case"Past trips":t=4;break;case"Email provider":t=5}e.dimension=t},toString:function(){return"LocalyticsService"}};return t}]),window.analyticsModule.service("LocalyticsWebAnalyticsService",["$log","AnalyticsService","LocalyticsService",function(e,t,n){e=e.getInstance("LocalyticsWebAnalyticsService"),e.info("Service Started...");var o={isTrusted:!0,scope:"app",init:function(){var e=getContext("featureConfig.analytics.localytics.APIKey");isFeatureEnabled("analytics.localytics")&&isDefined(window.ll)&&isDefined(e)&&(t.register(o),window.ll("init",e,{}))},setProperty:function(e,i){window.ll("setCustomerId",i),e.name===t.FIRST_NAME?window.ll("setCustomerFirstName",e.value):e.name===t.LAST_NAME?window.ll("setCustomerLastName",e.value):e.name===t.EMAIL?window.ll("setCustomerEmail",e.value):e.name===t.FULL_NAME?window.ll("setCustomerFullName",e.value):isDefined(e.value)?window.ll("setProfileAttribute",e.name,e.value,o.scope):window.ll("deleteProfileAttribute",e.name,o.scope),n.updateDimension(e),isDefined(e.dimension)&&window.ll("setCustomDimension",e.dimension,e.value)},sendEvent:function(e,t,o,i){var r=n.prepareParameters(t);r.dimensions.map(function(e){window.ll("setCustomDimension",e.dimension,e.value)}),window.ll("tagEvent",e,r.data,isDefined(r.customerLifetimeValue)?r.customerLifetimeValue:0)},screenView:function(e,t,n){window.ll("tagScreen",e),o.sendEvent("View "+e,t)},toString:function(){return"LocalyticsWebAnalyticsService"}};return o}]),window.analyticsModule.service("TagManagerService",["$log","AnalyticsService","$ionicPlatform",function(e,t,n){e=e.getInstance("TagManagerService"),e.info("Service Started...");var o={isTrusted:!0,_customEvent:[],mapping:{"Trip details":"View Trip"},init:function(){isFeatureEnabled("analytics.tagManager")&&(window.tmpack={trigCustomEvent:function(){o._customEvent.push(arguments)}},n.ready(function(){var e=getContext("featureConfig.analytics.tagManager.id"),t=document.createElement("script");if(isFeatureEnabled("cookiesConsent")){var n=getContext("featureConfig.cookiesConsent.targetingAds_groupId",4);t.type="text/plain",t.setAttribute("class","optanon-category-"+n)}else t.type="text/javascript";t.async=1,t.onload=o._loaded,t.src="//"+getContext("featureConfig.analytics.tagManager.server")+"/"+e+"/"+getContext("featureConfig.analytics.tagManager.script");var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(t,i.nextSibling)}),t.register(o))},_loaded:function(){o._customEvent.forEach(function(e){window.tmpack.trigCustomEvent.apply(window.tmpack,e)}),o._customEvent=[]},_prepareParameter:function(e){return e.map(function(e){return{name:e.name,value:e.value}})},sendEvent:function(e,t,n,i){"Trip"!==n&&"Screen View"!==n||window.tmpack.trigCustomEvent(e.replace(" ","_"),o._prepareParameter(t),!1,!0)},screenView:function(e,t,n){o.sendEvent(o.mapping[e]?o.mapping[e]:e,o._prepareParameter(t),n)},toString:function(){return"TagManagerService"}};return o}]),window.accountModule=angular.module("AccountModule",["ionic","CoreModule","CoreUiModule","AnalyticsModule"]),window.accountModule.run(["$log","$rootScope","AccountOrchestratorService","AuthenticationService","LoginWithEmailService",function(e,t,n,o,i){e=e.getInstance("Account"),e.info("Module started"),setContext("applicationConfig.forgotPasswordKey","forgot_password_email"),n.noop(),o.init(),i.noop()}]),window.accountModule.config(["$translatePartialLoaderProvider",function(e){e.addPart("account")}]);var profileMenuEnabledConfig="featureConfig.mainFeatures.isProfileMenuEnabled",helpMenuEnabledConfig="featureConfig.mainFeatures.isHelpMenuEnabled";window.accountModule.routes={login:{url:"/login",templateUrl:"account/templates/pages/LoginView.html",controller:"AuthenticationController",secured:!1,resolve:{analytics:["AnalyticsService",function(e){return e.screenView("Login with email").promise()}]},ncyBreadcrumb:{label:"{{'account.login.title.login'|translate}}"}},register:{url:"/register",templateUrl:"account/templates/pages/RegistrationView.html",controller:"RegistrationController",defaultBackState:"login",secured:!1,resolve:{analytics:["AnalyticsService",function(e){return e.screenView("Create account").promise()}]},ncyBreadcrumb:{label:"{{'account.registration.title.createAccount'|translate}}",parent:"login"}},forgotpassword:{url:"/forgotpassword",templateUrl:"account/templates/pages/ForgotPasswordView.html",controller:"ForgotPasswordController",defaultBackState:"login",secured:!1,resolve:{analytics:["AnalyticsService",function(e){return e.screenView("Forgot password").promise()}]},ncyBreadcrumb:{label:"{{'account.forgotPassword.title.forgotPassword'|translate}}",parent:"login"}},"forgotpassword-activation":{url:"/forgotpassword-activation?userId&activationKey",templateUrl:"account/templates/pages/ForgotPasswordActivationView.html",controller:"SharedActivationController",resolve:{ACTIVATION_SERVICE_NAME:function(){return"ForgotPasswordActivationService"},analytics:["AnalyticsService",function(e){return e.screenView("Forgot password activation").promise()}]}},activation:{url:"/activation?userId&activationKey",templateUrl:"account/templates/pages/AccountActivationView.html",controller:"SharedActivationController",secured:!1,forceLogout:!0,resolve:{ACTIVATION_SERVICE_NAME:function(){return"AccountActivationService"},analytics:["AnalyticsService",function(e){return e.screenView("Account activation").promise()}]}},settings:{url:"/settings",templateUrl:"account/templates/pages/SettingsView.html",controller:"SettingsController",secured:!0,resolve:{analytics:["AnalyticsService",function(e){return e.screenView("Settings").promise()}]},ncyBreadcrumb:{label:"{{'account.settings.title.view'|translate}}"}},help:{url:"/help",templateUrl:"account/templates/pages/HelpView.html",controller:"SettingsController",secured:!0,resolve:{analytics:["AnalyticsService",function(e){return e.screenView("Help").promise()}]},ncyBreadcrumb:{label:"{{'account.settings.label.helpmenuitem'|translate}}"}},profile:{url:"/profile",templateUrl:"account/templates/pages/ProfileMenuView.html",controller:"SettingsController",secured:!0,resolve:{analytics:["AnalyticsService",function(e){return e.screenView("Profile").promise()}]},ncyBreadcrumb:{label:"{{'account.settings.label.profilemenuitem'|translate}}"}},"notifications-settings":{url:"/notifications-settings",templateUrl:"account/templates/pages/NotificationsSettingsView.html",controller:"ProfileSettingsController",defaultBackState:getContext(profileMenuEnabledConfig,!1)?"profile":"settings",secured:!0,resolve:{analytics:["AnalyticsService",function(e){return e.screenView("Notification settings").promise()}]},ncyBreadcrumb:{label:"{{'account.notificationsSettings.title.notifications'|translate}}",parent:["AuthenticationService",function(e){return e.isLogged()?getContext(profileMenuEnabledConfig,!1)?"profile":"settings":null}]}},"edit-profile":{url:"/edit-profile",templateUrl:"account/templates/pages/ProfileView.html",controller:"ProfileSettingsController",defaultBackState:getContext(profileMenuEnabledConfig,!1)?"profile":"settings",secured:!0,resolve:{analytics:["AnalyticsService",function(e){return e.screenView("Edit profile").promise()}]},ncyBreadcrumb:{label:"{{'account.editProfile.title.editProfile'|translate}}",parent:["AuthenticationService",function(e){return e.isLogged()?getContext(profileMenuEnabledConfig,!1)?"profile":"settings":null}]}},address:{url:"/address",templateUrl:"account/templates/pages/AddressView.html",controller:"ProfileSettingsController",defaultBackState:getContext(profileMenuEnabledConfig,!1)?"profile":"settings",secured:!0,resolve:{analytics:["AnalyticsService",function(e){return e.screenView("Address").promise()}]},ncyBreadcrumb:{label:"{{'account.address.label.address'|translate}}",parent:["AuthenticationService",function(e){return e.isLogged()?getContext(profileMenuEnabledConfig,!1)?"profile":"settings":null}]}},termsandconditions:{url:"/termsandconditions",templateUrl:"account/templates/pages/SharedContentInIframeView.html",controller:"SharedContentInIframeController",resolve:{IFRAME_PARAMS:function(){return{controllerName:"TermsAndConditionsController",serverUrl:"termsandcondition",labelSlow:"tandcnotslow",labelNotFound:"tandcnotfound",labelHeader:"account.registration.title.termsAndConditions"}},analytics:["AnalyticsService",function(e){return e.screenView("Terms and conditions").promise()}]},defaultBackState:getContext(helpMenuEnabledConfig,!1)?"help":"settings",ncyBreadcrumb:{label:"{{'account.settings.label.termsandcondition'|translate}}",parent:["AuthenticationService",function(e){return e.isLogged()?getContext(helpMenuEnabledConfig,!1)?"help":"settings":getContext(helpMenuEnabledConfig,!1)?"guest-help":null}]}},privacypolicy:{url:"/privacypolicy",templateUrl:"account/templates/pages/SharedContentInIframeView.html",controller:"SharedContentInIframeController",resolve:{IFRAME_PARAMS:function(){return{controllerName:"PrivacyPolicyController",serverUrl:"privacypolicy",labelSlow:"privacypolicyslow",labelNotFound:"privacypolicynotfound",labelHeader:"account.settings.label.privacypolicy"}},analytics:["AnalyticsService",function(e){return e.screenView("Privacy policy").promise()}]},defaultBackState:getContext(helpMenuEnabledConfig,!1)?"help":"settings",ncyBreadcrumb:{label:"{{'account.settings.label.privacypolicy'|translate}}",parent:["AuthenticationService",function(e){return e.isLogged()?getContext(helpMenuEnabledConfig,!1)?"help":"settings":getContext(helpMenuEnabledConfig,!1)?"guest-help":null}]}},cookiepolicy:{url:"/cookiepolicy",templateUrl:"account/templates/pages/SharedContentInIframeView.html",controller:"SharedContentInIframeController",resolve:{IFRAME_PARAMS:function(){return{controllerName:"CookiePolicyController",serverUrl:"cookiepolicy",labelSlow:"cookiepolicyslow",labelNotFound:"cookiepolicynotfound",labelHeader:"account.settings.label.cookiepolicy"}},analytics:["AnalyticsService",function(e){return e.screenView("Cookie Policy").promise()}]},defaultBackState:getContext(helpMenuEnabledConfig,!1)?"help":"settings",ncyBreadcrumb:{label:"{{'account.settings.label.cookiepolicy'|translate}}",parent:["AuthenticationService",function(e){return e.isLogged()?getContext(helpMenuEnabledConfig,!1)?"help":"settings":getContext(helpMenuEnabledConfig,!1)?"guest-help":null}]}},cookiepolicyWeb:{url:"/webcookiepolicy",templateUrl:"account/templates/pages/SharedContentInIframeView.html",controller:"SharedContentInIframeController",resolve:{IFRAME_PARAMS:function(){return{controllerName:"CookiePolicyController",serverUrl:"cookiepolicy",labelSlow:"cookiepolicyslow",labelNotFound:"cookiepolicynotfound",labelHeader:"account.settings.label.cookiepolicy"}},analytics:["AnalyticsService",function(e){return e.screenView("Cookie Policy Web").promise()}]},defaultBackState:getContext(helpMenuEnabledConfig,!1)?"help":"settings",ncyBreadcrumb:{label:"{{'account.settings.label.cookiepolicy'|translate}}",parent:["AuthenticationService",function(e){return e.isLogged()?getContext(helpMenuEnabledConfig,!1)?"help":"settings":getContext(helpMenuEnabledConfig,!1)?"guest-help":null}]}}},window.accountModule.value("IFRAME_PARAMS",{controllerName:"TermsAndConditionsController",serverUrl:"termsandcondition",labelSlow:"tandcnotslow",labelNotFound:"tandcnotfound",labelHeader:"account.registration.title.termsAndConditions"}),accountModule.service("AuthenticationService",["DataManagerService","$log","RequestService","$rootScope","$q","I18nService","$ionicHistory","PromiseService","OrchestratorChiefService","LayoutService","$injector","AccountAnalyticsService","$window",function(e,t,n,o,i,r,a,s,c,l,u,d,f){t=t.getInstance("AuthenticationService"),t.info("Service Started...");var g=!1,p={_prefillData:{firstName:"",lastName:"",email:"",phoneNumber:"",phoneCode:"",password:""},_autoMarketKey:null,events:{userLoggedEvent:"userLoggedEvent",userLoggedOutEvent:"userLoggedOutEvent",pushTokenUpdateInProfileSuccessEvent:"pushTokenUpdateInProfileSuccessEvent",pushTokenUpdateInProfileFailureEvent:"pushTokenUpdateInProfileFailureEvent"},NO_USER_ID:"noid",USER_STORAGE_KEY:"User",USER_PASSWORD_STORAGE_KEY:"UserPassword",AUTH_METHOD_STORAGE_KEY:"UserAuthMethod",ACCESS_TOKEN_STORAGE_KEY:"AccessToken",MULTIMARKET_CONTACT_DATA_STORAGE_KEY:"MultiMarketContactData",LOGOUT_URL_PATH:"v1/account/logout",REGISTER_DEVICE_NOTIFICATION_TOKEN_URL_PATH:"v1/account/registerDevice",EMAIL_METHOD:"email",CORPORATE_METHOD:"corporate",ERR_NO_INTERNET_CONNECTIVITY:"No internet connectivity",USER_NOT_LOGGED_LANDED_PAGE:"USER_NOT_LOGGED_LANDED_PAGE",init:function(){if(o.$on("userLoggedOutEvent",function(e){c.next({forceLogoutNavigation:!0,islogged:!1})}),p.retrieveToken(),isDefined(f.authenticationInformation)){var e=f.authenticationInformation.user,n=f.authenticationInformation.token;isDefined(e)&&isDefined(n)&&isDefined(e.firstName)&&isDefined(e.lastName)?(p._storeUser(e),p._storeUserAccessToken(n)):t.error("Trying to authenticate with bad formatted data",e,n);var i=f.authenticationInformation.site;isDefined(i)&&(setContext("SITECODE",i),setContext("applicationConfig.dataManagerKeyPrefix",i+":"));var r=f.authenticationInformation.octx;isDefined(i)&&setContext("OCTX",r);var a=f.authenticationInformation.googlePlacesApiKey;isDefined(a)&&setContext("featureConfig.googlePlaces.apiKey",a)}o.$on("$stateChangeStart",function(e,n,o,i,r){if(n.secured&&!p.isLogged()){var a=getContext("applicationConfig.securedPage.redirectionRoute","login");t.warn("User not logged, blocking navigation to "+n.name+" (stored in localStorage)"),t.warn('Will redirect to "'+a+'" instead'),p.setLandedPage(n,o),a.indexOf(".html")>-1?f.location.href=f.location.href.replace(/web\-\w*\.html/i,a):c.navigateTo(a)}if(n.secured===!1&&p.isLogged())if(n.forceLogout)p.__logout();else{var s=getContext("applicationConfig.securedPage.redirectionHomeRoute","");t.warn("User logged, blocking navigation to "+n.name),t.warn('Will redirect to "'+s+'" instead'),c.navigateTo(s)}}),o.$on("$stateChangeError",function(e,n,o,i,r,a){t.error("Error during state change",n,a)})},retrieveToken:function(){e.getSecureAsync(p.ACCESS_TOKEN_STORAGE_KEY).then(function(e){isDefined(e)&&p._storeUserAccessToken(e)})},isFirstUsage:function(){var t=e.get("isFirstTimeAppRun",e.LOCALSTORAGE);return e.set(!1,"isFirstTimeAppRun",{storage:e.LOCALSTORAGE}),isUndefined(t)},isLogged:function(){return isDefined(p.getUser())},getUser:function(){return e.get(p.USER_STORAGE_KEY,e.LOCALSTORAGE)},getMultiMarketContactData:function(){return e.get(p.MULTIMARKET_CONTACT_DATA_STORAGE_KEY,e.LOCALSTORAGE)},getUserId:function(){var e=p.getUser();return isDefined(e)?e.userId:p.NO_USER_ID},getUserPassword:function(){return e.getSecureAsync(p.USER_PASSWORD_STORAGE_KEY)},getUserAccessToken:function(){var t=isDefined(window.cordova)?e.MEMORY:e.LOCALSTORAGE;return e.get(p.ACCESS_TOKEN_STORAGE_KEY,t)},getUserAuthMethod:function(){return e.get(p.AUTH_METHOD_STORAGE_KEY,e.LOCALSTORAGE)},_storeUser:function(t){e.set(t,p.USER_STORAGE_KEY,{storage:e.LOCALSTORAGE,ttl:e.INFINITE,belongsToUser:!0})},_storeUserPassword:function(t){return e.setSecureAsync(t,p.USER_PASSWORD_STORAGE_KEY)},_storeUserAccessToken:function(t){var n=isDefined(window.cordova)?e.MEMORY:e.LOCALSTORAGE;e.set(t,p.ACCESS_TOKEN_STORAGE_KEY,{storage:n,ttl:e.INFINITE,belongsToUser:!0}),isDefined(window.cordova)&&e.setSecureAsync(t,p.ACCESS_TOKEN_STORAGE_KEY)},_storeUserAuthMethod:function(t){e.set(t,p.AUTH_METHOD_STORAGE_KEY,{storage:e.LOCALSTORAGE,ttl:e.INFINITE,belongsToUser:!0})},_storeMultiMarketContactData:function(t){e.set(t,p.MULTIMARKET_CONTACT_DATA_STORAGE_KEY,{storage:e.LOCALSTORAGE,ttl:e.INFINITE,belongsToUser:!0})},setLandedPage:function(t,n){e.set({state:t,params:n},p.USER_NOT_LOGGED_LANDED_PAGE,{storage:e.LOCALSTORAGE,ttl:"1h",belongsToUser:!0})},getAndRemoveLandedPage:function(){var t=e.get(p.USER_NOT_LOGGED_LANDED_PAGE,e.LOCALSTORAGE);return e.remove(p.USER_NOT_LOGGED_LANDED_PAGE,e.LOCALSTORAGE),t},getLandedPage:function(){return e.get(p.USER_NOT_LOGGED_LANDED_PAGE,e.LOCALSTORAGE)},hasLandedPage:function(){return isDefined(p.getLandedPage())},updatePushNotificationTokenInUserProfile:function(){if(!p.isLogged())return t.warn("Not logged; unable to update the push token in the profile"),void o.$emit(p.events.pushTokenUpdateInProfileFailureEvent);var e=p.augmentLoginLogoutPayloadWithDeviceInfo({});return isDefined(safeAccess(e,"device.token"))?(t.info("Sending push token to backend to update in profile"),void n.post(p.REGISTER_DEVICE_NOTIFICATION_TOKEN_URL_PATH,e).then(function(e){var t=safeAccess(e,"data.success");t?o.$emit(p.events.pushTokenUpdateInProfileSuccessEvent):(s.rejectDueToBackendError({response:e,method:"updatePushNotificationTokenInUserProfile"}),o.$emit(p.events.pushTokenUpdateInProfileFailureEvent))},function(e){s.getDefaultFailHandler("updatePushNotificationTokenInUserProfile")(e),o.$emit(p.events.pushTokenUpdateInProfileFailureEvent)})["catch"](handleUnexpectedError)):(t.warn("Push token not available; unable to update the push token in the profile"),void o.$emit(p.events.pushTokenUpdateInProfileFailureEvent))},augmentLoginLogoutPayloadWithDeviceInfo:function(e){e=e||{};var n;if(getContext("isMobileApp",!1)&&(n=u.get("PushNotificationService").getNotificationToken()),isDefined(n)){t.info("adding push token to payload");var o="";ionic.Platform.isIOS()?o="iOS":ionic.Platform.isAndroid()&&(o="Android"),e.device={system:o,token:n}}else t.info("push token not available");return e},loginSuccessCallback:function(e,n,o){var i=e.data;if(isDefined(i))if(i.success&&isDefined(i.user))p.afterLoginSuccessSharedCallback(i,n,i.accessToken),o.resolve(i);else{t.backendError(i);var a=safeAccess(e,"data.errorCodes");r.translateBackendErrorCodes(a).then(function(e){o.reject(e)})}else o.reject("No data received");return o.promise},afterLoginSuccessSharedCallback:function(e,t,n){if(e.overriddenContextParameters){var i=e.overriddenContextParameters;p._storeMultiMarketContactData(i)}var r=angular.copy(e.user);delete r.triplist,p._storeUser(r);var a=t.password;getContext("isMobileApp")&&p._storeUserPassword(a);var s="",c=safeAccess(t,"network.type");s=isDefined(c)?getContext("featureConfig.corporate.enabled",!1)?p.CORPORATE_METHOD:c.toLowerCase():p.EMAIL_METHOD,p._storeUserAuthMethod(s),s===p.EMAIL_METHOD&&p.registerEventsForEmailMethod(),s===p.CORPORATE_METHOD&&getContext("isMobileApp",!1)&&p.registerEventsForCorporateMethod(),p._storeUserAccessToken(n),d.loggedIn(s,r),o.$emit(p.events.userLoggedEvent,e.user)},loginFailureCallback:function(e,n,o){return t.httpError(e),isDefined(e)?r.translateHttpStatusCode(e.status).then(function(e){o.reject(e)}):r.translateHttpStatusCode("0").then(function(e){o.reject(e)}),o.promise},logout:function(e){e=e||{doMiddlewareCall:!0};var t=i.defer();if(e.doMiddlewareCall){var o=p.augmentLoginLogoutPayloadWithDeviceInfo({}),r=n.post(p.LOGOUT_URL_PATH,o);r["finally"](function(){p.__frontendLogout(t)})}else p.__frontendLogout(t);return t.promise},__frontendLogout:function(e){p.__logout(),o.$emit(p.events.userLoggedOutEvent),e.resolve()},__logout:function(){t.info("logout.finally: cleaning user data"),p.userLogOutEventDeregistrationHandler&&(p.userLogOutEventDeregistrationHandler(),delete p.userLogOutEventDeregistrationHandler),e.clearUserData(),t.info("Cleaning ionic history"),a.clearHistory(),d.loggedOut()},setAutoMarketSelectionData:function(e,t,n){getContext("featureConfig.multiMarket.autoMarketSelection",!1)&&(isDefined(e)&&""!==e&&isDefined(t)&&""!==t&&isDefined(n)&&""!==n?p._autoMarketKey={userId:e,marketId:t,officeId:n}:p._autoMarketKey=null)},getAutoMarketSelectionData:function(){return p._autoMarketKey},setEncryptedPayload:function(e,t,n){isDefined(e)||isDefined(t)||isDefined(n)?p._encryptedPayload={email:isDefined(e)?e:"",firstName:isDefined(t)?t:"",lastName:isDefined(n)?n:""}:p._encryptedPayload=null},getEncryptedPayload:function(){return p._encryptedPayload},setPrefillData:function(e,t,n,o,i){p._prefillData={firstName:isDefined(t)?t:"",lastName:isDefined(n)?n:"",email:isDefined(e)?e:"",phoneNumber:isDefined(o)?o:"",phoneCode:isDefined(i)?i:"",password:""}},getPrefillData:function(){return p._prefillData},registerEventsForEmailMethod:function(){p.userLogOutEventDeregistrationHandler&&(t.warn("userLogOutEventDeregistrationHandler is still alive !!!"),p.userLogOutEventDeregistrationHandler()),p.userLogOutEventDeregistrationHandler=o.$on("userLogOutEvent",function(){p.logout()})},registerEventsForCorporateMethod:function(){p.userLogOutEventDeregistrationHandler&&(t.warn("userLogOutEventDeregistrationHandler is still alive !!!"),p.userLogOutEventDeregistrationHandler()),p.userLogOutEventDeregistrationHandler=o.$on("userLogOutEvent",function(){p.logout()})},toString:function(){return"AuthenticationService"}};return o.$on("userLoggedEvent",function(){p.updatePushNotificationTokenInUserProfile()}),o.$on("auth:needToLogOutTheUserEvent",function(){t.info("Doing front-end logout"),p.logout({doMiddlewareCall:!1}).then(function(){return g?(t.info("There is already an auth error popup displayed, not displaying a second one!"),i.when()):(t.info("Displaying auth error popup"),g=!0,r.translate("account.silentLogin.error.authFailure").then(function(e){return l.toastError(e)}))})["finally"](function(){l.loading(!1),g=!1})}),p}]),accountModule.service("LoginWithEmailService",["$log","RequestService","$q","I18nService","AuthenticationService","$rootScope",function(e,t,n,o,i,r){e=e.getInstance("LoginWithEmailService"),e.info("Service Started...");var a={LOGIN_WITH_EMAIL_URL_PATH:"v1/account/loginWithEmail",noop:function(){},login:function(o,r,s){e.profile("emaillogin"),definedOrThrow([o,r],"You must pass a login and a password");var c=i.augmentLoginLogoutPayloadWithDeviceInfo({userId:o,password:r,triplistTimeWindow:"Future"}),l=i.getAutoMarketSelectionData();isDefined(l)&&(c.marketId=safeAccess(l,"marketId",void 0),c.officeId=safeAccess(l,"officeId",void 0)),getContext("isMobileApp",!1)&&getContext("featureConfig.cytric.enabled",!1)&&(ionic.Platform.isIOS()?c.clientPlatform="iPhone":c.clientPlatform="Android");var u=n.defer(),d=t.post(a.LOGIN_WITH_EMAIL_URL_PATH,c,s);return d.then(function(t){e.profile("emaillogin"),i.loginSuccessCallback(t,c,u)},function(t){e.profile("emaillogin"),i.loginFailureCallback(t,c,u)}),u.promise},logout:function(){var e=i.logout();return e},toString:function(){return"LoginWithEmailService"}};return i.getUserAuthMethod()===i.EMAIL_METHOD&&i.registerEventsForEmailMethod(),a}]),accountModule.service("RegistrationService",["DataManagerService","$log","RequestService","$q","I18nService","I18nConfig","AccountAnalyticsService",function(e,t,n,o,i,r,a){t=t.getInstance("RegistrationService"),t.info("Service Started...");var s={REGISTER_URL_PATH:"v1/account/register",register:function(e){var i={};angular.extend(i,e),definedOrThrow(i,"You must at least pass email, firstName, lastName, phoneCode, phoneNumber, password");try{parseInt(i.phoneCode,10),parseInt(i.phoneNumber,10)}catch(a){t.throwException("The phone format should be only digit")}var c={userId:i.email,firstName:i.firstName,lastName:i.lastName,password:i.password,
preferredLanguage:r.getCurrentAmadeusLanguage()};getContext("featureConfig.registration.displayPhoneNumberInput",!1)&&(c.mobileCountryCode=i.phoneCode,c.mobilePhoneNumber=i.phoneNumber),getContext("featureConfig.multiMarket.isEnabled",!1)&&i.marketInformation&&(c.marketInformation=i.marketInformation,c.officeId=i.officeId);var l=o.defer();return n.post(s.REGISTER_URL_PATH,c).then(function(e){s._registerSuccessCallback(e,l)},function(e){s._registerFailureCallback(e,l)}),l.promise},_registerSuccessCallback:function(e,n){var o=e.data;if(isDefined(o))if(o.success)a.accountCreatedWithEmail(),n.resolve(o);else{t.backendError(o);var r=safeAccess(e,"data.errorCodes");i.translateBackendErrorCodes(r).then(function(e){n.reject(e)})}else n.reject("No data received")},_registerFailureCallback:function(e,n){t.httpError(e),i.translateHttpStatusCode(e.status).then(function(e){n.reject(e)})},toString:function(){return"RegistrationService"}};return s}]),accountModule.service("ShareService",["$q","$log",function(e,t){return t=t.getInstance("ShareService"),t.info("Service Started..."),{shareViaEmail:function(t){var n=e.defer();return window.open("mailto:?subject="+t.subject+"&body="+encodeURIComponent(t.message),"_self"),n.resolve(),n.promise},shareViaWhatsApp:function(t){var n=e.defer();return n.reject("Not implemented yet"),n.promise},checkAppAvailability:function(t){var n=e.defer();return n.reject("Not implemented yet"),n.promise},toString:function(){return"ShareService"}}}]),accountModule.controller("AuthenticationController",["$scope","$rootScope","LayoutService","LoginWithEmailService","$log","OrchestratorChiefService","DataManagerService","$controller","$q","AuthenticationService","EasterEggService","ProfileService","ContentService",function(e,t,n,o,i,r,a,s,c,l,u,d,f){function g(){var t=getContext("applicationConfig.angularDebugEnabled");getContext("featureConfig.page.hasCustomBackground",!1)&&e.setupBackgroundImage(),t?(e.loginInputs={email:a.get("__DEBUG_USER_EMAIL",a.LOCALSTORAGE)||"",password:a.get("__DEBUG_USER_PASSWORD",a.LOCALSTORAGE)||""},a.remove("__DEBUG_USER_EMAIL",a.LOCALSTORAGE),a.remove("__DEBUG_USER_PASSWORD",a.LOCALSTORAGE)):p()}function p(){e.loginInputs={email:safeAccess(e,"prefillData.email",""),password:""}}function m(){var t=c.defer(),n=e.$new(!0);try{s("MultiMarketLoginController",{$scope:n}),n.isMarketEmpty()?n.showMarketSelectPopUp().then(function(){t.resolve("Market changed successfully!")},function(){t.resolve("Market change failed, stick to default Market.")}):t.resolve("User already has Market!")}catch(o){i.error(o),t.resolve("MultiMarketLoginController not found, falling back to continue login flow.")}return t.promise}i=i.getInstance("AuthenticationController"),i.info("Controller Started..."),e.forms={},e.showCustomBackgroundScreen=!1,e.prefillData=l.getPrefillData(),isDefined(l.getEncryptedPayload())&&(e.allowMaskedValues=!0),e.isForgotPasswordEnabled=getContext("featureConfig.whiteLabelCustomFeatures.isForgotPasswordEnabled",!0),e.isCreateAccountEnabled=getContext("featureConfig.whiteLabelCustomFeatures.isCreateAccountEnabled",!0);var v=l.getLandedPage();e.isLoginToSeeYourTripMessageDisplayed="trip-expanded"===safeAccess(v,"state.name"),e.isInternetExplorer=isIE(),e.login=function(){if(e.forms.loginform.$valid){n.loading(!0);var t=l.getEncryptedPayload(),i=e.loginInputs.email;isDefined(t)&&(i=t.email),o.login(i,e.loginInputs.password).then(C,S)}else n.addErrors(e.forms.loginform.$error)};var h=function(){r.next({islogged:!0}),p(),e.forms.loginform.$setPristine(),l.setEncryptedPayload(),l.setPrefillData()},C=function(e){n.loading(!1),getContext("featureConfig.multiMarket.isEnabled",!1)?m().then(function(e){i.info(e),h()}):h()},S=function(t){n.loading(!1),n.toastError(t).then(function(){a.set(e.loginInputs.email,getContext("applicationConfig.forgotPasswordKey"),{storage:a.MEMORY,ttl:"1m"})})};e.handleEasterEgg=function(){u.handleEasterEgg()},e.setupBackgroundImage=function(){var t=f.getBackgroundImageUrl();d.preloadImage(t).then(function(t){e.showCustomBackgroundScreen=!!t},function(){e.showCustomBackgroundScreen=!1})},t.$on("paramsUpdates",function(t,n){e.isForgotPasswordEnabled=getContext("featureConfig.whiteLabelCustomFeatures.isForgotPasswordEnabled",!0),e.isCreateAccountEnabled=getContext("featureConfig.whiteLabelCustomFeatures.isCreateAccountEnabled",!0)}),g()}]),accountModule.controller("RegistrationController",["$scope","$rootScope","LayoutService","RegistrationService","$log","I18nService","OrchestratorChiefService","AuthenticationService","$ionicPopup","DataManagerService","$ionicModal","NetworkService","ContentService","ProfileService",function(e,t,n,o,i,r,a,s,c,l,u,d,f,g){function p(){n.loading(!0);var t={email:e.registerInputs.email,firstName:e.registerInputs.firstName,lastName:e.registerInputs.lastName,phoneCode:e.registerInputs.phoneCode.substr(1),phoneNumber:e.registerInputs.phoneNumber.replace(/[a-zA-Z ()-]/g,""),password:e.registerInputs.password};safeAccess(e,"autoMarketData.marketId",!1)&&safeAccess(e,"autoMarketData.officeId",!1)&&(t.marketInformation=e.autoMarketData.marketId,t.officeId=e.autoMarketData.officeId),e.isMultiMarket&&(t.marketInformation=safeAccess(e.registerInputs,"marketInformation.marketCode",""));var i=s.getEncryptedPayload();isDefined(i)&&(t.email=i.email,t.firstName=i.firstName,t.lastName=i.lastName);var r=o.register(t);r.then(v,h)}if(i=i.getInstance("RegistrationController"),i.info("Controller Started..."),s.isLogged()&&a.next({islogged:!0}),e.showCustomBackgroundScreen=!1,e.isIOSWebView=ionic.Platform.isIOS()&&ionic.Platform.isWebView(),e.createAccountButtonDisabled=!1,e.displayPhone=getContext("featureConfig.registration.displayPhoneNumberInput",!1),e.phoneNumberRequired=getContext("featureConfig.registration.phoneNumberRequired",!1),e.marketData=null,e.isMultiMarket=getContext("featureConfig.multiMarket.isEnabled",!1)&&!getContext("featureConfig.multiMarket.hideMarketSelection",!1),e.autoMarketData=s.getAutoMarketSelectionData(),e.forms={},e.registerInputs=s.getPrefillData(),isDefined(s.getEncryptedPayload())){var m=s.getEncryptedPayload();e.allowMaskedValues=!0,isDefined(m.firstName)&&""!==m.firstName&&(e.isFirstNameReadOnly=!0,e.allowMaskedFirstName=!0),isDefined(m.lastName)&&""!==m.lastName&&(e.isLastNameReadOnly=!0,e.allowMaskedLastName=!0)}e.isInternetExplorer=isIE(),e.register=function(){return e.createAccountButtonDisabled?void i.info("Multiple consecutive clicks on create account button, not doing anything this time!"):void(e.forms.registerform.$valid?(e.isOnline=d.hasConnectivity(!0).isOnline,e.isOnline&&(e.createAccountButtonDisabled=!0,e.$on("modal.hidden",function(){e.createAccountButtonDisabled=!1}),u.fromTemplateUrl("account/templates/partial/termsAndConditions.html",{scope:e,animation:"slide-in-up"}).then(function(o){e.termsAndConditionsModal=o,e.termsAndConditionsSuccess=function(){n.removeModal(e.termsAndConditionsModal).then(function(){p()})},e.termsAndConditionsFailure=function(){n.removeModal(e.termsAndConditionsModal),t.$emit("termsAndConditionsFailure")},n.showModal(e.termsAndConditionsModal),a.registerNavigateBackFromModal()}))):n.addErrors(e.forms.registerform.$error))};var v=function(){n.loading(!1),r.translate(["account.registration.label.registrationOkTitle","account.registration.label.registrationOkMessage"]).then(function(t){var n=c.alert({title:t["account.registration.label.registrationOkTitle"],template:t["account.registration.label.registrationOkMessage"]});n.then(function(t){a.next({registered:!0});var n=e.registerInputs.phoneCode;e.registerInputs={},e.registerInputs.phoneCode=n,e.forms.registerform.$setPristine(),s.setEncryptedPayload(),s.setPrefillData()})})},h=function(t){n.loading(!1),n.toastError(t).then(function(){l.set(e.registerInputs.email,getContext("applicationConfig.forgotPasswordKey"),{storage:l.MEMORY,ttl:"1m"}),t.indexOf("2116076")>-1&&a.navigateTo("forgotpassword")})},C=function(n){n&&(e.marketData=t.marketData,e.registerInputs.marketInformation={regionCode:"",marketCode:""})};C(e.isMultiMarket),e.setupBackgroundImage=function(){var t=f.getBackgroundImageUrl();g.preloadImage(t).then(function(t){e.showCustomBackgroundScreen=!!t},function(){e.showCustomBackgroundScreen=!1})},getContext("featureConfig.page.hasCustomBackground",!1)&&e.setupBackgroundImage(),t.$on("multiMarketParamsChangedEvent",function(t,n){safeAccess(n,"marketData")&&(e.marketData=n.marketData,e.$broadcast("marketDataChangedEvent",e.marketData)),e.isMultiMarket=getContext("featureConfig.multiMarket.isEnabled",!1)&&!getContext("featureConfig.multiMarket.hideMarketSelection",!1),C(e.isMultiMarket)})}]),accountModule.service("ProfileService",["$log","$q","RequestService","AuthenticationService","PromiseService","DataManagerService","$rootScope","ContentService",function(e,t,n,o,i,r,a,s){e=e.getInstance("ProfileService"),e.info("Service Started...");var c={UPDATE_PROFILE_URL_PATH:"v1/account/updateProfile",DELETE_PROFILE_URL_PATH:"v1/account/deleteProfile",GET_PROFILE_URL_PATH:"v1/account/getProfile",CHECKIN_REMINDER_ENABLED_KEY:"CHECKIN_REMINDER_ENABLED",SSR_NOTIF_ENABLED_KEY:"SSR_NOTIF_ENABLED",getProfile:function(){return o.getUser()},getProfileFromServer:function(){var e=t.defer();return n.post(c.GET_PROFILE_URL_PATH).then(function(t){c.__getProfileSuccess(e,t,"getProfileFromServer")},function(t){c.__getProfileFailure(e,t,"getProfileFromServer")}),e.promise},updateProfile:function(e){var o=c.getProfile();isDefined(e.mobileCountryCode)||isDefined(e.mobilePhoneNumber)||(e.mobileCountryCode=o.mobileCountryCode,e.mobilePhoneNumber=o.mobilePhoneNumber);var i=t.defer();return n.post(c.UPDATE_PROFILE_URL_PATH,e).then(function(e){c.__getProfileSuccess(i,e,"updateProfile")},function(e){c.__getProfileFailure(i,e,"updateProfile")}),i.promise},deleteProfile:function(){var o={},i=t.defer();return n.post(c.DELETE_PROFILE_URL_PATH,o).then(function(t){var n=safeAccess(t,"data.success");if(n)i.resolve();else{e.error("deleteProfile: rejecting promise due to backend error");var o={errorCode:safeAccess(t,"data.errorCodes[0]","000000"),errorType:"backend"};i.reject(o)}},function(t){e.error("deleteProfile: rejecting promise due to http error");var n={errorCode:t.status,errorType:"http"};i.reject(n)}),i.promise},__getProfileSuccess:function(t,n,i){var r=n.data,a=safeAccess(n,"data.success");if(a)o._storeUser(r.user),t.resolve(r.user);else{e.warn(i+": rejecting promise due to backend error");var s={errorCode:safeAccess(n,"data.errorCodes[0]","000000"),errorType:"backend"};t.reject(s)}},__getProfileFailure:function(t,n,o){e.warn(o+": rejecting promise due to http error");var i={errorCode:n.status,errorType:"http"};t.reject(i)},isCheckinReminderNotifEnabled:function(){var e=r.get(c.CHECKIN_REMINDER_ENABLED_KEY,r.LOCALSTORAGE);return isDefined(e)||(e=!0),e},setCheckinReminderNotifEnabled:function(t){"boolean"!=typeof t&&(e.error("setCheckinReminderNotifEnabled: boolean expected, received: "+t),t=!!t);var n=c.isCheckinReminderNotifEnabled();n!==t&&(r.set(t,c.CHECKIN_REMINDER_ENABLED_KEY,{storage:r.LOCALSTORAGE}),a.$emit("userProfileCheckinNotificationSettingsChangedEvent",t))},isSsrNotifEnabled:function(){var e=r.get(c.SSR_NOTIF_ENABLED_KEY,r.LOCALSTORAGE);return isDefined(e)||(e=!0),e},setSsrNotifEnabled:function(t){"boolean"!=typeof t&&(e.error("setSsrNotifEnabled: boolean expected, received: "+t),t=!!t);var n=c.isSsrNotifEnabled();n!==t&&(r.set(t,c.SSR_NOTIF_ENABLED_KEY,{storage:r.LOCALSTORAGE}),a.$emit("userProfileSsrNotificationSettingsChangedEvent",t))},preloadImage:function(e){var n=!1,o=t.defer(),i=new Image;return i.onload=function(){n=!0,o.resolve(n)},i.onerror=function(){o.reject()},i.src=e,o.promise},toString:function(){return"ProfileService"}};return c}]),accountModule.service("AccountOrchestratorService",["$state","$log","LayoutService","$ionicHistory","OrchestratorChiefService","$timeout","$q",function(e,t,n,o,i,r,a){t=t.getInstance("AccountOrchestratorService"),t.info("Service Started...");var s={noop:function(){},_navigateToSettings:function(){return i.navigateTo("settings")},navigateToLoginPage:function(){return i.navigateTo("login")},_navigateToLoginOrLanding:function(){var e=getContext("featureConfig.whiteLabelCustomFeatures.isCreateAccountEnabled",!0),n=function(){r(function(){t.info("Cleaning ionic cache"),o.clearCache()},500)};return e?(t.info("Redirecting user to landing page"),i.navigateToLandingPage()["finally"](n)):(t.info("Redirecting user to login page"),s.navigateToLoginPage()["finally"](n))},next:function(e,t){var n=a.when(e);if(e.forceLogoutNavigation)n=s._navigateToLoginOrLanding();else switch(e.page){case"":case"settings":case"more-settings":case"login":case"register":case"activation":case"forgotpassword":case"forgotpassword-activation":n=e.islogged?s._navigateToSettings():s._navigateToLoginOrLanding();break;default:n=i.check(e,t)}return n},toString:function(){return"AccountOrchestratorService"}};return i.register(s),s}]),accountModule.service("SharedActivationService",["$log","RequestService","$q","I18nService","AuthenticationService","PromiseService","AccountAnalyticsService",function(e,t,n,o,i,r,a){e=e.getInstance("SharedActivationService"),e.info("Service Started...");var s={ACTIVATE_URL_PATH:"!undefined!",activate:function(e){var o={userId:e.userId,password:e.password,activationKey:e.activationKey},i=this,r=n.defer();return t.post(i.ACTIVATE_URL_PATH,o).then(function(t){i._activateSuccessCallback(t,e,r)},function(t){i._activateFailureCallback(t,e,r)}),r.promise},_activateSuccessCallback:function(e,t,n){var s=e.data;if(isDefined(s))if(s.success&&isDefined(s.user))a.accountActivated(),i.afterLoginSuccessSharedCallback(s,t,s.accessToken),n.resolve(s);else{var c=safeAccess(e,"data.errorCodes[0]","000000");"777955"===c?o.translateBackendErrorCodes(["2016257"]).then(function(e){n.reject(e[0])}):r.rejectDueToBackendError({deferred:n,response:e,payload:t,method:"activate"})}else n.reject("No data received")},_activateFailureCallback:function(e,t,n){r.rejectDueToHttpError({deferred:n,response:e,payload:t,method:"activate"})},toString:function(){return"SharedActivationService"}};return s}]),accountModule.service("DecryptionService",["$log","RequestService","$q","PromiseService",function(e,t,n,o){e=e.getInstance("DecryptionService"),e.info("Service Started...");var i={DECRYPT_URL_PATH:"v1/tools/decryptAndMask",decryptLink:function(e){var o={email:safeAccess(e,"email",""),firstName:safeAccess(e,"firstName",""),lastName:safeAccess(e,"lastName","")},r=n.defer();return t.post(i.DECRYPT_URL_PATH,o).then(function(t){i._decryptLinkSuccessCallback(t,e,r)},function(t){i._decryptLinkFailureCallback(t,e,r)}),r.promise},_decryptLinkSuccessCallback:function(e,t,n){var o=e.data;if(isDefined(o))if(o.success&&isDefined(o.email))n.resolve(o);else{var i=safeAccess(e,"data.errorCodes");n.reject(i)}else n.reject("No data received")},_decryptLinkFailureCallback:function(e,t,n){o.rejectDueToHttpError({deferred:n,response:e,payload:t,method:"decryptLink"})},toString:function(){return"DecryptionService"}};return i}]),accountModule.service("AccountActivationService",["SharedActivationService",function(e){var t=Object.create(e);return angular.extend(t,{ACTIVATE_URL_PATH:"v1/account/activate",toString:function(){return"AccountActivationService"}}),t}]),accountModule.service("ForgotPasswordActivationService",["SharedActivationService",function(e){var t=Object.create(e);return angular.extend(t,{ACTIVATE_URL_PATH:"v1/account/activatePassword",toString:function(){return"ForgotPasswordActivationService"}}),t}]),accountModule.service("ContentService",["$log","I18nConfig","$q","I18nService","$timeout","LayoutService","NetworkService","$injector",function(e,t,n,o,i,r,a,s){e=e.getInstance("ContentService"),e.info("Service Started...");var c={_createStaticUrlForServerContent:function(e,t){var n;return n=getContext("isB2b",!1)?getContext("cdnHost")+getContext("SITECODE")+"/html/":getContext("server")+getContext("pathToHTML","")+"html/"+getContext("SITECODE")+"/",n+=t+"_"+e+".html"},createStaticUrlForServerContentWithCurrentLocale:function(e){var n=t.getCurrentApplicationLanguage(),o=c._createStaticUrlForServerContent(n,e);return o},createStaticUrlWithLocaleOfType:function(e,t,n){var o;return o=getContext("isMobileApp",!1)?"resources/":getContext("isB2b",!1)?getContext("cdnHost")+getContext("SITECODE")+"/app_html/":"resources/",o+=t+"_"+c._makeProperCase(e)+"."+n},_makeProperCase:function(e){var t=e.split("-");return t.length>1?t[0].toLowerCase()+"-"+t[1].toUpperCase():t[0].toLowerCase()},contentSlow:function(e){return i(function(){o.translate("account.settings.error."+e).then(function(e){r.toast(e)})},a.getRequestTimeout())},getFileOpenerService:function(){return s.has("FileOpenerService")?s.get("FileOpenerService"):null},openFileUrl:function(e){var t=c.getFileOpenerService();if(t){var n=e.getElementsByTagName("a");t.openFileUrl(n)}},getInjectedService:function(e){return s.has(e)?s.get(e):null},contentNotFound:function(e,t){return i(function(){o.translate("account.settings.error."+e).then(function(e){r.toast(e)}),i.cancel(t)},1e3)},getBackgroundImageUrl:function(){var e="";if(getContext("isMobileApp"))e="../www/images/mobileBackground.jpg";else{var t=getContext("cdnHost","");e=getContext("applicationConfig.isWebDesktop")?t+getContext("SITECODE")+"/images/desktopBackground.jpg":t+getContext("SITECODE")+"/images/mobileBackground.jpg"}return e}};return c}]),accountModule.service("TemperatureUnitService",["DataManagerService","I18nConfig","AuthenticationService","$log",function(e,t,n,o){o=o.getInstance("TemperatureUnitService"),o.info("Service Started...");var i=["F","C"],r={getTemperatureUnit:function(){var o=ApplicationContext.SITECODE+"_TEMPERATURE_UNIT_KEY_"+n.getUserId(),i=e.get(o,e.LOCALSTORAGE);if(isUndefined(i)){var r=t.getCountryCodeFromDeviceLocale(),a=getContext("featureConfig.weather.countriesDisplayingTempInFahrenheit",["US"]);i=a.indexOf(r)>-1?"F":"C"}return i},updateTemperatureUnit:function(t){if(i.indexOf(t)>-1){var o=ApplicationContext.SITECODE+"_TEMPERATURE_UNIT_KEY_"+n.getUserId();return e.set(t,o,{storage:e.LOCALSTORAGE}),!0}return!1},isTemperatureFahrenheit:function(){return"F"===r.getTemperatureUnit()},toString:function(){return"TemperatureUnitService"}};return r}]),accountModule.service("AccountAnalyticsService",["$log","AnalyticsService","StringService",function(e,t,n){e=e.getInstance("AccountAnalyticsService"),e.info("Service Started...");var o={CATEGORY:"User Lifecycle",LOYALTY_EVENTS:{add:"Loyalty Card Added Successfully",update:"Loyalty Card Updated Successfully","delete":"Loyalty Card Deleted Successfully",select:"Loyalty Card Selected",addCard:"Add Loyalty Card Button Clicked",deleteCard:"Delete Loyalty Card Button Clicked",saveCardAdd:"Save Loyalty Card Button Clicked for Add Card",saveCardEdit:"Save Loyalty Card Clicked for Edit Card"},EVENTS:{loggedIn:"Customer Logged In",accountCreatedWithEmail:"Customer Registered",accountActivated:"Account activated",loggedOut:"Customer Logged Out",appOpenedFromShareTripLink:"Opened app from share trip link"},loggedIn:function(e,n){t.runSafe(function(){this.setProperty("Logged in channel",e),this.setProperty(t.FIRST_NAME,n.firstName,!0),this.setProperty("Email provider",n.userId.split("@")[1]),this.sendEvent(o.EVENTS.loggedIn,t.extendDefaultParameterWith(o._getLoggedInParameter(e)),o.CATEGORY)})},_getLoggedInParameter:function(e){return[{name:"Channel",isMarketing:!0,value:n.capitalizedFirst(e)}]},accountCreatedWithEmail:function(){t.runSafe(function(){this.sendEvent(o.EVENTS.accountCreatedWithEmail,t.extendDefaultParameterWith(),o.CATEGORY)})},accountActivated:function(){t.runSafe(function(){this.sendEvent(o.EVENTS.accountActivated,t.extendDefaultParameterWith(),o.CATEGORY)})},loggedOut:function(){t.runSafe(function(){this.sendEvent(o.EVENTS.loggedOut,t.extendDefaultParameterWith(),o.CATEGORY)})},appOpenedFromShareTripLink:function(){t.runSafe(function(){this.sendEvent(o.EVENTS.appOpenedFromShareTripLink,t.extendDefaultParameterWith(),o.CATEGORY)})},loyaltyCardActionDone:function(e,n){var i=[];isDefined(n)&&""!==n?i.push({value:"Type : "+n}):i.push({value:"-"}),isDefined(e)&&o.LOYALTY_EVENTS[e]&&t.runSafe(function(){this.sendEvent(o.LOYALTY_EVENTS[e],i,"User Settings")})},exceptionOccurred:function(e,n){t.runSafe(function(){this.sendException({message:e,isFatal:n})})},toString:function(){return"AccountAnalyticsService"}};return o}]),accountModule.controller("SharedActivationController",["$scope","$log","$stateParams","LayoutService","OrchestratorChiefService","I18nService","$ionicPopup","$injector","ACTIVATION_SERVICE_NAME","$rootScope","ContentService","ProfileService","DecryptionService","EMAIL_REGEX",function(e,t,n,o,i,r,a,s,c,l,u,d,f,g){t=t.getInstance("SharedActivationController");var p=s.get(c);t.info("Controller Started..."),e.forms={},e.activationInputs={activationKey:n.activationKey,userId:n.userId,password:"",email:""},g.test(n.userId)?e.activationInputs.email=n.userId:(e.allowMaskedValues=!0,e.$on("$ionicView.beforeEnter",function(e,t){o.loading(!0),f.decryptLink({email:n.userId}).then(h,C)})),e.showCustomBackgroundScreen=!1,e.activate=function(){if(e.allowMaskedValues&&e.forms.activateform.passwordInput.$valid||e.forms.activateform.$valid){o.loading(!0);var t=e.activationInputs;p.activate(t).then(m,v)}else o.addErrors(e.forms.activateform.$error)};var m=function(){o.loading(!1);var t="AccountActivationService"===c?"activation":"forgotPasswordActivation";r.translate(["account."+t+".label.activationOkTitle","account."+t+".label.activationOkMessage"]).then(function(n){var o=a.alert({title:n["account."+t+".label.activationOkTitle"],template:n["account."+t+".label.activationOkMessage"]});o.then(function(t){i.next({islogged:!0}),l.$broadcast("accountActivatedEvent",{}),e.activationInputs={},e.forms.activateform.$setPristine()})})},v=function(e){o.loading(!1),o.toastError(e)},h=function(t){o.loading(!1),e.activationInputs.email=t.email},C=function(e){if(o.loading(!1),"777955"===e[0]||"777959"===e[0]){var t="AccountActivationService"===c?"activation":"forgotPasswordActivation";r.translate(["core.title.errorPopup","account."+t+".error.message"]).then(function(e){var n=a.alert({title:e["core.title.errorPopup"],template:e["account."+t+".error.message"]});n.then(function(e){i.next()})})}else o.toastError(e).then(function(){i.next()})};e.setupBackgroundImage=function(){var t=u.getBackgroundImageUrl();d.preloadImage(t).then(function(t){e.showCustomBackgroundScreen=!!t},function(){e.showCustomBackgroundScreen=!1})},getContext("featureConfig.page.hasCustomBackground",!1)&&e.setupBackgroundImage()}]),accountModule.service("ForgotPasswordService",["$log","RequestService","$q","I18nService",function(e,t,n,o){e=e.getInstance("ForgotPasswordService"),e.info("Service Started...");var i={RESET_PASSWORD_URL_PATH:"v1/account/resetPassword",forgotPassword:function(e){var o=getContext("featureConfig.whiteLabelCustomFeatures.isPasswordFieldDisplayedInForgotPasswordFlow",!0),r={userId:e.email};o?(r.newPassword=e.password,definedOrThrow(r,"missing one of mandatory fields (email, password)")):definedOrThrow([r.userId],"missing one of mandatory fields (email)");var a=n.defer();return t.post(i.RESET_PASSWORD_URL_PATH,r).then(function(t){i._forgotPasswordSuccessCallback(t,e,a)},function(t){i._forgotPasswordFailureCallback(t,e,a)}),a.promise},_forgotPasswordSuccessCallback:function(t,n,i){var r=t.data;if(isDefined(r))if(r.success)i.resolve(r);else{e.backendError(r);var a=safeAccess(t,"data.errorCodes");o.translateBackendErrorCodes(a).then(function(e){i.reject(e)})}else i.reject("No data received")},_forgotPasswordFailureCallback:function(t,n,i){e.httpError(t),o.translateHttpStatusCode(t.status).then(function(e){i.reject(e)})},toString:function(){return"ForgotPasswordService"}};return i}]),accountModule.controller("ForgotPasswordController",["$scope","ForgotPasswordService","$log","DataManagerService","LayoutService","I18nService","$ionicPopup","OrchestratorChiefService","ContentService","ProfileService",function(e,t,n,o,i,r,a,s,c,l){n=n.getInstance("ForgotPasswordController"),n.info("Controller Started..."),e.forms={},e.formInputs={email:o.get(getContext("applicationConfig.forgotPasswordKey")),password:""},e.showCustomBackgroundScreen=!1,e.isPasswordFieldDisplayedInForgotPasswordFlow=getContext("featureConfig.whiteLabelCustomFeatures.isPasswordFieldDisplayedInForgotPasswordFlow",!0),e.isInternetExplorer=isIE(),e.forgotPassword=function(){e.forms.forgotpasswordform.$valid?(i.loading(!0),t.forgotPassword(e.formInputs).then(u,d)):i.addErrors(e.forms.forgotpasswordform.$error)};var u=function(){i.loading(!1),r.translate(["account.forgotPassword.label.forgotPasswordOkTitle","account.forgotPassword.label.forgotPasswordOkMessage"]).then(function(t){var n=a.alert({title:t["account.forgotPassword.label.forgotPasswordOkTitle"],template:t["account.forgotPassword.label.forgotPasswordOkMessage"]});n.then(function(){s.next({forgotPassword:!0}),e.formInputs={},e.forms.forgotpasswordform.$setPristine()})})},d=function(e){i.loading(!1),i.toastError(e)};e.setupBackgroundImage=function(){var t=c.getBackgroundImageUrl();l.preloadImage(t).then(function(t){e.showCustomBackgroundScreen=!!t},function(){e.showCustomBackgroundScreen=!1})},getContext("featureConfig.page.hasCustomBackground",!1)&&e.setupBackgroundImage()}]),accountModule.controller("SettingsController",["$scope","$log","LayoutService","I18nService","OrchestratorChiefService","AuthenticationService","NetworkService","$rootScope","TemperatureUnitService",function(e,t,n,o,i,r,a,s,c){t=t.getInstance("SettingsController"),t.info("Controller Started..."),e.isWebDesktop=getContext("isWebDesktop",!1),e.isProfileSectionEnabled=!getContext("featureConfig.mainFeatures.isProfileMenuEnabled",!1),e.navigateTo=function(e){switch(e){case"termsandconditions":l(e,"tandcnotconnected");break;case"privacypolicy":l(e,"privacypolicynotconnected");break;case"cookiepolicy":l(e,"cookiepolicynotconnected");break;case"logout":u();break;default:getContext("featureConfig.guestMode.enabled",!1)&&!r.isLogged()?i.navigateTo("guest-"+e):i.navigateTo(e)}};var l=function(e,t){a.hasConnectivity().isOnline?getContext("featureConfig.guestMode.enabled",!1)&&!r.isLogged()?i.navigateTo("guest-"+e):i.navigateTo(e):o.translate("account.settings.error."+t).then(function(e){n.toast(e)})},u=function(){var e=["account.login.title.logout","account.login.label.logOutMessage","account.login.button.logout","account.login.button.cancel"];o.translate(e).then(function(t){n.showConfirmPopup(t[e[0]],t[e[1]],t[e[2]],t[e[3]]).then(function(){n.loading(!0),s.$emit("userLogOutEvent"),s.$on("userLoggedOutEvent",function(e){n.loading(!1)})})})};e.updateTemperatureUnit=function(t){e.temperatureUnit!==t&&c.updateTemperatureUnit(t)&&(e.temperatureUnit=t)};var d=function(){var e=getContext("featureConfig.multiMarket.isEnabled",!1),t=getContext("featureConfig.multiMarket.displaySettings",!1);return e&&t},f=function(){return getContext("featureConfig.gpsCheckin.isEnabled",!1)&&r.isLogged()},g=function(){return e.enableGPSCheckinButton},p=function(){return getContext("featureConfig.dynamicMenuPage.faqPageEnabled",!1)},m=function(){return getContext("featureConfig.license.enabled",!1)},v=function(){return(getContext("featureConfig.notifications.flightAlertsPushEnabled",!0)||getContext("featureConfig.notifications.tripAddedPushEnabled",!0)||getContext("featureConfig.notifications.flightAlertsEmailEnabled",!0))&&r.isLogged()},h=function(){return(e.enableTermsAndConditionsSection||e.enablePrivacyPolicySection||e.enableCookiePolicyButton)&&!getContext("featureConfig.mainFeatures.isHelpMenuEnabled",!1)};e.showAddressOption=getContext("featureConfig.profile.profileAddressEnabled",!1),e.showLoyaltyCardOption=getContext("featureConfig.loyaltyCards.enabled",!1),e.showCreditCardOption=getContext("featureConfig.profile.isSaveCCCardEnabled",!1),e.showTemperatureControlOption=getContext("featureConfig.dynamicMenuPage.temperatureControlEnabled",!1);var C=function(){e.temperatureUnit=c.getTemperatureUnit()},S=function(){var t=getContext("featureConfig.mainFeatures.isContactUsMenuEnabled",!1),n=getContext("featureConfig.dynamicMenuPage.contactPageEnabled",!1);e.enableContactButton=!t&&n,e.enableCookiePolicyButton=getContext("featureConfig.dynamicMenuPage.cookiesPageEnabled",!1),e.enableCookieSettingsButton=getContext("featureConfig.dynamicMenuPage.cookieSettingsEnabled",!1)&&getContext("featureConfig.cookiesConsent.enabled",!1),e.showMarketOption=d(),e.enableGPSCheckinButton=f(),e.enableFAQButton=p(),e.enableLicenseButton=m(),e.enableAboutSection=(e.enableContactButton||p())&&!getContext("featureConfig.mainFeatures.isHelpMenuEnabled",!1),e.enableInformationSection=g(),e.enableNotificationsSection=v(),e.enableTermsAndConditionsSection=getContext("featureConfig.dynamicMenuPage.termsAndConditionsEnabled",!0),e.enablePrivacyPolicySection=getContext("featureConfig.dynamicMenuPage.privacyPolicyEnabled",!0),e.showLegalSection=h()};e.$on("$ionicView.beforeEnter",function(){S(),C()})}]),accountModule.controller("ProfileSettingsController",["$scope","$log","ProfileService","LayoutService","I18nService","$rootScope","GloballistProcessor","DataManagerService","AnalyticsService","AuthenticationService",function(e,t,n,o,i,r,a,s,c,l){function u(r){e.enableDeleteAccount=getContext("featureConfig.profile.enableDeleteAccount",!1),e.phoneNumberRequired=getContext("featureConfig.registration.phoneNumberRequired",!1);var s=safeAccess(r,"notificationSettings",{});e.pushChannel={flightAlerts:safeAccess(s,"flightAlertType.pushChannelEnabled",!1),newTripAdded:safeAccess(s,"tripAddedType.pushChannelEnabled",!1)},e.emailChannel={flightAlerts:safeAccess(s,"flightAlertType.emailChannelEnabled",!1),newTripAdded:safeAccess(s,"tripAddedType.emailChannelEnabled",!1)},e.smsChannel={newTripAdded:safeAccess(s,"tripAddedType.smsChannelEnabled",!1),flightAlerts:safeAccess(s,"flightAlertType.smsChannelEnabled",!1)},e.localNotifs={checkinReminder:n.isCheckinReminderNotifEnabled()},e.userProfile=e.userProfile||{},e.userProfile.userId=safeAccess(r,"userId"),e.userProfile.firstName=safeAccess(r,"firstName"),e.userProfile.lastName=safeAccess(r,"lastName"),e.userProfile.phoneNumber=safeAccess(r,"mobilePhoneNumber",""),isDefined(safeAccess(r,"mobileCountryCode"))&&(e.userProfile.phoneCode="+"+r.mobileCountryCode);var c=getContext("featureConfig.profile.profileAddressEnabled",!1);if(c){e.addressInputs={street:safeAccess(r,"address.addressLine"),city:safeAccess(r,"address.cityName"),state:safeAccess(r,"address.stateName"),countries:[],zipcode:safeAccess(r,"address.postalCode")};var l=a.getCountryCodeByCountry();l.then(function(t){e.addressInputs.countries=t,e.addressInputs.country=safeAccess(r,"address.countryName")},function(e){t.warn("Something went wrong while fetching country list"+e),i.translate("account.address.error.retrieveCountryFailed").then(function(e){o.toast(e)})})}}function d(r,a,s){o.loading(!0),n.updateProfile(r).then(function(r){t.info("__tryUpdateProfile ok"),o.loading(!1),i.translate(s).then(function(e){o.toast(e)}),n.setCheckinReminderNotifEnabled(e.localNotifs.checkinReminder),n.setSsrNotifEnabled(e.pushChannel.flightAlerts),u(r),e.forms[a].$setPristine(),"addressForm"===a&&c.runSafe(function(){this.sendEvent("Address Save Success",[{value:"-"}],"User Settings")})},function(e){t.error("__tryUpdateProfile failed: "+e),o.loading(!1),"http"===e.errorType?i.translateHttpStatusCode(e.errorCode).then(function(e){o.toastError(e)}):i.translateBackendErrorCodes([e.errorCode]).then(function(e){o.toastError(e)}),"addressForm"===a&&c.runSafe(function(){this.sendException({message:"Address Save Failed",isFatal:!1})})})["catch"](handleUnexpectedError)}t=t.getInstance("ProfileSettingsController"),t.info("Controller Started..."),e.forms={notificationsSettingsForm:{},editProfileForm:{},addressForm:{}},e.userProfile={userId:"",firstName:"",lastName:"",phoneNumber:"",phoneCode:""},e.disableUpdateProfile=!getContext("featureConfig.profile.enableUpdateProfile",!0),
e.displayPhone=getContext("featureConfig.registration.displayPhoneNumberInput",!1),e.enableDeleteAccount=getContext("featureConfig.profile.enableDeleteAccount",!1),e.phoneNumberRequired=getContext("featureConfig.registration.phoneNumberRequired",!1);var f=function(){return e.enableFlightAlertsPush||e.enableTripAddedPush||e.enableCheckinReminderLocalNotif},g=function(){return e.enableFlightAlertsEmail||e.enableTripAddedEmail},p=function(){return e.enableFlightAlertsSms||e.enableTripAddedSms},m=function(){e.enableFlightAlertsPush=getContext("featureConfig.notifications.flightAlertsPushEnabled",!0),e.enableTripAddedPush=getContext("featureConfig.notifications.tripAddedPushEnabled",!0),e.enablePushNotifications=f(),e.enableFlightAlertsEmail=getContext("featureConfig.notifications.flightAlertsEmailEnabled",!0),e.enableTripAddedEmail=getContext("featureConfig.notifications.tripAddedEmailEnabled",!0),e.enableEmailNotifications=g(),e.enableTripAddedSms=getContext("featureConfig.notifications.tripAddedSmsEnabled",!0),e.enableFlightAlertsSms=getContext("featureConfig.notifications.flightAlertsSmsEnabled",!0),e.enableSmsNotifications=p(),e.enableCheckinReminderLocalNotif=getContext("isMobileApp")&&getContext("featureConfig.notifications.checkinReminderLocalNotifEnabled",!0)};m();var v=null;e.$on("$ionicView.leave",function(){isDefined(v)&&v()}),e.saveNotificationsSettings=function(){var t={flightAlertEmailNotification:e.emailChannel.flightAlerts,tripAddedEmailNotification:e.emailChannel.newTripAdded,flightAlertPushNotification:e.pushChannel.flightAlerts,tripAddedPushNotification:e.pushChannel.newTripAdded,tripAddedSmsNotification:e.smsChannel.newTripAdded,flightAlertSmsNotification:e.smsChannel.flightAlerts};d(t,"notificationsSettingsForm","account.notificationsSettings.label.settingsSaved")},e.saveProfile=function(){if(e.forms.editProfileForm.$valid){t.info("saveProfile: form ok");var n={firstName:e.userProfile.firstName,lastName:e.userProfile.lastName};e.displayPhone&&angular.extend(n,{mobileCountryCode:e.userProfile.phoneCode.substr(1),mobilePhoneNumber:e.userProfile.phoneNumber.replace(/[a-zA-Z ()-]/g,"")}),d(n,"editProfileForm","account.editProfile.label.profileUpdated")}else t.warn("saveProfile: form invalid"),o.addErrors(e.forms.editProfileForm.$error)},e.deleteAccount=function(){var e=["account.editProfile.label.deleteAccount","account.editProfile.text.confirmDeleteAccount","core.button.ok","core.button.cancel"];i.translate(e).then(function(t){o.showConfirmPopup(t[e[0]],t[e[1]],t[e[2]],t[e[3]]).then(function(){o.loading(!0),n.deleteProfile().then(function(){o.loading(!1),l.logout({doMiddlewareCall:!1}).then(function(){o.toast("account.editProfile.text.deleteAccountSuccess")})},function(e){o.loading(!1),"http"===e.errorType?i.translateHttpStatusCode(e.errorCode).then(function(e){o.toastError(e)}):i.translateBackendErrorCodes([e.errorCode]).then(function(e){o.toastError(e)})})})})},e.saveAddress=function(){if(c.runSafe(function(){this.sendEvent("Address Save Button Clicked",[{value:"-"}],"User Settings")}),e.forms.addressForm.$valid){t.info("saveAddress: form ok");var n={address:{addressLine:null!=safeAccess(e.addressInputs,"street")?e.addressInputs.street:"",cityName:null!=safeAccess(e.addressInputs,"city")?e.addressInputs.city:"",stateName:null!=safeAccess(e.addressInputs,"state")?e.addressInputs.state:"",countryName:null!=safeAccess(e.addressInputs,"country")?e.addressInputs.country:"",postalCode:null!=safeAccess(e.addressInputs,"zipcode")?e.addressInputs.zipcode:""}};d(n,"addressForm","account.address.label.addressUpdated")}else t.warn("saveAddress: form invalid"),o.addErrors(e.forms.addressForm.$error)},e.$on("$ionicView.enter",function(){var e=n.getProfile();u(e),o.loading(!0),n.getProfileFromServer().then(function(e){u(e)})["finally"](function(){o.loading(!1)}),v=r.$on("paramsUpdates",function(e,t){m()})})}]);var alreadyDownloadedUrl={};accountModule.controller("SharedContentInIframeController",["$scope","$log","LayoutService","ContentService","$timeout","$window","$sce","IFRAME_PARAMS","OneTrustCookiesService","$rootScope",function(e,t,n,o,i,r,a,s,c,l){function u(){i.cancel(g),i.cancel(m)}function d(t){"content_loaded"===t.data&&(e._displayIframe(!0),e.contentLoadedSuccessfully=!0,u(),n.loading(!1),alreadyDownloadedUrl[e.iframeContentUrl]=!0),"navigation_back"===t.data&&isFF()&&window.history.back(),"open_cookies"===t.data&&isFeatureEnabled("cookiesConsent")&&(Optanon||c.init(),Optanon.ToggleInfoDisplay())}function f(){if(navigator.onLine){e.hideSharedContentInIframe&&(e.iframeContentUrl="");var t=o.createStaticUrlForServerContentWithCurrentLocale(s.serverUrl);"cookiepolicy"===s.serverUrl&&(t+=isFeatureEnabled("cookiesConsent")?"?consent=1":"?consent=0"),"cookiepolicy"===s.serverUrl&&getContext("isB2b",!1)&&(t+="&isB2b=1"),e.isIOSWebView?C(t):(t=a.trustAsResourceUrl(t),i(function(){e.iframeId=s.serverUrl+"_iframe",e.iframeContentUrl=t},500),alreadyDownloadedUrl[t]||n.loading(!0))}else e._displayIframe(!1),u()}t=t.getInstance(s.controllerName),t.info("Controller Started...");var g=o.contentSlow(s.labelSlow);e.headerLabel=s.labelHeader,e.contentLoadedSuccessfully=!1,e.hideSharedContentInIframe=!1,e.isIOSWebView=ionic.Platform.isIOS()&&ionic.Platform.isWebView(),e.$on("$ionicView.enter",function(){f()}),e.$on("modal.shown",function(){f()});var p=function(){safeAccess(e,"webview",!1)&&(e.webview.close(),e.webview=null)};e.acceptTermsAndConditions=function(){e.termsAndConditionsSuccess&&e.termsAndConditionsSuccess(),p()},e.rejectTermsAndConditions=function(){e.termsAndConditionsFailure&&e.termsAndConditionsFailure(),p()},e._displayIframe=function(t){e.hideSharedContentInIframe=!t},e.refreshButtonClick=function(){f()},e.slowNetworkHandler=function(){e._displayIframe(!1),n.loading(!1)};var m=i(e.slowNetworkHandler,15e3),v=function(){e.webview.executeScript('setTimeout(function(){var anchors = document.getElementsByTagName("a");for (var index = 0; index < anchors.length; index++) {var anchor = anchors[index];if (anchor.getAttribute("href").startsWith("http") || anchor.getAttribute("href").startsWith("https")) {anchor.dataset.href = anchor.getAttribute("href");anchor.dataset.extension = anchor.getAttribute("extension-type");anchor.setAttribute("href", "javascript:");anchor.addEventListener("click", function(inboxEvent) {webkit.messageHandlers.shareContentHandler.postMessage({linkUrl: inboxEvent.target.dataset.href,extension: inboxEvent.target.dataset.extension});}, false);}}},10)')},h=function(){i(function(){e.contentLoadedSuccessfully=!0},500),v()},C=function(n){if(safeAccess(r,"cordova.plugins.AMWebview")){t.info("Setting URL of WebView: "+n),p(),e.webview=r.cordova.plugins.AMWebview(n,{hasTabs:!0,hideHeader:!0,postMessageHandler:"shareContentHandler",hasAdditionalHeader:"NCMTBOSC"===getContext("SITECODE")}),e.webview.addEventListener("loadend",h);var i=o.getFileOpenerService();i&&e.webview.addEventListener("onMessage",i.handleWebViewContentLink)}};e.$on("$stateChangeStart",function(t,o,i,r,a,s){var c=["termsandconditions","privacypolicy","cookiepolicy","help-termsandconditions","help-privacypolicy","help-cookiepolicy","more-help-termsandconditions","more-help-privacypolicy","more-help-cookiepolicy","guest-help-termsandconditions","guest-help-privacypolicy","guest-help-cookiepolicy","more-guest-help-termsandconditions","more-guest-help-privacypolicy","more-guest-help-cookiepolicy"];c.indexOf(r.name)>-1&&(n.unFocusActiveElement(),e.isIOSWebView&&e.webview&&(e.webview.removeEventListener("onMessage",function(t){e.receiveMessage(t)}),p()))}),l.$on("onMoreMenuPopup",function(t,n){e.isIOSWebView&&e.webview&&(safeAccess(n,"modalDisplayed")?e.webview.hide():e.webview.show())}),r.onIframeContentLoaded=function(t){if(getContext("isMobileApp",!1)){var i=document.getElementById(e.iframeId);if(isDefined(i)){var r=i.contentDocument.documentElement;o.openFileUrl(r)}}""===t.target.src||e.contentLoadedSuccessfully||(u(),alreadyDownloadedUrl[e.iframeContentUrl]=!1,e._displayIframe(!1),n.loading(!1))},r.addEventListener("message",d),e.$on("$destroy",function(){r.removeEventListener("message",d),r.onIframeContentLoaded=void 0,u()})}]),accountModule.service("OneTrustCookiesService",["$log","I18nConfig","ParameterService","$rootScope","$timeout",function(e,t,n,o,i){e=e.getInstance("OneTrustCookiesService"),e.info("OneTrustCookiesService Started...");var r={oneTrustUrls:{DEFAULT:"71082daf-f05a-452e-96a5-002692c3127a",fr:"4c9733d0-e494-4fba-b7a6-76be6857d7f3",de:"b22ac1c3-bada-4dd3-9762-81c8ac78aa65",it:"de737747-ab0b-4666-9e91-05cf004de7ed","pt-BR":"d5ccde65-80ee-4ed2-baec-38263c12e274","pt-PT":"78737b8d-9e79-484d-9dc2-6eaf1a3fba02",sv:"2d7161af-0030-4438-b4df-03a609299a4a",ru:"85ef030c-e4d7-428c-a106-b08c457352da",ja:"a7d56730-399c-4ee4-93ab-9214bcecc102","zh-CN":"661eefff-5b8c-44bf-911c-790d9bda1641","zh-TW":"0f5a2d9e-150d-4142-9a5c-a986e2645294",es:"5c94795c-5dcb-460b-acf8-39b9a57798b9",ar:"3c9fad52-ba2e-4736-b639-a4d3ad8b868c",da:"382dd2a7-0d6a-4a22-aa90-d6d949341cb3",fi:"ecde7313-606f-48c8-8469-027adb3b52b5",ko:"b2d8a57b-3cc4-4e39-808a-1ab3d4f25387",no:"c7906e7f-9b12-4366-8e6e-98a6d23b4528",pl:"a2c770a3-6767-429b-934e-cb7b0c8f6fea",th:"5833d2d5-a375-46b7-8d37-91278a1d3d42",tr:"07f08c03-5019-4a39-9d9e-6273b7ecd2d5",nl:"d030ecd6-785d-4f01-8535-573f1c89bdd4"},determineUrl:function(){var e=n.parse(),o=e.language||t.getCurrentApplicationLanguage(),i=r.oneTrustUrls[o];i=i?i:r.oneTrustUrls.DEFAULT;var a="https://optanon.blob.core.windows.net/consent/",s=getContext("featureConfig.cookiesConsent.url",a),c=getContext("featureConfig.cookiesConsent.script",".js");return s+i+c},getStaticPageUrl:function(e){var t="";return t+="/"===getContext("server","/")?window.location.origin+"/":getContext("server"),t+=getContext("applicationConfig.entryPoint","cmtweb")+"/",getContext("isB2b",!1)?(t+="?ST="+getContext("SITECODE","NCMTDEMO"),t+="&OCTX="+getContext("OCTX","TCPROD"),t+="&TYPE=ONETRUST","cookiepolicy"===e&&(e="onetrust-cookiepolicy")):n.parse().OCTX&&(t+="?OCTX="+n.parse().OCTX),t+="#/"+e},updatePopupDesign:function(e,t,n){var o=document.querySelectorAll("ul#optanon-menu > li")[3];if(o.setAttribute("style","display: none;"),t){for(var i=document.querySelectorAll("#optanon.modern #optanon-popup-top, #optanon.modern #optanon-popup-body-left-shading"),r=0;r<i.length;r++)i[r].setAttribute("style","background-color: "+t+" !important;");document.querySelector("#optanon #optanon-popup-bottom").setAttribute("style","background-color: "+t+" !important;")}if(n){document.querySelector(".optanon-alert-box-wrapper .optanon-alert-box-button-middle").setAttribute("style","background-color: "+n+" !important;");for(var a=document.querySelectorAll("#optanon #optanon-popup-wrapper .optanon-white-button-middle"),s=0;s<a.length;s++)a[s].setAttribute("style","background-color: "+n+" !important;");document.querySelector("div.optanon-alert-box-button-middle.accept-cookie-container").setAttribute("style","background-color: "+n+" !important; border-color: "+n+" !important;")}e&&document.querySelector("#optanon.modern #optanon-popup-wrapper #optanon-branding-top-logo").setAttribute("style","background-image: url('"+e+"') !important;")},getLogoUrlForB2B:function(){e.method("getLogoUrlForB2B");var t="";return t=getContext("isMobileApp",!1)?"resources/":getContext("cdnHost"),t&&(t+=getContext("SITECODE"),t+="/images/logo-toolbar.png"),t},setupUIwithContext:function(){window.addEventListener("load",function(){e.info("DOM loaded");var n,o=r.getStaticPageUrl("cookiepolicy"),a=5;n=window.setInterval(function(){if(a--,document.querySelector(".optanon-alert-box-wrapper")){window.clearInterval(n),e.info("Customizing oneTrust UI...");var s=document.querySelector("a.banner-policy-link"),c=document.querySelector("p.preference-menu-item > a"),l=document.querySelectorAll("ul#optanon-menu > li")[4];if(l.onclick=function(){i(function(){var e=document.querySelectorAll("p.optanon-subgroup-cookies-list.subgroup-cookies-list");if(getContext("featureConfig.restaurantBooking.enabled",!1)&&-1!==getContext("featureConfig.activitiesBooking.defaultUrl").indexOf("opentable")||e[0].setAttribute("style","display: none;"),getContext("featureConfig.activitiesBooking.enabled",!1)&&-1!==getContext("featureConfig.activitiesBooking.defaultUrl").indexOf("mylittleadventure")||e[1].setAttribute("style","display: none;"),getContext("featureConfig.parkcloud.enabled",!1)||e[2].setAttribute("style","display: none;"),getContext("featureConfig.taxiBooking.enabled",!1)&&-1!==getContext("featureConfig.taxiBooking.iframeUrl").indexOf("transferbookingengine")){if(e[3]&&getContext("isB2b",!1)){var n=t.getCurrentDeviceLanguage();"zh"===n&&(n="cn");var o=getContext("featureConfig.taxiBooking.websiteUrl","");if(o){o=o+"?language="+n;var i=e[3].querySelector("div").querySelector("a");i.setAttribute("href",o)}}}else e[3].setAttribute("style","display: none;");if(getContext("featureConfig.loungeBooking.enabled",!1)||e[4].setAttribute("style","display: none;"),e[5]&&!getContext("featureConfig.cytric.enabled",!1)&&e[5].setAttribute("style","display: none;"),e[6]&&!getContext("featureConfig.ezeego1.enabled",!1)&&e[6].setAttribute("style","display: none;"),e[7]&&!getContext("featureConfig.airhelp.enabled",!1)&&e[7].setAttribute("style","display: none;"),(e[8]&&!getContext("featureConfig.activitiesBooking.enabled",!1)||-1===getContext("featureConfig.activitiesBooking.defaultUrl").indexOf("viator"))&&e[8].setAttribute("style","display: none;"),e[9]&&!getContext("featureConfig.stripe.enabled",!1)&&e[9].setAttribute("style","display: none;"),e[10]&&!getContext("featureConfig.flightBookAndSearchEpower.enabled",!1))e[10].setAttribute("style","display: none;");else if(e[10]){var r=getContext("featureConfig.flightBookAndSearchEpower.url","");if(r){var a=e[10].querySelector("div").querySelector("a");a.setAttribute("href",r)}}(e[11]&&!getContext("featureConfig.explore.enabled",!1)||"tripadvisor"!==getContext("featureConfig.explore.PROVIDER"))&&e[11].setAttribute("style","display: none;"),e[12]&&!getContext("featureConfig.bookingDotCom.enabled",!1)&&e[12].setAttribute("style","display: none;")})},s&&s.setAttribute("href",o),c&&c.setAttribute("href",o),getContext("isB2b",!1)){var u=r.getLogoUrlForB2B();r.updatePopupDesign(u)}}else 1>a&&window.clearInterval(n)},500)})},init:function(){if(getContext("featureConfig.cookiesConsent.enabled",!1)){var e=r.determineUrl(),t=getContext("featureConfig.analytics.google.APIKey","UA-18514622-6"),n=getContext("featureConfig.cookiesConsent.analytical_groupId",2),o=getContext("featureConfig.cookiesConsent.targetingAds_groupId",4),i=new RegExp(","+o+","),a="https://amadeus-d.openx.net/privacy/optout",s=document.createElement("script");s.setAttribute("src",e),s.setAttribute("type","text/javascript"),s.setAttribute("charset","UTF-8");var c=document.createElement("script");c.setAttribute("type","text/javascript"),c.innerHTML="function OptanonWrapper(){ Optanon.BlockGoogleAnalytics('"+t+"', "+n+"); if(!OptanonActiveGroups.match("+i+")){var img = document.createElement('img'); img.src ='"+a+"'; img.style='display: none;' ;document.body.appendChild(img);}}",document.head.appendChild(c);var l=document.getElementsByTagName("script")[0];l.parentNode.insertBefore(s,l),r.setupUIwithContext()}},toString:function(){return"OneTrustCookiesService"}};return r}]),accountModule.run(["$templateCache",function(e){e.put("account/templates/pages/AccountActivationView.html",'<ion-view debug-file-path="AccountActivationView.html"><ion-nav-title translate>account.activation.title.activation</ion-nav-title><div ng-class="{&apos;custom-bg-screen&apos;: showCustomBackgroundScreen}"></div><ion-content class="spaced-layout splash"><div class="transbox"></div><article class="contained-narrow"><form name="forms.activateform" novalidate role="form"><cmt-input-email allow-masked-values="allowMaskedValues" class="custom-bg-text" id="userId" label="{{&apos;account.activation.label.email&apos;|translate}}" model-container="activationInputs" model-key="&apos;email&apos;" name="userId" readonly="true" required></cmt-input-email><cmt-input-password class="custom-bg-text semi-spaced-element" data="activationInputs.password" id="password" label="{{&apos;account.activation.label.password&apos;|translate}}" name="password" novalidate required></cmt-input-password><button class="btn-fullwidth spaced-element" name="account_activation_view_submit" ng-click="activate()" translate type="submit">account.activation.button.activate</button></form></article></ion-content></ion-view>'),e.put("account/templates/pages/AddressView.html",'<ion-view debug-file-path="AddressView.html"><ion-nav-title translate>account.address.label.address</ion-nav-title><ion-content><div class="contained-pad loyalty-card-head" translate>account.address.label.address</div><article class="contained-pad"><form name="forms.addressForm" novalidate role="form"><cmt-input-text data="addressInputs.street" id="addressStreet" label="{{&apos;account.address.label.street&apos;|translate}}" maxlength="50" name="street"></cmt-input-text><cmt-input-text data="addressInputs.city" id="addressCity" label="{{&apos;account.address.label.city&apos;|translate}}" maxlength="30" name="city" class="spaced-element"></cmt-input-text><cmt-input-text data="addressInputs.state" id="addressState" label="{{&apos;account.address.label.state&apos;|translate}}" maxlength="25" name="state" class="spaced-element"></cmt-input-text><cmt-input-text data="addressInputs.zipcode" id="addressZipcode" label="{{&apos;account.address.label.zipCode&apos;|translate}}" maxlength="20" name="zipCode" class="spaced-element"></cmt-input-text><cmt-select class="spaced-element" data="addressInputs.country" id="addressCountry" label="{{&apos;account.address.label.country&apos;|translate}}" name="country" ng-if="addressInputs.countries" options="addressInputs.countries" placeholder="{{&apos;account.address.label.selectCountry&apos;|translate}}"></cmt-select><button class="spaced-element btn-fullwidth" id="addressSubmit" name="address_view_submit" ng-click="saveAddress()" ng-disabled="forms.addressForm.$pristine" translate type="submit">account.address.button.save</button></form></article></ion-content></ion-view>'),e.put("account/templates/pages/ForgotPasswordActivationView.html",'<ion-view debug-file-path="ForgotPasswordActivationView.html"><ion-nav-title translate>account.forgotPasswordActivation.title.activation</ion-nav-title><div ng-class="{&apos;custom-bg-screen&apos;: showCustomBackgroundScreen}"></div><ion-content class="spaced-layout splash"><div class="transbox"></div><article class="contained-narrow"><form name="forms.activateform" novalidate role="form"><cmt-input-email allow-masked-values="allowMaskedValues" class="custom-bg-text" id="userId" label="{{&apos;account.forgotPasswordActivation.label.email&apos;|translate}}" model-container="activationInputs" model-key="&apos;email&apos;" name="userId" readonly="true" required></cmt-input-email><cmt-input-password class="custom-bg-text semi-spaced-element" data="activationInputs.password" id="password" label="{{&apos;account.forgotPasswordActivation.label.password&apos;|translate}}" name="password" novalidate required></cmt-input-password><button class="btn-fullwidth spaced-element" name="forgot_password_activation_view_submit" ng-click="activate()" translate type="submit">account.forgotPasswordActivation.button.activate</button></form></article></ion-content></ion-view>'),e.put("account/templates/pages/ForgotPasswordView.html",'<ion-view debug-file-path="ForgotPasswordView.html"><ion-nav-title translate>account.forgotPassword.title.forgotPassword</ion-nav-title><div ng-class="{&apos;custom-bg-screen&apos;: showCustomBackgroundScreen}"></div><ion-content class="spaced-layout splash"><div class="transbox"></div><article class="contained-narrow"><form name="forms.forgotpasswordform" novalidate role="form"><cmt-input-email class="custom-bg-text" label="{{&apos;account.forgotPassword.label.email&apos;|translate}}" model-container="formInputs" model-key="&apos;email&apos;" name="email" required></cmt-input-email><cmt-input-password class="custom-bg-text semi-spaced-element" data="formInputs.password" label="{{&apos;account.forgotPassword.label.password&apos;|translate}}" name="password" ng-if="isPasswordFieldDisplayedInForgotPasswordFlow" required></cmt-input-password><input class="input-hidden-but-active" ng-click="forgotPassword()" ng-if="isInternetExplorer" type="submit"> <button class="btn-fullwidth spaced-element" name="forgot_password_view_submit" ng-click="forgotPassword()" translate type="submit">account.forgotPassword.button.submit</button></form></article></ion-content></ion-view>'),e.put("account/templates/pages/HelpView.html",'<ion-view debug-file-path="HelpView.html"><ion-nav-title translate>account.settings.label.helpmenuitem</ion-nav-title><ion-content><article class="contained-mobile-pad"><div class="list"><div class="item item-divider settings-header" ng-if="isWebDesktop" translate>account.settings.label.helpmenuitem</div><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;help-termsandconditions&apos;)" ng-if="enableTermsAndConditionsSection"><span translate>account.settings.label.termsandcondition</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;help-privacypolicy&apos;)" ng-if="enablePrivacyPolicySection"><span translate>account.settings.label.privacypolicy</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;help-cookiepolicy&apos;)" ng-if="enableCookiePolicyButton"><span translate>account.settings.label.cookiepolicy</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;help-contact&apos;)" ng-if="enableContactButton"><span translate>account.settings.label.contactmenuitem</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;help-faq&apos;)" ng-if="enableFAQButton"><span translate>account.settings.label.faqpage</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;help-license&apos;)" ng-if="enableLicenseButton"><span translate>account.settings.label.licenses</span><i class="icon icon-chevron-right-small"></i></a></div></article></ion-content></ion-view>'),e.put("account/templates/pages/LoginView.html",'<ion-view debug-file-path="LoginView.html"><ion-nav-title translate>account.login.title.login</ion-nav-title><div ng-class="{&apos;custom-bg-screen&apos;: showCustomBackgroundScreen}"></div><ion-content class="spaced-layout splash"><div class="transbox"></div><article class="align-login-page contained-narrow"><i class="cmtLogo" ng-click="handleEasterEgg()"></i><form id="login-form" method="POST" name="forms.loginform" novalidate role="form"><span translate class="log-in-to-see-trip-message ng-hide validation" ng-show="isLoginToSeeYourTripMessageDisplayed">account.login.error.logInToSeeYourTrip</span><cmt-input-email allow-masked-values="allowMaskedValues" class="custom-bg-text" label="{{&apos;account.login.label.email&apos;|translate}}" model-container="loginInputs" model-key="&apos;email&apos;" name="email" required></cmt-input-email><cmt-input-password class="custom-bg-text semi-spaced-element" data="loginInputs.password" label="{{&apos;account.login.label.password&apos;|translate}}" name="password" novalidate required></cmt-input-password><input class="input-hidden-but-active" ng-click="login()" ng-if="isInternetExplorer" type="submit"> <button class="spaced-element btn-fullwidth" id="login-submit" name="login_view_submit" ng-click="login()" translate type="submit">account.login.button.login</button><p class="custom-bg-text sentence spaced-element" ng-if="isForgotPasswordEnabled"><a class="important" navigate-to="forgotpassword" translate>account.login.link.forgotPassword</a></p><p class="custom-bg-text sentence spaced-element" ng-if="isCreateAccountEnabled"><span translate ng-click="handleEasterEgg()" style="cursor:default">account.login.label.notMember</span> <a class="important" navigate-to="register" translate>account.login.link.createAccount</a></p></form></article></ion-content></ion-view>'),e.put("account/templates/pages/NotificationsSettingsView.html",'<ion-view debug-file-path="NotificationsSettingsView.html"><ion-nav-title translate>account.notificationsSettings.title.notifications</ion-nav-title><ion-content><article class="contained-mobile-pad"><form name="forms.notificationsSettingsForm"><div class="list"><div class="item item-divider settings-header" ng-if="enablePushNotifications" translate>account.notificationsSettings.label.pushChannel</div><ion-toggle ng-if="enableFlightAlertsPush" ng-model="pushChannel.flightAlerts" toggle-class="toggle-balanced">{{&apos;account.notificationsSettings.label.flightAlerts&apos;|translate}}</ion-toggle><ion-toggle ng-if="enableTripAddedPush" ng-model="pushChannel.newTripAdded" toggle-class="toggle-balanced">{{&apos;account.notificationsSettings.label.newTripAdded&apos;|translate}}</ion-toggle><ion-toggle ng-if="enableCheckinReminderLocalNotif" ng-model="localNotifs.checkinReminder" toggle-class="toggle-balanced">{{&apos;account.notificationsSettings.label.checkinReminder&apos;|translate}}</ion-toggle><div class="item item-divider settings-header" ng-if="enableEmailNotifications" translate>account.notificationsSettings.label.emailChannel</div><ion-toggle ng-if="enableFlightAlertsEmail" ng-model="emailChannel.flightAlerts" toggle-class="toggle-balanced">{{&apos;account.notificationsSettings.label.flightAlerts&apos;|translate}}</ion-toggle><ion-toggle ng-if="enableTripAddedEmail" ng-model="emailChannel.newTripAdded" toggle-class="toggle-balanced">{{&apos;account.notificationsSettings.label.newTripAdded&apos;|translate}}</ion-toggle><div class="item item-divider settings-header" ng-if="enableSmsNotifications" translate>account.notificationsSettings.label.smsChannel</div><ion-toggle ng-if="enableFlightAlertsSms" ng-model="smsChannel.flightAlerts" toggle-class="toggle-balanced">{{&apos;account.notificationsSettings.label.flightAlerts&apos;|translate}}</ion-toggle><ion-toggle ng-if="enableTripAddedSms" ng-model="smsChannel.newTripAdded" toggle-class="toggle-balanced">{{&apos;account.notificationsSettings.label.newTripAdded&apos;|translate}}</ion-toggle><div class="contained-narrow spaced-layout-element"><button class="btn-fullwidth" name="notification_settings_view_save" ng-click="saveNotificationsSettings()" ng-disabled="forms.notificationsSettingsForm.$pristine" translate>account.notificationsSettings.button.save</button></div></div></form></article></ion-content></ion-view>'),e.put("account/templates/pages/ProfileMenuView.html",'<ion-view debug-file-path="ProfileMenuView.html"><ion-nav-title translate>account.settings.label.profilemenuitem</ion-nav-title><ion-content><article class="contained-mobile-pad"><div class="list"><div class="item item-divider settings-header" ng-if="isWebDesktop" translate>account.settings.label.profilemenuitem</div><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;profile-notifications-settings&apos;)" ng-if="enableNotificationsSection"><span translate>account.settings.label.notification</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right e2e-personal-information" href ng-click="navigateTo(&apos;profile-edit-profile&apos;)"><span translate>account.settings.label.personalinformation</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;profile-market&apos;)" ng-if="showMarketOption"><span translate>multiMarket.label.travelAgency</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;profile-address&apos;)" ng-if="showAddressOption"><span translate>account.address.label.address</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;profile-loyaltycardlist&apos;)" ng-if="showLoyaltyCardOption"><span translate>account.settings.label.loyaltyCards</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;profile-creditcardlist&apos;)" ng-if="showCreditCardOption"><span translate>account.settings.label.creditCards</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" ng-if="showTemperatureControlOption"><span translate class="temperature-control-label">account.settings.label.temperatureControl</span><div class="btn-set temperature-control-buttons"><button name="profile_menu_view_temperature_celcius_button" ng-click="updateTemperatureUnit(&apos;C&apos;)" ng-class="{&apos;active&apos;: temperatureUnit === &apos;C&apos;}" type="button"><span translate class="temperature-unit-text-full">account.settings.text.temperatureCelcius</span> <span translate class="temperature-unit-text-small">account.settings.text.temperatureCelciusSmall</span></button> <button name="profile_menu_view_temperature_fahrenheit_button" ng-click="updateTemperatureUnit(&apos;F&apos;)" ng-class="{&apos;active&apos;: temperatureUnit === &apos;F&apos;}" type="button"><span translate class="temperature-unit-text-full">account.settings.text.temperatureFahrenheit</span> <span translate class="temperature-unit-text-small">account.settings.text.temperatureFahrenheitSmall</span></button></div></a></div><div class="contained-narrow spaced-layout-element"><button name="profile_menu_view_logout_button" ng-click="navigateTo(&apos;logout&apos;)" class="btn-fullwidth" id="e2e-logout" translate>account.settings.label.logoutmenuitem</button></div></article></ion-content></ion-view>'),e.put("account/templates/pages/ProfileView.html",'<ion-view debug-file-path="ProfileView.html"><ion-nav-title translate>account.editProfile.title.editProfile</ion-nav-title><ion-content class="spaced-layout"><article class="contained-narrow"><form name="forms.editProfileForm" novalidate role="form"><cmt-input-email label="{{&apos;account.editProfile.label.email&apos;|translate}}" model-container="userProfile" model-key="&apos;userId&apos;" name="email" readonly="true" required></cmt-input-email><cmt-input-text class="semi-spaced-element" data="userProfile.firstName" label="{{&apos;account.editProfile.label.firstName&apos;|translate}}" name="firstname" readonly="disableUpdateProfile" required use-pattern="firstName"></cmt-input-text><cmt-input-text class="semi-spaced-element" data="userProfile.lastName" label="{{&apos;account.editProfile.label.lastName&apos;|translate}}" name="lastname" readonly="disableUpdateProfile" required use-pattern="lastName"></cmt-input-text><cmt-input-phone class="semi-spaced-element" label="{{&apos;account.editProfile.label.mobileNumber&apos;|translate}}" name="phoneNumber" ng-if="displayPhone" phone-code-model="userProfile.phoneCode" phone-number-model="userProfile.phoneNumber" readonly="disableUpdateProfile" required="{{phoneNumberRequired}}"></cmt-input-phone><button class="btn-fullwidth spaced-element" name="profile_view_submit" ng-click="saveProfile()" translate type="submit" ng-disabled="forms.editProfileForm.$pristine" ng-hide="disableUpdateProfile">account.editProfile.button.save</button><div class="contained-narrow spaced-element" ng-if="enableDeleteAccount"><button class="btn-fullwidth btn-danger e2e-delete-account" name="profile_view_delete_account_button" ng-click="deleteAccount()" translate type="button">account.editProfile.label.deleteAccount</button></div></form></article></ion-content></ion-view>'),
e.put("account/templates/pages/RegistrationView.html",'<ion-view debug-file-path="RegistrationView.html"><ion-nav-title translate>account.registration.title.createAccount</ion-nav-title><div ng-class="{&apos;custom-bg-screen&apos;: showCustomBackgroundScreen}"></div><ion-content class="spaced-layout splash"><div class="transbox"></div><article class="contained-narrow"><form name="forms.registerform" novalidate role="form"><cmt-input-text allow-masked-values="allowMaskedFirstName" class="custom-bg-text" data="registerInputs.firstName" id="registrationFirstname" label="{{&apos;account.registration.label.firstName&apos;|translate}}" name="firstname" readonly="isFirstNameReadOnly" required use-pattern="firstName"></cmt-input-text><cmt-input-text allow-masked-values="allowMaskedLastName" class="custom-bg-text semi-spaced-element" data="registerInputs.lastName" id="registrationLastname" label="{{&apos;account.registration.label.lastName&apos;|translate}}" name="lastname" readonly="isLastNameReadOnly" required use-pattern="lastName"></cmt-input-text><cmt-input-email allow-masked-values="allowMaskedValues" class="custom-bg-text semi-spaced-element" id="registrationEmail" label="{{&apos;account.registration.label.email&apos;|translate}}" model-container="registerInputs" model-key="&apos;email&apos;" name="email" required></cmt-input-email><cmt-input-phone class="custom-bg-text semi-spaced-element" id="registrationPhone" label="{{&apos;account.registration.label.mobileNumber&apos;|translate}}" name="phoneNumber" ng-if="displayPhone" phone-code-model="registerInputs.phoneCode" phone-number-model="registerInputs.phoneNumber" required="{{phoneNumberRequired}}"></cmt-input-phone><cmt-input-password class="custom-bg-text semi-spaced-element" data="registerInputs.password" id="registrationPassword" label="{{&apos;account.registration.label.password&apos;|translate}}" name="password" required></cmt-input-password><div ng-if="isMultiMarket"><multi-market-select class="custom-bg-text" data="marketData" fields-data="registerInputs.marketInformation"></multi-market-select></div><input class="input-hidden-but-active" ng-click="register()" ng-if="isInternetExplorer" type="submit"> <button class="btn-fullwidth spaced-element" id="registrationsubmit" name="registration_view_submit" ng-click="register()" translate type="submit">account.registration.button.createAccount</button></form></article></ion-content></ion-view>'),e.put("account/templates/pages/SettingsView.html",'<ion-view debug-file-path="SettingsView.html"><ion-nav-title translate>account.settings.title.view</ion-nav-title><ion-content><article class="contained-mobile-pad"><div class="list"><div ng-if="isProfileSectionEnabled"><div class="item item-divider settings-header" translate>account.settings.label.profilemenuitem</div><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;notifications-settings&apos;)" ng-if="enableNotificationsSection"><span translate>account.settings.label.notification</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right e2e-personal-information" href ng-click="navigateTo(&apos;edit-profile&apos;)"><span translate>account.settings.label.personalinformation</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;market&apos;)" ng-if="showMarketOption"><span translate>multiMarket.label.travelAgency</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;address&apos;)" ng-if="showAddressOption"><span translate>account.address.label.address</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;loyaltycardlist&apos;)" ng-if="showLoyaltyCardOption"><span translate>account.settings.label.loyaltyCards</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;creditcardlist&apos;)" ng-if="showCreditCardOption"><span translate>account.settings.label.creditCards</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" ng-if="showTemperatureControlOption"><span translate class="temperature-control-label">account.settings.label.temperatureControl</span><div class="btn-set temperature-control-buttons"><button ng-click="updateTemperatureUnit(&apos;C&apos;)" name="profile_menu_view_temperature_celcius_button" ng-class="{&apos;active&apos;: temperatureUnit === &apos;C&apos;}" type="button"><span translate class="temperature-unit-text-full">account.settings.text.temperatureCelcius</span> <span translate class="temperature-unit-text-small">account.settings.text.temperatureCelciusSmall</span></button> <button ng-click="updateTemperatureUnit(&apos;F&apos;)" name="profile_menu_view_temperature_fahrenheit_button" ng-class="{&apos;active&apos;: temperatureUnit === &apos;F&apos;}" type="button"><span translate class="temperature-unit-text-full">account.settings.text.temperatureFahrenheit</span> <span translate class="temperature-unit-text-small">account.settings.text.temperatureFahrenheitSmall</span></button></div></a></div><div ng-if="showLegalSection"><div class="item item-divider settings-header" translate>account.settings.label.legalmenuitem</div><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;termsandconditions&apos;)" ng-if="enableTermsAndConditionsSection"><span translate>account.settings.label.termsandcondition</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;privacypolicy&apos;)" ng-if="enablePrivacyPolicySection"><span translate>account.settings.label.privacypolicy</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;cookiepolicy&apos;)" ng-if="enableCookiePolicyButton"><span translate>account.settings.label.cookiepolicy</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right optanon-toggle-display" href ng-if="enableCookieSettingsButton"><span translate>account.settings.label.cookiesettings</span> <i class="icon icon-chevron-right-small"></i></a></div><div ng-if="enableAboutSection"><div class="item item-divider settings-header" translate ng-if="enableInformationSection">account.settings.label.informationmenuitem</div><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;gpsCheckin&apos;)" ng-if="enableGPSCheckinButton"><span translate>gpsCheckin.label.gpsCheckin</span> <i class="icon icon-chevron-right-small"></i></a></div><div ng-if="enableAboutSection"><div class="item item-divider settings-header" translate>account.settings.label.aboutmenuitem</div><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;contact&apos;)" ng-if="enableContactButton"><span translate>account.settings.label.contactmenuitem</span> <i class="icon icon-chevron-right-small"></i> </a><a class="item cmt-link-midcontrast item-icon-right" href ng-click="navigateTo(&apos;faq&apos;)" ng-if="enableFAQButton"><span translate>account.settings.label.faqpage</span> <i class="icon icon-chevron-right-small"></i></a></div></div><div class="contained-narrow spaced-layout-element" ng-if="isProfileSectionEnabled"><button ng-click="navigateTo(&apos;logout&apos;)" class="btn-fullwidth" id="e2e-logout" translate>account.settings.label.logoutmenuitem</button></div></article></ion-content></ion-view>'),e.put("account/templates/pages/SharedContentInIframeView.html",'<ion-view debug-file-path="SharedContentInIframeView.html"><ion-nav-title>{{headerLabel | translate}}</ion-nav-title><ion-content class="iframe-fullpage" ng-class="{&apos;hideContentOverflow&apos;: hideSharedContentInIframe}"><div class="sharedContentErrorContainer" ng-if="hideSharedContentInIframe"><p><i class="space-rt icon icon-alert-tri-outline"></i><br>{{&apos;account.settings.error.nonetwork&apos;|translate}}</p><button class="btn-small" name="shared_content_in_iframe_view_refresh_button" ng-click="refreshButtonClick()" type="button"><i class="space-rt icon-refresh"></i> {{&apos;account.settings.button.refresh&apos;|translate}}</button></div><div class="iframe-container" ng-if="!isIOSWebView"><iframe class="iframe-content" id="{{iframeId}}" ng-class="{&apos;sharedContentFrameHidden&apos;: hideSharedContentInIframe}" ng-src="{{iframeContentUrl}}" onload="if(window.onIframeContentLoaded) window.onIframeContentLoaded(event)"></iframe></div></ion-content></ion-view>'),e.put("account/templates/partial/termsAndConditions.html",'<ion-modal-view class="terms-and-conditions-modal" debug-file-path="termsAndConditions.html"><ion-header-bar class="bar-stable"><h1 class="title" translate>account.registration.title.termsAndConditions</h1></ion-header-bar><ion-content class="t-and-c-with-buttons has-header" ng-show="!isIOSWebView"><div class="t-and-c-with-buttons align-t-and-c" ng-controller="SharedContentInIframeController" ng-class="{&apos;hideContentOverflow&apos;: hideSharedContentInIframe}" ng-if="!isIOSWebView"><div class="has-header has-tabs"><div class="sharedContentErrorContainer" ng-if="hideSharedContentInIframe"><p><i class="space-rt icon icon-alert-tri-outline"></i><br>{{&apos;account.settings.error.nonetwork&apos;|translate}}</p><button class="btn-small" name="terms_and_conditions_refresh_button" ng-click="refreshButtonClick()" type="button"><i class="space-rt icon-refresh"></i> {{&apos;account.settings.button.refresh&apos;|translate}}</button></div></div><div class="iframe-container"><iframe class="iframe-content" id="{{iframeId}}" ng-class="{&apos;iframe-loaded&apos;: contentLoadedSuccessfully}" ng-src="{{iframeContentUrl}}" onload="if(window.onIframeContentLoaded) window.onIframeContentLoaded(event)"></iframe></div><div ng-class="{&apos;fixedFooter&apos;: hideSharedContentInIframe}"><a class="two-equal-column reject" id="rejecttandc" ng-click="rejectTermsAndConditions()" translate ng-show="isOnline">account.registration.link.reject</a> <a class="two-equal-column accept" id="accepttandc" ng-click="acceptTermsAndConditions()" translate ng-show="isOnline &amp;&amp; contentLoadedSuccessfully">account.registration.link.accept</a></div></div></ion-content><ion-content ng-if="isIOSWebView" scroll="false"><div class="t-and-c-with-buttons fixedFooterIOS" ng-controller="SharedContentInIframeController"><a class="two-equal-column reject" id="rejecttandc" ng-click="rejectTermsAndConditions()" translate>account.registration.link.reject</a> <a class="two-equal-column accept" id="accepttandc" ng-click="acceptTermsAndConditions()" translate ng-show="contentLoadedSuccessfully">account.registration.link.accept</a></div></ion-content></ion-modal-view>')}]);var moduleDependencies=["ionic","CoreModule","AccountModule","satellizer"];getContext("isMobileApp",!1)&&moduleDependencies.push("AccountCordovaModule"),window.socialModule=angular.module("SocialModule",moduleDependencies),window.socialModule.run(["$log","SocialService","$injector",function(e,t,n){if(e=e.getInstance("Social"),e.info("Module started"),getContext("isMobileApp",!1)){if(getContext("featureConfig.facebook.enabled",!1)){var o=n.get("FacebookConnectorService");t.registerConnector(o,o.ID)}if(getContext("featureConfig.google.enabled",!1)){var i=n.get("GoogleplusConnectorService");t.registerConnector(i,i.ID)}}}]),window.socialModule.config(["$translatePartialLoaderProvider","$authProvider",function(e,t){e.addPart("social"),getContext("featureConfig.facebook.enabled",!1)&&t.facebook({clientId:getContext("featureConfig.facebook.appID",function(){throw new Error("Can't activate Facebook login without AppID")})}),getContext("featureConfig.google.enabled",!1)&&t.google({clientId:getContext("featureConfig.google.appID",function(){throw new Error("Can't activate Google login without AppID")})})}]),window.socialModule.routes={social:{url:"/socialLogin",templateUrl:"social/templates/pages/SocialActionView.html",controller:"SocialButtonsController"}},socialModule.service("SocialService",["RequestService","$log","$q","$auth","AuthenticationService","I18nConfig","$rootScope","I18nService","StringService",function(e,t,n,o,i,r,a,s,c){t=t.getInstance("SocialService"),t.info("Service Started...");var l={},u={LOGIN_WITH_SOCIAL_URL_PATH:"v1/account/loginWithSocial",TOKEN_BELONGS_TO_ANOTHER_APPID:"777804",_hasNativePlugin:function(e){return e=isDefined(e)?e.toLowerCase():"",isDefined(l[e])&&l[e].isNative()},registerConnector:function(e,t){l[t.toLowerCase()]=e},login:function(e,r){this._currentProvider=e;var a,s=n.defer();return a=this._hasNativePlugin(e)?l[e.toLowerCase()].login(r):o.authenticate(e),a.then(function(t){u._socialLoginSuccessCallback(t,e,s)},function(n){t.error("Failed to login: ",n),n.errorMessage!==i.ERR_NO_INTERNET_CONNECTIVITY&&u.logout({provider:e,doOnServerSide:!0,doOnSocialSide:!1}),s.reject(n)}),s.promise},_socialLoginSuccessCallback:function(n,o,a){t.debug(n),t.profile("sociallogin");var l=i.augmentLoginLogoutPayloadWithDeviceInfo({email:n.email,network:{type:c.capitalizedFirst((o||"").toLowerCase()),token:n.accessToken},preferredLanguage:r.getCurrentAmadeusLanguage()}),d=e.post(u.LOGIN_WITH_SOCIAL_URL_PATH,l);d.then(function(e){t.profile("sociallogin");var r=safeAccess(e,"data.errorCodes",[]);r.indexOf(u.TOKEN_BELONGS_TO_ANOTHER_APPID)>-1?(t.backendError(e),s.translateBackendErrorCodes(r).then(function(e){u.logout({provider:o,doOnServerSide:!1,doOnSocialSide:!0}).then(function(){a.reject(e)})})):(l.password=n.accessToken,i.loginSuccessCallback(e,l,a).then(null,function(){u.logout({provider:o,doOnServerSide:!1,doOnSocialSide:!0})}))},function(e){t.profile("sociallogin"),i.loginFailureCallback(e,l,a)}),u.registerEvents()},logout:function(e){var r=n.defer();return e.doOnSocialSide?this._hasNativePlugin(e.provider)?l[e.provider.toLowerCase()].logout().then(function(){t.log("Log out success"),r.resolve()},function(e){t.error("Failed to log out user: ",e),r.reject(e)})["finally"](function(){i.logout({doMiddlewareCall:e.doOnServerSide})}):o.logout().then(function(){r.resolve()})["catch"](function(e){t.error(e),r.reject(e)})["finally"](function(){i.logout({doMiddlewareCall:e.doOnServerSide})}):i.logout({doMiddlewareCall:e.doOnServerSide}),u.userLogOutEventDeregistrationHandler&&(u.userLogOutEventDeregistrationHandler(),delete u.userLogOutEventDeregistrationHandler),r.promise},share:function(){},registerEvents:function(){u.userLogOutEventDeregistrationHandler&&(t.warn("userLogOutEventDeregistrationHandler is still alive !!!"),u.userLogOutEventDeregistrationHandler()),u.userLogOutEventDeregistrationHandler=a.$on("userLogOutEvent",function(){u.logout({provider:u._currentProvider,doOnServerSide:!0,doOnSocialSide:!0})})},toString:function(){return"SocialService"}};return isDefined(i.getUserAuthMethod())&&i.getUserAuthMethod()!==i.EMAIL_METHOD&&u.registerEvents(),u}]),socialModule.controller("SocialButtonsController",["$scope","SocialService","$log","LayoutService","AuthenticationService","OrchestratorChiefService","$ionicModal","NetworkService","$q",function(e,t,n,o,i,r,a,s,c){function l(){var t=c.defer(),n=s.hasConnectivity(!0);return e.isOnline=n.isOnline,e.isOnline?a.fromTemplateUrl("account/templates/partial/termsAndConditions.html",{scope:e,animation:"slide-in-up"}).then(function(n){e.termsAndConditionsModal=n,e.termsAndConditionsSuccess=function(){o.removeModal(e.termsAndConditionsModal).then(function(){t.resolve()})},e.termsAndConditionsFailure=function(){o.removeModal(e.termsAndConditionsModal).then(function(){t.reject({errorMessage:f})})},o.showModal(e.termsAndConditionsModal)}):n.then(function(){t.reject({errorMessage:d})}),t.promise}function u(e){l().then(function(){return o.loading(!0,"social.login.message.canBeLong",3e4),t.login(e).then(function(){o.loading(!1),r.next({islogged:!0})})})["catch"](function(t){o.loading(!1);var n=[f,d,g,m];if(-1===n.indexOf(t.errorMessage)){var r;t.errorMessage!==i.ERR_NO_INTERNET_CONNECTIVITY&&t.errorMessage!==p||(r="core.httpErrorCodes.0"),v(e,r)}})}n=n.getInstance("SocialButtonsController"),n.info("Controller Started..."),e.enableFacebook=getContext("featureConfig.facebook.enabled",!1),e.enableGoogle=getContext("featureConfig.google.enabled",!1);var d=0,f=1,g="User cancelled dialog",p="Facebook error: CONNECTION_FAILURE: CONNECTION_FAILURE",m=12501;e.isIOSWebView=ionic.Platform.isIOS()&&ionic.Platform.isWebView();var v=function(e,t){var n="social.login.error."+e+"Login",i=angular.isString(t)?t:n;o.toastError(i)};e.loginWithFacebook=function(){u("facebook")},e.loginWithGplus=function(){u("google")}}]),socialModule.run(["$templateCache",function(e){e.put("social/templates/pages/SocialActionView.html",'<ion-view debug-file-path="SocialActionView.html"><ion-nav-title translate>social.redirect.title</ion-nav-title><ion-content class="spaced-layout splash"><ng-include src="&apos;social/templates/partial/SocialButtons.html&apos;"></ng-include></ion-content></ion-view>'),e.put("social/templates/partial/SocialButtons.html",'<div debug-file-path="SocialButtons.html" ng-controller="SocialButtonsController"><button class="btn-fullwidth btn-facebook" ng-click="loginWithFacebook()" ng-if="enableFacebook" translate type="button">social.login.button.facebook</button> <button class="btn-fullwidth btn-google" ng-click="loginWithGplus()" ng-if="enableGoogle" translate type="button">social.login.button.google</button></div>')}]),window.authModule=angular.module("AuthModule",["CoreModule","AccountModule","SocialModule"]),window.authModule.config(function(){}),authModule.service("AuthenticationRequestInterceptor",["RequestUtil","$injector",function(e,t){var n={_accessToken:null,setUserAccessToken:function(e){isDefined(e)&&(n._accessToken=e)},_getUserAccessToken:function(){var e=t.get("AuthenticationService");return e.getUserAccessToken()},request:function(t){var o=t.url;if(e.isRequestManagedExtension(o)&&e.isRequestUrlMatch(o,getContext("applicationConfig.securedUrls",[]))){var i=n._getUserAccessToken();i&&(t.headers=t.headers||{},t.headers.Authorization="Bearer "+i)}return t}};return n}]),authModule.service("AuthenticationResponseInterceptor",["$rootScope","$q","$injector",function(e,t,n){function o(e,t){var n=safeAccess(e,"data.errorCodes",[]);return n.indexOf(t)>-1}function i(e){var o=t.defer();e.cmtIsRequestRetry=!0;var i=n.get("BackgroundLoginService");return i.backgroundLogin().then(function(){r.info("Silent relogin ok, will retry the original request");var t=n.get("$http");t(e).then(function(e){r.info("Retry ok"),o.resolve(e)},function(e){r.info("Retry fail"),o.reject(e)})},function(t){r.info("Silent relogin fail, abandoning the original request");var n=Array.isArray(t)?t:[t],i={config:e,data:{success:!1,errorCodes:["000000"],debugErrorMessages:n},headers:{},status:200,statusText:"OK (faked)"};o.reject(i)}),o.promise}var r=angular.injector(["ng"]).get("$log");getContext("applicationConfig.logLevel",6)>2&&r.info("[AuthenticationResponseInterceptor] Service Started...");var a="800204",s="800202",c="800209",l="800211",u="800212",d={response:function(t){var n=safeAccess(t,"data.success");if(n===!1){if(t.config.cmtIsRequestRetry)return r.info("Request retry failed, giving up!"),t;var d=getContext("isMobileApp",!1);if(o(t,a)&&!d||o(t,s)||o(t,c)||o(t,l)||o(t,u))r.info("[AuthenticationResponseInterceptor] can not authenticate the user, need to log out!"),t.cmtSwallowError=!0,e.$emit("auth:needToLogOutTheUserEvent");else if(o(t,a)&&d){r.info("[AuthenticationResponseInterceptor] user access token expired, will try to relogin and retry the request once");var f=t.config,g=i(f);return g}}return t}};return d}]),authModule.service("BackgroundLoginService",["$log","$q","AuthenticationService","SocialService","LoginWithEmailService","DataManagerService","$injector",function(e,t,n,o,i,r,a){e=e.getInstance("BackgroundLoginService"),e.info("Service Started...");var s="ERR_NO_AUTH_DATA_IN_STORAGE",c={backgroundLogin:function(){var e=t.defer(),i=n.getUserAuthMethod(),a=n.getUser(),l=getContext("featureConfig.smartTrip.enabled",!1)||getContext("featureConfig.cytric.enabled",!1),u=safeAccess(a,"userId");if(isDefined(u)&&isDefined(i))if(i===n.EMAIL_METHOD)n.getUserPassword().then(function(t){return l?void r.getSecureAsync("SMART_TRIP_PIN").then(function(n){return c.loginWithIdAndPassword(n,t,e)},function(){e.reject(s)}):c.loginWithIdAndPassword(u,t,e)},function(){e.reject(s)});else if(i===n.CORPORATE_METHOD){var d=getContext("featureConfig.corporate.identityProvider",""),f=c._getCorporateService();isDefined(f)?f.login(d,!0).then(function(){c.__backgroundLoginSuccess(e)},function(t){c.__backgroundLoginFailure(e,t)}):c.__backgroundLoginFailure(e,"CorporateService not found")}else o.login(i,!0).then(function(){c.__backgroundLoginSuccess(e)},function(t){c.__backgroundLoginFailure(e,t)});else e.reject(s);return e.promise},_getCorporateService:function(){return a.has("CorporateService")?a.get("CorporateService"):void 0},__backgroundLoginSuccess:function(e){e.resolve()},__backgroundLoginFailure:function(t,n){e.error("Fail to silent login: "+n),t.reject(n)},loginWithIdAndPassword:function(e,t,n){return i.login(e,t).then(function(){c.__backgroundLoginSuccess(n)},function(e){c.__backgroundLoginFailure(n,e)}),n.promise},toString:function(){return"BackgroundLoginService"}};return c}]);