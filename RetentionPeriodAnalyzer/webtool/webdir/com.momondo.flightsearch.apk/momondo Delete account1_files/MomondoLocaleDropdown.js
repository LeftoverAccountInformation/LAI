(function(e,c){e.extend("RP.MomondoLocaleDropdown",{});var f=e.RP.MomondoLocaleDropdown=function(a){this.id=a;return this};f.prototype={constructor:f,id:"",dialog:void 0,countryList:void 0,languageList:void 0,currencyList:void 0,countryLabel:void 0,languageLabel:void 0,currencyLabel:void 0,selectionContent:void 0,options:{currentCountryCode:"",currentCountryUrl:"",currentLanguageCode:"",currentCurrencyCode:"",placeholderText:""},previousCC:"",previousLC:"",previousCurr:"",init:function(){var a=this;
this.dialog=new e.Widgets.DropdownDialog(c("#"+a.id),{onClose:c.proxy(a.onDropdownClose,a),onOpen:c.proxy(a.onDropdownOpen,a)});c.ajax({url:"/s/horizon/common/layout/brands/momondo/MomondoLocaleDropdownContent",data:{id:a.id},success:function(b){c.trim(b.content)?(a.dialog.content.html(b.content),a.initContent()):a.dialog.hide(400)}})},getChildElement:function(a){return c("#"+this.id+"-"+a)},initContent:function(){this.localeContainer=this.getChildElement("localeContainer");this.options.currentCountryCode=
this.localeContainer.data("currentcountrycode");this.options.currentLanguageCode=this.localeContainer.data("currentlanguagecode");this.options.currentCurrencyCode=this.localeContainer.data("currentcurrencycode");this.options.placeholderText=this.localeContainer.data("placeholdertext");this.previousCC=this.options.currentCountryCode;this.previousLC=this.options.currentLanguageCode;this.previousCurr=this.options.currentCurrencyCode;this.countryList=this.getChildElement("countries");this.languageList=
this.getChildElement("languages");this.currencyList=this.getChildElement("currency");this.countryLabel=this.getChildElement("localeCountry");this.languageLabel=this.getChildElement("localeLanguage");this.currencyLabel=this.getChildElement("localeCurrency");this.selectionContent=this.getChildElement("selectionContent");this.dialog.updateLabel(this.options.placeholderText);this.addEventHandlers()},onDropdownOpen:function(){var a=this;setTimeout(function(){a.dialog.content.addClass("rendered")},100)},
onDropdownClose:function(){this.dialog.content.removeClass("rendered");this.selectionContent.addClass("show");c(".js-locale-list-container",this.dialog.content).removeClass("show")},openList:function(a){a.addClass("show");this.selectionContent.removeClass("show")},closeList:function(a){a.removeClass("show");this.selectionContent.addClass("show")},saveCurrency:function(){c.ajax({type:"POST",url:"/k/ident/currency",data:{currency:this.options.currentCurrencyCode,posted:!0,save:!1},dataType:"text",success:function(){location.reload()},
cache:!1})},addEventHandlers:function(){var a=this;c(".js-selection",a.dialog.content).click(function(b){a.openList(c("#"+c(b.currentTarget).data("list")))});c(".js-locale-list-container \x3e .js-back",a.dialog.content).click(function(b){a.closeList(c(b.currentTarget).parent())});c("li",a.countryList).on("click",function(b){var d=c(b.delegateTarget);a.options.currentCountryCode=d.data("countrycode");a.options.currentCountryUrl=d.data("url");b=d.data("countryname");for(var d=d.data("languages").split("|"),
e="",h=0;h<d.length;h++){var g=d[h].split(";"),f=g[0],k=g[1],g=g[2];0==h&&(a.languageLabel.html(k),a.options.currentLanguageCode=f);e+="\x3cli data-langcode\x3d'"+f+"' data-langname\x3d'"+k+"' data-url\x3d'"+g+"'\x3e"+k+"\x3c/li\x3e"}c("ul",a.languageList).html(e);a.addLanguagesEventHandlers();a.countryLabel.html(a.formatCountryLabel(a.options.currentCountryCode,b));a.closeList(a.countryList)});a.addLanguagesEventHandlers();c("li",a.currencyList).on("click",function(b){b=c(b.delegateTarget);a.options.currentCurrencyCode=
b.data("currencycode");a.currencyLabel.html(a.formatCurrencyLabel(b.data("currencycode"),b.data("currencyname")));a.closeList(a.currencyList)});c(".cancel",a.dialog.content).on("click",function(){a.dialog.close()});c(".ok",a.dialog.content).on("click",function(){if(a.hasAnyChanges())if(a.onlyCurrencyChanged())a.saveCurrency();else{var b="/in?cc\x3d"+a.options.currentCountryCode+"\x26lc\x3d"+a.options.currentLanguageCode+"\x26mc\x3d"+a.options.currentCurrencyCode;a.options.currentCountryUrl&&(b=a.options.currentCountryUrl,
-1<b.indexOf("/in?")&&(b+="\x26mc\x3d"+a.options.currentCurrencyCode));window.location=b}else a.dialog.close()})},onlyCurrencyChanged:function(){return this.options.currentCountryCode===this.previousCC&&this.options.currentLanguageCode===this.previousLC},hasAnyChanges:function(){return this.options.currentCountryCode!==this.previousCC||this.options.currentLanguageCode!==this.previousLC||this.options.currentCurrencyCode!==this.previousCurr},addLanguagesEventHandlers:function(){var a=this;c("li",a.languageList).on("click",
function(b){b=c(b.delegateTarget);a.options.currentLanguageCode=b.data("langcode");a.languageLabel.html(b.data("langname"));if(b=b.data("url"))a.options.currentCountryUrl=b;a.closeList(a.languageList)})},formatCurrencyLabel:function(a,b){return b+"\x3cspan class\x3d'currencyCode'\x3e"+a+"\x3c/span\x3e"},formatCountryLabel:function(a,b){return"\x3cspan class\x3d'flag "+a+"'\x3e\x26nbsp;\x3c/span\x3e "+b}}})(window.R9,window.jq||window.jQuery);